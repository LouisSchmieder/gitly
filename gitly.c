
#ifndef V_COMMIT_HASH
	#define V_COMMIT_HASH "b3011b4"
#endif

#ifndef V_CURRENT_COMMIT_HASH
	#define V_CURRENT_COMMIT_HASH "85b6859"
#endif

// V typedefs:

typedef struct {
	void* _object;
	int _interface_idx;
} _Interface;

typedef struct strings__Builder strings__Builder;
typedef union strconv__Float64u strconv__Float64u;
typedef struct strconv__PrepNumber strconv__PrepNumber;
typedef union strconv__Float64u strconv__Float64u;
typedef struct strconv__Dec32 strconv__Dec32;
typedef union strconv__Uf32 strconv__Uf32;
typedef struct strconv__Uint128 strconv__Uint128;
typedef struct strconv__Dec64 strconv__Dec64;
typedef union strconv__Uf64 strconv__Uf64;
typedef struct strconv__BF_param strconv__BF_param;
typedef struct array array;
typedef struct VAssertMetaInfo VAssertMetaInfo;
typedef struct MethodAttr MethodAttr;
typedef struct DenseArray DenseArray;
typedef struct map map;
typedef struct OptionBase OptionBase;
typedef struct Option Option;
typedef struct SortedMap SortedMap;
typedef struct mapnode mapnode;
typedef struct string string;
typedef struct ustring ustring;
typedef struct RepIndex RepIndex;
typedef struct os__FilePermission os__FilePermission;
typedef struct os__FileMode os__FileMode;
typedef struct os__File os__File;
typedef struct os__FileInfo os__FileInfo;
typedef struct os__Result os__Result;
typedef struct os__Uname os__Uname;
typedef struct time__StopWatchOptions time__StopWatchOptions;
typedef struct time__StopWatch time__StopWatch;
typedef struct time__Time time__Time;
typedef struct hl__Lang hl__Lang;
typedef struct sqlite__DB sqlite__DB;
typedef struct sqlite__Row sqlite__Row;
typedef struct net__urllib__URL net__urllib__URL;
typedef struct net__urllib__Userinfo net__urllib__Userinfo;
typedef struct net__urllib__ParseAuthorityRes net__urllib__ParseAuthorityRes;
typedef struct net__urllib__Value net__urllib__Value;
typedef struct net__urllib__Values net__urllib__Values;
typedef struct net__openssl__SSL_CTX net__openssl__SSL_CTX;
typedef struct net__openssl__SSL net__openssl__SSL;
typedef struct net__openssl__SSL_METHOD net__openssl__SSL_METHOD;
typedef struct net__http__chunked__ChunkScanner net__http__chunked__ChunkScanner;
typedef struct crypto__sha1__Digest crypto__sha1__Digest;
typedef struct crypto__sha256__Digest crypto__sha256__Digest;
typedef struct net__Socket net__Socket;
typedef struct log__Log log__Log;
typedef struct net__http__Cookie net__http__Cookie;
typedef struct net__http__Request net__http__Request;
typedef struct net__http__FetchConfig net__http__FetchConfig;
typedef struct net__http__Response net__http__Response;
typedef struct sync__PoolProcessor sync__PoolProcessor;
typedef struct sync__PoolProcessorConfig sync__PoolProcessorConfig;
typedef struct sync__SResult sync__SResult;
typedef struct sync__IResult sync__IResult;
typedef struct sync__Mutex sync__Mutex;
typedef struct sync__RwMutex sync__RwMutex;
typedef struct sync__RwMutexAttr sync__RwMutexAttr;
typedef struct sync__MacOSX_Semaphore sync__MacOSX_Semaphore;
typedef struct sync__PosixSemaphore sync__PosixSemaphore;
typedef struct sync__CondAttr sync__CondAttr;
typedef struct sync__Semaphore sync__Semaphore;
typedef struct sync__Waiter sync__Waiter;
typedef struct sync__WaitGroup sync__WaitGroup;
typedef struct rand__wyrand__WyRandRNG rand__wyrand__WyRandRNG;
typedef struct vweb__Context vweb__Context;
typedef struct vweb__Cookie vweb__Cookie;
typedef struct vweb__Result vweb__Result;
typedef struct rand__PRNGConfigStruct rand__PRNGConfigStruct;
typedef struct main__Branch main__Branch;
typedef struct main__Comment main__Comment;
typedef struct main__Commit main__Commit;
typedef struct main__Change main__Change;
typedef struct main__File main__File;
typedef struct main__App main__App;
typedef struct main__Issue main__Issue;
typedef struct main__Label main__Label;
typedef struct main__LangStat main__LangStat;
typedef struct main__OAuthRequest main__OAuthRequest;
typedef struct main__GitHubUser main__GitHubUser;
typedef struct main__Release main__Release;
typedef struct main__Repo main__Repo;
typedef struct main__SecurityLog main__SecurityLog;
typedef struct main__GitlySettings main__GitlySettings;
typedef struct main__Tag main__Tag;
typedef struct main__Token main__Token;
typedef struct main__User main__User;
typedef struct main__SshKey main__SshKey;
typedef struct main__Email main__Email;
typedef struct main__Contributor main__Contributor;
typedef struct main__OAuth_Request main__OAuth_Request;
typedef struct main__GitHubUser main__GitHubUser;
typedef struct main__Visit main__Visit;
typedef struct varg_voidptr varg_voidptr;
typedef struct varg_string varg_string;
typedef struct varg_int varg_int;

// V typedefs2:
typedef struct Option_int Option_int;
typedef struct Option_voidptr Option_voidptr;
typedef struct Option_array_byte Option_array_byte;
typedef struct Option_string Option_string;
typedef struct Option_void Option_void;
typedef struct Option_array_string Option_array_string;
typedef struct Option_bool Option_bool;
typedef struct Option_array_ustring Option_array_ustring;
typedef struct Option_os__File Option_os__File;
typedef struct Option_os__Result Option_os__Result;
typedef struct Option_time__Time Option_time__Time;
typedef struct Option_hl__Lang Option_hl__Lang;
typedef struct Option_sqlite__DB Option_sqlite__DB;
typedef struct Option_sqlite__Row Option_sqlite__Row;
typedef struct Option_net__urllib__URL Option_net__urllib__URL;
typedef struct Option_net__urllib__ParseAuthorityRes Option_net__urllib__ParseAuthorityRes;
typedef struct Option_net__urllib__Values Option_net__urllib__Values;
typedef struct Option_net__Socket Option_net__Socket;
typedef struct Option_net__http__Response Option_net__http__Response;
typedef struct Option_net__http__Request Option_net__http__Request;
typedef struct Option_array_main__Issue Option_array_main__Issue;
typedef struct Option_main__Issue Option_main__Issue;
typedef struct Option_array_main__Commit Option_array_main__Commit;
typedef struct Option_main__Commit Option_main__Commit;
typedef struct Option_main__User Option_main__User;
typedef struct Option_main__File Option_main__File;
typedef struct Option_main__Repo Option_main__Repo;
typedef struct Option_main__OAuthRequest Option_main__OAuthRequest;
typedef struct Option_main__GitHubUser Option_main__GitHubUser;

// V cheaders:
// Generated by the V compiler
#include <inttypes.h>

//================================== builtin types ================================*/
typedef int64_t i64;
typedef int16_t i16;
typedef int8_t i8;
typedef uint64_t u64;
typedef uint32_t u32;
typedef uint16_t u16;
typedef uint8_t byte;
typedef uint32_t rune;
typedef float f32;
typedef double f64;
typedef int64_t any_int;
typedef double any_float;
typedef unsigned char* byteptr;
typedef void* voidptr;
typedef char* charptr;
typedef struct array array;
typedef struct map map;
typedef array array_string;
typedef array array_int;
typedef array array_byte;
typedef array array_f32;
typedef array array_f64;
typedef array array_u16;
typedef array array_u32;
typedef array array_u64;
typedef map map_int;
typedef map map_string;
typedef byte array_fixed_byte_300 [300];
typedef byte array_fixed_byte_400 [400];

#ifndef __cplusplus
	#ifndef bool
		typedef int bool;
		#define true 1
		#define false 0
	#endif
#endif


// c_headers
typedef int (*qsort_callback_func)(const void*, const void*);
#include <stdio.h>  // TODO remove all these includes, define all function signatures and types manually
#include <stdlib.h>

#ifdef __cplusplus
	#include <utility>
	#define _MOV std::move
#else
	#define _MOV
#endif

#ifndef _WIN32
	#if defined __has_include
		#if __has_include (<execinfo.h>)
			#include <execinfo.h>
		#else
			// Most probably musl OR __ANDROID__ ...
			int backtrace (void **__array, int __size) { return 0; }
			char **backtrace_symbols (void *const *__array, int __size){ return 0; }
			void backtrace_symbols_fd (void *const *__array, int __size, int __fd){}
		#endif
	#endif
#endif

//#include "fns.h"
#include <signal.h>
#include <stdarg.h> // for va_list
#include <string.h> // memcpy

#if INTPTR_MAX == INT32_MAX
	#define TARGET_IS_32BIT 1
#elif INTPTR_MAX == INT64_MAX
	#define TARGET_IS_64BIT 1
#else
	#error "The environment is not 32 or 64-bit."
#endif

#if defined(__BYTE_ORDER__) && __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__ || defined(__BYTE_ORDER) && __BYTE_ORDER == __BIG_ENDIAN || defined(__BIG_ENDIAN__) || defined(__ARMEB__) || defined(__THUMBEB__) || defined(__AARCH64EB__) || defined(_MIBSEB) || defined(__MIBSEB) || defined(__MIBSEB__)
	#define TARGET_ORDER_IS_BIG
#elif defined(__BYTE_ORDER__) && __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__ || defined(__BYTE_ORDER) && __BYTE_ORDER == __LITTLE_ENDIAN || defined(__LITTLE_ENDIAN__) || defined(__ARMEL__) || defined(__THUMBEL__) || defined(__AARCH64EL__) || defined(_MIPSEL) || defined(__MIPSEL) || defined(__MIPSEL__) || defined(_M_AMD64) || defined(_M_X64) || defined(_M_IX86)
	#define TARGET_ORDER_IS_LITTLE
#else
	#error "Unknown architecture endianness"
#endif

#ifndef _WIN32
	#include <ctype.h>
	#include <locale.h> // tolower
	#include <sys/time.h>
	#include <unistd.h> // sleep
	extern char **environ;
#endif

#if defined(__CYGWIN__) && !defined(_WIN32)
	#error Cygwin is not supported, please use MinGW or Visual Studio.
#endif

#ifdef __linux__
	#include <sys/types.h>
	#include <sys/wait.h> // os__wait uses wait on nix
#endif

#ifdef __FreeBSD__
	#include <sys/types.h>
	#include <sys/wait.h> // os__wait uses wait on nix
#endif

#ifdef __DragonFly__
	#include <sys/types.h>
	#include <sys/wait.h> // os__wait uses wait on nix
#endif

#ifdef __OpenBSD__
	#include <sys/types.h>
	#include <sys/resource.h>
	#include <sys/wait.h> // os__wait uses wait on nix
#endif

#ifdef __NetBSD__
	#include <sys/wait.h> // os__wait uses wait on nix
#endif

#ifdef __sun
	#include <sys/types.h>
	#include <sys/wait.h> // os__wait uses wait on nix
#endif


#define EMPTY_STRUCT_DECLARATION
#define EMPTY_STRUCT_INITIALIZATION 0
// Due to a tcc bug, the length of an array needs to be specified, but GCC crashes if it is...
#define EMPTY_ARRAY_OF_ELEMS(x,n) (x[])
#define TCCSKIP(x) x

#define __NOINLINE __attribute__((noinline))
#define __IRQHANDLER __attribute__((interrupt))

#ifdef __TINYC__
	#undef EMPTY_STRUCT_DECLARATION
	#undef EMPTY_STRUCT_INITIALIZATION
	#define EMPTY_STRUCT_DECLARATION char _dummy
	#define EMPTY_STRUCT_INITIALIZATION 0
	#undef EMPTY_ARRAY_OF_ELEMS
	#define EMPTY_ARRAY_OF_ELEMS(x,n) (x[n])
	#undef __NOINLINE
	#undef __IRQHANDLER
	// tcc does not support inlining at all
	#define __NOINLINE
	#define __IRQHANDLER
	#undef TCCSKIP
	#define TCCSKIP(x)
	// #include <byteswap.h>
#endif

// for __offset_of
#ifndef __offsetof
	#define __offsetof(s,memb) ((size_t)((char *)&((s *)0)->memb - (char *)0))
#endif

#define OPTION_CAST(x) (x)

#ifndef V64_PRINTFORMAT
	#ifdef PRIx64
		#define V64_PRINTFORMAT "0x%"PRIx64
	#elif defined(__WIN32__)
		#define V64_PRINTFORMAT "0x%I64x"
	#elif defined(__linux__) && defined(__LP64__)
		#define V64_PRINTFORMAT "0x%lx"
	#else
		#define V64_PRINTFORMAT "0x%llx"
	#endif
#endif


#ifdef _WIN32
	#define WINVER 0x0600
	#ifdef _WIN32_WINNT
		#undef _WIN32_WINNT
	#endif
	#define _WIN32_WINNT 0x0600
	#define WIN32_LEAN_AND_MEAN
	#define _UNICODE
	#define UNICODE
	#include <windows.h>

	#include <io.h> // _waccess
	#include <direct.h> // _wgetcwd
	//#include <WinSock2.h>

	#ifdef _MSC_VER
		// On MSVC these are the same (as long as /volatile:ms is passed)
		#define _Atomic volatile

		// MSVC cannot parse some things properly
		#undef EMPTY_STRUCT_DECLARATION
		#undef OPTION_CAST

		#define EMPTY_STRUCT_DECLARATION int ____dummy_variable
		#define OPTION_CAST(x)
		#undef __NOINLINE
		#undef __IRQHANDLER
		#define __NOINLINE __declspec(noinline)
		#define __IRQHANDLER __declspec(naked)

		#include <dbghelp.h>
		#pragma comment(lib, "Dbghelp.lib")

		extern wchar_t **_wenviron;
	#elif !defined(SRWLOCK_INIT)
		// these seem to be missing on Windows tcc
		typedef struct SRWLOCK { void* SRWLOCK; } SRWLOCK;
		void InitializeSRWLock(void*);
		void AcquireSRWLockShared(void*);
		void AcquireSRWLockExclusive(void*);
		void ReleaseSRWLockShared(void*);
		void ReleaseSRWLockExclusive(void*);
	#endif
#else
	#include <pthread.h>
	#ifndef PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
		// musl does not have that
		#define pthread_rwlockattr_setkind_np(a, b)
	#endif
#endif

// g_live_info is used by live.info()
static void* g_live_info = NULL;

//============================== HELPER C MACROS =============================*/
//#define tos4(s, slen) ((string){.str=(s), .len=(slen)})
#define _SLIT(s) ((string){.str=(byteptr)(s), .len=(strlen(s))})
#define _PUSH_MANY(arr, val, tmp, tmp_typ) {tmp_typ tmp = (val); array_push_many(arr, tmp.data, tmp.len);}
#define _IN(typ, val, arr) array_##typ##_contains(arr, val)
#define _IN_MAP(val, m) map_exists(m, val)

// unsigned/signed comparisons
static inline bool _us32_gt(uint32_t a, int32_t b) { return a > INT32_MAX || (int32_t)a > b; }
static inline bool _us32_ge(uint32_t a, int32_t b) { return a >= INT32_MAX || (int32_t)a >= b; }
static inline bool _us32_eq(uint32_t a, int32_t b) { return a <= INT32_MAX && (int32_t)a == b; }
static inline bool _us32_ne(uint32_t a, int32_t b) { return a > INT32_MAX || (int32_t)a != b; }
static inline bool _us32_le(uint32_t a, int32_t b) { return a <= INT32_MAX && (int32_t)a <= b; }
static inline bool _us32_lt(uint32_t a, int32_t b) { return a < INT32_MAX && (int32_t)a < b; }
static inline bool _us64_gt(uint64_t a, int64_t b) { return a > INT64_MAX || (int64_t)a > b; }
static inline bool _us64_ge(uint64_t a, int64_t b) { return a >= INT64_MAX || (int64_t)a >= b; }
static inline bool _us64_eq(uint64_t a, int64_t b) { return a <= INT64_MAX && (int64_t)a == b; }
static inline bool _us64_ne(uint64_t a, int64_t b) { return a > INT64_MAX || (int64_t)a != b; }
static inline bool _us64_le(uint64_t a, int64_t b) { return a <= INT64_MAX && (int64_t)a <= b; }
static inline bool _us64_lt(uint64_t a, int64_t b) { return a < INT64_MAX && (int64_t)a < b; }

#if defined(__MINGW32__) || defined(__MINGW64__) || (defined(_WIN32) && defined(__TINYC__))
	#undef PRId64
	#undef PRIi64
	#undef PRIo64
	#undef PRIu64
	#undef PRIx64
	#undef PRIX64
	#define PRId64 "lld"
	#define PRIi64 "lli"
	#define PRIo64 "llo"
	#define PRIu64 "llu"
	#define PRIx64 "llx"
	#define PRIX64 "llX"
#endif

//================================== GLOBALS =================================*/
//byte g_str_buf[1024];
static byte* g_str_buf;
int load_so(byteptr);
void reload_so();
void _vinit();
void _vcleanup();
#define sigaction_size sizeof(sigaction);
#define _ARR_LEN(a) ( (sizeof(a)) / (sizeof(a[0])) )

// ============== wyhash ==============
//Author: Wang Yi
#ifndef wyhash_version_gamma
	#define wyhash_version_gamma
	#define WYHASH_CONDOM 0
	#include <stdint.h>
	#include <string.h>
	#if defined(_MSC_VER) && defined(_M_X64)
		#include <intrin.h>
		#pragma intrinsic(_umul128)
	#endif

	//const uint64_t _wyp0=0xa0761d6478bd642full, _wyp1=0xe7037ed1a0b428dbull;
	#define _wyp0 ((uint64_t)0xa0761d6478bd642full)
	#define _wyp1 ((uint64_t)0xe7037ed1a0b428dbull)

	#if defined(__GNUC__) || defined(__INTEL_COMPILER) || defined(__clang__) || defined(__TINYC__)
		#define _likely_(x) __builtin_expect(x, 1)
		#define _unlikely_(x) __builtin_expect((x), 0)
	#else
		#define _likely_(x) (x)
		#define _unlikely_(x) (x)
	#endif

	#if defined(TARGET_ORDER_IS_LITTLE)
		#define WYHASH_LITTLE_ENDIAN 1
	#elif defined(TARGET_ORDER_IS_BIG)
		#define WYHASH_LITTLE_ENDIAN 0
	#endif

	#if (WYHASH_LITTLE_ENDIAN)
		static inline uint64_t _wyr8(const uint8_t *p) { uint64_t v; memcpy(&v, p, 8); return v;}
		static inline uint64_t _wyr4(const uint8_t *p) { unsigned v; memcpy(&v, p, 4); return v;}
	#else
		#if defined(__GNUC__) || defined(__INTEL_COMPILER) || defined(__clang__)
			static inline uint64_t _wyr8(const uint8_t *p) { uint64_t v; memcpy(&v, p, 8); return __builtin_bswap64(v);}
			static inline uint64_t _wyr4(const uint8_t *p) { unsigned v; memcpy(&v, p, 4); return __builtin_bswap32(v);}
		#elif defined(_MSC_VER)
			static inline uint64_t _wyr8(const uint8_t *p) { uint64_t v; memcpy(&v, p, 8); return _byteswap_uint64(v);}
			static inline uint64_t _wyr4(const uint8_t *p) { unsigned v; memcpy(&v, p, 4); return _byteswap_ulong(v);}
		#elif defined(__TINYC__)
			static inline uint64_t _wyr8(const uint8_t *p) { uint64_t v; memcpy(&v, p, 8); return bswap_64(v);}
			static inline uint64_t _wyr4(const uint8_t *p) { unsigned v; memcpy(&v, p, 4); return bswap_32(v);}
		#endif
	#endif

	static inline uint64_t _wyr3(const uint8_t *p, unsigned k) { return (((uint64_t)p[0]) << 16) | (((uint64_t)p[k >> 1]) << 8) | p[k - 1];}
	static inline uint64_t _wyrotr(uint64_t v, unsigned k) { return (v >> k) | (v << (64 - k));}
	static inline void _wymix128(uint64_t A, uint64_t B, uint64_t *C, uint64_t *D){
		A^=*C;	B^=*D;
	#ifdef UNOFFICIAL_WYHASH_32BIT
		uint64_t hh=(A>>32)*(B>>32), hl=(A>>32)*(unsigned)B, lh=(unsigned)A*(B>>32), ll=(uint64_t)(unsigned)A*(unsigned)B;
		*C=_wyrotr(hl,32)^hh; *D=_wyrotr(lh,32)^ll;
	#else
		#ifdef __SIZEOF_INT128__
			__uint128_t r=A; r*=B; *C=(uint64_t)r; *D=(uint64_t)(r>>64);
		#elif defined(_MSC_VER) && defined(_M_X64)
			A=_umul128(A,B,&B); *C=A; *D=B;
		#else
			uint64_t ha=A>>32, hb=B>>32, la=(uint32_t)A, lb=(uint32_t)B, hi, lo;
			uint64_t rh=ha*hb, rm0=ha*lb, rm1=hb*la, rl=la*lb, t=rl+(rm0<<32), c=t<rl;
			lo=t+(rm1<<32); c+=lo<t; hi=rh+(rm0>>32)+(rm1>>32)+c;
			*C=lo;	*D=hi;
		#endif
	#endif
	}
	static inline uint64_t wyhash(const void *key, uint64_t len, uint64_t seed){
		const uint8_t *p=(const uint8_t *)key;
		uint64_t i=len, see1=seed;
		start:
		if (_likely_(i<=16)) {
	#ifndef	WYHASH_CONDOM
			uint64_t shift = (i<8)*((8-i)<<3);
			//WARNING: intended reading outside buffer, trading for speed.
			_wymix128((_wyr8(p)<<shift)^_wyp0, (_wyr8(p+i-8)>>shift)^_wyp1, &seed, &see1);
	#else
			if (_likely_(i<=8)) {
				if (_likely_(i>=4)) _wymix128(_wyr4(p)^_wyp0,_wyr4(p+i-4)^_wyp1, &seed, &see1);
				else if (_likely_(i)) _wymix128(_wyr3(p,i)^_wyp0,_wyp1, &seed, &see1);
				else _wymix128(_wyp0,_wyp1, &seed, &see1);
			}
  			else _wymix128(_wyr8(p)^_wyp0,_wyr8(p+i-8)^_wyp1, &seed, &see1);
	#endif
			_wymix128(len,_wyp0, &seed, &see1);
			return	seed^see1;
		}
		_wymix128(_wyr8(p)^_wyp0,_wyr8(p+8)^_wyp1, &seed, &see1);
		i-=16;	p+=16;	goto start;
	}
	static inline uint64_t wyhash64(uint64_t A, uint64_t B){
		_wymix128(_wyp0,_wyp1,&A,&B);
		_wymix128(0,0,&A,&B);
		return	A^B;
	}
	static inline uint64_t wyrand(uint64_t *seed){
		*seed+=_wyp0;
		uint64_t	a=0, b=0;
		_wymix128(*seed,*seed^_wyp1,&a,&b);
		return	a^b;
	}
	static inline double wy2u01(uint64_t r) {
		const double _wynorm=1.0/(1ull<<52);
		return (r>>12)*_wynorm;
	}
	static inline double wy2gau(uint64_t r) {
		const double _wynorm=1.0/(1ull<<20);
		return ((r&0x1fffff)+((r>>21)&0x1fffff)+((r>>42)&0x1fffff))*_wynorm-3.0;
	}
#endif


// V includes:
// added by module `builtin`:
#include <float.h>
// added by module `json`:
#include "cJSON.h"
#define js_get(object, key) cJSON_GetObjectItemCaseSensitive((object), (key))
// added by module `os`:
#include <sys/stat.h> // #include <signal.h>
// added by module `os`:
#include <errno.h>
// added by module `os`:
#include <dirent.h>
// added by module `os`:
#include <unistd.h>
// added by module `os`:
#include <fcntl.h>
// added by module `os`:
#include <sys/utsname.h>
// added by module `time`:
#include <time.h>
// added by module `time`:
#include <time.h>
// added by module `sqlite`:
#include "sqlite3.h"
// added by module `math`:
#include <math.h>
// added by module `net.openssl`:
#include <openssl/rand.h>
// added by module `net.openssl`:
#include <openssl/ssl.h>
// added by module `net.openssl`:
#include <openssl/err.h>
// added by module `net`:
#include <sys/socket.h>
// added by module `net`:
#include <unistd.h>
// added by module `net`:
#include <netinet/in.h>
// added by module `net`:
#include <arpa/inet.h>
// added by module `net`:
#include <netdb.h>
// added by module `net`:
#include <errno.h>
// added by module `term`:
#include <sys/ioctl.h>
// added by module `term`:
#include <termios.h> // TIOCGWINSZ
// added by module `sync`:
#include <semaphore.h>

// Enum definitions:
typedef enum {
	strconv__Char_parse_state_start, // 
	strconv__Char_parse_state_norm_char, // +1
	strconv__Char_parse_state_field_char, // +2
	strconv__Char_parse_state_pad_ch, // +3
	strconv__Char_parse_state_len_set_start, // +4
	strconv__Char_parse_state_len_set_in, // +5
	strconv__Char_parse_state_check_type, // +6
	strconv__Char_parse_state_check_float, // +7
	strconv__Char_parse_state_check_float_in, // +8
	strconv__Char_parse_state_reset_params, // +9
} strconv__Char_parse_state;

typedef enum {
	strconv__Align_text_right = 0, // 0
	strconv__Align_text_left, // 0+1
	strconv__Align_text_center, // 0+2
} strconv__Align_text;

typedef enum {
	os__FileType_regular, // 
	os__FileType_directory, // +1
	os__FileType_character_device, // +2
	os__FileType_block_device, // +3
	os__FileType_fifo, // +4
	os__FileType_symbolic_link, // +5
	os__FileType_socket, // +6
} os__FileType;

typedef enum {
	time__FormatTime_hhmm12, // 
	time__FormatTime_hhmm24, // +1
	time__FormatTime_hhmmss12, // +2
	time__FormatTime_hhmmss24, // +3
	time__FormatTime_no_time, // +4
} time__FormatTime;

typedef enum {
	time__FormatDate_ddmmyy, // 
	time__FormatDate_ddmmyyyy, // +1
	time__FormatDate_mmddyy, // +2
	time__FormatDate_mmddyyyy, // +3
	time__FormatDate_mmmd, // +4
	time__FormatDate_mmmdd, // +5
	time__FormatDate_mmmddyyyy, // +6
	time__FormatDate_no_date, // +7
	time__FormatDate_yyyymmdd, // +8
} time__FormatDate;

typedef enum {
	time__FormatDelimiter_dot, // 
	time__FormatDelimiter_hyphen, // +1
	time__FormatDelimiter_slash, // +2
	time__FormatDelimiter_space, // +3
	time__FormatDelimiter_no_delimiter, // +4
} time__FormatDelimiter;

typedef enum {
	net__urllib__EncodingMode_encode_path, // 
	net__urllib__EncodingMode_encode_path_segment, // +1
	net__urllib__EncodingMode_encode_host, // +2
	net__urllib__EncodingMode_encode_zone, // +3
	net__urllib__EncodingMode_encode_user_password, // +4
	net__urllib__EncodingMode_encode_query_component, // +5
	net__urllib__EncodingMode_encode_fragment, // +6
} net__urllib__EncodingMode;

typedef enum {
	log__Level_fatal = 1, // 1
	log__Level_error, // 1+1
	log__Level_warn, // 1+2
	log__Level_info, // 1+3
	log__Level_debug, // 1+4
} log__Level;

typedef enum {
	net__http__SameSite_same_site_default_mode = 1, // 1
	net__http__SameSite_same_site_lax_mode, // 1+1
	net__http__SameSite_same_site_strict_mode, // 1+2
	net__http__SameSite_same_site_none_mode, // 1+3
} net__http__SameSite;

typedef enum {
	main__GitService_receive, // 
	main__GitService_upload, // +1
	main__GitService_unknown, // +2
} main__GitService;

typedef enum {
	main__IssueStatus_open = 0, // 0
	main__IssueStatus_closed = 1, // 1
} main__IssueStatus;

typedef enum {
	main__RepoStatus_done, // 
	main__RepoStatus_caching, // +1
	main__RepoStatus_clone_failed, // +2
	main__RepoStatus_clone_done, // +3
} main__RepoStatus;

typedef enum {
	main__SecurityLogKind_registered, // 
	main__SecurityLogKind_logged_in, // +1
	main__SecurityLogKind_registered_via_github, // +2
	main__SecurityLogKind_logged_in_via_github, // +3
	main__SecurityLogKind_wrong_password, // +4
	main__SecurityLogKind_wrong_oauth_state, // +5
	main__SecurityLogKind_empty_oauth_code, // +6
	main__SecurityLogKind_empty_oauth_email, // +7
} main__SecurityLogKind;


// V type definitions:
struct string {
	byteptr str;
	int len;
	int is_lit;
};

struct array {
	int element_size;
	voidptr data;
	int len;
	int cap;
};

struct DenseArray {
	int value_bytes;
	u32 cap;
	u32 len;
	u32 deletes;
	string* keys;
	byteptr values;
};

struct map {
	int value_bytes;
	u32 cap;
	byte cached_hashbits;
	byte shift;
	DenseArray key_values;
	u32* metas;
	u32 extra_metas;
	int len;
};

struct Option {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	array_fixed_byte_400 data;
};

typedef map map_string_string;
typedef map map_string_int;
typedef map_string_string map_string;
typedef map_string_int map_int;
typedef array array_string;
typedef array array_byte;
typedef array array_int;
typedef array array_char;
typedef int (*anon_fn_7_7_7)(int,int);
typedef array array_voidptr;
typedef array array_u64;
typedef array array_RepIndex;
typedef byte (*anon_fn_9_9)(byte);
typedef bool (*anon_fn_9_16)(byte);
typedef array array_main__Branch;
typedef array array_main__Comment;
typedef array array_main__Change;
typedef array array_main__Commit;
typedef array array_main__File;
typedef string vweb__RawHtml;
typedef map map_string_array_main__Commit;
typedef map map_string_vweb__RawHtml;
typedef array array_main__Release;
typedef array array_main__Issue;
typedef array array_main__LangStat;
typedef array array_main__Label;
typedef map map_string_hl__Lang;
typedef array array_main__Repo;
typedef array array_main__SecurityLog;
typedef array array_main__Tag;
typedef array array_main__Email;
typedef array array_main__SshKey;
typedef array array_main__User;
typedef array array_main__Contributor;
typedef _Interface hash__Hasher;
typedef _Interface hash__Hash32er;
typedef _Interface hash__Hash64er;
typedef array array_array_string;
typedef array array_ustring;
typedef array array_T;
typedef void (*anon_fn_18_1)(string);
typedef i64 time__Duration;
typedef voidptr time__time_t;
typedef _Interface log__Logger;
typedef array array_hl__Lang;
typedef array array_u32;
typedef array array_sqlite__Row;
typedef map map_string_array_string;
typedef array array_net__http__Cookie_ptr;
typedef void (*net__http__DownloadFn)(int);
typedef void (*anon_fn__1)();
typedef voidptr (*sync__ThreadCB)(sync__PoolProcessor*,int,int);
typedef array array_sync__SResult;
typedef array array_sync__IResult;
typedef map map_string_net__urllib__Value;
typedef array array_strconv__Uint128;
typedef array array_f64;
// builtin types:
//------------------ #endbuiltin
struct MethodAttr {
	string value;
	string method;
};

typedef string array_fixed_string_11 [11];
struct vweb__Result {
EMPTY_STRUCT_DECLARATION;
};

struct sqlite__DB {
	struct sqlite3* conn;
};

struct main__OAuthRequest {
	string client_id;
	string client_secret;
	string code;
	string state;
};

struct main__GitHubUser {
	string username;
	string name;
	string email;
	string avatar;
};

struct main__OAuth_Request {
	string client_id;
	string client_secret;
	string code;
};

struct os__Uname {
	string sysname;
	string nodename;
	string release;
	string version;
	string machine;
};

struct net__openssl__SSL {
EMPTY_STRUCT_DECLARATION;
};

struct sync__SResult {
	string s;
};

struct sync__Waiter {
	sync__Mutex* mx;
};

struct net__urllib__ParseAuthorityRes {
	net__urllib__Userinfo* user;
	string host;
};

struct net__openssl__SSL_CTX {
EMPTY_STRUCT_DECLARATION;
};

struct net__openssl__SSL_METHOD {
EMPTY_STRUCT_DECLARATION;
};

struct ustring {
	string s;
	array_int runes;
	int len;
};

struct VAssertMetaInfo {
	string fpath;
	int line_nr;
	string fn_name;
	string src;
	string op;
	string llabel;
	string rlabel;
	string lvalue;
	string rvalue;
};

struct OptionBase {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
};

typedef byte array_fixed_byte_400 [400];
struct SortedMap {
	int value_bytes;
	mapnode* root;
	int len;
};

typedef voidptr array_fixed_voidptr_11 [11];
struct RepIndex {
	int idx;
	int val_idx;
};

struct main__Branch {
	int id;
	int repo_id;
	string name;
	string author;
	string hash;
	int date;
};

struct main__User {
	int id;
	string name;
	string username;
	string password;
	bool is_github;
	bool is_registered;
	bool is_blocked;
	bool is_admin;
	string oauth_state;
	int nr_namechanges;
	int last_namechange_time;
	int nr_posts;
	int last_post_time;
	string avatar;
	bool b_avatar;
	array_main__Email emails;
	int login_attempts;
};

struct main__Comment {
	int id;
	int author_id;
	int issue_id;
	int created_at;
	string text;
	string author_name;
};

struct main__Commit {
	int id;
	int author_id;
	string author;
	string hash;
	int created_at;
	int repo_id;
	string message;
};

struct main__Change {
	string file;
	int additions;
	int deletions;
	string diff;
	string message;
};

struct os__Result {
	int exit_code;
	string output;
};

struct main__Issue {
	int id;
	int author_id;
	int repo_id;
	bool is_pr;
	array_int assigned;
	array_int labels;
	int nr_comments;
	string title;
	string text;
	int created_at;
	main__IssueStatus status;
	array_int linked_issues;
	string author_name;
	string repo_author;
	string repo_name;
};

struct main__Label {
	int id;
	string name;
	string color;
};

struct main__LangStat {
	int id;
	int repo_id;
	string name;
	int nr_lines;
	int pct;
	string color;
};

struct main__GitlySettings {
	int id;
	string oauth_client_id;
	string oauth_client_secret;
	bool only_gh_login;
};

struct time__Time {
	int year;
	int month;
	int day;
	int hour;
	int minute;
	int second;
	int microsecond;
	u64 v_unix;
};

struct main__Contributor {
	int id;
	int user;
	int repo;
};

struct sync__WaitGroup {
	int task_count;
	sync__Mutex* task_count_mutex;
	sync__Waiter* wait_blocker;
};

struct hl__Lang {
	array_string keywords;
	array_string lang_extensions;
	array_string string_start;
	string line_comments;
	array_string mline_comments;
	string color;
	string name;
};

struct main__SecurityLog {
	int id;
	int user_id;
	main__SecurityLogKind kind;
	string ip;
	string arg1;
	string arg2;
	int created_at;
};

struct main__Tag {
	int id;
	int repo_id;
	string name;
	string hash;
	int user_id;
	int date;
};

struct main__Token {
	int id;
	int user_id;
	string value;
	string ip;
};

struct main__Email {
	int id;
	int user;
	string email;
};

struct main__SshKey {
	int id;
	int user;
	string title;
	string sshkey;
	bool is_deleted;
};

struct main__Visit {
	int id;
	int repo_id;
	string url;
	string referer;
	int created_at;
};

struct strings__Builder {
	array_byte buf;
	int str_calls;
	int len;
	int initial_size;
};

union strconv__Float64u {
	f64 f;
	u64 u;
};

struct strconv__PrepNumber {
	bool negative;
	int exponent;
	u64 mantissa;
};

struct strconv__Dec32 {
	u32 m;
	int e;
};

union strconv__Uf32 {
	f32 f;
	u32 u;
};

struct strconv__Uint128 {
	u64 lo;
	u64 hi;
};

struct strconv__Dec64 {
	u64 m;
	int e;
};

union strconv__Uf64 {
	f64 f;
	u64 u;
};

struct strconv__BF_param {
	byte pad_ch;
	int len0;
	int len1;
	bool positive;
	bool sign_flag;
	strconv__Align_text allign;
	bool rm_tail_zero;
};

struct net__http__Request {
	string method;
	map_string_string headers;
	map_string_string cookies;
	string data;
	string url;
	string user_agent;
	bool verbose;
	voidptr user_ptr;
	voidptr ws_func;
};

struct net__Socket {
	int sockfd;
	int family;
	int typ;
	int proto;
	int max_single_send_size;
};

struct os__FilePermission {
	bool read;
	bool write;
	bool execute;
};

struct os__File {
	voidptr cfile;
	int fd;
	bool opened;
};

struct os__FileInfo {
	string name;
	int size;
};

struct time__StopWatchOptions {
	bool auto_start;
};

struct time__StopWatch {
	u64 elapsed;
	u64 start;
	u64 end;
};

struct crypto__sha1__Digest {
	array_u32 h;
	array_byte x;
	int nx;
	u64 len;
};

struct sqlite__Row {
	array_string vals;
};

struct rand__PRNGConfigStruct {
	array_u32 seed;
};

struct rand__wyrand__WyRandRNG {
	u64 state;
	bool has_extra;
	u32 extra;
};

struct net__http__Response {
	string text;
	map_string_string headers;
	map_string_string lheaders;
	map_string_string cookies;
	int status_code;
};

struct net__http__FetchConfig {
	string method;
	string data;
	map_string_string params;
	map_string_string headers;
	map_string_string cookies;
	string user_agent;
	bool verbose;
};

struct net__urllib__URL {
	string scheme;
	string opaque;
	net__urllib__Userinfo* user;
	string host;
	string path;
	string raw_path;
	bool force_query;
	string raw_query;
	string fragment;
};

struct sync__Mutex {
	pthread_mutex_t mutex;
};

struct sync__PoolProcessor {
	voidptr thread_cb;
	int njobs;
	array_voidptr items;
	array_voidptr results;
	int ntask;
	sync__Mutex* ntask_mtx;
	sync__WaitGroup* waitgroup;
	voidptr shared_context;
	array_voidptr thread_contexts;
};

struct sync__PoolProcessorConfig {
	int maxjobs;
	sync__ThreadCB callback;
};

struct sync__IResult {
	int i;
};

struct sync__RwMutex {
	pthread_rwlock_t mutex;
};

struct sync__RwMutexAttr {
	pthread_rwlockattr_t attr;
};

struct sync__MacOSX_Semaphore {
	pthread_mutex_t mtx;
	pthread_cond_t cond;
	int count;
};

struct sync__PosixSemaphore {
	sem_t sem;
};

struct sync__CondAttr {
	pthread_condattr_t attr;
};

struct sync__Semaphore {
	voidptr sem;
};

struct crypto__sha256__Digest {
	array_u32 h;
	array_byte x;
	int nx;
	u64 len;
	bool is224;
};

struct net__urllib__Userinfo {
	string username;
	string password;
	bool password_set;
};

struct net__urllib__Values {
	map_string_net__urllib__Value data;
	int len;
};

struct net__urllib__Value {
	array_string data;
};

struct net__http__chunked__ChunkScanner {
	int pos;
	string text;
};

typedef byte array_fixed_byte_26 [26];
typedef byteptr array_fixed_byteptr_100 [100];
typedef byte array_fixed_byte_1000 [1000];
typedef byte array_fixed_byte_1024 [1024];
typedef byte array_fixed_byte_4096 [4096];
typedef byte array_fixed_byte_256 [256];
typedef byte array_fixed_byte_44 [44];
typedef byte array_fixed_byte_1536 [1536];
struct mapnode {
	voidptr* children;
	int len;
	array_fixed_string_11 keys;
	array_fixed_voidptr_11 values;
};

struct main__Repo {
	int id;
	string git_dir;
	string name;
	int user_id;
	string user_name;
	string clone_url;
	string primary_branch;
	string description;
	bool is_public;
	array_string users_contributed;
	array_string users_authorized;
	int nr_topics;
	int nr_views;
	string latest_update_hash;
	time__Time latest_activity;
	string webhook_secret;
	int nr_tags;
	int nr_open_issues;
	int nr_open_prs;
	int nr_releases;
	int nr_branches;
	array_main__LangStat lang_stats;
	int created_at;
	int nr_contributors;
	int nr_commits;
	array_main__Label labels;
	main__RepoStatus status;
	map_string_string msg_cache;
};

struct main__File {
	int id;
	int repo_id;
	string name;
	string parent_path;
	bool is_dir;
	string branch;
	int nr_contributors;
	string last_hash;
	int size;
	int nr_views;
	string last_msg;
	int last_time;
	main__Commit commit;
};

struct log__Log {
	log__Level level;
	string output_label;
	os__File ofile;
	bool output_to_file;
	string output_file_name;
};

struct vweb__Context {
	map_string_string static_files;
	map_string_string static_mime_types;
	string content_type;
	net__http__Request req;
	net__Socket conn;
	map_string_string form;
	map_string_string query;
	string headers;
	bool done;
	i64 page_gen_start;
	string form_error;
};

struct main__Release {
	int id;
	int repo_id;
	int tag_id;
	string notes;
	string tag_name;
	string tag_hash;
	string user;
	time__Time date;
};

struct vweb__Cookie {
	string name;
	string value;
	time__Time expires;
	bool secure;
	bool http_only;
};

struct os__FileMode {
	os__FileType typ;
	os__FilePermission owner;
	os__FilePermission group;
	os__FilePermission others;
};

struct net__http__Cookie {
	string name;
	string value;
	string path;
	string domain;
	time__Time expires;
	string raw_expires;
	int max_age;
	bool secure;
	bool http_only;
	net__http__SameSite same_site;
	string raw;
	array_string unparsed;
};

struct main__App {
	string path;
	main__Repo repo;
	string version;
	vweb__RawHtml html_path;
	string page_gen_time;
	bool is_tree;
	bool show_menu;
	string oauth_client_id;
	string oauth_client_secret;
	bool only_gh_login;
	log__Log file_log;
	log__Log cli_log;
	vweb__Context vweb;
	sqlite__DB db;
	bool logged_in;
	main__User user;
};

// multi return structs
typedef struct {
	u32 arg0;
	u32 arg1;
} multi_return_u32_u32;

typedef struct {
	bool arg0;
	main__User arg1;
} multi_return_bool_main__User;

typedef struct {
	u32 arg0;
	u32 arg1;
	u32 arg2;
} multi_return_u32_u32_u32;

typedef struct {
	int arg0;
	strconv__PrepNumber arg1;
} multi_return_int_strconv__PrepNumber;

typedef struct {
	strconv__Dec32 arg0;
	bool arg1;
} multi_return_strconv__Dec32_bool;

typedef struct {
	strconv__Dec64 arg0;
	bool arg1;
} multi_return_strconv__Dec64_bool;

typedef struct {
	int arg0;
	bool arg1;
} multi_return_int_bool;

typedef struct {
	int arg0;
	int arg1;
	int arg2;
} multi_return_int_int_int;

typedef struct {
	string arg0;
	int arg1;
	int arg2;
} multi_return_string_int_int;

typedef struct {
	array_sqlite__Row arg0;
	int arg1;
} multi_return_array_sqlite__Row_int;

typedef struct {
	u64 arg0;
	u64 arg1;
} multi_return_u64_u64;

typedef struct {
	byteptr arg0;
	int arg1;
} multi_return_byteptr_int;

typedef struct {
	string arg0;
	string arg1;
} multi_return_string_string;

typedef struct {
	int arg0;
	int arg1;
} multi_return_int_int;

string strings__Builder_str_no_ptr(strings__Builder it); // auto no_ptr version
string time__FormatTime_str(time__FormatTime it); // auto
string time__FormatDate_str(time__FormatDate it); // auto

typedef struct thread_arg_sync__process_in_thread {
	sync__PoolProcessor* arg1;
	int arg2;
} thread_arg_sync__process_in_thread;
void* sync__process_in_thread_thread_wrapper(thread_arg_sync__process_in_thread *arg);
string map_string_string_str(map_string_string m); // auto
string main__GitService_str(main__GitService it); // auto

typedef struct thread_arg_main__App_command_fetcher {
	main__App* arg0;
EMPTY_STRUCT_DECLARATION;
} thread_arg_main__App_command_fetcher;
void* main__App_command_fetcher_thread_wrapper(thread_arg_main__App_command_fetcher *arg);

typedef struct thread_arg_main__App_delete_repo {
	main__App* arg0;
	int arg1;
	string arg2;
	string arg3;
} thread_arg_main__App_delete_repo;
void* main__App_delete_repo_thread_wrapper(thread_arg_main__App_delete_repo *arg);

typedef struct thread_arg_main__App_slow_fetch_files_info {
	main__App* arg0;
	string arg1;
	string arg2;
} thread_arg_main__App_slow_fetch_files_info;
void* main__App_slow_fetch_files_info_thread_wrapper(thread_arg_main__App_slow_fetch_files_info *arg);

typedef struct thread_arg_main__App_update_repo_data {
	main__App* arg0;
	main__Repo arg1;
} thread_arg_main__App_update_repo_data;
void* main__App_update_repo_data_thread_wrapper(thread_arg_main__App_update_repo_data *arg);

typedef struct thread_arg_main__App_update_repo {
	main__App* arg0;
EMPTY_STRUCT_DECLARATION;
} thread_arg_main__App_update_repo;
void* main__App_update_repo_thread_wrapper(thread_arg_main__App_update_repo *arg);
string main__GitHubUser_str(main__GitHubUser x); // auto
string indent_main__GitHubUser_str(main__GitHubUser x, int indent_count); // auto

typedef struct thread_arg_main__Repo_analyse_lang {
	main__Repo arg0;
	sync__WaitGroup* arg1;
	main__App* arg2;
} thread_arg_main__Repo_analyse_lang;
void* main__Repo_analyse_lang_thread_wrapper(thread_arg_main__Repo_analyse_lang *arg);
string main__SecurityLogKind_str(main__SecurityLogKind it); // auto
string main__SecurityLog_str(main__SecurityLog x); // auto
string indent_main__SecurityLog_str(main__SecurityLog x, int indent_count); // auto
// variadic structs
struct varg_voidptr {
	int len;
	voidptr args[0];
};

struct varg_string {
	int len;
	string args[2];
};

struct varg_int {
	int len;
	int args[1];
};


// V Option_xxx definitions:
struct Option_int {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(int)];
};

struct Option_voidptr {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(voidptr)];
};

struct Option_array_byte {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(array_byte)];
};

struct Option_string {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(string)];
};

struct Option_void {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(int)];
};

struct Option_array_string {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(array_string)];
};

struct Option_bool {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(bool)];
};

struct Option_array_ustring {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(array_ustring)];
};

struct Option_os__File {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(os__File)];
};

struct Option_os__Result {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(os__Result)];
};

struct Option_time__Time {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(time__Time)];
};

struct Option_hl__Lang {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(hl__Lang)];
};

struct Option_sqlite__DB {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(sqlite__DB)];
};

struct Option_sqlite__Row {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(sqlite__Row)];
};

struct Option_net__urllib__URL {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(net__urllib__URL)];
};

struct Option_net__urllib__ParseAuthorityRes {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(net__urllib__ParseAuthorityRes)];
};

struct Option_net__urllib__Values {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(net__urllib__Values)];
};

struct Option_net__Socket {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(net__Socket)];
};

struct Option_net__http__Response {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(net__http__Response)];
};

struct Option_net__http__Request {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(net__http__Request)];
};

struct Option_array_main__Issue {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(array_main__Issue)];
};

struct Option_main__Issue {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(main__Issue)];
};

struct Option_array_main__Commit {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(array_main__Commit)];
};

struct Option_main__Commit {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(main__Commit)];
};

struct Option_main__User {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(main__User)];
};

struct Option_main__File {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(main__File)];
};

struct Option_main__Repo {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(main__Repo)];
};

struct Option_main__OAuthRequest {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(main__OAuthRequest)];
};

struct Option_main__GitHubUser {
	bool ok;
	bool is_none;
	string v_error;
	int ecode;
	byte data[sizeof(main__GitHubUser)];
};


// V json forward decls:
Option_array_main__Issue json__decode_array_main__Issue(cJSON* root);
cJSON* json__encode_array_main__Issue(array_main__Issue val);

Option_main__Issue json__decode_main__Issue(cJSON* root);
cJSON* json__encode_main__Issue(main__Issue val);

Option_array_main__Commit json__decode_array_main__Commit(cJSON* root);
cJSON* json__encode_array_main__Commit(array_main__Commit val);

Option_main__Commit json__decode_main__Commit(cJSON* root);
cJSON* json__encode_main__Commit(main__Commit val);

Option_main__OAuthRequest json__decode_main__OAuthRequest(cJSON* root);
cJSON* json__encode_main__OAuthRequest(main__OAuthRequest val);

Option_main__GitHubUser json__decode_main__GitHubUser(cJSON* root);
cJSON* json__encode_main__GitHubUser(main__GitHubUser val);


// V definitions:
void _STR_PRINT_ARG(const char*, char**, int*, int*, int, ...);
string _STR(const char*, int, ...);
string _STR_TMP(const char*, ...);
// end of definitions #endif
strings__Builder strings__new_builder(int initial_size);
void strings__Builder_write_bytes(strings__Builder* b, byteptr bytes, int howmany);
void strings__Builder_write_b(strings__Builder* b, byte data);
void strings__Builder_write(strings__Builder* b, string s);
void strings__Builder_go_back(strings__Builder* b, int n);
static string strings__bytes2string(array_byte b);
string strings__Builder_cut_last(strings__Builder* b, int n);
void strings__Builder_go_back_to(strings__Builder* b, int pos);
void strings__Builder_writeln(strings__Builder* b, string s);
string strings__Builder_last_n(strings__Builder* b, int n);
string strings__Builder_after(strings__Builder* b, int n);
string strings__Builder_str(strings__Builder* b);
void strings__Builder_free(strings__Builder* b);
int strings__levenshtein_distance(string a, string b);
f32 strings__levenshtein_distance_percentage(string a, string b);
f32 strings__dice_coefficient(string s1, string s2);
string strings__repeat(byte c, int n);
string strings__repeat_string(string s, int n);
static u64 _const_hash__wyp0; // inited later
static u64 _const_hash__wyp1; // inited later
static u64 _const_hash__wyp2; // inited later
static u64 _const_hash__wyp3; // inited later
static u64 _const_hash__wyp4; // inited later
u64 hash__wyhash_c(byteptr key, u64 len, u64 seed);
u64 hash__sum64_string(string key, u64 seed);
u64 hash__sum64(array_byte key, u64 seed);
static u64 hash__wyhash64(byteptr key, u64 len, u64 seed_);
static u64 hash__wyrotr(u64 v, u32 k);
u64 hash__wymum(u64 a, u64 b);
static u64 hash__wyr3(byteptr p, u64 k);
static u64 hash__wyr4(byteptr p);
static u64 hash__wyr8(byteptr p);
static u32 _const_math__bits__de_bruijn32; // inited later
static array_byte _const_math__bits__de_bruijn32tab; // inited later
static u64 _const_math__bits__de_bruijn64; // inited later
static array_byte _const_math__bits__de_bruijn64tab; // inited later
static u64 _const_math__bits__m0; // inited later
static u64 _const_math__bits__m1; // inited later
static u64 _const_math__bits__m2; // inited later
static u64 _const_math__bits__m3; // inited later
static u64 _const_math__bits__m4; // inited later
static u32 _const_math__bits__max_u32; // inited later
static u64 _const_math__bits__max_u64; // inited later
int math__bits__leading_zeros_8(byte x);
int math__bits__leading_zeros_16(u16 x);
int math__bits__leading_zeros_32(u32 x);
int math__bits__leading_zeros_64(u64 x);
int math__bits__trailing_zeros_8(byte x);
int math__bits__trailing_zeros_16(u16 x);
int math__bits__trailing_zeros_32(u32 x);
int math__bits__trailing_zeros_64(u64 x);
int math__bits__ones_count_8(byte x);
int math__bits__ones_count_16(u16 x);
int math__bits__ones_count_32(u32 x);
int math__bits__ones_count_64(u64 x);
byte math__bits__rotate_left_8(byte x, int k);
u16 math__bits__rotate_left_16(u16 x, int k);
u32 math__bits__rotate_left_32(u32 x, int k);
u64 math__bits__rotate_left_64(u64 x, int k);
byte math__bits__reverse_8(byte x);
u16 math__bits__reverse_16(u16 x);
u32 math__bits__reverse_32(u32 x);
u64 math__bits__reverse_64(u64 x);
u16 math__bits__reverse_bytes_16(u16 x);
u32 math__bits__reverse_bytes_32(u32 x);
u64 math__bits__reverse_bytes_64(u64 x);
int math__bits__len_8(byte x);
int math__bits__len_16(u16 x);
int math__bits__len_32(u32 x);
int math__bits__len_64(u64 x);
multi_return_u32_u32 math__bits__add_32(u32 x, u32 y, u32 carry);
multi_return_u64_u64 math__bits__add_64(u64 x, u64 y, u64 carry);
multi_return_u32_u32 math__bits__sub_32(u32 x, u32 y, u32 borrow);
multi_return_u64_u64 math__bits__sub_64(u64 x, u64 y, u64 borrow);
static u64 _const_math__bits__two32; // inited later
static u64 _const_math__bits__mask32; // inited later
static string _const_math__bits__overflow_error; // a string literal, inited later
static string _const_math__bits__divide_error; // a string literal, inited later
multi_return_u32_u32 math__bits__mul_32(u32 x, u32 y);
multi_return_u64_u64 math__bits__mul_64(u64 x, u64 y);
multi_return_u32_u32 math__bits__div_32(u32 hi, u32 lo, u32 y);
multi_return_u64_u64 math__bits__div_64(u64 hi, u64 lo, u64 y1);
u32 math__bits__rem_32(u32 hi, u32 lo, u32 y);
u64 math__bits__rem_64(u64 hi, u64 lo, u64 y);
static array_byte _const_math__bits__ntz_8_tab; // inited later
static array_byte _const_math__bits__pop_8_tab; // inited later
static array_byte _const_math__bits__rev_8_tab; // inited later
static array_byte _const_math__bits__len_8_tab; // inited later
static multi_return_u32_u32_u32 strconv__lsr96(u32 s2, u32 s1, u32 s0);
static multi_return_u32_u32_u32 strconv__lsl96(u32 s2, u32 s1, u32 s0);
static multi_return_u32_u32_u32 strconv__add96(u32 s2, u32 s1, u32 s0, u32 d2, u32 d1, u32 d0);
static multi_return_u32_u32_u32 strconv__sub96(u32 s2, u32 s1, u32 s0, u32 d2, u32 d1, u32 d0);
#define _const_strconv__digits 18
static u64 _const_strconv__double_plus_zero; // inited later
static u64 _const_strconv__double_minus_zero; // inited later
static u64 _const_strconv__double_plus_infinity; // inited later
static u64 _const_strconv__double_minus_infinity; // inited later
#define _const_strconv__fsm_a 0
#define _const_strconv__fsm_b 1
#define _const_strconv__fsm_c 2
#define _const_strconv__fsm_d 3
#define _const_strconv__fsm_e 4
#define _const_strconv__fsm_f 5
#define _const_strconv__fsm_g 6
#define _const_strconv__fsm_h 7
#define _const_strconv__fsm_i 8
#define _const_strconv__fsm_stop 9
#define _const_strconv__parser_ok 0
#define _const_strconv__parser_pzero 1
#define _const_strconv__parser_mzero 2
#define _const_strconv__parser_pinf 3
#define _const_strconv__parser_minf 4
#define _const_strconv__c_dpoint '.'
#define _const_strconv__c_plus '+'
#define _const_strconv__c_minus '-'
#define _const_strconv__c_zero '0'
#define _const_strconv__c_nine '9'
static u32 _const_strconv__c_ten; // inited later
static bool strconv__is_digit(byte x);
static bool strconv__is_space(byte x);
static bool strconv__is_exp(byte x);
static multi_return_int_strconv__PrepNumber strconv__parser(string s);
static u64 strconv__converter(strconv__PrepNumber* pn);
f64 strconv__atof64(string s);
f64 strconv__atof_quick(string s);
static array_u64 _const_strconv__pos_exp; // inited later
static array_u64 _const_strconv__neg_exp; // inited later
#define _const_strconv__int_size 32
static u64 _const_strconv__max_u64; // inited later
byte strconv__byte_to_lower(byte c);
u64 strconv__common_parse_uint(string s, int _base, int _bit_size, bool error_on_non_digit, bool error_on_high_digit);
u64 strconv__parse_uint(string s, int _base, int _bit_size);
i64 strconv__common_parse_int(string _s, int base, int _bit_size, bool error_on_non_digit, bool error_on_high_digit);
i64 strconv__parse_int(string _s, int base, int _bit_size);
int strconv__atoi(string s);
static bool strconv__underscore_ok(string s);
static array_u32 _const_strconv__ten_pow_table_32; // inited later
static u32 _const_strconv__mantbits32; // inited later
static u32 _const_strconv__expbits32; // inited later
#define _const_strconv__bias32 127
#define _const_strconv__maxexp32 255
string strconv__Dec32_get_string_32(strconv__Dec32 d, bool neg, int i_n_digit, int i_pad_digit);
static multi_return_strconv__Dec32_bool strconv__f32_to_decimal_exact_int(u32 i_mant, u32 exp);
strconv__Dec32 strconv__f32_to_decimal(u32 mant, u32 exp);
string strconv__f32_to_str(f32 f, int n_digit);
string strconv__f32_to_str_pad(f32 f, int n_digit);
static array_u64 _const_strconv__ten_pow_table_64; // inited later
static u32 _const_strconv__mantbits64; // inited later
static u32 _const_strconv__expbits64; // inited later
#define _const_strconv__bias64 1023
#define _const_strconv__maxexp64 2047
static string strconv__Dec64_get_string_64(strconv__Dec64 d, bool neg, int i_n_digit, int i_pad_digit);
static multi_return_strconv__Dec64_bool strconv__f64_to_decimal_exact_int(u64 i_mant, u64 exp);
static strconv__Dec64 strconv__f64_to_decimal(u64 mant, u64 exp);
string strconv__f64_to_str(f64 f, int n_digit);
string strconv__f64_to_str_pad(f64 f, int n_digit);
static array_f64 _const_strconv__dec_round; // inited later
string strconv__f64_to_str_lnd(f64 f, int dec_digit);
string strconv__format_str(string s, strconv__BF_param p);
string strconv__format_dec(u64 d, strconv__BF_param p);
string strconv__format_fl(f64 f, strconv__BF_param p);
string strconv__format_es(f64 f, strconv__BF_param p);
string strconv__remove_tail_zeros(string s);
void strconv__v_printf(string str, varg_voidptr pt);
string strconv__v_sprintf(string str, varg_voidptr pt);
static f64 strconv__fabs(f64 x);
string strconv__ftoa_64(f64 f);
string strconv__ftoa_long_64(f64 f);
string strconv__ftoa_32(f32 f);
string strconv__ftoa_long_32(f32 f);
#define _const_strconv__pow5_num_bits_32 61
#define _const_strconv__pow5_inv_num_bits_32 59
#define _const_strconv__pow5_num_bits_64 121
#define _const_strconv__pow5_inv_num_bits_64 122
static array_u64 _const_strconv__powers_of_10; // inited later
static array_u64 _const_strconv__pow5_split_32; // inited later
static array_u64 _const_strconv__pow5_inv_split_32; // inited later
static array_strconv__Uint128 _const_strconv__pow5_split_64; // inited later
static array_strconv__Uint128 _const_strconv__pow5_inv_split_64; // inited later
static void strconv__assert1(bool t, string msg);
static int strconv__bool_to_int(bool b);
static u32 strconv__bool_to_u32(bool b);
static u64 strconv__bool_to_u64(bool b);
static string strconv__get_string_special(bool neg, bool expZero, bool mantZero);
static int strconv__decimal_len_32(u32 u);
static u32 strconv__mul_shift_32(u32 m, u64 mul, int ishift);
static u32 strconv__mul_pow5_invdiv_pow2(u32 m, u32 q, int j);
static u32 strconv__mul_pow5_div_pow2(u32 m, u32 i, int j);
static u32 strconv__pow5_factor_32(u32 i_v);
static bool strconv__multiple_of_power_of_five_32(u32 v, u32 p);
static bool strconv__multiple_of_power_of_two_32(u32 v, u32 p);
static u32 strconv__log10_pow2(int e);
static u32 strconv__log10_pow5(int e);
static int strconv__pow5_bits(int e);
static int strconv__decimal_len_64(u64 u);
static u64 strconv__shift_right_128(strconv__Uint128 v, int shift);
static u64 strconv__mul_shift_64(u64 m, strconv__Uint128 mul, int shift);
static u32 strconv__pow5_factor_64(u64 v_i);
static bool strconv__multiple_of_power_of_five_64(u64 v, u32 p);
static bool strconv__multiple_of_power_of_two_64(u64 v, u32 p);
string strconv__f32_to_str_l(f64 f);
string strconv__f64_to_str_l(f64 f);
static array __new_array(int mylen, int cap, int elm_size);
static array __new_array_with_default(int mylen, int cap, int elm_size, voidptr val);
static array __new_array_with_array_default(int mylen, int cap, int elm_size, array val);
static array new_array_from_c_array(int len, int cap, int elm_size, voidptr c_array);
static array new_array_from_c_array_no_alloc(int len, int cap, int elm_size, voidptr c_array);
static void array_ensure_cap(array* a, int required);
array array_repeat(array a, int count);
void array_sort_with_compare(array* a, voidptr compare);
void array_insert(array* a, int i, voidptr val);
void array_insert_many(array* a, int i, voidptr val, int size);
void array_prepend(array* a, voidptr val);
void array_prepend_many(array* a, voidptr val, int size);
void array_delete(array* a, int i);
void array_clear(array* a);
void array_trim(array* a, int index);
static voidptr array_get_unsafe(array a, int i);
static voidptr array_get(array a, int i);
voidptr array_first(array a);
voidptr array_last(array a);
voidptr array_pop(array* a);
static array array_slice(array a, int start, int _end);
static array array_slice2(array a, int start, int _end, bool end_max);
static array array_clone_static(array a);
array array_clone(array* a);
static array array_slice_clone(array* a, int start, int _end);
static void array_set_unsafe(array* a, int i, voidptr val);
static void array_set(array* a, int i, voidptr val);
static void array_push(array* a, voidptr val);
void array_push_many(array* a3, voidptr val, int size);
void array_reverse_in_place(array* a);
array array_reverse(array a);
void array_free(array* a);
string array_string_str(array_string a);
string array_byte_hex(array_byte b);
int copy(array_byte dst, array_byte src);
static int compare_ints(int* a, int* b);
void array_int_sort(array_int* a);
int array_string_index(array_string a, string v);
int array_int_index(array_int a, int v);
int array_byte_index(array_byte a, byte v);
int array_char_index(array_char a, char v);
int array_int_reduce(array_int a, int (*iter)(int accum, int curr), int accum_start);
bool array_string_eq(array_string a1, array_string a2);
int compare_i64(i64* a, i64* b);
int compare_f64(f64* a, f64* b);
int compare_f32(f32* a, f32* b);
array_voidptr array_pointers(array a);
static byteptr g_m2_buf; // global
static byteptr g_m2_ptr; // global
void v_exit(int code);
bool isnil(voidptr v);
void print_backtrace();
static void panic_debug(int line_no, string file, string mod, string fn_name, string s);
void v_panic(string s);
void eprintln(string s);
void eprint(string s);
void print(string s);
static string _const_new_line_character; // a string literal, inited later
void println(string s);
static i64 total_m; // global
static int nr_mallocs; // global
static void looo();
byteptr v_malloc(int n);
byteptr v_realloc(byteptr b, u32 n);
byteptr v_calloc(int n);
byteptr vcalloc(int n);
void v_free(voidptr ptr);
voidptr memdup(voidptr src, int sz);
static void v_ptr_free(voidptr ptr);
int is_atty(int fd);
static voidptr __as_cast(voidptr obj, int obj_type, int expected_type);
static void __print_assert_failure(VAssertMetaInfo* i);
static void builtin_init();
static bool print_backtrace_skipping_top_frames(int xskipframes);
static bool print_backtrace_skipping_top_frames_mac(int skipframes);
static bool print_backtrace_skipping_top_frames_freebsd(int skipframes);
static bool print_backtrace_skipping_top_frames_linux(int skipframes);
static void break_if_debugger_attached();
int proc_pidpath(int, voidptr, int);
string f64_str(f64 x);
string any_float_str(any_float d);
string f64_strsci(f64 x, int digit_num);
string f64_strlong(f64 x);
string f32_str(f32 x);
string f32_strsci(f32 x, int digit_num);
string f32_strlong(f32 x);
f32 f32_abs(f32 a);
static f64 f64_abs(f64 a);
f32 f32_max(f32 a, f32 b);
f32 f32_min(f32 a, f32 b);
f64 f64_max(f64 a, f64 b);
static f64 f64_min(f64 a, f64 b);
bool f32_eq_epsilon(f32 a, f32 b);
bool f64_eq_epsilon(f64 a, f64 b);
string ptr_str(voidptr ptr);
static string _const_digit_pairs; // a string literal, inited later
string int_str_l(int nn, int max);
string i8_str(i8 n);
string i16_str(i16 n);
string u16_str(u16 n);
string int_str(int n);
string u32_str(u32 nn);
string any_int_str(any_int n);
string i64_str(i64 nn);
string u64_str(u64 nn);
string bool_str(bool b);
string byte_hex(byte nn);
string i8_hex(i8 nn);
string u16_hex(u16 nn);
string i16_hex(i16 nn);
string u32_hex(u32 nn);
string int_hex(int nn);
string int_hex2(int n);
string u64_hex(u64 nn);
string i64_hex(i64 nn);
string any_int_hex(any_int nn);
string voidptr_str(voidptr nn);
string byteptr_str(byteptr nn);
string byte_str(byte c);
bool byte_is_capital(byte c);
array_byte array_byte_clone(array_byte b);
bool array_byte_contains(array_byte a, byte val);
static bool array_int_contains(array_int ar, int val);
bool array_u64_contains(array_u64 a, u64 val);
#define _const_hashbits 24
#define _const_max_cached_hashbits 16
#define _const_init_log_capicity 5
static int _const_init_capicity; // inited later
#define _const_max_load_factor 0.8
static int _const_init_cap; // inited later
#define _const_extra_metas_inc 4
static u32 _const_hash_mask; // inited later
static u32 _const_probe_inc; // inited later
static bool fast_string_eq(string a, string b);
static DenseArray new_dense_array(int value_bytes);
static u32 DenseArray_push(DenseArray* d, string key, voidptr value);
static voidptr DenseArray_get(DenseArray d, int i);
static void DenseArray_zeros_to_end(DenseArray* d);
static map new_map_1(int value_bytes);
static map new_map_init(int n, int value_bytes, string* keys, voidptr values);
static multi_return_u32_u32 map_key_to_index(map* m, string key);
static multi_return_u32_u32 map_meta_less(map* m, u32 _index, u32 _metas);
static void map_meta_greater(map* m, u32 _index, u32 _metas, u32 kvi);
static void map_ensure_extra_metas(map* m, u32 probe_count);
static void map_set(map* m, string k, voidptr value);
static void map_expand(map* m);
static void map_rehash(map* m);
static void map_cached_rehash(map* m, u32 old_cap);
static voidptr map_get_and_set(map* m, string key, voidptr zero);
static voidptr map_get(map m, string key, voidptr zero);
static bool map_exists(map m, string key);
void map_delete(map* m, string key);
array_string map_keys(map* m);
DenseArray DenseArray_clone(DenseArray d);
map map_clone(map m);
void map_free(map* m);
string map_string_str(map_string m);
string OptionBase_str(OptionBase o);
static void opt_ok2(voidptr data, OptionBase* option, int size);
string Option_str(Option o);
static Option opt_ok(voidptr data, int size);
static Option opt_none();
Option v_error(string s);
Option error_with_code(string s, int code);
#define _const_degree 6
static int _const_mid_index; // inited later
static int _const_max_len; // inited later
static u32 _const_children_bytes; // inited later
static SortedMap new_sorted_map(int n, int value_bytes);
static SortedMap new_sorted_map_init(int n, int value_bytes, string* keys, voidptr values);
static mapnode* new_node();
static void SortedMap_set(SortedMap* m, string key, voidptr value);
static void mapnode_split_child(mapnode* n, int child_index, mapnode* y);
static bool SortedMap_get(SortedMap m, string key, voidptr out);
static bool SortedMap_exists(SortedMap m, string key);
static int mapnode_find_key(mapnode* n, string k);
static bool mapnode_remove_key(mapnode* n, string k);
static void mapnode_remove_from_leaf(mapnode* n, int idx);
static void mapnode_remove_from_non_leaf(mapnode* n, int idx);
static void mapnode_fill(mapnode* n, int idx);
static void mapnode_borrow_from_prev(mapnode* n, int idx);
static void mapnode_borrow_from_next(mapnode* n, int idx);
static void mapnode_merge(mapnode* n, int idx);
void SortedMap_delete(SortedMap* m, string key);
static int mapnode_subkeys(mapnode* n, array_string* keys, int at);
array_string SortedMap_keys(SortedMap* m);
static void mapnode_free(mapnode* n);
void SortedMap_free(SortedMap* m);
void SortedMap_print(SortedMap m);
int vstrlen(byteptr s);
string tos(byteptr s, int len);
string tos_clone(byteptr s);
string tos2(byteptr s);
string tos3(charptr s);
string tos_lit(charptr s);
static string string_clone_static(string a);
string string_clone(string a);
string cstring_to_vstring(byteptr cstr);
string string_replace_once(string s, string rep, string with);
string string_replace(string s, string rep, string with);
static int compare_rep_index(RepIndex* a, RepIndex* b);
static void array_RepIndex_sort(array_RepIndex* a);
string string_replace_each(string s, array_string vals);
bool string_bool(string s);
int string_int(string s);
i64 string_i64(string s);
i8 string_i8(string s);
i16 string_i16(string s);
f32 string_f32(string s);
f64 string_f64(string s);
u16 string_u16(string s);
u32 string_u32(string s);
u64 string_u64(string s);
static bool string_eq(string s, string a);
static bool string_ne(string s, string a);
static bool string_lt(string s, string a);
static bool string_le(string s, string a);
static bool string_gt(string s, string a);
static bool string_ge(string s, string a);
static string string_add(string s, string a);
array_string string_split(string s, string delim);
array_string string_split_nth(string s, string delim, int nth);
array_string string_split_into_lines(string s);
static string string_left(string s, int n);
static string string_right(string s, int n);
static string string_substr2(string s, int start, int _end, bool end_max);
string string_substr(string s, int start, int end);
int string_index_old(string s, string p);
Option_int string_index(string s, string p);
static int string_index_kmp(string s, string p);
int string_index_any(string s, string chars);
Option_int string_last_index(string s, string p);
int string_index_after(string s, string p, int start);
int string_index_byte(string s, byte c);
int string_last_index_byte(string s, byte c);
int string_count(string s, string substr);
bool string_contains(string s, string p);
bool string_starts_with(string s, string p);
bool string_ends_with(string s, string p);
string string_to_lower(string s);
bool string_is_lower(string s);
string string_to_upper(string s);
bool string_is_upper(string s);
string string_capitalize(string s);
bool string_is_capital(string s);
string string_title(string s);
bool string_is_title(string s);
string string_find_between(string s, string start, string end);
static bool array_string_contains(array_string ar, string val);
bool byte_is_space(byte c);
string string_trim_space(string s);
string string_trim(string s, string cutset);
string string_trim_left(string s, string cutset);
string string_trim_right(string s, string cutset);
string string_trim_prefix(string s, string str);
string string_trim_suffix(string s, string str);
int compare_strings(string* a, string* b);
static int compare_strings_by_len(string* a, string* b);
static int compare_lower_strings(string* a, string* b);
void array_string_sort(array_string* s);
void array_string_sort_ignore_case(array_string* s);
void array_string_sort_by_len(array_string* s);
string string_str(string s);
string ustring_str(ustring s);
ustring string_ustring(string s);
static array_int g_ustring_runes; // global
ustring string_ustring_tmp(string s);
static bool ustring_eq(ustring u, ustring a);
static bool ustring_ne(ustring u, ustring a);
static bool ustring_lt(ustring u, ustring a);
static bool ustring_le(ustring u, ustring a);
static bool ustring_gt(ustring u, ustring a);
static bool ustring_ge(ustring u, ustring a);
ustring ustring_add(ustring u, ustring a);
int ustring_index_after(ustring u, ustring p, int start);
int ustring_count(ustring u, ustring substr);
string ustring_substr(ustring u, int _start, int _end);
string ustring_left(ustring u, int pos);
string ustring_right(ustring u, int pos);
static byte string_at(string s, int idx);
string ustring_at(ustring u, int idx);
static void ustring_free(ustring* u);
bool byte_is_digit(byte c);
bool byte_is_hex_digit(byte c);
bool byte_is_oct_digit(byte c);
bool byte_is_bin_digit(byte c);
bool byte_is_letter(byte c);
void string_free(string* s);
string string_all_before(string s, string dot);
string string_all_before_last(string s, string dot);
string string_all_after(string s, string dot);
string string_all_after_last(string s, string dot);
string string_after(string s, string dot);
string string_after_char(string s, byte dot);
string array_string_join(array_string a, string del);
string array_string_join_lines(array_string s);
string string_reverse(string s);
string string_limit(string s, int max);
bool byte_is_white(byte c);
int string_hash(string s);
array_byte string_bytes(string s);
string string_repeat(string s, int count);
array_string string_fields(string s);
string string_map(string s, byte (*func)(byte));
string string_filter(string s, bool (*func)(byte b));
string string_strip_margin(string s);
string string_strip_margin_custom(string s, byte del);
int utf8_char_len(byte b);
string utf32_to_str(u32 code);
string utf32_to_str_no_malloc(u32 code, voidptr buf);
int string_utf32_code(string _rune);
#define _const_cp_utf8 65001
u16* string_to_wide(string _str);
string string_from_wide(u16* _wstr);
string string_from_wide2(u16* _wstr, int len);
static int utf8_len(byte c);
static int utf8_str_len(string s);
static int utf8_str_visible_length(string s);
int utf8_getchar();
Option_voidptr json__decode(voidptr typ, string s);
string json__encode(voidptr x);
static int json__decode_int(struct cJSON* root);
static i8 json__decode_i8(struct cJSON* root);
static i16 json__decode_i16(struct cJSON* root);
static i64 json__decode_i64(struct cJSON* root);
static byte json__decode_byte(struct cJSON* root);
static u16 json__decode_u16(struct cJSON* root);
static u32 json__decode_u32(struct cJSON* root);
static u64 json__decode_u64(struct cJSON* root);
static f32 json__decode_f32(struct cJSON* root);
static f64 json__decode_f64(struct cJSON* root);
static string json__decode_string(struct cJSON* root);
static bool json__decode_bool(struct cJSON* root);
static struct cJSON* json__encode_int(int val);
static struct cJSON* json__encode_i8(i8 val);
static struct cJSON* json__encode_i16(i16 val);
static struct cJSON* json__encode_i64(i64 val);
static struct cJSON* json__encode_byte(byte val);
static struct cJSON* json__encode_u16(u16 val);
static struct cJSON* json__encode_u32(u32 val);
static struct cJSON* json__encode_u64(u64 val);
static struct cJSON* json__encode_f32(f32 val);
static struct cJSON* json__encode_f64(f64 val);
static struct cJSON* json__encode_bool(bool val);
static struct cJSON* json__encode_string(string val);
static struct cJSON* json__json_parse(string s);
static string json__json_print(struct cJSON* json);
#define _const_os__s_ifmt 0xF000
#define _const_os__s_ifdir 0x4000
#define _const_os__s_iflnk 0xa000
#define _const_os__s_ixusr 0100
#define _const_os__s_ixgrp 0010
#define _const_os__s_ixoth 0001
static int _const_os__std_input_handle; // inited later
static int _const_os__std_output_handle; // inited later
static int _const_os__std_error_handle; // inited later
#define _const_os__o_rdonly 0
#define _const_os__o_wronly 1
#define _const_os__o_rdwr 2
#define _const_os__o_create 100
#define _const_os__o_excl 200
#define _const_os__o_noctty 400
#define _const_os__o_trunc 1000
#define _const_os__o_append 2000
#define _const_os__o_nonblock 4000
#define _const_os__o_sync 10000
string os__getenv(string key);
int os__setenv(string name, string value, bool overwrite);
int os__unsetenv(string name);
map_string_string os__environ();
os__FileMode os__inode(string path);
static array_string _const_os__args; // inited later
#define _const_os__max_path_len 4096
bool os__File_is_opened(os__File f);
void os__File_write(os__File* f, string s);
void os__File_writeln(os__File* f, string s);
int os__File_write_bytes(os__File* f, voidptr data, int size);
int os__File_write_bytes_at(os__File* f, voidptr data, int size, int pos);
array_byte os__File_read_bytes(os__File* f, int size);
array_byte os__File_read_bytes_at(os__File* f, int size, int pos);
Option_array_byte os__read_bytes(string path);
Option_string os__read_file(string path);
void os__File_flush(os__File* f);
int os__file_size(string path);
void os__mv(string old, string v_new);
Option_void os__cp(string old, string v_new);
Option_void os__cp_r(string osource_path, string odest_path, bool overwrite);
Option_void os__cp_all(string osource_path, string odest_path, bool overwrite);
Option_void os__mv_by_cp(string source, string target);
FILE* os__vfopen(string path, string mode);
int os__fileno(voidptr cfile);
Option_array_string os__read_lines(string path);
static Option_array_ustring os__read_ulines(string path);
Option_os__File os__open_append(string path);
Option_os__File os__open_file(string path, string mode, varg_int options);
static voidptr os__vpopen(string path);
static multi_return_int_bool os__posix_wait4_to_exit_status(int waitret);
string os__posix_get_error_msg(int code);
static int os__vpclose(voidptr f);
int os__system(string cmd);
string os__sigint_to_signal_name(int si);
#define _const_os__f_ok 0
#define _const_os__x_ok 1
#define _const_os__w_ok 2
#define _const_os__r_ok 4
bool os__exists(string path);
bool os__is_executable(string path);
Option_bool os__is_writable_folder(string folder);
bool os__is_writable(string path);
bool os__is_readable(string path);
bool os__file_exists(string _path);
Option_void os__rm(string path);
Option_void os__rmdir(string path);
void os__rmdir_recursive(string path);
Option_void os__rmdir_all(string path);
bool os__is_dir_empty(string path);
static void os__print_c_errno();
string os__file_ext(string path);
string os__dir(string path);
string os__base_dir(string path);
string os__file_name(string path);
string os__input(string prompt);
string os__get_line();
string os__get_raw_line();
array_byte os__get_raw_stdin();
array_string os__get_lines();
string os__get_lines_joined();
string os__user_os();
string os__home_dir();
Option_void os__write_file(string path, string text);
Option_void os__write_file_array(string path, array buffer);
void os__on_segfault(voidptr f);
string os__executable();
static string os__executable_fallback();
Option_string os__find_abs_path_of_executable(string exepath);
bool os__exists_in_system_path(string prog);
bool os__dir_exists(string path);
bool os__is_dir(string path);
bool os__is_link(string path);
void os__chdir(string path);
string os__getwd();
string os__real_path(string fpath);
bool os__is_abs_path(string path);
string os__join_path(string base, varg_string dirs);
array_string os__walk_ext(string path, string ext);
void os__walk(string path, void (*f)(string path));
void os__signal(int signum, voidptr handler);
int os__fork();
int os__wait();
int os__file_last_mod_unix(string path);
void os__log(string s);
void os__flush_stdout();
void os__flush();
Option_void os__mkdir_all(string path);
string os__cache_dir();
string os__temp_dir();
void os__chmod(string path, int mode);
static string _const_os__wd_at_startup; // inited later
string os__resource_abs_path(string path);
Option_os__File os__open(string path);
Option_os__File os__create(string path);
#define _const_os__prot_read 1
#define _const_os__prot_write 2
#define _const_os__map_private 0x02
#define _const_os__map_anonymous 0x20
#define _const_os__sys_write 1
#define _const_os__sys_open 2
#define _const_os__sys_close 3
#define _const_os__sys_mkdir 83
#define _const_os__sys_creat 85
static string _const_os__path_separator; // a string literal, inited later
static string _const_os__path_delimiter; // a string literal, inited later
#define _const_os__stdin_value 0
#define _const_os__stdout_value 1
#define _const_os__stderr_value 2
os__Uname os__uname();
static array_string os__init_os_args(int argc, byte** argv);
Option_array_string os__ls(string path);
Option_bool os__mkdir(string path);
Option_os__Result os__exec(string cmd);
Option_bool os__symlink(string origin, string target);
string os__get_error_msg(int code);
void os__File_close(os__File* f);
bool os__debugger_present();
string time__Time_format(time__Time t);
string time__Time_format_ss(time__Time t);
string time__Time_hhmm(time__Time t);
string time__Time_hhmmss(time__Time t);
string time__Time_hhmm12(time__Time t);
string time__Time_ymmdd(time__Time t);
string time__Time_ddmmy(time__Time t);
string time__Time_md(time__Time t);
string time__Time_clean(time__Time t);
string time__Time_clean12(time__Time t);
string time__Time_get_fmt_time_str(time__Time t, time__FormatTime fmt_time);
string time__Time_get_fmt_date_str(time__Time t, time__FormatDelimiter fmt_dlmtr, time__FormatDate fmt_date);
string time__Time_get_fmt_str(time__Time t, time__FormatDelimiter fmt_dlmtr, time__FormatTime fmt_time, time__FormatDate fmt_date);
string time__Time_utc_string(time__Time time);
bool time__Time_eq(time__Time t1, time__Time t2);
bool time__Time_ne(time__Time t1, time__Time t2);
bool time__Time_lt(time__Time t1, time__Time t2);
bool time__Time_le(time__Time t1, time__Time t2);
bool time__Time_gt(time__Time t1, time__Time t2);
bool time__Time_ge(time__Time t1, time__Time t2);
Option_time__Time time__parse(string s);
Option_time__Time time__parse_rfc2822(string s);
Option_time__Time time__parse_iso8601(string s);
time__StopWatch time__new_stopwatch(time__StopWatchOptions opts);
void time__StopWatch_start(time__StopWatch* t);
void time__StopWatch_restart(time__StopWatch* t);
void time__StopWatch_stop(time__StopWatch* t);
void time__StopWatch_pause(time__StopWatch* t);
time__Duration time__StopWatch_elapsed(time__StopWatch t);
static string _const_time__days_string; // a string literal, inited later
static array_int _const_time__month_days; // inited later
static string _const_time__months_string; // a string literal, inited later
static i64 _const_time__absolute_zero_year; // inited later
#define _const_time__seconds_per_minute 60
static int _const_time__seconds_per_hour; // inited later
static int _const_time__seconds_per_day; // inited later
static int _const_time__seconds_per_week; // inited later
static int _const_time__days_per_400_years; // inited later
static int _const_time__days_per_100_years; // inited later
static int _const_time__days_per_4_years; // inited later
static array_int _const_time__days_before; // inited later
time__Time time__now();
time__Time time__utc();
string time__Time_smonth(time__Time t);
time__Time time__new_time(time__Time t);
int time__Time_unix_time(time__Time t);
time__Time time__Time_add_seconds(time__Time t, int seconds);
time__Time time__Time_add_days(time__Time t, int days);
static int time__since(time__Time t);
string time__Time_relative(time__Time t);
string time__Time_relative_short(time__Time t);
int time__day_of_week(int y, int m, int d);
int time__Time_day_of_week(time__Time t);
string time__Time_weekday_str(time__Time t);
i64 time__ticks();
void time__sleep(int seconds);
void time__sleep_ms(int milliseconds);
void time__usleep(int microseconds);
bool time__is_leap_year(int year);
Option_int time__days_in_month(int month, int year);
string time__Time_str(time__Time t);
static time__Time time__convert_ctime(struct tm t, int microsecond);
static time__Duration _const_time__nanosecond; // inited later
static i64 _const_time__microsecond; // inited later
static i64 _const_time__millisecond; // inited later
static i64 _const_time__second; // inited later
static i64 _const_time__minute; // inited later
static i64 _const_time__hour; // inited later
i64 time__Duration_nanoseconds(time__Duration d);
i64 time__Duration_microseconds(time__Duration d);
i64 time__Duration_milliseconds(time__Duration d);
f64 time__Duration_seconds(time__Duration d);
f64 time__Duration_minutes(time__Duration d);
f64 time__Duration_hours(time__Duration d);
static time__Time time__linux_now();
static time__Time time__linux_utc();
static u64 time__sys_mono_now_darwin();
time__Time time__darwin_now();
time__Time time__solaris_now();
time__Time time__darwin_utc();
time__Time time__solaris_utc();
static int time__make_unix_time(struct tm t);
static time__Time time__to_local_time(time__Time t);
u64 time__sys_mono_now();
static u64 time__vpc_now();
time__Time time__win_now();
time__Time time__win_utc();
struct timespec time__Duration_timespec(time__Duration d);
struct timespec time__zero_timespec();
time__Time time__unix(int abs);
time__Time time__unix2(int abs, int microsecond);
static multi_return_int_int_int time__calculate_date_from_offset(int day_offset_);
static multi_return_int_int_int time__calculate_time_from_offset(int second_offset_);
static string _const_hl__tab; // a string literal, inited later
multi_return_string_int_int hl__highlight_text(string st, string ext, bool commit);
static array_byte hl__write(byte c);
static bool hl__is_letter(byte c, hl__Lang lang);
static bool hl__is_string_token(byte c, hl__Lang lang);
static bool hl__is_line_comment(array_byte s, int pos, string lc);
static bool hl__is_single_line(string s);
static hl__Lang hl__init_c();
static hl__Lang hl__init_cpp();
static hl__Lang hl__init_go();
static hl__Lang hl__init_js();
static hl__Lang hl__init_v();
static string _const_hl__lang_path; // a string literal, inited later
static array_hl__Lang _const_hl__langs; // inited later
static bool hl__is_source(string ext);
Option_hl__Lang hl__extension_to_lang(string ext);
static array_hl__Lang hl__init_langs();
Option_sqlite__DB sqlite__connect(string path);
static struct sqlite3_stmt* sqlite__DB_init_stmt(sqlite__DB db, string query);
static int sqlite__get_int_from_stmt(struct sqlite3_stmt* stmt);
int sqlite__DB_q_int(sqlite__DB db, string query);
string sqlite__DB_q_string(sqlite__DB db, string query);
multi_return_array_sqlite__Row_int sqlite__DB_exec(sqlite__DB db, string query);
Option_sqlite__Row sqlite__DB_exec_one(sqlite__DB db, string query);
int sqlite__DB_exec_none(sqlite__DB db, string query);
static u64 _const_math__uvnan; // inited later
static u64 _const_math__uvinf; // inited later
static u64 _const_math__uvneginf; // inited later
static u64 _const_math__uvone; // inited later
#define _const_math__mask 0x7FF
static int _const_math__shift; // inited later
#define _const_math__bias 1023
static u64 _const_math__sign_mask; // inited later
static u64 _const_math__frac_mask; // inited later
f64 math__inf(int sign);
f64 math__nan();
bool math__is_nan(f64 f);
bool math__is_inf(f64 f, int sign);
#define _const_math__e 2.71828182845904523536028747135266249775724709369995957496696763
#define _const_math__pi 3.14159265358979323846264338327950288419716939937510582097494459
#define _const_math__phi 1.61803398874989484820458683436563811772030917980576286213544862
#define _const_math__tau 6.28318530717958647692528676655900576839433879875021164194988918
#define _const_math__sqrt2 1.41421356237309504880168872420969807856967187537694807317667974
#define _const_math__sqrt_e 1.64872127070012814684865078781416357165377610071014801157507931
#define _const_math__sqrt_pi 1.77245385090551602729816748334114518279754945612238712821380779
#define _const_math__sqrt_tau 2.50662827463100050241576528481104525300698674060993831662992357
#define _const_math__sqrt_phi 1.27201964951406896425242246173749149171560804184009624861664038
#define _const_math__ln2 0.693147180559945309417232121458176568075500134360255254120680009
static f64 _const_math__log2_e; // inited later
#define _const_math__ln10 2.30258509299404568401799145468436420760110148862877297603332790
static f64 _const_math__log10_e; // inited later
#define _const_math__max_f32 3.40282346638528859811704183484516925440e+38
#define _const_math__smallest_non_zero_f32 1.401298464324817070923729583289916131280e-45
#define _const_math__max_f64 1.797693134862315708145274237317043567981e+308
#define _const_math__smallest_non_zero_f64 4.940656458412465441765687928682213723651e-324
#define _const_math__max_i8 127
static int _const_math__min_i8; // inited later
#define _const_math__max_i16 32767
static int _const_math__min_i16; // inited later
#define _const_math__max_i32 2147483647
static int _const_math__min_i32; // inited later
static i64 _const_math__min_i64; // inited later
static i64 _const_math__max_i64; // inited later
#define _const_math__max_u8 255
#define _const_math__max_u16 65535
static u32 _const_math__max_u32; // inited later
static u64 _const_math__max_u64; // inited later
f64 math__abs(f64 a);
f64 math__acos(f64 a);
f64 math__asin(f64 a);
f64 math__atan(f64 a);
f64 math__atan2(f64 a, f64 b);
f64 math__cbrt(f64 a);
f64 math__ceil(f64 a);
f64 math__cos(f64 a);
f32 math__cosf(f32 a);
f64 math__cosh(f64 a);
f64 math__exp(f64 a);
f64 math__erf(f64 a);
f64 math__erfc(f64 a);
f64 math__exp2(f64 a);
f64 math__floor(f64 a);
f64 math__fmod(f64 a, f64 b);
f64 math__gamma(f64 a);
f64 math__hypot(f64 a, f64 b);
f64 math__log(f64 a);
f64 math__log2(f64 a);
f64 math__log10(f64 a);
f64 math__log_gamma(f64 a);
f64 math__log_n(f64 a, f64 b);
f64 math__pow(f64 a, f64 b);
f32 math__powf(f32 a, f32 b);
f64 math__round(f64 f);
f64 math__sin(f64 a);
f32 math__sinf(f32 a);
f64 math__sinh(f64 a);
f64 math__sqrt(f64 a);
f32 math__sqrtf(f32 a);
f64 math__tan(f64 a);
f32 math__tanf(f32 a);
f64 math__tanh(f64 a);
f64 math__trunc(f64 a);
f64 math__aprox_sin(f64 a);
f64 math__aprox_cos(f64 a);
f64 math__copysign(f64 x, f64 y);
f64 math__degrees(f64 radians);
array_int math__digits(int _n, int base);
f64 math__fabs(f64 x);
i64 math__gcd(i64 a_, i64 b_);
i64 math__lcm(i64 a, i64 b);
f64 math__max(f64 a, f64 b);
f64 math__min(f64 a, f64 b);
f64 math__radians(f64 degrees);
u32 math__f32_bits(f32 f);
f32 math__f32_from_bits(u32 b);
u64 math__f64_bits(f64 f);
f64 math__f64_from_bits(u64 b);
static string _const_net__urllib__err_msg_escape; // a string literal, inited later
static string _const_net__urllib__err_msg_parse; // a string literal, inited later
static string net__urllib__error_msg(string message, string val);
static bool net__urllib__should_escape(byte c, net__urllib__EncodingMode mode);
Option_string net__urllib__query_unescape(string s);
Option_string net__urllib__path_unescape(string s);
static Option_string net__urllib__unescape(string s_, net__urllib__EncodingMode mode);
string net__urllib__query_escape(string s);
string net__urllib__path_escape(string s);
static string net__urllib__escape(string s, net__urllib__EncodingMode mode);
net__urllib__Userinfo* net__urllib__user(string username);
static net__urllib__Userinfo* net__urllib__user_password(string username, string password);
static bool net__urllib__Userinfo_empty(net__urllib__Userinfo* u);
static string net__urllib__Userinfo_string(net__urllib__Userinfo* u);
static Option_array_string net__urllib__split_by_scheme(string rawurl);
static Option_string net__urllib__get_scheme(string rawurl);
static multi_return_string_string net__urllib__split(string s, byte sep, bool cutc);
Option_net__urllib__URL net__urllib__parse(string rawurl);
static Option_net__urllib__URL net__urllib__parse_request_uri(string rawurl);
static Option_net__urllib__URL net__urllib__parse_url(string rawurl, bool via_request);
static Option_net__urllib__ParseAuthorityRes net__urllib__parse_authority(string authority);
static Option_string net__urllib__parse_host(string host);
Option_bool net__urllib__URL_set_path(net__urllib__URL* u, string p);
static string net__urllib__URL_escaped_path(net__urllib__URL* u);
static bool net__urllib__valid_encoded_path(string s);
static bool net__urllib__valid_optional_port(string port);
string net__urllib__URL_str(net__urllib__URL u);
Option_net__urllib__Values net__urllib__parse_query(string query);
static net__urllib__Values net__urllib__parse_query_silent(string query);
static Option_bool net__urllib__parse_query_values(net__urllib__Values* m, string query);
string net__urllib__Values_encode(net__urllib__Values v);
static string net__urllib__resolve_path(string base, string ref);
bool net__urllib__URL_is_abs(net__urllib__URL* u);
Option_net__urllib__URL net__urllib__URL_parse(net__urllib__URL* u, string ref);
Option_net__urllib__URL net__urllib__URL_resolve_reference(net__urllib__URL* u, net__urllib__URL* ref);
net__urllib__Values net__urllib__URL_query(net__urllib__URL* u);
string net__urllib__URL_request_uri(net__urllib__URL* u);
string net__urllib__URL_hostname(net__urllib__URL* u);
string net__urllib__URL_port(net__urllib__URL* u);
static multi_return_string_string net__urllib__split_host_port(string hostport);
bool net__urllib__valid_userinfo(string s);
static bool net__urllib__string_contains_ctl_byte(string s);
bool net__urllib__ishex(byte c);
static byte net__urllib__unhex(byte c);
net__urllib__Values net__urllib__new_values();
array_string net__urllib__Value_all(net__urllib__Value* v);
string net__urllib__Values_get(net__urllib__Values* v, string key);
array_string net__urllib__Values_get_all(net__urllib__Values* v, string key);
void net__urllib__Values_set(net__urllib__Values* v, string key, string value);
void net__urllib__Values_add(net__urllib__Values* v, string key, string value);
void net__urllib__Values_del(net__urllib__Values* v, string key);
u16 encoding__binary__little_endian_u16(array_byte b);
void encoding__binary__little_endian_put_u16(array_byte* b, u16 v);
u32 encoding__binary__little_endian_u32(array_byte b);
void encoding__binary__little_endian_put_u32(array_byte* b, u32 v);
u64 encoding__binary__little_endian_u64(array_byte b);
void encoding__binary__little_endian_put_u64(array_byte* b, u64 v);
u16 encoding__binary__big_endian_u16(array_byte b);
void encoding__binary__big_endian_put_u16(array_byte* b, u16 v);
u32 encoding__binary__big_endian_u32(array_byte b);
void encoding__binary__big_endian_put_u32(array_byte* b, u32 v);
u64 encoding__binary__big_endian_u64(array_byte b);
void encoding__binary__big_endian_put_u64(array_byte* b, u64 v);
static void net__openssl__init();
#define _const_net__openssl__is_used 1
static int net__http__chunked__ChunkScanner_read_chunk_size(net__http__chunked__ChunkScanner* s);
static byte net__http__chunked__unhex(byte c);
static void net__http__chunked__ChunkScanner_skip_crlf(net__http__chunked__ChunkScanner* s);
static string net__http__chunked__ChunkScanner_read_chunk(net__http__chunked__ChunkScanner* s, int chunksize);
string net__http__chunked__decode(string text);
#define _const_crypto__sha1__size 20
#define _const_crypto__sha1__block_size 64
#define _const_crypto__sha1__chunk 64
#define _const_crypto__sha1__init0 0x67452301
#define _const_crypto__sha1__init1 0xEFCDAB89
#define _const_crypto__sha1__init2 0x98BADCFE
#define _const_crypto__sha1__init3 0x10325476
#define _const_crypto__sha1__init4 0xC3D2E1F0
static void crypto__sha1__Digest_reset(crypto__sha1__Digest* d);
crypto__sha1__Digest* crypto__sha1__new();
int crypto__sha1__Digest_write(crypto__sha1__Digest* d, array_byte p_);
array_byte crypto__sha1__Digest_sum(crypto__sha1__Digest* d, array_byte b_in);
static array_byte crypto__sha1__Digest_checksum(crypto__sha1__Digest* d);
array_byte crypto__sha1__sum(array_byte data);
static void crypto__sha1__block(crypto__sha1__Digest* dig, array_byte p);
int crypto__sha1__Digest_size(crypto__sha1__Digest* d);
int crypto__sha1__Digest_block_size(crypto__sha1__Digest* d);
string crypto__sha1__hexhash(string s);
#define _const_crypto__sha1___k0 0x5A827999
#define _const_crypto__sha1___k1 0x6ED9EBA1
#define _const_crypto__sha1___k2 0x8F1BBCDC
#define _const_crypto__sha1___k3 0xCA62C1D6
static void crypto__sha1__block_generic(crypto__sha1__Digest* dig, array_byte p_);
#define _const_crypto__sha256__size 32
#define _const_crypto__sha256__size224 28
#define _const_crypto__sha256__block_size 64
#define _const_crypto__sha256__chunk 64
#define _const_crypto__sha256__init0 0x6A09E667
#define _const_crypto__sha256__init1 0xBB67AE85
#define _const_crypto__sha256__init2 0x3C6EF372
#define _const_crypto__sha256__init3 0xA54FF53A
#define _const_crypto__sha256__init4 0x510E527F
#define _const_crypto__sha256__init5 0x9B05688C
#define _const_crypto__sha256__init6 0x1F83D9AB
#define _const_crypto__sha256__init7 0x5BE0CD19
#define _const_crypto__sha256__init0_224 0xC1059ED8
#define _const_crypto__sha256__init1_224 0x367CD507
#define _const_crypto__sha256__init2_224 0x3070DD17
#define _const_crypto__sha256__init3_224 0xF70E5939
#define _const_crypto__sha256__init4_224 0xFFC00B31
#define _const_crypto__sha256__init5_224 0x68581511
#define _const_crypto__sha256__init6_224 0x64F98FA7
#define _const_crypto__sha256__init7_224 0xBEFA4FA4
static void crypto__sha256__Digest_reset(crypto__sha256__Digest* d);
crypto__sha256__Digest* crypto__sha256__new();
crypto__sha256__Digest* crypto__sha256__new224();
static int crypto__sha256__Digest_write(crypto__sha256__Digest* d, array_byte p_);
static array_byte crypto__sha256__Digest_sum(crypto__sha256__Digest* d, array_byte b_in);
static array_byte crypto__sha256__Digest_checksum(crypto__sha256__Digest* d);
array_byte crypto__sha256__sum(array_byte data);
array_byte crypto__sha256__sum256(array_byte data);
array_byte crypto__sha256__sum224(array_byte data);
static void crypto__sha256__block(crypto__sha256__Digest* dig, array_byte p);
int crypto__sha256__Digest_size(crypto__sha256__Digest* d);
int crypto__sha256__Digest_block_size(crypto__sha256__Digest* d);
string crypto__sha256__hexhash(string s);
string crypto__sha256__hexhash_224(string s);
static array_int _const_crypto__sha256___k; // inited later
static void crypto__sha256__block_generic(crypto__sha256__Digest* dig, array_byte p_);
static int net__error_code();
#define _const_net__msg_nosignal 0x4000
Option_string net__hostname();
Option_net__Socket net__new_socket(int family, int typ, int proto);
Option_net__Socket net__socket_udp();
Option_int net__Socket_setsockopt(net__Socket s, int level, int optname, int* optvalue);
Option_int net__Socket_bind(net__Socket s, int port);
Option_int net__Socket_listen(net__Socket s);
Option_int net__Socket_listen_backlog(net__Socket s, int backlog);
Option_net__Socket net__listen(int port);
Option_net__Socket net__Socket_accept(net__Socket s);
Option_string net__Socket_peer_ip(net__Socket s);
Option_int net__Socket_connect(net__Socket s, string address, int port);
Option_net__Socket net__dial(string address, int port);
Option_int net__Socket_send(net__Socket s, byteptr buf, int len);
Option_int net__Socket_send_string(net__Socket s, string sdata);
multi_return_byteptr_int net__Socket_recv(net__Socket s, int bufsize);
int net__Socket_cread(net__Socket s, byteptr buffer, int buffersize);
int net__Socket_crecv(net__Socket s, voidptr buffer, int buffersize);
Option_int net__Socket_close(net__Socket s);
static string _const_net__crlf; // a string literal, inited later
#define _const_net__max_read 400
#define _const_net__msg_peek 0x02
Option_int net__Socket_write(net__Socket s, string str);
string net__Socket_read_line(net__Socket s);
string net__Socket_read_all(net__Socket s);
int net__Socket_get_port(net__Socket s);
string term__format(string msg, string open, string close);
string term__format_rgb(int r, int g, int b, string msg, string open, string close);
string term__rgb(int r, int g, int b, string msg);
string term__bg_rgb(int r, int g, int b, string msg);
string term__hex(int hex, string msg);
string term__bg_hex(int hex, string msg);
string term__bg_black(string msg);
string term__bright_bg_black(string msg);
string term__bg_blue(string msg);
string term__bright_bg_blue(string msg);
string term__bg_cyan(string msg);
string term__bright_bg_cyan(string msg);
string term__bg_green(string msg);
string term__bright_bg_green(string msg);
string term__bg_magenta(string msg);
string term__bright_bg_magenta(string msg);
string term__bg_red(string msg);
string term__bright_bg_red(string msg);
string term__bg_white(string msg);
string term__bright_bg_white(string msg);
string term__bg_yellow(string msg);
string term__bright_bg_yellow(string msg);
string term__black(string msg);
string term__bright_black(string msg);
string term__blue(string msg);
string term__bright_blue(string msg);
string term__bold(string msg);
string term__cyan(string msg);
string term__bright_cyan(string msg);
string term__dim(string msg);
string term__green(string msg);
string term__bright_green(string msg);
string term__gray(string msg);
string term__hidden(string msg);
string term__italic(string msg);
string term__inverse(string msg);
string term__magenta(string msg);
string term__bright_magenta(string msg);
string term__reset(string msg);
string term__red(string msg);
string term__bright_red(string msg);
string term__strikethrough(string msg);
string term__underline(string msg);
string term__white(string msg);
string term__bright_white(string msg);
string term__yellow(string msg);
string term__bright_yellow(string msg);
void term__set_cursor_position(int x, int y);
void term__move(int n, string direction);
void term__cursor_up(int n);
void term__cursor_down(int n);
void term__cursor_forward(int n);
void term__cursor_back(int n);
void term__erase_display(string t);
void term__erase_toend();
void term__erase_tobeg();
void term__erase_clear();
void term__erase_del_clear();
void term__erase_line(string t);
void term__erase_line_toend();
void term__erase_line_tobeg();
void term__erase_line_clear();
void term__show_cursor();
void term__hide_cursor();
#define _const_term__default_columns_size 80
#define _const_term__default_rows_size 25
bool term__can_show_color_on_stdout();
bool term__can_show_color_on_stderr();
string term__ok_message(string s);
string term__fail_message(string s);
string term__warn_message(string s);
string term__h_divider(string divider);
string term__header(string text, string divider);
static bool term__supports_escape_sequences(int fd);
void term__clear();
multi_return_int_int term__get_terminal_size();
static u64 _const_rand__util__lower_mask; // inited later
#define _const_rand__util__max_u32 0xFFFFFFFF
#define _const_rand__util__max_u64 0xFFFFFFFFFFFFFFFF
static f32 _const_rand__util__max_u32_as_f32; // inited later
static f64 _const_rand__util__max_u64_as_f64; // inited later
static u32 _const_rand__util__u31_mask; // inited later
static u64 _const_rand__util__u63_mask; // inited later
static u32 rand__util__nr_next(u32 prev);
array_u32 rand__util__time_seed_array(int count);
u32 rand__util__time_seed_32();
u64 rand__util__time_seed_64();
int runtime__nr_jobs();
bool runtime__is_32bit();
bool runtime__is_64bit();
bool runtime__is_little_endian();
bool runtime__is_big_endian();
int runtime__nr_cpus();
static string log__tag(log__Level l);
void log__Log_set_level(log__Log* l, log__Level level);
void log__Log_set_output_level(log__Log* l, log__Level level);
void log__Log_set_full_logpath(log__Log* l, string full_log_path);
void log__Log_set_output_label(log__Log* l, string label);
void log__Log_set_output_path(log__Log* l, string output_file_path);
void log__Log_close(log__Log* l);
static void log__Log_log_file(log__Log* l, string s, log__Level level);
static void log__Log_log_cli(log__Log* l, string s, log__Level level);
static void log__Log_send_output(log__Log* l, string* s, log__Level level);
void log__Log_fatal(log__Log* l, string s);
void log__Log_error(log__Log* l, string s);
void log__Log_warn(log__Log* l, string s);
void log__Log_info(log__Log* l, string s);
void log__Log_debug(log__Log* l, string s);
static int _const_net__http__is_used; // inited later
static Option_net__http__Response net__http__Request_ssl_do(net__http__Request* req, int port, string method, string host_name, string path);
array_net__http__Cookie_ptr net__http__read_set_cookies(map_string_array_string h);
array_net__http__Cookie_ptr net__http__read_cookies(map_string_array_string h, string filter);
string net__http__Cookie_str(net__http__Cookie* c);
static string net__http__sanitize(bool (*valid)(byte b), string v);
static string net__http__sanitize_cookie_name(string name);
string net__http__sanitize_cookie_value(string v);
static string net__http__sanitize_cookie_path(string v);
static bool net__http__valid_cookie_value_byte(byte b);
static bool net__http__valid_cookie_path_byte(byte b);
static bool net__http__valid_cookie_domain(string v);
bool net__http__is_cookie_domain_name(string _s);
static Option_string net__http__parse_cookie_value(string _raw, bool allow_double_quote);
static bool net__http__is_cookie_name_valid(string name);
bool net__http__download_file(string url, string out);
static void net__http__download_cb(voidptr ptr, size_t size, size_t nmemb, voidptr userp);
void net__http__download_file_with_progress(string url, string out, net__http__DownloadFn cb, void (*cb_finished)());
static void net__http__empty();
#define _const_net__http__max_redirects 4
static string _const_net__http__content_type_default; // a string literal, inited later
#define _const_net__http__bufsize 1536
Option_net__http__Request net__http__new_request(string method, string url_, string data);
Option_net__http__Response net__http__get(string url);
Option_net__http__Response net__http__post(string url, string data);
Option_net__http__Response net__http__post_json(string url, string data);
Option_net__http__Response net__http__post_form(string url, map_string_string data);
Option_net__http__Response net__http__put(string url, string data);
Option_net__http__Response net__http__patch(string url, string data);
Option_net__http__Response net__http__head(string url);
Option_net__http__Response net__http__delete(string url);
Option_net__http__Response net__http__fetch(string _url, net__http__FetchConfig config);
string net__http__get_text(string url);
string net__http__url_encode_form_data(map_string_string data);
static Option_net__http__Response net__http__fetch_with_method(string method, string url, net__http__FetchConfig _config);
static Option_string net__http__build_url_from_fetch(string _url, net__http__FetchConfig config);
static void net__http__Request_free(net__http__Request* req);
static void net__http__Response_free(net__http__Response* resp);
void net__http__Request_add_header(net__http__Request* req, string key, string val);
map_string_string net__http__parse_headers(array_string lines);
Option_net__http__Response net__http__Request_do(net__http__Request* req);
static Option_net__http__Response net__http__Request_method_and_url_to_response(net__http__Request* req, string method, net__urllib__URL url);
static net__http__Response net__http__parse_response(string resp);
static string net__http__Request_build_request_headers(net__http__Request* req, string method, string host_name, string path);
static string net__http__Request_build_request_cookies_header(net__http__Request* req);
string net__http__unescape_url(string s);
string net__http__escape_url(string s);
string net__http__unescape(string s);
string net__http__escape(string s);
static Option_net__http__Response net__http__Request_http_do(net__http__Request* req, int port, string method, string host_name, string path);
string net__http__Request_referer(net__http__Request* req);
static voidptr _const_sync__no_result; // inited later
sync__PoolProcessor* sync__new_pool_processor(sync__PoolProcessorConfig context);
void sync__PoolProcessor_set_max_jobs(sync__PoolProcessor* pool, int njobs);
void sync__PoolProcessor_work_on_pointers(sync__PoolProcessor* pool, array_voidptr items);
static void sync__process_in_thread(sync__PoolProcessor* pool, int task_id);
string sync__PoolProcessor_get_string_item(sync__PoolProcessor* pool, int idx);
int sync__PoolProcessor_get_int_item(sync__PoolProcessor* pool, int idx);
void sync__PoolProcessor_set_shared_context(sync__PoolProcessor* pool, voidptr context);
voidptr sync__PoolProcessor_get_shared_context(sync__PoolProcessor* pool);
void sync__PoolProcessor_set_thread_context(sync__PoolProcessor* pool, int idx, voidptr context);
voidptr sync__PoolProcessor_get_thread_context(sync__PoolProcessor* pool, int idx);
void sync__PoolProcessor_work_on_items_s(sync__PoolProcessor* pool, array_string items);
void sync__PoolProcessor_work_on_items_i(sync__PoolProcessor* pool, array_int items);
array_sync__SResult sync__PoolProcessor_get_results_s(sync__PoolProcessor* pool);
array_sync__IResult sync__PoolProcessor_get_results_i(sync__PoolProcessor* pool);
sync__Mutex* sync__new_mutex();
sync__RwMutex* sync__new_rwmutex();
void sync__Mutex_m_lock(sync__Mutex* m);
void sync__Mutex_unlock(sync__Mutex* m);
void sync__RwMutex_r_lock(sync__RwMutex* m);
void sync__RwMutex_w_lock(sync__RwMutex* m);
void sync__RwMutex_r_unlock(sync__RwMutex* m);
void sync__RwMutex_w_unlock(sync__RwMutex* m);
sync__Semaphore sync__new_semaphore();
void sync__Semaphore_post(sync__Semaphore s);
void sync__Semaphore_wait(sync__Semaphore s);
bool sync__Semaphore_try_wait(sync__Semaphore s);
bool sync__Semaphore_timed_wait(sync__Semaphore s, time__Duration timeout);
void sync__Waiter_wait(sync__Waiter* w);
void sync__Waiter_stop(sync__Waiter* w);
sync__Waiter* sync__new_waiter();
sync__WaitGroup* sync__new_waitgroup();
void sync__WaitGroup_add(sync__WaitGroup* wg, int delta);
void sync__WaitGroup_done(sync__WaitGroup* wg);
void sync__WaitGroup_wait(sync__WaitGroup* wg);
static u64 _const_rand__wyrand__wyp0; // inited later
static u64 _const_rand__wyrand__wyp1; // inited later
void rand__wyrand__WyRandRNG_seed(rand__wyrand__WyRandRNG* rng, array_u32 seed_data);
u32 rand__wyrand__WyRandRNG_u32(rand__wyrand__WyRandRNG* rng);
u64 rand__wyrand__WyRandRNG_u64(rand__wyrand__WyRandRNG* rng);
u32 rand__wyrand__WyRandRNG_u32n(rand__wyrand__WyRandRNG* rng, u32 max);
u64 rand__wyrand__WyRandRNG_u64n(rand__wyrand__WyRandRNG* rng, u64 max);
u32 rand__wyrand__WyRandRNG_u32_in_range(rand__wyrand__WyRandRNG* rng, u32 min, u32 max);
u64 rand__wyrand__WyRandRNG_u64_in_range(rand__wyrand__WyRandRNG* rng, u64 min, u64 max);
int rand__wyrand__WyRandRNG_int(rand__wyrand__WyRandRNG* rng);
i64 rand__wyrand__WyRandRNG_i64(rand__wyrand__WyRandRNG* rng);
int rand__wyrand__WyRandRNG_int31(rand__wyrand__WyRandRNG* rng);
i64 rand__wyrand__WyRandRNG_int63(rand__wyrand__WyRandRNG* rng);
int rand__wyrand__WyRandRNG_intn(rand__wyrand__WyRandRNG* rng, int max);
i64 rand__wyrand__WyRandRNG_i64n(rand__wyrand__WyRandRNG* rng, i64 max);
int rand__wyrand__WyRandRNG_int_in_range(rand__wyrand__WyRandRNG* rng, int min, int max);
i64 rand__wyrand__WyRandRNG_i64_in_range(rand__wyrand__WyRandRNG* rng, i64 min, i64 max);
f32 rand__wyrand__WyRandRNG_f32(rand__wyrand__WyRandRNG* rng);
f64 rand__wyrand__WyRandRNG_f64(rand__wyrand__WyRandRNG* rng);
f32 rand__wyrand__WyRandRNG_f32n(rand__wyrand__WyRandRNG* rng, f32 max);
f64 rand__wyrand__WyRandRNG_f64n(rand__wyrand__WyRandRNG* rng, f64 max);
f32 rand__wyrand__WyRandRNG_f32_in_range(rand__wyrand__WyRandRNG* rng, f32 min, f32 max);
f64 rand__wyrand__WyRandRNG_f64_in_range(rand__wyrand__WyRandRNG* rng, f64 min, f64 max);
static array_string _const_vweb__methods_with_form; // inited later
static array_string _const_vweb__method_all; // inited later
static string _const_vweb__header_server; // a string literal, inited later
static string _const_vweb__header_connection_close; // a string literal, inited later
static string _const_vweb__headers_close; // inited later
static string _const_vweb__http_404; // inited later
static string _const_vweb__http_500; // inited later
static map_string_string _const_vweb__mime_types; // inited later
static int _const_vweb__max_http_post_size; // inited later
#define _const_vweb__default_port 8080
static bool vweb__Context_send_response_to_client(vweb__Context* ctx, string mimetype, string res);
void vweb__Context_html(vweb__Context* ctx, string s);
vweb__Result vweb__Context_text(vweb__Context* ctx, string s);
vweb__Result vweb__Context_json(vweb__Context* ctx, string s);
vweb__Result vweb__Context_ok(vweb__Context* ctx, string s);
vweb__Result vweb__Context_redirect(vweb__Context* ctx, string url);
vweb__Result vweb__Context_not_found(vweb__Context* ctx);
void vweb__Context_set_cookie(vweb__Context* ctx, vweb__Cookie cookie);
void vweb__Context_set_cookie_old(vweb__Context* ctx, string key, string val);
void vweb__Context_set_content_type(vweb__Context* ctx, string typ);
void vweb__Context_set_cookie_with_expire_date(vweb__Context* ctx, string key, string val, time__Time expire_date);
Option_string vweb__Context_get_cookie(vweb__Context* ctx, string key);
void vweb__Context_add_header(vweb__Context* ctx, string key, string val);
string vweb__Context_get_header(vweb__Context* ctx, string key);
void vweb__run_main__App(int port);
void vweb__run_app_main__App(main__App* app, int port);
static void vweb__handle_conn_main__App(net__Socket conn, main__App* app);
static void vweb__send_action_main__App(string action, array_string vars, main__App* app);
static void vweb__Context_parse_form(vweb__Context* ctx, string s);
static void vweb__Context_scan_static_directory(vweb__Context* ctx, string directory_path, string mount_path);
bool vweb__Context_handle_static(vweb__Context* ctx, string directory_path);
void vweb__Context_serve_static(vweb__Context* ctx, string url, string file_path, string mime_type);
string vweb__Context_ip(vweb__Context* ctx);
void vweb__Context_error(vweb__Context* ctx, string s);
static string vweb__strip(string s);
vweb__Result vweb__not_found();
static string vweb__filter(string s);
static rand__wyrand__WyRandRNG* default_rng; // global
static void rand__init();
rand__wyrand__WyRandRNG* rand__new_default(rand__PRNGConfigStruct config);
void rand__seed(array_u32 seed);
u32 rand__u32();
u64 rand__u64();
u32 rand__u32n(u32 max);
u64 rand__u64n(u64 max);
u32 rand__u32_in_range(u32 min, u32 max);
u64 rand__u64_in_range(u64 min, u64 max);
int rand__int();
int rand__intn(int max);
int rand__int_in_range(int min, int max);
int rand__int31();
i64 rand__i64();
i64 rand__i64n(i64 max);
i64 rand__i64_in_range(i64 min, i64 max);
i64 rand__int63();
f32 rand__f32();
f64 rand__f64();
f32 rand__f32n(f32 max);
f64 rand__f64n(f64 max);
f32 rand__f32_in_range(f32 min, f32 max);
f64 rand__f64_in_range(f64 min, f64 max);
static string _const_rand__chars; // a string literal, inited later
string rand__string(int len);
vweb__Result main__App_admin(main__App* app);
vweb__Result main__App_admin_settings(main__App* app);
vweb__Result main__App_update_admin_settings(main__App* app);
vweb__Result main__App_admin_userlist(main__App* app);
vweb__Result main__App_admin_edituser(main__App* app, string user);
static bool main__App_is_admin(main__App* app);
vweb__Result main__App_api_issues(main__App* app, string user, string repo);

//Option_main__Issue json__decode_main__Issue(cJSON* root, main__Issue* res) {
Option_main__Issue json__decode_main__Issue(cJSON* root) {
  main__Issue res;
  if (!root) {
    const char *error_ptr = cJSON_GetErrorPtr();
    if (error_ptr != NULL)	{
//      fprintf(stderr, "Error in decode() for main__Issue error_ptr=: %%s\n", error_ptr);
//      printf("\nbad js=%%s\n", js.str);
		Option err = v_error(tos2(error_ptr));
      return *(Option_main__Issue *)&err;
    }
  }

 res . id = json__decode_int (js_get(root, "id"));
 res . author_id = json__decode_int (js_get(root, "author_id"));
 res . repo_id = json__decode_int (js_get(root, "repo_id"));
 res . is_pr = json__decode_bool (js_get(root, "is_pr"));
 res . nr_comments = json__decode_int (js_get(root, "nr_comments"));
 res . title = json__decode_string (js_get(root, "title"));
 res . text = json__decode_string (js_get(root, "text"));
 res . created_at = json__decode_int (js_get(root, "created_at"));
Option_main__Issue ret;
opt_ok2(&res, (OptionBase*)&ret, sizeof(res));
return ret;
}


//Option_array_main__Issue json__decode_array_main__Issue(cJSON* root, array_main__Issue* res) {
Option_array_main__Issue json__decode_array_main__Issue(cJSON* root) {
  array_main__Issue res;
  if (!root) {
    const char *error_ptr = cJSON_GetErrorPtr();
    if (error_ptr != NULL)	{
//      fprintf(stderr, "Error in decode() for array_main__Issue error_ptr=: %%s\n", error_ptr);
//      printf("\nbad js=%%s\n", js.str);
		Option err = v_error(tos2(error_ptr));
      return *(Option_array_main__Issue *)&err;
    }
  }


res = __new_array(0, 0, sizeof(main__Issue));
const cJSON *jsval = NULL;
cJSON_ArrayForEach(jsval, root)
{
	main__Issue val = *(main__Issue*) json__decode_main__Issue(jsval).data; 
  array_push(&res, &val);
}

Option_array_main__Issue ret;
opt_ok2(&res, (OptionBase*)&ret, sizeof(res));
return ret;
}

vweb__Result main__App_api_commits(main__App* app, string user, string repo);

//Option_main__Commit json__decode_main__Commit(cJSON* root, main__Commit* res) {
Option_main__Commit json__decode_main__Commit(cJSON* root) {
  main__Commit res;
  if (!root) {
    const char *error_ptr = cJSON_GetErrorPtr();
    if (error_ptr != NULL)	{
//      fprintf(stderr, "Error in decode() for main__Commit error_ptr=: %%s\n", error_ptr);
//      printf("\nbad js=%%s\n", js.str);
		Option err = v_error(tos2(error_ptr));
      return *(Option_main__Commit *)&err;
    }
  }

 res . id = json__decode_int (js_get(root, "id"));
 res . author_id = json__decode_int (js_get(root, "author_id"));
 res . author = json__decode_string (js_get(root, "author"));
 res . hash = json__decode_string (js_get(root, "hash"));
 res . created_at = json__decode_int (js_get(root, "created_at"));
 res . repo_id = json__decode_int (js_get(root, "repo_id"));
 res . message = json__decode_string (js_get(root, "message"));
Option_main__Commit ret;
opt_ok2(&res, (OptionBase*)&ret, sizeof(res));
return ret;
}


//Option_array_main__Commit json__decode_array_main__Commit(cJSON* root, array_main__Commit* res) {
Option_array_main__Commit json__decode_array_main__Commit(cJSON* root) {
  array_main__Commit res;
  if (!root) {
    const char *error_ptr = cJSON_GetErrorPtr();
    if (error_ptr != NULL)	{
//      fprintf(stderr, "Error in decode() for array_main__Commit error_ptr=: %%s\n", error_ptr);
//      printf("\nbad js=%%s\n", js.str);
		Option err = v_error(tos2(error_ptr));
      return *(Option_array_main__Commit *)&err;
    }
  }


res = __new_array(0, 0, sizeof(main__Commit));
const cJSON *jsval = NULL;
cJSON_ArrayForEach(jsval, root)
{
	main__Commit val = *(main__Commit*) json__decode_main__Commit(jsval).data; 
  array_push(&res, &val);
}

Option_array_main__Commit ret;
opt_ok2(&res, (OptionBase*)&ret, sizeof(res));
return ret;
}

static void main__App_fetch_branches(main__App* app, main__Repo r);
static void main__App_update_branches(main__App* app, main__Repo* r);
static string main__Branch_relative(main__Branch branch);
static void main__App_update_branch(main__App* app, main__Branch branch);
static void main__App_insert_branch(main__App* app, main__Branch branch);
static main__Branch main__App_find_repo_branch_by_name(main__App* app, string name, int repo_id);
static array_main__Branch main__App_find_repo_branches(main__App* app, int repo_id);
static int main__App_nr_repo_branches(main__App* app, int repo_id);
static bool main__App_contains_repo_branch(main__App* app, string name, int repo_id);
static void main__App_delete_repo_branches(main__App* app, int repo_id);
void main__App_command_fetcher(main__App* app);
static void main__App_insert_comment(main__App* app, main__Comment comment);
static array_main__Comment main__App_find_issue_comments(main__App* app, int issue_id);
static string main__Comment_relative(main__Comment comment);
static string main__Commit_relative(main__Commit commit);
static array_main__Change main__Commit_get_changes(main__Commit commit, main__Repo repo);
static void main__App_insert_commit(main__App* app, main__Commit commit);
static array_main__Commit main__App_find_repo_commits(main__App* app, int repo_id);
static array_main__Commit main__App_find_repo_commits_as_page(main__App* app, int repo_id, int page);
static int main__App_nr_repo_commits(main__App* app, int repo_id);
static main__Commit main__App_find_repo_commit_by_hash(main__App* app, int repo_id, string hash);
static main__Commit main__App_find_repo_last_commit(main__App* app, int repo_id);
static main__Commit main__App_find_repo_first_commit(main__App* app, int repo_id);
static array_main__Commit main__App_find_repo_commits_by_author(main__App* app, int repo_id, string author);
static string main__File_url(main__File f);
static string main__File_full_path(main__File* f);
static string main__File_pretty_last_time(main__File f);
static string main__File_pretty_size(main__File f);
static void main__App_insert_file(main__App* app, main__File file);
static array_main__File main__App_find_repo_files(main__App* app, int repo_id2, string branch, string parent_path);
static Option_main__File main__App_find_repo_file_by_path(main__App* app, int repo_id, string branch, string path);
static void main__App_delete_repo_files(main__App* app, int repo_id);
static void main__App_delete_repo_folder(main__App* app, string path);
static string main__GitService_to_str(main__GitService s);
static vweb__Result main__App_git_info(main__App* app);
static string main__packet_flush();
static string main__packet_write(string str);
#define _const_main__commits_per_page 35
#define _const_main__http_port 8080
#define _const_main__expire_length 200
#define _const_main__posts_per_day 5
#define _const_main__max_username_len 32
#define _const_main__max_login_attempts 5
static string _const_main__repo_storage_path; // a string literal, inited later
#define _const_main__max_user_repos 5
#define _const_main__max_repo_name_len 20
#define _const_main__max_namechanges 3
static i64 _const_main__namechange_period; // inited later
static void main__main();
void main__App_info(main__App* app, string msg);
void main__App_warn(main__App* app, string msg);
void main__App_init_once(main__App* app);
void main__App_init(main__App* app);
vweb__Result main__App_r_home(main__App* app);
vweb__Result main__App_r_repo(main__App* app);
vweb__Result main__App_settings(main__App* app);
vweb__Result main__App_repo_settings(main__App* app, string user, string repo);
static bool main__App_repo_belongs_to(main__App* app, string user, string repo);
vweb__Result main__App_update_repo_settings(main__App* app, string user, string repo);
vweb__Result main__App_repo_delete(main__App* app, string user, string repo);
vweb__Result main__App_repo_move(main__App* app, string user, string repo);
vweb__Result main__App_tree2(main__App* app, string user, string repo);
vweb__Result main__App_tree(main__App* app, string user, string repo, string branch, string path);
vweb__Result main__App_index(main__App* app);
vweb__Result main__App_update(main__App* app, string user, string repo);
vweb__Result main__App_new(main__App* app);
vweb__Result main__App_new_repo(main__App* app);
vweb__Result main__App_commits(main__App* app, string user, string repo, int page);
vweb__Result main__App_commit(main__App* app, string user, string repo, string hash);
vweb__Result main__App_issues(main__App* app, string user, string repo, string page_str);
vweb__Result main__App_issue(main__App* app, string user, string repo, string id_str);
vweb__Result main__App_pull(main__App* app, string user, string repo, string id_str);
vweb__Result main__App_pulls(main__App* app);
vweb__Result main__App_contributors(main__App* app, string user, string repo);
vweb__Result main__App_branches(main__App* app, string user, string repo);
vweb__Result main__App_releases(main__App* app, string user_str, string repo);
vweb__Result main__App_blob(main__App* app, string user, string repo, string branch, string path);
vweb__Result main__App_new_issue(main__App* app, string user, string repo);
vweb__Result main__App_add_issue(main__App* app, string user, string repo);
vweb__Result main__App_add_comment(main__App* app, string user, string repo);
static void main__App_insert_issue(main__App* app, main__Issue issue);
static Option_main__Issue main__App_find_issue_by_id(main__App* app, int issue_id);
static Option_main__Issue main__App_find_pr_by_id(main__App* app, int issue_id);
static array_main__Issue main__App_find_repo_issues_as_page(main__App* app, int repo_id, int page);
static array_main__Issue main__App_find_repo_issues(main__App* app, int repo_id);
static array_main__Issue main__App_find_repo_prs(main__App* app, int repo_id);
static array_main__Issue main__App_find_user_issues(main__App* app, int user_id);
static void main__App_delete_repo_issues(main__App* app, int repo_id);
static void main__App_inc_issue_comments(main__App* app, int id);
static string main__Issue_relative_time(main__Issue* i);
static array_main__LangStat _const_main__test_lang_stats; // inited later
vweb__RawHtml main__LangStat_pct_html(main__LangStat* l);
array_main__LangStat main__App_find_repo_lang_stats(main__App* app, int repo_id);
static array_string _const_main__ignored_folder; // inited later
vweb__Result main__App_login(main__App* app);
vweb__Result main__App_handle_login(main__App* app);
void main__App_auth_user(main__App* app, main__User user, string ip);
bool main__App_logged_in(main__App* app);
vweb__Result main__App_logout(main__App* app);
Option_main__User main__App_get_user_from_cookies(main__App* app);
vweb__Result main__App_register(main__App* app);
vweb__Result main__App_handle_register(main__App* app);
static string main__gen_uuid_v4ish();
vweb__Result main__App_oauth(main__App* app);

//Option_main__OAuthRequest json__decode_main__OAuthRequest(cJSON* root, main__OAuthRequest* res) {
Option_main__OAuthRequest json__decode_main__OAuthRequest(cJSON* root) {
  main__OAuthRequest res;
  if (!root) {
    const char *error_ptr = cJSON_GetErrorPtr();
    if (error_ptr != NULL)	{
//      fprintf(stderr, "Error in decode() for main__OAuthRequest error_ptr=: %%s\n", error_ptr);
//      printf("\nbad js=%%s\n", js.str);
		Option err = v_error(tos2(error_ptr));
      return *(Option_main__OAuthRequest *)&err;
    }
  }

 res . client_id = json__decode_string (js_get(root, "client_id"));
 res . client_secret = json__decode_string (js_get(root, "client_secret"));
 res . code = json__decode_string (js_get(root, "code"));
 res . state = json__decode_string (js_get(root, "state"));
Option_main__OAuthRequest ret;
opt_ok2(&res, (OptionBase*)&ret, sizeof(res));
return ret;
}


//Option_main__GitHubUser json__decode_main__GitHubUser(cJSON* root, main__GitHubUser* res) {
Option_main__GitHubUser json__decode_main__GitHubUser(cJSON* root) {
  main__GitHubUser res;
  if (!root) {
    const char *error_ptr = cJSON_GetErrorPtr();
    if (error_ptr != NULL)	{
//      fprintf(stderr, "Error in decode() for main__GitHubUser error_ptr=: %%s\n", error_ptr);
//      printf("\nbad js=%%s\n", js.str);
		Option err = v_error(tos2(error_ptr));
      return *(Option_main__GitHubUser *)&err;
    }
  }

 res . username = json__decode_string (js_get(root, "login"));
 res . name = json__decode_string (js_get(root, "name"));
 res . email = json__decode_string (js_get(root, "email"));
 res . avatar = json__decode_string (js_get(root, "avatar_url"));
Option_main__GitHubUser ret;
opt_ok2(&res, (OptionBase*)&ret, sizeof(res));
return ret;
}

static void main__App_get_oauth_tokens_from_db(main__App* app);
void main__App_insert_release(main__App* app, main__Release release);
array_main__Release main__App_find_repo_releases(main__App* app, int repo_id);
void main__App_delete_repo_releases(main__App* app, int repo_id);
#define _const_main__max_git_res_size 1000
static string _const_main__log_field_separator; // a string literal, inited later
static void main__App_update_repo(main__App* app);
static void main__App_update_repo_data(main__App* app, main__Repo repo);
static void main__Repo_analyse_lang(main__Repo r, sync__WaitGroup* wg, main__App* app);
static int main__calc_lines_of_code(array_string lines, hl__Lang lang);
static array_string main__Repo_get_all_files(main__Repo r, string path);
static vweb__RawHtml main__Repo_nr_commits_fmt(main__Repo* r);
static vweb__RawHtml main__Repo_nr_branches_fmt(main__Repo* r);
static vweb__RawHtml main__Repo_nr_open_prs_fmt(main__Repo* r);
static vweb__RawHtml main__Repo_nr_open_issues_fmt(main__Repo* r);
static vweb__RawHtml main__Repo_nr_contributors_fmt(main__Repo* r);
static vweb__RawHtml main__Repo_nr_topics_fmt(main__Repo* r);
static vweb__RawHtml main__Repo_nr_releases_fmt(main__Repo* r);
static string main__Repo_git(main__Repo* r, string cmd_);
static Option_main__File main__Repo_parse_ls(main__Repo* r, string ls, string branch);
static array_main__File main__App_cache_repo_files(main__App* app, main__Repo* r, string branch, string path);
static vweb__RawHtml main__Repo_html_path_to(main__Repo* r, string path, string branch);
static void main__App_slow_fetch_files_info(main__App* app, string branch, string path);
static string main__Repo_git_advertise(main__Repo r, string a);
static string main__first_line(string s);
static void main__App_fetch_file_info(main__App* app, main__Repo* r, main__File* file);
static void main__Repo_clone(main__Repo* r);
static void main__App_create_table(main__App* app, string name, array_string fields);
static void main__App_create_tables(main__App* app);
static void main__App_update_repo_in_db(main__App* app, main__Repo* repo);
static Option_main__Repo main__App_find_repo_by_name(main__App* app, int user, string name);
static int main__App_nr_user_repos(main__App* app, int user_id);
static array_main__Repo main__App_find_user_repos(main__App* app, int user_id);
static main__Repo main__App_find_repo_by_id(main__App* app, int repo_id);
static bool main__App_exists_user_repo(main__App* app, string user, string name);
static main__Repo main__App_retrieve_repo(main__App* app, int id);
static void main__App_inc_repo_views(main__App* app, int repo_id);
static void main__App_inc_file_views(main__App* app, int file_id);
static void main__App_inc_repo_issues(main__App* app, int repo_id);
static void main__App_update_repo_nr_commits(main__App* app, int repo_id, int nr_commits);
static void main__App_update_repo_webhook(main__App* app, int repo_id, string webhook);
static void main__App_update_repo_nr_contributor(main__App* app, int repo_id, int nr_contributors);
static void main__App_insert_repo(main__App* app, main__Repo repo);
static void main__App_delete_repo(main__App* app, int id, string path, string name);
static void main__App_move_repo_to_user(main__App* app, int repo_id, int user_id, string user_name);
static bool main__App_user_has_repo(main__App* app, int user_id, string repo_name);
static void main__App_security_log(main__App* app, main__SecurityLog log);
static array_main__SecurityLog main__App_find_security_logs(main__App* app, int user_id);
static vweb__Result main__App_security(main__App* app);
static void main__App_init_tags(main__App* app, main__Repo* r);
void main__App_insert_tag(main__App* app, main__Tag tag);
main__Tag main__App_find_tag_by_name(main__App* app, string name);
main__Tag main__App_find_tag_by_id(main__App* app, int id);
array_main__Tag main__App_find_repo_tags(main__App* app, int repo_id);
static string main__App_update_user_token(main__App* app, int user_id, string token, string ip);
static string main__App_find_user_token(main__App* app, int user_id, string ip);
static void main__App_clear_sessions(main__App* app, int user_id);
static string main__App_add_token(main__App* app, int user_id, string ip);
static string main__make_password(string password, string username);
static bool main__check_password(string password, string username, string hashed);
bool main__App_add_user(main__App* app, string username, string password, array_string emails, bool github);
static void main__App_create_user_dir(main__App* app, string username);
void main__App_update_user_avatar(main__App* app, string data, int id);
int main__App_create_empty_user(main__App* app, string username, string email);
void main__App_insert_user(main__App* app, main__User user);
void main__App_insert_email(main__App* app, main__Email email);
void main__App_insert_sshkey(main__App* app, main__SshKey sshkey);
void main__App_insert_contributor(main__App* app, main__Contributor contributor);
void main__App_remove_ssh_key(main__App* app, string title, int user_id);
void main__App_user_set_admin(main__App* app, int id);
void main__App_user_unset_admin(main__App* app, int id);
array_main__SshKey main__App_find_user_sshkeys(main__App* app, int id);
string main__App_find_username_by_id(main__App* app, int id);
Option_main__User main__App_find_user_by_username(main__App* app, string username);
Option_main__User main__App_find_user_by_id(main__App* app, int id2);
Option_main__User main__App_find_user_by_email(main__App* app, string email);
array_main__Email main__App_find_user_emails(main__App* app, int id2);
array_main__Contributor main__App_find_repo_contributor(main__App* app, int id);
array_main__User main__App_find_repo_registered_contributor(main__App* app, int id);
array_main__User main__App_find_registered_user(main__App* app);
int main__App_nr_repo_contributor(main__App* app, int id);
void main__App_inc_user_post(main__App* app, main__User* user);
void main__App_inc_user_login_attempts(main__App* app, int user_id);
void main__App_update_user_login_attempts(main__App* app, int user_id, int attempts);
void main__App_block_user(main__App* app, int user_id);
void main__App_unblock_user(main__App* app, int user_id);
bool main__App_check_user_blocked(main__App* app, int user_id);
Option_string main__App_client_ip(main__App* app, string username);
static void main__App_change_username(main__App* app, int user_id, string username);
static void main__App_inc_namechanges(main__App* app, int user_id);
static multi_return_bool_main__User main__App_check_username(main__App* app, string user);
vweb__Result main__App_user(main__App* app, string username);
vweb__Result main__App_user_repos(main__App* app, string username);
vweb__Result main__App_user_issues(main__App* app, string username, string page_str);
vweb__Result main__App_user_settings(main__App* app, string user);
vweb__Result main__App_update_user_settings(main__App* app, string user);
static void main__App_add_visit(main__App* app);

// V gowrappers:
void* sync__process_in_thread_thread_wrapper(thread_arg_sync__process_in_thread *arg) {
	sync__process_in_thread(arg->arg1, arg->arg2);
	return 0;
}

cJSON* json__encode_main__Issue(main__Issue val) {
	cJSON *o = cJSON_CreateObject();
	cJSON_AddItemToObject(o, "id", json__encode_int(val.id));
	cJSON_AddItemToObject(o, "author_id", json__encode_int(val.author_id));
	cJSON_AddItemToObject(o, "repo_id", json__encode_int(val.repo_id));
	cJSON_AddItemToObject(o, "is_pr", json__encode_bool(val.is_pr));
	cJSON_AddItemToObject(o, "nr_comments", json__encode_int(val.nr_comments));
	cJSON_AddItemToObject(o, "title", json__encode_string(val.title));
	cJSON_AddItemToObject(o, "text", json__encode_string(val.text));
	cJSON_AddItemToObject(o, "created_at", json__encode_int(val.created_at));
	return o;
}


cJSON* json__encode_array_main__Issue(array_main__Issue val) {
	cJSON *o = cJSON_CreateObject();

o = cJSON_CreateArray();
for (int i = 0; i < val.len; i++){
  cJSON_AddItemToArray(o, json__encode_main__Issue (  ((main__Issue*)val.data)[i]  ));
}

	return o;
}


cJSON* json__encode_main__Commit(main__Commit val) {
	cJSON *o = cJSON_CreateObject();
	cJSON_AddItemToObject(o, "id", json__encode_int(val.id));
	cJSON_AddItemToObject(o, "author_id", json__encode_int(val.author_id));
	cJSON_AddItemToObject(o, "author", json__encode_string(val.author));
	cJSON_AddItemToObject(o, "hash", json__encode_string(val.hash));
	cJSON_AddItemToObject(o, "created_at", json__encode_int(val.created_at));
	cJSON_AddItemToObject(o, "repo_id", json__encode_int(val.repo_id));
	cJSON_AddItemToObject(o, "message", json__encode_string(val.message));
	return o;
}


cJSON* json__encode_array_main__Commit(array_main__Commit val) {
	cJSON *o = cJSON_CreateObject();

o = cJSON_CreateArray();
for (int i = 0; i < val.len; i++){
  cJSON_AddItemToArray(o, json__encode_main__Commit (  ((main__Commit*)val.data)[i]  ));
}

	return o;
}

void* main__App_command_fetcher_thread_wrapper(thread_arg_main__App_command_fetcher *arg) {
	main__App_command_fetcher(arg->arg0);
	return 0;
}
void* main__App_delete_repo_thread_wrapper(thread_arg_main__App_delete_repo *arg) {
	main__App_delete_repo(arg->arg0, arg->arg1, arg->arg2, arg->arg3);
	return 0;
}
void* main__App_slow_fetch_files_info_thread_wrapper(thread_arg_main__App_slow_fetch_files_info *arg) {
	main__App_slow_fetch_files_info(arg->arg0, arg->arg1, arg->arg2);
	return 0;
}
void* main__App_update_repo_data_thread_wrapper(thread_arg_main__App_update_repo_data *arg) {
	main__App_update_repo_data(arg->arg0, arg->arg1);
	return 0;
}
void* main__App_update_repo_thread_wrapper(thread_arg_main__App_update_repo *arg) {
	main__App_update_repo(arg->arg0);
	return 0;
}

cJSON* json__encode_main__OAuthRequest(main__OAuthRequest val) {
	cJSON *o = cJSON_CreateObject();
	cJSON_AddItemToObject(o, "client_id", json__encode_string(val.client_id));
	cJSON_AddItemToObject(o, "client_secret", json__encode_string(val.client_secret));
	cJSON_AddItemToObject(o, "code", json__encode_string(val.code));
	cJSON_AddItemToObject(o, "state", json__encode_string(val.state));
	return o;
}


cJSON* json__encode_main__GitHubUser(main__GitHubUser val) {
	cJSON *o = cJSON_CreateObject();
	cJSON_AddItemToObject(o, "login", json__encode_string(val.username));
	cJSON_AddItemToObject(o, "name", json__encode_string(val.name));
	cJSON_AddItemToObject(o, "email", json__encode_string(val.email));
	cJSON_AddItemToObject(o, "avatar_url", json__encode_string(val.avatar));
	return o;
}

void* main__Repo_analyse_lang_thread_wrapper(thread_arg_main__Repo_analyse_lang *arg) {
	main__Repo_analyse_lang(arg->arg0, arg->arg1, arg->arg2);
	return 0;
}

// V hotcode definitions:
typedef struct {
			int  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_int;
typedef struct {
			voidptr  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_voidptr;
typedef struct {
			array_byte  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_array_byte;
typedef struct {
			string  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_string;
typedef struct {
			void*  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_void;
typedef struct {
			array_string  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_array_string;
typedef struct {
			bool  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_bool;
typedef struct {
			array_ustring  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_array_ustring;
typedef struct {
			os__File  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_os__File;
typedef struct {
			os__Result  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_os__Result;
typedef struct {
			time__Time  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_time__Time;
typedef struct {
			hl__Lang  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_hl__Lang;
typedef struct {
			sqlite__DB  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_sqlite__DB;
typedef struct {
			sqlite__Row  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_sqlite__Row;
typedef struct {
			net__urllib__URL  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_net__urllib__URL;
typedef struct {
			net__urllib__ParseAuthorityRes  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_net__urllib__ParseAuthorityRes;
typedef struct {
			net__urllib__Values  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_net__urllib__Values;
typedef struct {
			net__Socket  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_net__Socket;
typedef struct {
			net__http__Response  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_net__http__Response;
typedef struct {
			net__http__Request  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_net__http__Request;
typedef struct {
			array_main__Issue  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_array_main__Issue;
typedef struct {
			main__Issue  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_main__Issue;
typedef struct {
			array_main__Commit  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_array_main__Commit;
typedef struct {
			main__Commit  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_main__Commit;
typedef struct {
			main__User  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_main__User;
typedef struct {
			main__File  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_main__File;
typedef struct {
			main__Repo  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_main__Repo;
typedef struct {
			main__OAuthRequest  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_main__OAuthRequest;
typedef struct {
			main__GitHubUser  data;
			string error;
			int    ecode;
			bool   ok;
			bool   is_none;
		} Option2_main__GitHubUser;

// V stringliterals:

// >> string literal consts
void vinit_string_literals(){
	_const_math__bits__overflow_error = tos_lit("Overflow Error");
	_const_math__bits__divide_error = tos_lit("Divide Error");
	_const_new_line_character = tos_lit("\n");
	_const_digit_pairs = tos_lit("00102030405060708090011121314151617181910212223242526272829203132333435363738393041424344454647484940515253545556575859506162636465666768696071727374757677787970818283848586878889809192939495969798999");
	_const_os__path_separator = tos_lit("/");
	_const_os__path_delimiter = tos_lit(":");
	_const_time__days_string = tos_lit("MonTueWedThuFriSatSun");
	_const_time__months_string = tos_lit("JanFebMarAprMayJunJulAugSepOctNovDec");
	_const_hl__tab = tos_lit("        ");
	_const_hl__lang_path = tos_lit("langs");
	_const_net__urllib__err_msg_escape = tos_lit("unescape: invalid URL escape");
	_const_net__urllib__err_msg_parse = tos_lit("parse: failed parsing url");
	_const_net__crlf = tos_lit("\r\n");
	_const_net__http__content_type_default = tos_lit("text/plain");
	_const_vweb__header_server = tos_lit("Server: VWeb\r\n");
	_const_vweb__header_connection_close = tos_lit("Connection: close\r\n");
	_const_rand__chars = tos_lit("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");
	_const_main__repo_storage_path = tos_lit("./repos");
	_const_main__log_field_separator = tos_lit("\x7F");
}
// << string literal consts


// V auto str functions:
string strings__Builder_str_no_ptr(strings__Builder it){ return strings__Builder_str(&it); }
string time__FormatTime_str(time__FormatTime it) { /* gen_str_for_enum */
	switch(it) {
		case time__FormatTime_hhmm12: return tos_lit("hhmm12");
		case time__FormatTime_hhmm24: return tos_lit("hhmm24");
		case time__FormatTime_hhmmss12: return tos_lit("hhmmss12");
		case time__FormatTime_hhmmss24: return tos_lit("hhmmss24");
		case time__FormatTime_no_time: return tos_lit("no_time");
		default: return tos_lit("unknown enum value");
	}
}
string time__FormatDate_str(time__FormatDate it) { /* gen_str_for_enum */
	switch(it) {
		case time__FormatDate_ddmmyy: return tos_lit("ddmmyy");
		case time__FormatDate_ddmmyyyy: return tos_lit("ddmmyyyy");
		case time__FormatDate_mmddyy: return tos_lit("mmddyy");
		case time__FormatDate_mmddyyyy: return tos_lit("mmddyyyy");
		case time__FormatDate_mmmd: return tos_lit("mmmd");
		case time__FormatDate_mmmdd: return tos_lit("mmmdd");
		case time__FormatDate_mmmddyyyy: return tos_lit("mmmddyyyy");
		case time__FormatDate_no_date: return tos_lit("no_date");
		case time__FormatDate_yyyymmdd: return tos_lit("yyyymmdd");
		default: return tos_lit("unknown enum value");
	}
}
string map_string_string_str(map_string_string m) { /* gen_str_for_map */
	strings__Builder sb = strings__new_builder(m.key_values.len*10);
	strings__Builder_write(&sb, tos_lit("{"));
	for (unsigned int i = 0; i < m.key_values.len; ++i) {
		string key = (*(string*)DenseArray_get(m.key_values, i));
		strings__Builder_write(&sb, _STR("'%.*s\000'", 2, key));
		strings__Builder_write(&sb, tos_lit(": "));
	string it = (*(string*)map_get(m, (*(string*)DenseArray_get(m.key_values, i)),  &(string[]) { (string){.str=(byteptr)""} }));
		strings__Builder_write(&sb, _STR("'%.*s\000'", 2, it));
		if (i != m.key_values.len-1) {
			strings__Builder_write(&sb, tos_lit(", "));
		}
	}
	strings__Builder_write(&sb, tos_lit("}"));
	return strings__Builder_str(&sb);
}
string main__GitService_str(main__GitService it) { /* gen_str_for_enum */
	switch(it) {
		case main__GitService_receive: return tos_lit("receive");
		case main__GitService_upload: return tos_lit("upload");
		case main__GitService_unknown: return tos_lit("unknown");
		default: return tos_lit("unknown enum value");
	}
}
string main__GitHubUser_str(main__GitHubUser x) { return indent_main__GitHubUser_str(x,0);}
string indent_main__GitHubUser_str(main__GitHubUser x, int indent_count) {
	main__GitHubUser *it = &x;
	string indents = tos_lit("");
	for (int i = 0; i < indent_count; ++i) {
		indents = string_add(indents, tos_lit("    "));
	}
	return _STR("GitHubUser {\n"
		"%.*s\000    username: '%.*s\000'\n"
		"%.*s\000    name: '%.*s\000'\n"
		"%.*s\000    email: '%.*s\000'\n"
		"%.*s\000    avatar: '%.*s\000'\n"
		"%.*s\000}", 10,
		indents, it->username,
		indents, it->name,
		indents, it->email,
		indents, it->avatar,
		indents);
}
string main__SecurityLogKind_str(main__SecurityLogKind it) { /* gen_str_for_enum */
	switch(it) {
		case main__SecurityLogKind_registered: return tos_lit("registered");
		case main__SecurityLogKind_logged_in: return tos_lit("logged_in");
		case main__SecurityLogKind_registered_via_github: return tos_lit("registered_via_github");
		case main__SecurityLogKind_logged_in_via_github: return tos_lit("logged_in_via_github");
		case main__SecurityLogKind_wrong_password: return tos_lit("wrong_password");
		case main__SecurityLogKind_wrong_oauth_state: return tos_lit("wrong_oauth_state");
		case main__SecurityLogKind_empty_oauth_code: return tos_lit("empty_oauth_code");
		case main__SecurityLogKind_empty_oauth_email: return tos_lit("empty_oauth_email");
		default: return tos_lit("unknown enum value");
	}
}
string main__SecurityLog_str(main__SecurityLog x) { return indent_main__SecurityLog_str(x,0);}
string indent_main__SecurityLog_str(main__SecurityLog x, int indent_count) {
	main__SecurityLog *it = &x;
	string indents = tos_lit("");
	for (int i = 0; i < indent_count; ++i) {
		indents = string_add(indents, tos_lit("    "));
	}
	return _STR("SecurityLog {\n"
		"%.*s\000    id: %d\000\n"
		"%.*s\000    user_id: %d\000\n"
		"%.*s\000    kind: %.*s\000\n"
		"%.*s\000    ip: '%.*s\000'\n"
		"%.*s\000    arg1: '%.*s\000'\n"
		"%.*s\000    arg2: '%.*s\000'\n"
		"%.*s\000    created_at: %d\000\n"
		"%.*s\000}", 16,
		indents, it->id,
		indents, it->user_id,
		indents, main__SecurityLogKind_str( it->kind ) ,
		indents, it->ip,
		indents, it->arg1,
		indents, it->arg2,
		indents, it->created_at,
		indents);
}

// V out

// >> typeof() support for sum types
// << typeof() support for sum types


void _STR_PRINT_ARG(const char *fmt, char** refbufp, int *nbytes, int *memsize, int guess, ...) {
	va_list args;
	va_start(args, guess);
	// NB: (*memsize - *nbytes) === how much free space is left at the end of the current buffer refbufp
	// *memsize === total length of the buffer refbufp
	// *nbytes === already occupied bytes of buffer refbufp
	// guess === how many bytes were taken during the current vsnprintf run
	for(;;) {
		if (guess < *memsize - *nbytes) {
			guess = vsnprintf(*refbufp + *nbytes, *memsize - *nbytes, fmt, args);
			if (guess < *memsize - *nbytes) { // result did fit into buffer
				*nbytes += guess;
				break;
			}
		}
		// increase buffer (somewhat exponentially)
		*memsize += (*memsize + *memsize) / 3 + guess;
		*refbufp = (char*)realloc((void*)*refbufp, *memsize);
	}
	va_end(args);
}

string _STR(const char *fmt, int nfmts, ...) {
	va_list argptr;
	int memsize = 128;
	int nbytes = 0;
	char* buf = (char*)malloc(memsize);
	va_start(argptr, nfmts);
	for (int i=0; i<nfmts; ++i) {
		int k = strlen(fmt);
		bool is_fspec = false;
		for (int j=0; j<k; ++j) {
			if (fmt[j] == '%') {
				j++;
				if (fmt[j] != '%') {
					is_fspec = true;
					break;
				}
			}
		}
		if (is_fspec) {
			char f = fmt[k-1];
			char fup = f & 0xdf; // toupper
			bool l = fmt[k-2] == 'l';
			bool ll = l && fmt[k-3] == 'l';
			if (f == 'u' || fup == 'X' || f == 'o' || f == 'd' || f == 'c') { // int...
				if (ll) _STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k+16, va_arg(argptr, long long));
				else if (l) _STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k+10, va_arg(argptr, long));
				else _STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k+8, va_arg(argptr, int));
			} else if (fup >= 'E' && fup <= 'G') { // floating point
				_STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k+10, va_arg(argptr, double));
			} else if (f == 'p') {
				_STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k+14, va_arg(argptr, void*));
			} else if (f == 's') { // v string
				string s = va_arg(argptr, string);
				if (fmt[k-4] == '*') { // %*.*s
					int fwidth = va_arg(argptr, int);
					if (fwidth < 0)
						fwidth -= (s.len - utf8_str_visible_length(s));
					else
						fwidth += (s.len - utf8_str_visible_length(s));
					_STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k+s.len-4, fwidth, s.len, s.str);
				} else { // %.*s
					_STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k+s.len-4, s.len, s.str);
				}
			} else {
				//v_panic(tos3('Invaid format specifier'));
			}
		} else {
			_STR_PRINT_ARG(fmt, &buf, &nbytes, &memsize, k);
		}
		fmt += k+1;
	}
	va_end(argptr);
	buf[nbytes] = 0;
	buf = (char*)realloc((void*)buf, nbytes+1);
#ifdef DEBUG_ALLOC
	//puts('_STR:');
	puts(buf);
#endif
#if _VAUTOFREE
	//g_cur_str = (byteptr)buf;
#endif
	return tos2((byteptr)buf);
}

string _STR_TMP(const char *fmt, ...) {
	va_list argptr;
	va_start(argptr, fmt);
	size_t len = vsnprintf(0, 0, fmt, argptr) + 1;
	va_end(argptr);
	va_start(argptr, fmt);
	vsprintf((char *)g_str_buf, fmt, argptr);
	va_end(argptr);

#ifdef DEBUG_ALLOC
	//puts('_STR_TMP:');
	//puts(g_str_buf);
#endif
	string res = tos(g_str_buf,  len);
	res.is_lit = 1;
	return res;

} // endof _STR_TMP


strings__Builder strings__new_builder(int initial_size) {
	return (strings__Builder){.buf = __new_array_with_default(0, initial_size, sizeof(byte), 0),.str_calls = 0,.len = 0,.initial_size = initial_size,};
}

void strings__Builder_write_bytes(strings__Builder* b, byteptr bytes, int howmany) {
	array_push_many(&b->buf, bytes, howmany);
	b->len += howmany;
}

void strings__Builder_write_b(strings__Builder* b, byte data) {
	array_push(&b->buf, _MOV((byte[]){ data }));
	b->len++;
}

// Attr: [inline]
inline void strings__Builder_write(strings__Builder* b, string s) {
	if (string_eq(s, tos_lit(""))) {
		return;
	}
	array_push_many(&b->buf, s.str, s.len);
	b->len += s.len;
}

void strings__Builder_go_back(strings__Builder* b, int n) {
	array_trim(&b->buf, b->buf.len - n);
	b->len -= n;
}

static string strings__bytes2string(array_byte b) {
	array_byte copy = array_clone(&b);
	array_push(&copy, _MOV((byte[]){ '\0' }));
	string res = tos(copy.data, copy.len - 1);
	return res;
}

string strings__Builder_cut_last(strings__Builder* b, int n) {
	string res = strings__bytes2string(array_slice(b->buf, b->len - n, b->buf.len));
	array_trim(&b->buf, b->buf.len - n);
	b->len -= n;
	return res;
}

void strings__Builder_go_back_to(strings__Builder* b, int pos) {
	array_trim(&b->buf, pos);
	b->len = pos;
}

// Attr: [inline]
inline void strings__Builder_writeln(strings__Builder* b, string s) {
	array_push_many(&b->buf, s.str, s.len);
	array_push(&b->buf, _MOV((byte[]){ '\n' }));
	b->len += s.len + 1;
}

string strings__Builder_last_n(strings__Builder* b, int n) {
	if (n > b->len) {
		return tos_lit("");
	}
	return strings__bytes2string(array_slice(b->buf, b->len - n, b->buf.len));
}

string strings__Builder_after(strings__Builder* b, int n) {
	if (n >= b->len) {
		return tos_lit("");
	}
	return strings__bytes2string(array_slice(b->buf, n, b->buf.len));
}

string strings__Builder_str(strings__Builder* b) {
	b->str_calls++;
	if (b->str_calls > 1) {
		v_panic(string_add(tos_lit("builder.str() should be called just once.\n"), tos_lit("If you want to reuse a builder, call b.free() first.")));
	}
	array_push(&b->buf, _MOV((byte[]){ '\0' }));
	string s = tos((byteptr)b->buf.data, b->len);
	int bis = b->initial_size;
	b->buf = __new_array_with_default(0, bis, sizeof(byte), 0);
	b->len = 0;
	return s;
}

void strings__Builder_free(strings__Builder* b) {
	{ // Unsafe block
		v_free(b->buf.data);
	}
	b->len = 0;
	b->str_calls = 0;
}

int strings__levenshtein_distance(string a, string b) {
	array_int f = array_repeat(new_array_from_c_array(1, 1, sizeof(int), _MOV((int[1]){0})), b.len + 1);
	for (int j = 0; j < f.len; ++j) {
		array_set(&f, j, &(int[]) { j });
	}
	for (int _t5 = 0; _t5 < a.len; ++_t5) {
		byte ca = a.str[_t5];
		int j = 1;
		int fj1 = (*(int*)array_get(f, 0));
		(*(int*)array_get(f, 0))++;
		for (int _t6 = 0; _t6 < b.len; ++_t6) {
			byte cb = b.str[_t6];
			int mn = ((*(int*)array_get(f, j)) + 1 <= (*(int*)array_get(f, j - 1)) + 1 ? ((*(int*)array_get(f, j)) + 1) : ((*(int*)array_get(f, j - 1)) + 1));
			if (cb != ca) {
				mn = (mn <= fj1 + 1 ? (mn) : (fj1 + 1));
			} else {
				mn = (mn <= fj1 ? (mn) : (fj1));
			}
			fj1 = (*(int*)array_get(f, j));
			array_set(&f, j, &(int[]) { mn });
			j++;
		}
	}
	return (*(int*)array_get(f, f.len - 1));
}

f32 strings__levenshtein_distance_percentage(string a, string b) {
	int d = strings__levenshtein_distance(a, b);
	int l = (a.len >= b.len ? (a.len) : (b.len));
	return (1.00 - ((f32)(d)) / ((f32)(l))) * 100.00;
}

f32 strings__dice_coefficient(string s1, string s2) {
	if (s1.len == 0 || s2.len == 0) {
		return 0.0;
	}
	if (string_eq(s1, s2)) {
		return 1.0;
	}
	if (s1.len < 2 || s2.len < 2) {
		return 0.0;
	}
	string a = (s1.len > s2.len ? (s1) : (s2));
	string b = (string_eq(a, s1) ? (s2) : (s1));
	map_string_int first_bigrams = new_map_1(sizeof(int));
	for (int i = 0; i < a.len - 1; ++i) {
		string bigram = string_substr(a, i, i + 2);
		int q = (_IN_MAP(bigram, first_bigrams) ? ((*(int*)map_get(first_bigrams, bigram, &(int[]){ 0 })) + 1) : (1));
		map_set(&first_bigrams, bigram, &(int[]) { q });
	}
	int intersection_size = 0;
	for (int i = 0; i < b.len - 1; ++i) {
		string bigram = string_substr(b, i, i + 2);
		int count = (_IN_MAP(bigram, first_bigrams) ? ((*(int*)map_get(first_bigrams, bigram, &(int[]){ 0 }))) : (0));
		if (count > 0) {
			map_set(&first_bigrams, bigram, &(int[]) { count - 1 });
			intersection_size++;
		}
	}
	return (2.0 * ((f32)(intersection_size))) / (((f32)(a.len)) + ((f32)(b.len)) - 2);
}

string strings__repeat(byte c, int n) {
	if (n <= 0) {
		return tos_lit("");
	}
	byteptr bytes = v_malloc(n + 1);
	{ // Unsafe block
		memset(bytes, c, n);
		bytes[n] = '0';
	}
	return tos((byteptr)bytes, n);
}

string strings__repeat_string(string s, int n) {
	if (n <= 0 || s.len == 0) {
		return tos_lit("");
	}
	int slen = s.len;
	int blen = slen * n;
	byteptr bytes = v_malloc(blen + 1);
	for (int bi = 0; bi < n; ++bi) {
		int bislen = bi * slen;
		for (int si = 0; si < slen; ++si) {
			{ // Unsafe block
				bytes[bislen + si] = string_at(s, si);
			}
		}
	}
	{ // Unsafe block
		bytes[blen] = '0';
	}
	return tos((byteptr)bytes, blen);
}

// Attr: [inline]
inline u64 hash__wyhash_c(byteptr key, u64 len, u64 seed) {
	return wyhash(key, len, seed);
}

// Attr: [inline]
inline u64 hash__sum64_string(string key, u64 seed) {
	return hash__wyhash64(key.str, ((u64)(key.len)), seed);
}

// Attr: [inline]
inline u64 hash__sum64(array_byte key, u64 seed) {
	return hash__wyhash64(((byteptr)(key.data)), ((u64)(key.len)), seed);
}

// Attr: [inline]
inline static u64 hash__wyhash64(byteptr key, u64 len, u64 seed_) {
	if (len == 0) {
		return 0;
	}
	byteptr p = key;
	u64 seed = seed_;
	u64 i = (len & 63);
	{ // Unsafe block
		if (i < 4) {
			seed = hash__wymum(((hash__wyr3(p, i) ^ seed) ^ _const_hash__wyp0), (seed ^ _const_hash__wyp1));
		} else if (i <= 8) {
			seed = hash__wymum(((hash__wyr4(p) ^ seed) ^ _const_hash__wyp0), ((hash__wyr4(p + i - 4) ^ seed) ^ _const_hash__wyp1));
		} else if (i <= 16) {
			seed = hash__wymum(((hash__wyr8(p) ^ seed) ^ _const_hash__wyp0), ((hash__wyr8(p + i - 8) ^ seed) ^ _const_hash__wyp1));
		} else if (i <= 24) {
			seed = (hash__wymum(((hash__wyr8(p) ^ seed) ^ _const_hash__wyp0), ((hash__wyr8(p + 8) ^ seed) ^ _const_hash__wyp1)) ^ hash__wymum(((hash__wyr8(p + i - 8) ^ seed) ^ _const_hash__wyp2), (seed ^ _const_hash__wyp3)));
		} else if (i <= 32) {
			seed = (hash__wymum(((hash__wyr8(p) ^ seed) ^ _const_hash__wyp0), ((hash__wyr8(p + 8) ^ seed) ^ _const_hash__wyp1)) ^ hash__wymum(((hash__wyr8(p + 16) ^ seed) ^ _const_hash__wyp2), ((hash__wyr8(p + i - 8) ^ seed) ^ _const_hash__wyp3)));
		} else {
			seed = (((hash__wymum(((hash__wyr8(p) ^ seed) ^ _const_hash__wyp0), ((hash__wyr8(p + 8) ^ seed) ^ _const_hash__wyp1)) ^ hash__wymum(((hash__wyr8(p + 16) ^ seed) ^ _const_hash__wyp2), ((hash__wyr8(p + 24) ^ seed) ^ _const_hash__wyp3))) ^ hash__wymum(((hash__wyr8(p + i - 32) ^ seed) ^ _const_hash__wyp1), ((hash__wyr8(p + i - 24) ^ seed) ^ _const_hash__wyp2))) ^ hash__wymum(((hash__wyr8(p + i - 16) ^ seed) ^ _const_hash__wyp3), ((hash__wyr8(p + i - 8) ^ seed) ^ _const_hash__wyp0)));
		}
	}
	if (i == len) {
		return hash__wymum(seed, (len ^ _const_hash__wyp4));
	}
	u64 see1 = seed;
	u64 see2 = seed;
	u64 see3 = seed;
	{ // Unsafe block
		p = p + i;
		for (i = len - i; i >= 64; i -= 64) {
			seed = hash__wymum(((hash__wyr8(p) ^ seed) ^ _const_hash__wyp0), ((hash__wyr8(p + 8) ^ seed) ^ _const_hash__wyp1));
			see1 = hash__wymum(((hash__wyr8(p + 16) ^ see1) ^ _const_hash__wyp2), ((hash__wyr8(p + 24) ^ see1) ^ _const_hash__wyp3));
			see2 = hash__wymum(((hash__wyr8(p + 32) ^ see2) ^ _const_hash__wyp1), ((hash__wyr8(p + 40) ^ see2) ^ _const_hash__wyp2));
			see3 = hash__wymum(((hash__wyr8(p + 48) ^ see3) ^ _const_hash__wyp3), ((hash__wyr8(p + 56) ^ see3) ^ _const_hash__wyp0));
			p = p + 64;
		}
	}
	return hash__wymum(((seed ^ see1) ^ see2), ((see3 ^ len) ^ _const_hash__wyp4));
}

// Attr: [inline]
inline static u64 hash__wyrotr(u64 v, u32 k) {
	return ((v >> k) | (v << (64 - k)));
}

// Attr: [inline]
inline u64 hash__wymum(u64 a, u64 b) {
	u32 mask32 = ((u32)(4294967295));
	u64 x0 = (a & mask32);
	u64 x1 = a >> 32;
	u64 y0 = (b & mask32);
	u64 y1 = b >> 32;
	u64 w0 = x0 * y0;
	u64 t = x1 * y0 + (w0 >> 32);
	u64 w1 = (t & mask32);
	u64 w2 = t >> 32;
	w1 += x0 * y1;
	u64 hi = x1 * y1 + w2 + (w1 >> 32);
	u64 lo = a * b;
	return (hi ^ lo);
}

// Attr: [inline]
inline static u64 hash__wyr3(byteptr p, u64 k) {
	{ // Unsafe block
		return (((((u64)(p[0])) << 16) | (((u64)(p[k >> 1])) << 8)) | ((u64)(p[k - 1])));
	}
}

// Attr: [inline]
inline static u64 hash__wyr4(byteptr p) {
	{ // Unsafe block
		return (((((u32)(p[0])) | (((u32)(p[1])) << ((u32)(8)))) | (((u32)(p[2])) << ((u32)(16)))) | (((u32)(p[3])) << ((u32)(24))));
	}
}

// Attr: [inline]
inline static u64 hash__wyr8(byteptr p) {
	{ // Unsafe block
		return (((((((((u64)(p[0])) | (((u64)(p[1])) << 8)) | (((u64)(p[2])) << 16)) | (((u64)(p[3])) << 24)) | (((u64)(p[4])) << 32)) | (((u64)(p[5])) << 40)) | (((u64)(p[6])) << 48)) | (((u64)(p[7])) << 56));
	}
}

int math__bits__leading_zeros_8(byte x) {
	return 8 - math__bits__len_8(x);
}

int math__bits__leading_zeros_16(u16 x) {
	return 16 - math__bits__len_16(x);
}

int math__bits__leading_zeros_32(u32 x) {
	return 32 - math__bits__len_32(x);
}

int math__bits__leading_zeros_64(u64 x) {
	return 64 - math__bits__len_64(x);
}

int math__bits__trailing_zeros_8(byte x) {
	return ((int)((*(byte*)array_get(_const_math__bits__ntz_8_tab, x))));
}

int math__bits__trailing_zeros_16(u16 x) {
	if (x == 0) {
		return 16;
	}
	return ((int)((*(byte*)array_get(_const_math__bits__de_bruijn32tab, ((u32)((x & -x))) * _const_math__bits__de_bruijn32 >> (32 - 5)))));
}

int math__bits__trailing_zeros_32(u32 x) {
	if (x == 0) {
		return 32;
	}
	return ((int)((*(byte*)array_get(_const_math__bits__de_bruijn32tab, ((x & -x)) * _const_math__bits__de_bruijn32 >> (32 - 5)))));
}

int math__bits__trailing_zeros_64(u64 x) {
	if (x == 0) {
		return 64;
	}
	return ((int)((*(byte*)array_get(_const_math__bits__de_bruijn64tab, ((x & -x)) * _const_math__bits__de_bruijn64 >> (64 - 6)))));
}

int math__bits__ones_count_8(byte x) {
	return ((int)((*(byte*)array_get(_const_math__bits__pop_8_tab, x))));
}

int math__bits__ones_count_16(u16 x) {
	return ((int)((*(byte*)array_get(_const_math__bits__pop_8_tab, x >> 8)) + (*(byte*)array_get(_const_math__bits__pop_8_tab, (x & ((u16)(0xff)))))));
}

int math__bits__ones_count_32(u32 x) {
	return ((int)((*(byte*)array_get(_const_math__bits__pop_8_tab, x >> 24)) + (*(byte*)array_get(_const_math__bits__pop_8_tab, (x >> 16 & 0xff))) + (*(byte*)array_get(_const_math__bits__pop_8_tab, (x >> 8 & 0xff))) + (*(byte*)array_get(_const_math__bits__pop_8_tab, (x & ((u32)(0xff)))))));
}

int math__bits__ones_count_64(u64 x) {
	u64 y = ((x >> ((u64)(1)) & ((_const_math__bits__m0 & _const_math__bits__max_u64)))) + ((x & ((_const_math__bits__m0 & _const_math__bits__max_u64))));
	y = ((y >> ((u64)(2)) & ((_const_math__bits__m1 & _const_math__bits__max_u64)))) + ((y & ((_const_math__bits__m1 & _const_math__bits__max_u64))));
	y = (((y >> 4) + y) & ((_const_math__bits__m2 & _const_math__bits__max_u64)));
	y += y >> 8;
	y += y >> 16;
	y += y >> 32;
	return (((int)(y)) & ((1 << 7) - 1));
}

// Attr: [inline]
inline byte math__bits__rotate_left_8(byte x, int k) {
	byte n = ((byte)(8));
	byte s = (((byte)(k)) & (n - ((byte)(1))));
	return (((x << s) | (x >> (n - s))));
}

// Attr: [inline]
inline u16 math__bits__rotate_left_16(u16 x, int k) {
	u16 n = ((u16)(16));
	u16 s = (((u16)(k)) & (n - ((u16)(1))));
	return (((x << s) | (x >> (n - s))));
}

// Attr: [inline]
inline u32 math__bits__rotate_left_32(u32 x, int k) {
	u32 n = ((u32)(32));
	u32 s = (((u32)(k)) & (n - ((u32)(1))));
	return (((x << s) | (x >> (n - s))));
}

// Attr: [inline]
inline u64 math__bits__rotate_left_64(u64 x, int k) {
	u64 n = ((u64)(64));
	u64 s = (((u64)(k)) & (n - ((u64)(1))));
	return (((x << s) | (x >> (n - s))));
}

// Attr: [inline]
inline byte math__bits__reverse_8(byte x) {
	return (*(byte*)array_get(_const_math__bits__rev_8_tab, x));
}

// Attr: [inline]
inline u16 math__bits__reverse_16(u16 x) {
	return (((u16)((*(byte*)array_get(_const_math__bits__rev_8_tab, x >> 8)))) | (((u16)((*(byte*)array_get(_const_math__bits__rev_8_tab, (x & ((u16)(0xff))))))) << 8));
}

// Attr: [inline]
inline u32 math__bits__reverse_32(u32 x) {
	u64 y = ((((x >> ((u32)(1)) & ((_const_math__bits__m0 & _const_math__bits__max_u32)))) | (((x & ((_const_math__bits__m0 & _const_math__bits__max_u32)))) << 1)));
	y = ((((y >> ((u32)(2)) & ((_const_math__bits__m1 & _const_math__bits__max_u32)))) | (((y & ((_const_math__bits__m1 & _const_math__bits__max_u32)))) << ((u32)(2)))));
	y = ((((y >> ((u32)(4)) & ((_const_math__bits__m2 & _const_math__bits__max_u32)))) | (((y & ((_const_math__bits__m2 & _const_math__bits__max_u32)))) << ((u32)(4)))));
	return math__bits__reverse_bytes_32(((u32)(y)));
}

// Attr: [inline]
inline u64 math__bits__reverse_64(u64 x) {
	u64 y = ((((x >> ((u64)(1)) & ((_const_math__bits__m0 & _const_math__bits__max_u64)))) | (((x & ((_const_math__bits__m0 & _const_math__bits__max_u64)))) << 1)));
	y = ((((y >> ((u64)(2)) & ((_const_math__bits__m1 & _const_math__bits__max_u64)))) | (((y & ((_const_math__bits__m1 & _const_math__bits__max_u64)))) << 2)));
	y = ((((y >> ((u64)(4)) & ((_const_math__bits__m2 & _const_math__bits__max_u64)))) | (((y & ((_const_math__bits__m2 & _const_math__bits__max_u64)))) << 4)));
	return math__bits__reverse_bytes_64(y);
}

// Attr: [inline]
inline u16 math__bits__reverse_bytes_16(u16 x) {
	return ((x >> 8) | (x << 8));
}

// Attr: [inline]
inline u32 math__bits__reverse_bytes_32(u32 x) {
	u64 y = ((((x >> ((u32)(8)) & ((_const_math__bits__m3 & _const_math__bits__max_u32)))) | (((x & ((_const_math__bits__m3 & _const_math__bits__max_u32)))) << ((u32)(8)))));
	return ((u32)(((y >> 16) | (y << 16))));
}

// Attr: [inline]
inline u64 math__bits__reverse_bytes_64(u64 x) {
	u64 y = ((((x >> ((u64)(8)) & ((_const_math__bits__m3 & _const_math__bits__max_u64)))) | (((x & ((_const_math__bits__m3 & _const_math__bits__max_u64)))) << ((u64)(8)))));
	y = ((((y >> ((u64)(16)) & ((_const_math__bits__m4 & _const_math__bits__max_u64)))) | (((y & ((_const_math__bits__m4 & _const_math__bits__max_u64)))) << ((u64)(16)))));
	return ((y >> 32) | (y << 32));
}

int math__bits__len_8(byte x) {
	return ((int)((*(byte*)array_get(_const_math__bits__len_8_tab, x))));
}

int math__bits__len_16(u16 x) {
	u16 y = x;
	int n = 0;
	if (y >= 1 << 8) {
		y >>= 8;
		n = 8;
	}
	return n + ((int)((*(byte*)array_get(_const_math__bits__len_8_tab, y))));
}

int math__bits__len_32(u32 x) {
	u32 y = x;
	int n = 0;
	if (y >= (1 << 16)) {
		y >>= 16;
		n = 16;
	}
	if (y >= (1 << 8)) {
		y >>= 8;
		n += 8;
	}
	return n + ((int)((*(byte*)array_get(_const_math__bits__len_8_tab, y))));
}

int math__bits__len_64(u64 x) {
	u64 y = x;
	int n = 0;
	if (y >= ((u64)(1)) << ((u64)(32))) {
		y >>= 32;
		n = 32;
	}
	if (y >= ((u64)(1)) << ((u64)(16))) {
		y >>= 16;
		n += 16;
	}
	if (y >= ((u64)(1)) << ((u64)(8))) {
		y >>= 8;
		n += 8;
	}
	return n + ((int)((*(byte*)array_get(_const_math__bits__len_8_tab, y))));
}

multi_return_u32_u32 math__bits__add_32(u32 x, u32 y, u32 carry) {
	u64 sum64 = ((u64)(x)) + ((u64)(y)) + ((u64)(carry));
	u32 sum = ((u32)(sum64));
	u32 carry_out = ((u32)(sum64 >> 32));
	return (multi_return_u32_u32){.arg0=sum, .arg1=carry_out};
}

multi_return_u64_u64 math__bits__add_64(u64 x, u64 y, u64 carry) {
	u64 sum = x + y + carry;
	u64 carry_out = ((((x & y)) | ((((x | y)) & ~sum)))) >> 63;
	return (multi_return_u64_u64){.arg0=sum, .arg1=carry_out};
}

multi_return_u32_u32 math__bits__sub_32(u32 x, u32 y, u32 borrow) {
	u32 diff = x - y - borrow;
	u32 borrow_out = ((((~x & y)) | ((~((x ^ y)) & diff)))) >> 31;
	return (multi_return_u32_u32){.arg0=diff, .arg1=borrow_out};
}

multi_return_u64_u64 math__bits__sub_64(u64 x, u64 y, u64 borrow) {
	u64 diff = x - y - borrow;
	u64 borrow_out = ((((~x & y)) | ((~((x ^ y)) & diff)))) >> 63;
	return (multi_return_u64_u64){.arg0=diff, .arg1=borrow_out};
}

multi_return_u32_u32 math__bits__mul_32(u32 x, u32 y) {
	u64 tmp = ((u64)(x)) * ((u64)(y));
	u32 hi = ((u32)(tmp >> 32));
	u32 lo = ((u32)(tmp));
	return (multi_return_u32_u32){.arg0=hi, .arg1=lo};
}

multi_return_u64_u64 math__bits__mul_64(u64 x, u64 y) {
	u64 x0 = (x & _const_math__bits__mask32);
	u64 x1 = x >> 32;
	u64 y0 = (y & _const_math__bits__mask32);
	u64 y1 = y >> 32;
	u64 w0 = x0 * y0;
	u64 t = x1 * y0 + (w0 >> 32);
	u64 w1 = (t & _const_math__bits__mask32);
	u64 w2 = t >> 32;
	w1 += x0 * y1;
	u64 hi = x1 * y1 + w2 + (w1 >> 32);
	u64 lo = x * y;
	return (multi_return_u64_u64){.arg0=hi, .arg1=lo};
}

multi_return_u32_u32 math__bits__div_32(u32 hi, u32 lo, u32 y) {
	if (y != 0 && y <= hi) {
		v_panic(_const_math__bits__overflow_error);
	}
	u64 z = ((((u64)(hi)) << 32) | ((u64)(lo)));
	u32 quo = ((u32)(z / ((u64)(y))));
	u32 rem = ((u32)(z % ((u64)(y))));
	return (multi_return_u32_u32){.arg0=quo, .arg1=rem};
}

multi_return_u64_u64 math__bits__div_64(u64 hi, u64 lo, u64 y1) {
	u64 y = y1;
	if (y == 0) {
		v_panic(_const_math__bits__overflow_error);
	}
	if (y <= hi) {
		v_panic(_const_math__bits__overflow_error);
	}
	u32 s = ((u32)(math__bits__leading_zeros_64(y)));
	y <<= s;
	u64 yn1 = y >> 32;
	u64 yn0 = (y & _const_math__bits__mask32);
	u64 un32 = ((hi << s) | (lo >> (64 - s)));
	u64 un10 = lo << s;
	u64 un1 = un10 >> 32;
	u64 un0 = (un10 & _const_math__bits__mask32);
	u64 q1 = un32 / yn1;
	u64 rhat = un32 - q1 * yn1;
	while (q1 >= _const_math__bits__two32 || q1 * yn0 > _const_math__bits__two32 * rhat + un1) {
		q1--;
		rhat += yn1;
		if (rhat >= _const_math__bits__two32) {
			break;
		}
	}
	u64 un21 = un32 * _const_math__bits__two32 + un1 - q1 * y;
	u64 q0 = un21 / yn1;
	rhat = un21 - q0 * yn1;
	while (q0 >= _const_math__bits__two32 || q0 * yn0 > _const_math__bits__two32 * rhat + un0) {
		q0--;
		rhat += yn1;
		if (rhat >= _const_math__bits__two32) {
			break;
		}
	}
	return (multi_return_u64_u64){.arg0=q1 * _const_math__bits__two32 + q0, .arg1=(un21 * _const_math__bits__two32 + un0 - q0 * y) >> s};
}

u32 math__bits__rem_32(u32 hi, u32 lo, u32 y) {
	return ((u32)((((((u64)(hi)) << 32) | ((u64)(lo)))) % ((u64)(y))));
}

u64 math__bits__rem_64(u64 hi, u64 lo, u64 y) {
	multi_return_u64_u64 mr_15086 = math__bits__div_64(hi % y, lo, y);
	u64 rem = mr_15086.arg1;
	return rem;
}

static multi_return_u32_u32_u32 strconv__lsr96(u32 s2, u32 s1, u32 s0) {
	u32 r0 = ((u32)(0));
	u32 r1 = ((u32)(0));
	u32 r2 = ((u32)(0));
	r0 = ((s0 >> 1) | (((s1 & ((u32)(1)))) << 31));
	r1 = ((s1 >> 1) | (((s2 & ((u32)(1)))) << 31));
	r2 = s2 >> 1;
	return (multi_return_u32_u32_u32){.arg0=r2, .arg1=r1, .arg2=r0};
}

static multi_return_u32_u32_u32 strconv__lsl96(u32 s2, u32 s1, u32 s0) {
	u32 r0 = ((u32)(0));
	u32 r1 = ((u32)(0));
	u32 r2 = ((u32)(0));
	r2 = ((s2 << 1) | (((s1 & (((u32)(1)) << 31))) >> 31));
	r1 = ((s1 << 1) | (((s0 & (((u32)(1)) << 31))) >> 31));
	r0 = s0 << 1;
	return (multi_return_u32_u32_u32){.arg0=r2, .arg1=r1, .arg2=r0};
}

static multi_return_u32_u32_u32 strconv__add96(u32 s2, u32 s1, u32 s0, u32 d2, u32 d1, u32 d0) {
	u64 w = ((u64)(0));
	u32 r0 = ((u32)(0));
	u32 r1 = ((u32)(0));
	u32 r2 = ((u32)(0));
	w = ((u64)(s0)) + ((u64)(d0));
	r0 = ((u32)(w));
	w >>= 32;
	w += ((u64)(s1)) + ((u64)(d1));
	r1 = ((u32)(w));
	w >>= 32;
	w += ((u64)(s2)) + ((u64)(d2));
	r2 = ((u32)(w));
	return (multi_return_u32_u32_u32){.arg0=r2, .arg1=r1, .arg2=r0};
}

static multi_return_u32_u32_u32 strconv__sub96(u32 s2, u32 s1, u32 s0, u32 d2, u32 d1, u32 d0) {
	u64 w = ((u64)(0));
	u32 r0 = ((u32)(0));
	u32 r1 = ((u32)(0));
	u32 r2 = ((u32)(0));
	w = ((u64)(s0)) - ((u64)(d0));
	r0 = ((u32)(w));
	w >>= 32;
	w += ((u64)(s1)) - ((u64)(d1));
	r1 = ((u32)(w));
	w >>= 32;
	w += ((u64)(s2)) - ((u64)(d2));
	r2 = ((u32)(w));
	return (multi_return_u32_u32_u32){.arg0=r2, .arg1=r1, .arg2=r0};
}

static bool strconv__is_digit(byte x) {
	return (x >= _const_strconv__c_zero && x <= _const_strconv__c_nine) == true;
}

static bool strconv__is_space(byte x) {
	return (x == '\t' || x == '\n' || x == '\v' || x == '\f' || x == '\r' || x == ' ');
}

static bool strconv__is_exp(byte x) {
	return (x == 'E' || x == 'e') == true;
}

static multi_return_int_strconv__PrepNumber strconv__parser(string s) {
	int state = _const_strconv__fsm_a;
	int digx = 0;
	byte c = ' ';
	int result = _const_strconv__parser_ok;
	bool expneg = false;
	int expexp = 0;
	int i = 0;
	strconv__PrepNumber pn = (strconv__PrepNumber){.negative = 0,.exponent = 0,.mantissa = 0,};
	while (state != _const_strconv__fsm_stop) {
		if (state == _const_strconv__fsm_a) {
			if (strconv__is_space(c) == true) {
				c = string_at(s, i++);
			} else {
				state = _const_strconv__fsm_b;
			}
		} else if (state == _const_strconv__fsm_b) {
			state = _const_strconv__fsm_c;
			if (c == _const_strconv__c_plus) {
				c = string_at(s, i++);
			} else if (c == _const_strconv__c_minus) {
				pn.negative = true;
				c = string_at(s, i++);
			} else if (strconv__is_digit(c)) {
			} else if (c == _const_strconv__c_dpoint) {
			} else {
				state = _const_strconv__fsm_stop;
			}
		} else if (state == _const_strconv__fsm_c) {
			if (c == _const_strconv__c_zero) {
				c = string_at(s, i++);
			} else if (c == _const_strconv__c_dpoint) {
				c = string_at(s, i++);
				state = _const_strconv__fsm_d;
			} else {
				state = _const_strconv__fsm_e;
			}
		} else if (state == _const_strconv__fsm_d) {
			if (c == _const_strconv__c_zero) {
				c = string_at(s, i++);
				if (pn.exponent > -2147483647) {
					pn.exponent--;
				}
			} else {
				state = _const_strconv__fsm_f;
			}
		} else if (state == _const_strconv__fsm_e) {
			if (strconv__is_digit(c)) {
				if (digx < _const_strconv__digits) {
					pn.mantissa *= 10;
					pn.mantissa += ((u64)(c - _const_strconv__c_zero));
					digx++;
				} else if (pn.exponent < 2147483647) {
					pn.exponent++;
				}
				c = string_at(s, i++);
			} else if (c == _const_strconv__c_dpoint) {
				c = string_at(s, i++);
				state = _const_strconv__fsm_f;
			} else {
				state = _const_strconv__fsm_f;
			}
		} else if (state == _const_strconv__fsm_f) {
			if (strconv__is_digit(c)) {
				if (digx < _const_strconv__digits) {
					pn.mantissa *= 10;
					pn.mantissa += ((u64)(c - _const_strconv__c_zero));
					pn.exponent--;
					digx++;
				}
				c = string_at(s, i++);
			} else if (strconv__is_exp(c)) {
				c = string_at(s, i++);
				state = _const_strconv__fsm_g;
			} else {
				state = _const_strconv__fsm_g;
			}
		} else if (state == _const_strconv__fsm_g) {
			if (c == _const_strconv__c_plus) {
				c = string_at(s, i++);
			} else if (c == _const_strconv__c_minus) {
				expneg = true;
				c = string_at(s, i++);
			}
			state = _const_strconv__fsm_h;
		} else if (state == _const_strconv__fsm_h) {
			if (c == _const_strconv__c_zero) {
				c = string_at(s, i++);
			} else {
				state = _const_strconv__fsm_i;
			}
		} else if (state == _const_strconv__fsm_i) {
			if (strconv__is_digit(c)) {
				if (expexp < 214748364) {
					expexp *= 10;
					expexp += ((int)(c - _const_strconv__c_zero));
				}
				c = string_at(s, i++);
			} else {
				state = _const_strconv__fsm_stop;
			}
		} else {
		};
		if (i >= s.len) {
			state = _const_strconv__fsm_stop;
		}
	}
	if (expneg) {
		expexp = -expexp;
	}
	pn.exponent += expexp;
	if (pn.mantissa == 0) {
		if (pn.negative) {
			result = _const_strconv__parser_mzero;
		} else {
			result = _const_strconv__parser_pzero;
		}
	} else if (pn.exponent > 309) {
		if (pn.negative) {
			result = _const_strconv__parser_minf;
		} else {
			result = _const_strconv__parser_pinf;
		}
	} else if (pn.exponent < -328) {
		if (pn.negative) {
			result = _const_strconv__parser_mzero;
		} else {
			result = _const_strconv__parser_pzero;
		}
	}
	return (multi_return_int_strconv__PrepNumber){.arg0=result, .arg1=pn};
}

static u64 strconv__converter(strconv__PrepNumber* pn) {
	int binexp = 92;
	u32 s2 = ((u32)(0));
	u32 s1 = ((u32)(0));
	u32 s0 = ((u32)(0));
	u32 q2 = ((u32)(0));
	u32 q1 = ((u32)(0));
	u32 q0 = ((u32)(0));
	u32 r2 = ((u32)(0));
	u32 r1 = ((u32)(0));
	u32 r0 = ((u32)(0));
	u32 mask28 = ((u32)(0xF << 28));
	u64 result = ((u64)(0));
	s0 = ((u32)((pn->mantissa & ((u64)(0x00000000FFFFFFFF)))));
	s1 = ((u32)(pn->mantissa >> 32));
	s2 = ((u32)(0));
	while (pn->exponent > 0) {
		multi_return_u32_u32_u32 mr_6937 = strconv__lsl96(s2, s1, s0);
		q2 = mr_6937.arg0;
		q1 = mr_6937.arg1;
		q0 = mr_6937.arg2;
		multi_return_u32_u32_u32 mr_6981 = strconv__lsl96(q2, q1, q0);
		r2 = mr_6981.arg0;
		r1 = mr_6981.arg1;
		r0 = mr_6981.arg2;
		multi_return_u32_u32_u32 mr_7035 = strconv__lsl96(r2, r1, r0);
		s2 = mr_7035.arg0;
		s1 = mr_7035.arg1;
		s0 = mr_7035.arg2;
		multi_return_u32_u32_u32 mr_7089 = strconv__add96(s2, s1, s0, q2, q1, q0);
		s2 = mr_7089.arg0;
		s1 = mr_7089.arg1;
		s0 = mr_7089.arg2;
		pn->exponent--;
		while (((s2 & mask28)) != 0) {
			multi_return_u32_u32_u32 mr_7210 = strconv__lsr96(s2, s1, s0);
			q2 = mr_7210.arg0;
			q1 = mr_7210.arg1;
			q0 = mr_7210.arg2;
			binexp++;
			s2 = q2;
			s1 = q1;
			s0 = q0;
		}
	}
	while (pn->exponent < 0) {
		while (!(((s2 & (((u32)(1)) << 31))) != 0)) {
			multi_return_u32_u32_u32 mr_7353 = strconv__lsl96(s2, s1, s0);
			q2 = mr_7353.arg0;
			q1 = mr_7353.arg1;
			q0 = mr_7353.arg2;
			binexp--;
			s2 = q2;
			s1 = q1;
			s0 = q0;
		}
		q2 = s2 / _const_strconv__c_ten;
		r1 = s2 % _const_strconv__c_ten;
		r2 = ((s1 >> 8) | (r1 << 24));
		q1 = r2 / _const_strconv__c_ten;
		r1 = r2 % _const_strconv__c_ten;
		r2 = (((((s1 & ((u32)(0xFF)))) << 16) | (s0 >> 16)) | (r1 << 24));
		r0 = r2 / _const_strconv__c_ten;
		r1 = r2 % _const_strconv__c_ten;
		q1 = ((q1 << 8) | (((r0 & ((u32)(0x00FF0000)))) >> 16));
		q0 = r0 << 16;
		r2 = (((s0 & ((u32)(0xFFFF)))) | (r1 << 16));
		q0 |= r2 / _const_strconv__c_ten;
		s2 = q2;
		s1 = q1;
		s0 = q0;
		pn->exponent++;
	}
	if (s2 != 0 || s1 != 0 || s0 != 0) {
		while (((s2 & mask28)) == 0) {
			multi_return_u32_u32_u32 mr_8012 = strconv__lsl96(s2, s1, s0);
			q2 = mr_8012.arg0;
			q1 = mr_8012.arg1;
			q0 = mr_8012.arg2;
			binexp--;
			s2 = q2;
			s1 = q1;
			s0 = q0;
		}
	}
	int nbit = 7;
	u32 check_round_bit = ((u32)(1)) << ((u32)(nbit));
	u32 check_round_mask = ((u32)(0xFFFFFFFF)) << ((u32)(nbit));
	if (((s1 & check_round_bit)) != 0) {
		if (((s1 & ~check_round_mask)) != 0) {
			multi_return_u32_u32_u32 mr_9085 = strconv__add96(s2, s1, s0, 0, check_round_bit, 0);
			s2 = mr_9085.arg0;
			s1 = mr_9085.arg1;
			s0 = mr_9085.arg2;
		} else {
			if (((s1 & (check_round_bit << ((u32)(1))))) != 0) {
				multi_return_u32_u32_u32 mr_9275 = strconv__add96(s2, s1, s0, 0, check_round_bit, 0);
				s2 = mr_9275.arg0;
				s1 = mr_9275.arg1;
				s0 = mr_9275.arg2;
			}
		}
		s1 = (s1 & check_round_mask);
		s0 = ((u32)(0));
		if ((s2 & (mask28 << ((u32)(1)))) != 0) {
			multi_return_u32_u32_u32 mr_9475 = strconv__lsr96(s2, s1, s0);
			q2 = mr_9475.arg0;
			q1 = mr_9475.arg1;
			q0 = mr_9475.arg2;
			binexp--;
			s2 = q2;
			s1 = q1;
			s0 = q0;
		}
	}
	binexp += 1023;
	if (binexp > 2046) {
		if (pn->negative) {
			result = _const_strconv__double_minus_infinity;
		} else {
			result = _const_strconv__double_plus_infinity;
		}
	} else if (binexp < 1) {
		if (pn->negative) {
			result = _const_strconv__double_minus_zero;
		} else {
			result = _const_strconv__double_plus_zero;
		}
	} else if (s2 != 0) {
		u64 q = ((u64)(0));
		u64 binexs2 = ((u64)(binexp)) << 52;
		q = (((((u64)((s2 & ~mask28))) << 24) | ((((u64)(s1)) + ((u64)(128))) >> 8)) | binexs2);
		if (pn->negative) {
			q |= (((u64)(1)) << 63);
		}
		result = q;
	}
	return result;
}

f64 strconv__atof64(string s) {
	strconv__PrepNumber pn = (strconv__PrepNumber){.negative = 0,.exponent = 0,.mantissa = 0,};
	int res_parsing = 0;
	strconv__Float64u res;
	multi_return_int_strconv__PrepNumber mr_10480 = strconv__parser(string_add(s, tos_lit(" ")));
	res_parsing = mr_10480.arg0;
	pn = mr_10480.arg1;
	if (res_parsing == _const_strconv__parser_ok) {
		res.u = strconv__converter((voidptr)&/*qq*/pn);
	} else if (res_parsing == _const_strconv__parser_pzero) {
		res.u = _const_strconv__double_plus_zero;
	} else if (res_parsing == _const_strconv__parser_mzero) {
		res.u = _const_strconv__double_minus_zero;
	} else if (res_parsing == _const_strconv__parser_pinf) {
		res.u = _const_strconv__double_plus_infinity;
	} else if (res_parsing == _const_strconv__parser_minf) {
		res.u = _const_strconv__double_minus_infinity;
	} else {
	};
	return res.f;
}

f64 strconv__atof_quick(string s) {
	strconv__Float64u f;
	f64 sign = ((f64)(1.0));
	int i = 0;
	while (i < s.len && string_at(s, i) == ' ') {
		i++;
	}
	if (i < s.len) {
		if (string_at(s, i) == '-') {
			sign = -1.0;
			i++;
		} else if (string_at(s, i) == '+') {
			i++;
		}
	}
	if (string_at(s, i) == 'i' && i + 2 < s.len && string_at(s, i + 1) == 'n' && string_at(s, i + 2) == 'f') {
		if (sign > 0.0) {
			f.u = _const_strconv__double_plus_infinity;
		} else {
			f.u = _const_strconv__double_minus_infinity;
		}
		return f.f;
	}
	while (i < s.len && string_at(s, i) == '0') {
		i++;
		if (i >= s.len) {
			if (sign > 0.0) {
				f.u = _const_strconv__double_plus_zero;
			} else {
				f.u = _const_strconv__double_minus_zero;
			}
			return f.f;
		}
	}
	while (i < s.len && (string_at(s, i) >= '0' && string_at(s, i) <= '9')) {
		f.f *= ((f64)(10.0));
		f.f += ((f64)(string_at(s, i) - '0'));
		i++;
	}
	if (i < s.len && string_at(s, i) == '.') {
		i++;
		f64 frac_mul = ((f64)(0.1));
		while (i < s.len && (string_at(s, i) >= '0' && string_at(s, i) <= '9')) {
			f.f += ((f64)(string_at(s, i) - '0')) * frac_mul;
			frac_mul *= ((f64)(0.1));
			i++;
		}
	}
	if (i < s.len && (string_at(s, i) == 'e' || string_at(s, i) == 'E')) {
		i++;
		int exp = 0;
		int exp_sign = 1;
		if (i < s.len) {
			if (string_at(s, i) == '-') {
				exp_sign = -1;
				i++;
			} else if (string_at(s, i) == '+') {
				i++;
			}
		}
		while (i < s.len && string_at(s, i) == '0') {
			i++;
		}
		while (i < s.len && (string_at(s, i) >= '0' && string_at(s, i) <= '9')) {
			exp *= 10;
			exp += ((int)(string_at(s, i) - '0'));
			i++;
		}
		if (exp_sign == 1) {
			if (exp > _const_strconv__pos_exp.len) {
				if (sign > 0) {
					f.u = _const_strconv__double_plus_infinity;
				} else {
					f.u = _const_strconv__double_minus_infinity;
				}
				return f.f;
			}
			strconv__Float64u tmp_mul;
			f.f = f.f * tmp_mul.f;
		} else {
			if (exp > _const_strconv__neg_exp.len) {
				if (sign > 0) {
					f.u = _const_strconv__double_plus_zero;
				} else {
					f.u = _const_strconv__double_minus_zero;
				}
				return f.f;
			}
			strconv__Float64u tmp_mul;
			f.f = f.f * tmp_mul.f;
		}
	}
	f.f = f.f * sign;
	return f.f;
}

byte strconv__byte_to_lower(byte c) {
	return (c | ('x' - 'X'));
}

u64 strconv__common_parse_uint(string s, int _base, int _bit_size, bool error_on_non_digit, bool error_on_high_digit) {
	int bit_size = _bit_size;
	int base = _base;
	if (s.len < 1 || !strconv__underscore_ok(s)) {
		return ((u64)(0));
	}
	bool base0 = base == 0;
	int start_index = 0;
	if (2 <= base && base <= 36) {
	} else if (base == 0) {
		base = 10;
		if (string_at(s, 0) == '0') {
			if (s.len >= 3 && strconv__byte_to_lower(string_at(s, 1)) == 'b') {
				base = 2;
				start_index += 2;
			} else if (s.len >= 3 && strconv__byte_to_lower(string_at(s, 1)) == 'o') {
				base = 8;
				start_index += 2;
			} else if (s.len >= 3 && strconv__byte_to_lower(string_at(s, 1)) == 'x') {
				base = 16;
				start_index += 2;
			} else if (s.len >= 2 && (string_at(s, 1) >= '0' && string_at(s, 1) <= '9')) {
				base = 10;
				start_index++;
			} else {
				base = 8;
				start_index++;
			}
		}
	} else {
		return ((u64)(0));
	}
	if (bit_size == 0) {
		bit_size = _const_strconv__int_size;
	} else if (bit_size < 0 || bit_size > 64) {
		return ((u64)(0));
	}
	u64 cutoff = _const_strconv__max_u64 / ((u64)(base)) + ((u64)(1));
	u64 max_val = (bit_size == 64 ? (_const_strconv__max_u64) : ((((u64)(1)) << ((u64)(bit_size))) - ((u64)(1))));
	bool underscores = false;
	u64 n = ((u64)(0));
	for (int i = start_index; i < s.len; ++i) {
		byte c = string_at(s, i);
		byte cl = strconv__byte_to_lower(c);
		byte d = ((byte)(0));
		if (c == '_' && base0) {
			underscores = true;
			continue;
		} else if ('0' <= c && c <= '9') {
			d = c - '0';
		} else if ('a' <= cl && cl <= 'z') {
			d = cl - 'a' + 10;
		} else {
			if (error_on_non_digit) {
				return ((u64)(0));
			} else {
				break;
			}
		}
		if (d >= ((byte)(base))) {
			if (error_on_high_digit) {
				return ((u64)(0));
			} else {
				break;
			}
		}
		if (n >= cutoff) {
			return max_val;
		}
		n *= ((u64)(base));
		u64 n1 = n + ((u64)(d));
		if (n1 < n || n1 > max_val) {
			return max_val;
		}
		n = n1;
	}
	if (underscores && !strconv__underscore_ok(s)) {
		return ((u64)(0));
	}
	return n;
}

u64 strconv__parse_uint(string s, int _base, int _bit_size) {
	return strconv__common_parse_uint(s, _base, _bit_size, true, true);
}

i64 strconv__common_parse_int(string _s, int base, int _bit_size, bool error_on_non_digit, bool error_on_high_digit) {
	string s = _s;
	int bit_size = _bit_size;
	if (s.len < 1) {
		return ((i64)(0));
	}
	bool neg = false;
	if (string_at(s, 0) == '+') {
		s = string_substr(s, 1, s.len);
	} else if (string_at(s, 0) == '-') {
		neg = true;
		s = string_substr(s, 1, s.len);
	}
	u64 un = strconv__common_parse_uint(s, base, bit_size, error_on_non_digit, error_on_high_digit);
	if (un == 0) {
		return ((i64)(0));
	}
	if (bit_size == 0) {
		bit_size = _const_strconv__int_size;
	}
	u64 cutoff = ((u64)(1)) << ((u64)(bit_size - 1));
	if (!neg && un >= cutoff) {
		return ((i64)(cutoff - ((u64)(1))));
	}
	if (neg && un > cutoff) {
		return -((i64)(cutoff));
	}
	return (neg ? (-((i64)(un))) : (((i64)(un))));
}

i64 strconv__parse_int(string _s, int base, int _bit_size) {
	return strconv__common_parse_int(_s, base, _bit_size, true, true);
}

int strconv__atoi(string s) {
	if ((_const_strconv__int_size == 32 && (0 < s.len && s.len < 10)) || (_const_strconv__int_size == 64 && (0 < s.len && s.len < 19))) {
		int start_idx = 0;
		if (string_at(s, 0) == '-' || string_at(s, 0) == '+') {
			start_idx++;
			if (s.len - start_idx < 1) {
				return 0;
			}
		}
		int n = 0;
		for (int i = start_idx; i < s.len; ++i) {
			byte ch = string_at(s, i) - '0';
			if (ch > 9) {
				return 0;
			}
			n = n * 10 + ((int)(ch));
		}
		return (string_at(s, 0) == '-' ? (-n) : (n));
	}
	i64 int64 = strconv__parse_int(s, 10, 0);
	return ((int)(int64));
}

static bool strconv__underscore_ok(string s) {
	byte saw = '^';
	int i = 0;
	if (s.len >= 1 && (string_at(s, 0) == '-' || string_at(s, 0) == '+')) {
		i++;
	}
	bool hex = false;
	if (s.len - i >= 2 && string_at(s, i) == '0' && (strconv__byte_to_lower(string_at(s, i + 1)) == 'b' || strconv__byte_to_lower(string_at(s, i + 1)) == 'o' || strconv__byte_to_lower(string_at(s, i + 1)) == 'x')) {
		saw = '0';
		hex = strconv__byte_to_lower(string_at(s, i + 1)) == 'x';
		i += 2;
	}
	for (; i < s.len; i++) {
		if (('0' <= string_at(s, i) && string_at(s, i) <= '9') || (hex && 'a' <= strconv__byte_to_lower(string_at(s, i)) && strconv__byte_to_lower(string_at(s, i)) <= 'f')) {
			saw = '0';
			continue;
		}
		if (string_at(s, i) == '_') {
			if (saw != '0') {
				return false;
			}
			saw = '_';
			continue;
		}
		if (saw == '_') {
			return false;
		}
		saw = '!';
	}
	return saw != '_';
}

string strconv__Dec32_get_string_32(strconv__Dec32 d, bool neg, int i_n_digit, int i_pad_digit) {
	int n_digit = i_n_digit + 1;
	int pad_digit = i_pad_digit + 1;
	u32 out = d.m;
	int out_len = strconv__decimal_len_32(out);
	int out_len_original = out_len;
	int fw_zeros = 0;
	if (pad_digit > out_len) {
		fw_zeros = pad_digit - out_len;
	}
	array_byte buf = __new_array_with_default(((int)(out_len + 5 + 1 + 1)), 0, sizeof(byte), 0);
	int i = 0;
	if (neg) {
		array_set(&buf, i, &(byte[]) { '-' });
		i++;
	}
	int disp = 0;
	if (out_len <= 1) {
		disp = 1;
	}
	if (n_digit < out_len) {
		out += (*(u32*)array_get(_const_strconv__ten_pow_table_32, out_len - n_digit - 1)) * 5;
		out /= (*(u32*)array_get(_const_strconv__ten_pow_table_32, out_len - n_digit));
		out_len = n_digit;
	}
	int y = i + out_len;
	int x = 0;
	while (x < (out_len - disp - 1)) {
		array_set(&buf, y - x, &(byte[]) { '0' + ((byte)(out % 10)) });
		out /= 10;
		i++;
		x++;
	}
	if (out_len >= 1) {
		array_set(&buf, y - x, &(byte[]) { '.' });
		x++;
		i++;
	}
	if (y - x >= 0) {
		array_set(&buf, y - x, &(byte[]) { '0' + ((byte)(out % 10)) });
		i++;
	}
	while (fw_zeros > 0) {
		array_set(&buf, i++, &(byte[]) { '0' });
		fw_zeros--;
	}
	array_set(&buf, i, &(byte[]) { 'e' });
	i++;
	int exp = d.e + out_len_original - 1;
	if (exp < 0) {
		array_set(&buf, i, &(byte[]) { '-' });
		i++;
		exp = -exp;
	} else {
		array_set(&buf, i, &(byte[]) { '+' });
		i++;
	}
	int d1 = exp % 10;
	int d0 = exp / 10;
	array_set(&buf, i, &(byte[]) { '0' + ((byte)(d0)) });
	i++;
	array_set(&buf, i, &(byte[]) { '0' + ((byte)(d1)) });
	i++;
	array_set(&buf, i, &(byte[]) { 0 });
	return tos(((byteptr)(&(*(byte*)array_get(buf, 0)))), i);
}

static multi_return_strconv__Dec32_bool strconv__f32_to_decimal_exact_int(u32 i_mant, u32 exp) {
	strconv__Dec32 d = (strconv__Dec32){.m = 0,.e = 0,};
	u32 e = exp - _const_strconv__bias32;
	if (e > _const_strconv__mantbits32) {
		return (multi_return_strconv__Dec32_bool){.arg0=d, .arg1=false};
	}
	u32 shift = _const_strconv__mantbits32 - e;
	u32 mant = (i_mant | 0x00800000);
	d.m = mant >> shift;
	if ((d.m << shift) != mant) {
		return (multi_return_strconv__Dec32_bool){.arg0=d, .arg1=false};
	}
	while ((d.m % 10) == 0) {
		d.m /= 10;
		d.e++;
	}
	return (multi_return_strconv__Dec32_bool){.arg0=d, .arg1=true};
}

strconv__Dec32 strconv__f32_to_decimal(u32 mant, u32 exp) {
	int e2 = 0;
	u32 m2 = ((u32)(0));
	if (exp == 0) {
		e2 = 1 - _const_strconv__bias32 - ((int)(_const_strconv__mantbits32)) - 2;
		m2 = mant;
	} else {
		e2 = ((int)(exp)) - _const_strconv__bias32 - ((int)(_const_strconv__mantbits32)) - 2;
		m2 = ((((u32)(1)) << _const_strconv__mantbits32) | mant);
	}
	bool even = ((m2 & 1)) == 0;
	bool accept_bounds = even;
	u32 mv = ((u32)(4 * m2));
	u32 mp = ((u32)(4 * m2 + 2));
	u32 mm_shift = strconv__bool_to_u32(mant != 0 || exp <= 1);
	u32 mm = ((u32)(4 * m2 - 1 - mm_shift));
	u32 vr = ((u32)(0));
	u32 vp = ((u32)(0));
	u32 vm = ((u32)(0));
	int e10 = 0;
	bool vm_is_trailing_zeros = false;
	bool vr_is_trailing_zeros = false;
	byte last_removed_digit = ((byte)(0));
	if (e2 >= 0) {
		u32 q = strconv__log10_pow2(e2);
		e10 = ((int)(q));
		int k = _const_strconv__pow5_inv_num_bits_32 + strconv__pow5_bits(((int)(q))) - 1;
		int i = -e2 + ((int)(q)) + k;
		vr = strconv__mul_pow5_invdiv_pow2(mv, q, i);
		vp = strconv__mul_pow5_invdiv_pow2(mp, q, i);
		vm = strconv__mul_pow5_invdiv_pow2(mm, q, i);
		if (q != 0 && (vp - 1) / 10 <= vm / 10) {
			int l = _const_strconv__pow5_inv_num_bits_32 + strconv__pow5_bits(((int)(q - 1))) - 1;
			last_removed_digit = ((byte)(strconv__mul_pow5_invdiv_pow2(mv, q - 1, -e2 + ((int)(q - 1)) + l) % 10));
		}
		if (q <= 9) {
			if (mv % 5 == 0) {
				vr_is_trailing_zeros = strconv__multiple_of_power_of_five_32(mv, q);
			} else if (accept_bounds) {
				vm_is_trailing_zeros = strconv__multiple_of_power_of_five_32(mm, q);
			} else if (strconv__multiple_of_power_of_five_32(mp, q)) {
				vp--;
			}
		}
	} else {
		u32 q = strconv__log10_pow5(-e2);
		e10 = ((int)(q)) + e2;
		int i = -e2 - ((int)(q));
		int k = strconv__pow5_bits(i) - _const_strconv__pow5_num_bits_32;
		int j = ((int)(q)) - k;
		vr = strconv__mul_pow5_div_pow2(mv, ((u32)(i)), j);
		vp = strconv__mul_pow5_div_pow2(mp, ((u32)(i)), j);
		vm = strconv__mul_pow5_div_pow2(mm, ((u32)(i)), j);
		if (q != 0 && ((vp - 1) / 10) <= vm / 10) {
			j = ((int)(q)) - 1 - (strconv__pow5_bits(i + 1) - _const_strconv__pow5_num_bits_32);
			last_removed_digit = ((byte)(strconv__mul_pow5_div_pow2(mv, ((u32)(i + 1)), j) % 10));
		}
		if (q <= 1) {
			vr_is_trailing_zeros = true;
			if (accept_bounds) {
				vm_is_trailing_zeros = mm_shift == 1;
			} else {
				vp--;
			}
		} else if (q < 31) {
			vr_is_trailing_zeros = strconv__multiple_of_power_of_two_32(mv, q - 1);
		}
	}
	int removed = 0;
	u32 out = ((u32)(0));
	if (vm_is_trailing_zeros || vr_is_trailing_zeros) {
		while (vp / 10 > vm / 10) {
			vm_is_trailing_zeros = vm_is_trailing_zeros && (vm % 10) == 0;
			vr_is_trailing_zeros = vr_is_trailing_zeros && (last_removed_digit == 0);
			last_removed_digit = ((byte)(vr % 10));
			vr /= 10;
			vp /= 10;
			vm /= 10;
			removed++;
		}
		if (vm_is_trailing_zeros) {
			while (vm % 10 == 0) {
				vr_is_trailing_zeros = vr_is_trailing_zeros && (last_removed_digit == 0);
				last_removed_digit = ((byte)(vr % 10));
				vr /= 10;
				vp /= 10;
				vm /= 10;
				removed++;
			}
		}
		if (vr_is_trailing_zeros && (last_removed_digit == 5) && (vr % 2) == 0) {
			last_removed_digit = 4;
		}
		out = vr;
		if ((vr == vm && (!accept_bounds || !vm_is_trailing_zeros)) || last_removed_digit >= 5) {
			out++;
		}
	} else {
		while (vp / 10 > vm / 10) {
			last_removed_digit = ((byte)(vr % 10));
			vr /= 10;
			vp /= 10;
			vm /= 10;
			removed++;
		}
		out = vr + strconv__bool_to_u32(vr == vm || last_removed_digit >= 5);
	}
	return (strconv__Dec32){.m = out,.e = e10 + removed,};
}

string strconv__f32_to_str(f32 f, int n_digit) {
	strconv__Uf32 u1 = (strconv__Uf32){
#ifndef __cplusplus
0
#endif
};
	u1.f = f;
	u32 u = u1.u;
	bool neg = (u >> (_const_strconv__mantbits32 + _const_strconv__expbits32)) != 0;
	u32 mant = (u & ((((u32)(1)) << _const_strconv__mantbits32) - ((u32)(1))));
	u32 exp = ((u >> _const_strconv__mantbits32) & ((((u32)(1)) << _const_strconv__expbits32) - ((u32)(1))));
	if ((exp == _const_strconv__maxexp32) || (exp == 0 && mant == 0)) {
		return strconv__get_string_special(neg, exp == 0, mant == 0);
	}
	multi_return_strconv__Dec32_bool mr_8145 = strconv__f32_to_decimal_exact_int(mant, exp);
	strconv__Dec32 d = mr_8145.arg0;
	bool ok = mr_8145.arg1;
	if (!ok) {
		d = strconv__f32_to_decimal(mant, exp);
	}
	return strconv__Dec32_get_string_32(d, neg, n_digit, 0);
}

string strconv__f32_to_str_pad(f32 f, int n_digit) {
	strconv__Uf32 u1 = (strconv__Uf32){
#ifndef __cplusplus
0
#endif
};
	u1.f = f;
	u32 u = u1.u;
	bool neg = (u >> (_const_strconv__mantbits32 + _const_strconv__expbits32)) != 0;
	u32 mant = (u & ((((u32)(1)) << _const_strconv__mantbits32) - ((u32)(1))));
	u32 exp = ((u >> _const_strconv__mantbits32) & ((((u32)(1)) << _const_strconv__expbits32) - ((u32)(1))));
	if ((exp == _const_strconv__maxexp32) || (exp == 0 && mant == 0)) {
		return strconv__get_string_special(neg, exp == 0, mant == 0);
	}
	multi_return_strconv__Dec32_bool mr_8853 = strconv__f32_to_decimal_exact_int(mant, exp);
	strconv__Dec32 d = mr_8853.arg0;
	bool ok = mr_8853.arg1;
	if (!ok) {
		d = strconv__f32_to_decimal(mant, exp);
	}
	return strconv__Dec32_get_string_32(d, neg, n_digit, n_digit);
}

static string strconv__Dec64_get_string_64(strconv__Dec64 d, bool neg, int i_n_digit, int i_pad_digit) {
	int n_digit = i_n_digit + 1;
	int pad_digit = i_pad_digit + 1;
	u64 out = d.m;
	int d_exp = d.e;
	int out_len = strconv__decimal_len_64(out);
	int out_len_original = out_len;
	int fw_zeros = 0;
	if (pad_digit > out_len) {
		fw_zeros = pad_digit - out_len;
	}
	array_byte buf = __new_array_with_default((out_len + 6 + 1 + 1 + fw_zeros), 0, sizeof(byte), 0);
	int i = 0;
	if (neg) {
		array_set(&buf, i, &(byte[]) { '-' });
		i++;
	}
	int disp = 0;
	if (out_len <= 1) {
		disp = 1;
	}
	if (n_digit < out_len) {
		out += (*(u64*)array_get(_const_strconv__ten_pow_table_64, out_len - n_digit - 1)) * 5;
		out /= (*(u64*)array_get(_const_strconv__ten_pow_table_64, out_len - n_digit));
		if (d.m / (*(u64*)array_get(_const_strconv__ten_pow_table_64, out_len - n_digit)) < out) {
			d_exp++;
			n_digit++;
		}
		out_len = n_digit;
	}
	int y = i + out_len;
	int x = 0;
	while (x < (out_len - disp - 1)) {
		array_set(&buf, y - x, &(byte[]) { '0' + ((byte)(out % 10)) });
		out /= 10;
		i++;
		x++;
	}
	if (out_len >= 1) {
		array_set(&buf, y - x, &(byte[]) { '.' });
		x++;
		i++;
	}
	if (y - x >= 0) {
		array_set(&buf, y - x, &(byte[]) { '0' + ((byte)(out % 10)) });
		i++;
	}
	while (fw_zeros > 0) {
		array_set(&buf, i++, &(byte[]) { '0' });
		fw_zeros--;
	}
	array_set(&buf, i, &(byte[]) { 'e' });
	i++;
	int exp = d_exp + out_len_original - 1;
	if (exp < 0) {
		array_set(&buf, i, &(byte[]) { '-' });
		i++;
		exp = -exp;
	} else {
		array_set(&buf, i, &(byte[]) { '+' });
		i++;
	}
	int d2 = exp % 10;
	exp /= 10;
	int d1 = exp % 10;
	int d0 = exp / 10;
	if (d0 > 0) {
		array_set(&buf, i, &(byte[]) { '0' + ((byte)(d0)) });
		i++;
	}
	array_set(&buf, i, &(byte[]) { '0' + ((byte)(d1)) });
	i++;
	array_set(&buf, i, &(byte[]) { '0' + ((byte)(d2)) });
	i++;
	array_set(&buf, i, &(byte[]) { 0 });
	return tos(((byteptr)(&(*(byte*)array_get(buf, 0)))), i);
}

static multi_return_strconv__Dec64_bool strconv__f64_to_decimal_exact_int(u64 i_mant, u64 exp) {
	strconv__Dec64 d = (strconv__Dec64){.m = 0,.e = 0,};
	u64 e = exp - _const_strconv__bias64;
	if (e > _const_strconv__mantbits64) {
		return (multi_return_strconv__Dec64_bool){.arg0=d, .arg1=false};
	}
	u64 shift = _const_strconv__mantbits64 - e;
	u64 mant = (i_mant | ((u64)(0x0010000000000000)));
	d.m = mant >> shift;
	if ((d.m << shift) != mant) {
		return (multi_return_strconv__Dec64_bool){.arg0=d, .arg1=false};
	}
	while ((d.m % 10) == 0) {
		d.m /= 10;
		d.e++;
	}
	return (multi_return_strconv__Dec64_bool){.arg0=d, .arg1=true};
}

static strconv__Dec64 strconv__f64_to_decimal(u64 mant, u64 exp) {
	int e2 = 0;
	u64 m2 = ((u64)(0));
	if (exp == 0) {
		e2 = 1 - _const_strconv__bias64 - ((int)(_const_strconv__mantbits64)) - 2;
		m2 = mant;
	} else {
		e2 = ((int)(exp)) - _const_strconv__bias64 - ((int)(_const_strconv__mantbits64)) - 2;
		m2 = ((((u64)(1)) << _const_strconv__mantbits64) | mant);
	}
	bool even = ((m2 & 1)) == 0;
	bool accept_bounds = even;
	u64 mv = ((u64)(4 * m2));
	u64 mm_shift = strconv__bool_to_u64(mant != 0 || exp <= 1);
	u64 vr = ((u64)(0));
	u64 vp = ((u64)(0));
	u64 vm = ((u64)(0));
	int e10 = 0;
	bool vm_is_trailing_zeros = false;
	bool vr_is_trailing_zeros = false;
	if (e2 >= 0) {
		u32 q = strconv__log10_pow2(e2) - strconv__bool_to_u32(e2 > 3);
		e10 = ((int)(q));
		int k = _const_strconv__pow5_inv_num_bits_64 + strconv__pow5_bits(((int)(q))) - 1;
		int i = -e2 + ((int)(q)) + k;
		strconv__Uint128 mul = (*(strconv__Uint128*)array_get(_const_strconv__pow5_inv_split_64, q));
		vr = strconv__mul_shift_64(((u64)(4)) * m2, mul, i);
		vp = strconv__mul_shift_64(((u64)(4)) * m2 + ((u64)(2)), mul, i);
		vm = strconv__mul_shift_64(((u64)(4)) * m2 - ((u64)(1)) - mm_shift, mul, i);
		if (q <= 21) {
			if (mv % 5 == 0) {
				vr_is_trailing_zeros = strconv__multiple_of_power_of_five_64(mv, q);
			} else if (accept_bounds) {
				vm_is_trailing_zeros = strconv__multiple_of_power_of_five_64(mv - 1 - mm_shift, q);
			} else if (strconv__multiple_of_power_of_five_64(mv + 2, q)) {
				vp--;
			}
		}
	} else {
		u32 q = strconv__log10_pow5(-e2) - strconv__bool_to_u32(-e2 > 1);
		e10 = ((int)(q)) + e2;
		int i = -e2 - ((int)(q));
		int k = strconv__pow5_bits(i) - _const_strconv__pow5_num_bits_64;
		int j = ((int)(q)) - k;
		strconv__Uint128 mul = (*(strconv__Uint128*)array_get(_const_strconv__pow5_split_64, i));
		vr = strconv__mul_shift_64(((u64)(4)) * m2, mul, j);
		vp = strconv__mul_shift_64(((u64)(4)) * m2 + ((u64)(2)), mul, j);
		vm = strconv__mul_shift_64(((u64)(4)) * m2 - ((u64)(1)) - mm_shift, mul, j);
		if (q <= 1) {
			vr_is_trailing_zeros = true;
			if (accept_bounds) {
				vm_is_trailing_zeros = (mm_shift == 1);
			} else {
				vp--;
			}
		} else if (q < 63) {
			vr_is_trailing_zeros = strconv__multiple_of_power_of_two_64(mv, q - 1);
		}
	}
	int removed = 0;
	byte last_removed_digit = ((byte)(0));
	u64 out = ((u64)(0));
	if (vm_is_trailing_zeros || vr_is_trailing_zeros) {
		while (1) {
			u64 vp_div_10 = vp / 10;
			u64 vm_div_10 = vm / 10;
			if (vp_div_10 <= vm_div_10) {
				break;
			}
			u64 vm_mod_10 = vm % 10;
			u64 vr_div_10 = vr / 10;
			u64 vr_mod_10 = vr % 10;
			vm_is_trailing_zeros = vm_is_trailing_zeros && vm_mod_10 == 0;
			vr_is_trailing_zeros = vr_is_trailing_zeros && (last_removed_digit == 0);
			last_removed_digit = ((byte)(vr_mod_10));
			vr = vr_div_10;
			vp = vp_div_10;
			vm = vm_div_10;
			removed++;
		}
		if (vm_is_trailing_zeros) {
			while (1) {
				u64 vm_div_10 = vm / 10;
				u64 vm_mod_10 = vm % 10;
				if (vm_mod_10 != 0) {
					break;
				}
				u64 vp_div_10 = vp / 10;
				u64 vr_div_10 = vr / 10;
				u64 vr_mod_10 = vr % 10;
				vr_is_trailing_zeros = vr_is_trailing_zeros && (last_removed_digit == 0);
				last_removed_digit = ((byte)(vr_mod_10));
				vr = vr_div_10;
				vp = vp_div_10;
				vm = vm_div_10;
				removed++;
			}
		}
		if (vr_is_trailing_zeros && (last_removed_digit == 5) && (vr % 2) == 0) {
			last_removed_digit = 4;
		}
		out = vr;
		if ((vr == vm && (!accept_bounds || !vm_is_trailing_zeros)) || last_removed_digit >= 5) {
			out++;
		}
	} else {
		bool round_up = false;
		while (vp / 100 > vm / 100) {
			round_up = (vr % 100) >= 50;
			vr /= 100;
			vp /= 100;
			vm /= 100;
			removed += 2;
		}
		while (vp / 10 > vm / 10) {
			round_up = (vr % 10) >= 5;
			vr /= 10;
			vp /= 10;
			vm /= 10;
			removed++;
		}
		out = vr + strconv__bool_to_u64(vr == vm || round_up);
	}
	return (strconv__Dec64){.m = out,.e = e10 + removed,};
}

string strconv__f64_to_str(f64 f, int n_digit) {
	strconv__Uf64 u1 = (strconv__Uf64){
#ifndef __cplusplus
0
#endif
};
	u1.f = f;
	u64 u = u1.u;
	bool neg = (u >> (_const_strconv__mantbits64 + _const_strconv__expbits64)) != 0;
	u64 mant = (u & ((((u64)(1)) << _const_strconv__mantbits64) - ((u64)(1))));
	u64 exp = ((u >> _const_strconv__mantbits64) & ((((u64)(1)) << _const_strconv__expbits64) - ((u64)(1))));
	if ((exp == _const_strconv__maxexp64) || (exp == 0 && mant == 0)) {
		return strconv__get_string_special(neg, exp == 0, mant == 0);
	}
	multi_return_strconv__Dec64_bool mr_9917 = strconv__f64_to_decimal_exact_int(mant, exp);
	strconv__Dec64 d = mr_9917.arg0;
	bool ok = mr_9917.arg1;
	if (!ok) {
		d = strconv__f64_to_decimal(mant, exp);
	}
	return strconv__Dec64_get_string_64(d, neg, n_digit, 0);
}

string strconv__f64_to_str_pad(f64 f, int n_digit) {
	strconv__Uf64 u1 = (strconv__Uf64){
#ifndef __cplusplus
0
#endif
};
	u1.f = f;
	u64 u = u1.u;
	bool neg = (u >> (_const_strconv__mantbits64 + _const_strconv__expbits64)) != 0;
	u64 mant = (u & ((((u64)(1)) << _const_strconv__mantbits64) - ((u64)(1))));
	u64 exp = ((u >> _const_strconv__mantbits64) & ((((u64)(1)) << _const_strconv__expbits64) - ((u64)(1))));
	if ((exp == _const_strconv__maxexp64) || (exp == 0 && mant == 0)) {
		return strconv__get_string_special(neg, exp == 0, mant == 0);
	}
	multi_return_strconv__Dec64_bool mr_10653 = strconv__f64_to_decimal_exact_int(mant, exp);
	strconv__Dec64 d = mr_10653.arg0;
	bool ok = mr_10653.arg1;
	if (!ok) {
		d = strconv__f64_to_decimal(mant, exp);
	}
	return strconv__Dec64_get_string_64(d, neg, n_digit, n_digit);
}

string strconv__f64_to_str_lnd(f64 f, int dec_digit) {
	string s = strconv__f64_to_str(f + (*(f64*)array_get(_const_strconv__dec_round, dec_digit)), 18);
	if (s.len > 2 && (string_at(s, 0) == 'n' || string_at(s, 1) == 'i')) {
		return s;
	}
	bool m_sgn_flag = false;
	int sgn = 1;
	array_fixed_byte_26 b = {0};
	int d_pos = 1;
	int i = 0;
	int i1 = 0;
	int exp = 0;
	int exp_sgn = 1;
	int dot_res_sp = -1;
	for (int _t9 = 0; _t9 < s.len; ++_t9) {
		byte c = s.str[_t9];
		if (c == '-') {
			sgn = -1;
			i++;
		} else if (c == '+') {
			sgn = 1;
			i++;
		} else if (c >= '0' && c <= '9') {
			b[i1++] = c;
			i++;
		} else if (c == '.') {
			if (sgn > 0) {
				d_pos = i;
			} else {
				d_pos = i - 1;
			}
			i++;
		} else if (c == 'e') {
			i++;
			break;
		} else {
			return tos_lit("[Float conversion error!!]");
		}
	}
	b[i1] = 0;
	if (string_at(s, i) == '-') {
		exp_sgn = -1;
		i++;
	} else if (string_at(s, i) == '+') {
		exp_sgn = 1;
		i++;
	}
	for (int _t10 = 0; _t10 < string_substr(s, i, s.len).len; ++_t10) {
		byte c = string_substr(s, i, s.len).str[_t10];
		exp = exp * 10 + ((int)(c - '0'));
	}
	array_byte res = array_repeat(new_array_from_c_array(1, 1, sizeof(byte), _MOV((byte[1]){'0'})), exp + 32);
	int r_i = 0;
	if (sgn == 1) {
		if (m_sgn_flag) {
			array_set(&res, r_i++, &(byte[]) { '+' });
		}
	} else {
		array_set(&res, r_i++, &(byte[]) { '-' });
	}
	i = 0;
	if (exp_sgn >= 0) {
		while (b[i] != 0) {
			array_set(&res, r_i++, &(byte[]) { b[i] });
			i++;
			if (i >= d_pos && exp >= 0) {
				if (exp == 0) {
					dot_res_sp = r_i;
					array_set(&res, r_i++, &(byte[]) { '.' });
				}
				exp--;
			}
		}
		while (exp >= 0) {
			array_set(&res, r_i++, &(byte[]) { '0' });
			exp--;
		}
	} else {
		bool dot_p = true;
		while (exp > 0) {
			array_set(&res, r_i++, &(byte[]) { '0' });
			exp--;
			if (dot_p) {
				dot_res_sp = r_i;
				array_set(&res, r_i++, &(byte[]) { '.' });
				dot_p = false;
			}
		}
		while (b[i] != 0) {
			array_set(&res, r_i++, &(byte[]) { b[i] });
			i++;
		}
	}
	if (dot_res_sp >= 0) {
		if ((r_i - dot_res_sp) > dec_digit) {
			r_i = dot_res_sp + dec_digit + 1;
		}
		array_set(&res, r_i, &(byte[]) { 0 });
		return tos(&(*(byte*)array_get(res, 0)), r_i);
	} else {
		if (dec_digit > 0) {
			int c = 0;
			array_set(&res, r_i++, &(byte[]) { '.' });
			while (c < dec_digit) {
				array_set(&res, r_i++, &(byte[]) { '0' });
				c++;
			}
			array_set(&res, r_i, &(byte[]) { 0 });
		}
		return tos(&(*(byte*)array_get(res, 0)), r_i);
	}
}

string strconv__format_str(string s, strconv__BF_param p) {
	int dif = p.len0 - s.len;
	if (dif <= 0) {
		return s;
	}
	strings__Builder res = strings__new_builder(s.len + dif);
	if (p.allign == strconv__Align_text_right) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	strings__Builder_write(&res, s);
	if (p.allign == strconv__Align_text_left) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	return strings__Builder_str(&res);
}

string strconv__format_dec(u64 d, strconv__BF_param p) {
	string s = tos_lit("");
	strings__Builder res = strings__new_builder(20);
	int sign_len_diff = 0;
	if (p.pad_ch == '0') {
		if (p.positive) {
			if (p.sign_flag) {
				strings__Builder_write_b(&res, '+');
				sign_len_diff = -1;
			}
		} else {
			strings__Builder_write_b(&res, '-');
			sign_len_diff = -1;
		}
		s = u64_str(d);
	} else {
		if (p.positive) {
			if (p.sign_flag) {
				s = string_add(tos_lit("+"), u64_str(d));
			} else {
				s = u64_str(d);
			}
		} else {
			s = string_add(tos_lit("-"), u64_str(d));
		}
	}
	int dif = p.len0 - s.len + sign_len_diff;
	if (p.allign == strconv__Align_text_right) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	strings__Builder_write(&res, s);
	if (p.allign == strconv__Align_text_left) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	return strings__Builder_str(&res);
}

string strconv__format_fl(f64 f, strconv__BF_param p) {
	string s = tos_lit("");
	string fs = strconv__f64_to_str_lnd((f >= 0.0 ? (f) : (-f)), p.len1);
	if (string_at(fs, 0) == '[') {
		return fs;
	}
	if (p.rm_tail_zero) {
		fs = strconv__remove_tail_zeros(fs);
	}
	strings__Builder res = strings__new_builder((p.len0 > fs.len ? (p.len0) : (fs.len)));
	int sign_len_diff = 0;
	if (p.pad_ch == '0') {
		if (p.positive) {
			if (p.sign_flag) {
				strings__Builder_write_b(&res, '+');
				sign_len_diff = -1;
			}
		} else {
			strings__Builder_write_b(&res, '-');
			sign_len_diff = -1;
		}
		s = fs;
	} else {
		if (p.positive) {
			if (p.sign_flag) {
				s = string_add(tos_lit("+"), fs);
			} else {
				s = fs;
			}
		} else {
			s = string_add(tos_lit("-"), fs);
		}
	}
	int dif = p.len0 - s.len + sign_len_diff;
	if (p.allign == strconv__Align_text_right) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	strings__Builder_write(&res, s);
	if (p.allign == strconv__Align_text_left) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	return strings__Builder_str(&res);
}

string strconv__format_es(f64 f, strconv__BF_param p) {
	string s = tos_lit("");
	string fs = strconv__f64_to_str_pad((f > 0 ? (f) : (-f)), p.len1);
	if (p.rm_tail_zero) {
		fs = strconv__remove_tail_zeros(fs);
	}
	strings__Builder res = strings__new_builder((p.len0 > fs.len ? (p.len0) : (fs.len)));
	int sign_len_diff = 0;
	if (p.pad_ch == '0') {
		if (p.positive) {
			if (p.sign_flag) {
				strings__Builder_write_b(&res, '+');
				sign_len_diff = -1;
			}
		} else {
			strings__Builder_write_b(&res, '-');
			sign_len_diff = -1;
		}
		s = fs;
	} else {
		if (p.positive) {
			if (p.sign_flag) {
				s = string_add(tos_lit("+"), fs);
			} else {
				s = fs;
			}
		} else {
			s = string_add(tos_lit("-"), fs);
		}
	}
	int dif = p.len0 - s.len + sign_len_diff;
	if (p.allign == strconv__Align_text_right) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	strings__Builder_write(&res, s);
	if (p.allign == strconv__Align_text_left) {
		for (int i1 = 0; i1 < dif; i1++) {
			strings__Builder_write_b(&res, p.pad_ch);
		}
	}
	return strings__Builder_str(&res);
}

string strconv__remove_tail_zeros(string s) {
	int i = 0;
	int last_zero_start = -1;
	int dot_pos = -1;
	bool in_decimal = false;
	byte prev_ch = ((byte)(0));
	while (i < s.len) {
		byte ch = s.str[i];
		if (ch == '.') {
			in_decimal = true;
			dot_pos = i;
		} else if (in_decimal) {
			if (ch == '0' && prev_ch != '0') {
				last_zero_start = i;
			} else if (ch >= '1' && ch <= '9') {
				last_zero_start = -1;
			} else if (ch == 'e') {
				break;
			}
		}
		prev_ch = ch;
		i++;
	}
	string tmp = tos_lit("");
	if (last_zero_start > 0) {
		if (last_zero_start == dot_pos + 1) {
			tmp = string_add(string_substr(s, 0, dot_pos), string_substr(s, i, s.len));
		} else {
			tmp = string_add(string_substr(s, 0, last_zero_start), string_substr(s, i, s.len));
		}
	} else {
		tmp = s;
	}
	if (tmp.str[tmp.len - 1] == '.') {
		return string_substr(tmp, 0, tmp.len - 1);
	}
	return tmp;
}

void strconv__v_printf(string str, varg_voidptr pt) {
	print(strconv__v_sprintf(str, pt));
}

string strconv__v_sprintf(string str, varg_voidptr pt) {
	strings__Builder res = strings__new_builder(pt.len * 16);
	int i = 0;
	int p_index = 0;
	bool sign = false;
	strconv__Align_text allign = strconv__Align_text_right;
	int len0 = -1;
	int len1 = -1;
	int def_len1 = 6;
	byte pad_ch = ' ';
	bool th_separator = false;
	byte ch1 = '0';
	byte ch2 = '0';
	strconv__Char_parse_state status = strconv__Char_parse_state_norm_char;
	while (i < str.len) {
		if (status == strconv__Char_parse_state_reset_params) {
			sign = false;
			allign = strconv__Align_text_right;
			len0 = -1;
			len1 = -1;
			pad_ch = ' ';
			th_separator = false;
			status = strconv__Char_parse_state_norm_char;
			ch1 = '0';
			ch2 = '0';
			continue;
		}
		byte ch = string_at(str, i);
		if (ch != '%' && status == strconv__Char_parse_state_norm_char) {
			strings__Builder_write_b(&res, ch);
			i++;
			continue;
		}
		if (ch == '%' && status == strconv__Char_parse_state_norm_char) {
			status = strconv__Char_parse_state_field_char;
			i++;
			continue;
		}
		if (ch == 'c' && status == strconv__Char_parse_state_field_char) {
			byte d1 = *(((byte*)(pt.args[p_index])));
			strings__Builder_write_b(&res, d1);
			status = strconv__Char_parse_state_reset_params;
			p_index++;
			i++;
			continue;
		}
		if (ch == 'p' && status == strconv__Char_parse_state_field_char) {
			strings__Builder_write(&res, tos_lit("0x"));
			strings__Builder_write(&res, ptr_str(pt.args[p_index]));
			status = strconv__Char_parse_state_reset_params;
			p_index++;
			i++;
			continue;
		}
		if (status == strconv__Char_parse_state_field_char) {
			byte fc_ch1 = '0';
			byte fc_ch2 = '0';
			if ((i + 1) < str.len) {
				fc_ch1 = string_at(str, i + 1);
				if ((i + 2) < str.len) {
					fc_ch2 = string_at(str, i + 2);
				}
			}
			if (ch == '+') {
				sign = true;
				i++;
				continue;
			} else if (ch == '-') {
				allign = strconv__Align_text_left;
				i++;
				continue;
			} else if ((ch == '0' || ch == ' ')) {
				if (allign == strconv__Align_text_right) {
					pad_ch = ch;
				}
				i++;
				continue;
			} else if (ch == '\'') {
				th_separator = true;
				i++;
				continue;
			} else if (ch == '.' && fc_ch1 >= '1' && fc_ch1 <= '9') {
				status = strconv__Char_parse_state_check_float;
				i++;
				continue;
			} else if (ch == '.' && fc_ch1 == '*' && fc_ch2 == 's') {
				int len = *(((int*)(pt.args[p_index])));
				p_index++;
				string s = *(((string*)(pt.args[p_index])));
				s = string_substr(s, 0, len);
				p_index++;
				strings__Builder_write(&res, s);
				status = strconv__Char_parse_state_reset_params;
				i += 3;
				continue;
			}
			status = strconv__Char_parse_state_len_set_start;
			continue;
		}
		if (status == strconv__Char_parse_state_len_set_start) {
			if (ch >= '1' && ch <= '9') {
				len0 = ((int)(ch - '0'));
				status = strconv__Char_parse_state_len_set_in;
				i++;
				continue;
			}
			if (ch == '.') {
				status = strconv__Char_parse_state_check_float;
				i++;
				continue;
			}
			status = strconv__Char_parse_state_check_type;
			continue;
		}
		if (status == strconv__Char_parse_state_len_set_in) {
			if (ch >= '0' && ch <= '9') {
				len0 *= 10;
				len0 += ((int)(ch - '0'));
				i++;
				continue;
			}
			if (ch == '.') {
				status = strconv__Char_parse_state_check_float;
				i++;
				continue;
			}
			status = strconv__Char_parse_state_check_type;
			continue;
		}
		if (status == strconv__Char_parse_state_check_float) {
			if (ch >= '0' && ch <= '9') {
				len1 = ((int)(ch - '0'));
				status = strconv__Char_parse_state_check_float_in;
				i++;
				continue;
			}
			status = strconv__Char_parse_state_check_type;
			continue;
		}
		if (status == strconv__Char_parse_state_check_float_in) {
			if (ch >= '0' && ch <= '9') {
				len1 *= 10;
				len1 += ((int)(ch - '0'));
				i++;
				continue;
			}
			status = strconv__Char_parse_state_check_type;
			continue;
		}
		if (status == strconv__Char_parse_state_check_type) {
			if (ch == 'l') {
				if (ch1 == '0') {
					ch1 = 'l';
					i++;
					continue;
				} else {
					ch2 = 'l';
					i++;
					continue;
				}
			} else if (ch == 'h') {
				if (ch1 == '0') {
					ch1 = 'h';
					i++;
					continue;
				} else {
					ch2 = 'h';
					i++;
					continue;
				}
			} else if ((ch == 'd' || ch == 'i')) {
				u64 d1 = ((u64)(0));
				bool positive = true;
				if (ch1 == 'h') {
					if (ch2 == 'h') {
						i8 x = *(((i8*)(pt.args[p_index])));
						positive = (x >= 0 ? (true) : (false));
						d1 = (positive ? (((u64)(x))) : (((u64)(-x))));
					} else {
						i16 x = *(((i16*)(pt.args[p_index])));
						positive = (x >= 0 ? (true) : (false));
						d1 = (positive ? (((u64)(x))) : (((u64)(-x))));
					}
				} else if (ch1 == 'l') {
					i64 x = *(((i64*)(pt.args[p_index])));
					positive = (x >= 0 ? (true) : (false));
					d1 = (positive ? (((u64)(x))) : (((u64)(-x))));
				} else {
					int x = *(((int*)(pt.args[p_index])));
					positive = (x >= 0 ? (true) : (false));
					d1 = (positive ? (((u64)(x))) : (((u64)(-x))));
				};
				strings__Builder_write(&res, strconv__format_dec(d1, (strconv__BF_param){
					.pad_ch = pad_ch,
					.len0 = len0,
					.len1 = 0,
					.positive = positive,
					.sign_flag = sign,
					.allign = allign,
					.rm_tail_zero = false,
				}));
				status = strconv__Char_parse_state_reset_params;
				p_index++;
				i++;
				ch1 = '0';
				ch2 = '0';
				continue;
			} else if (ch == 'u') {
				u64 d1 = ((u64)(0));
				bool positive = true;
				if (ch1 == 'h') {
					if (ch2 == 'h') {
						d1 = ((u64)(*(((byte*)(pt.args[p_index])))));
					} else {
						d1 = ((u64)(*(((u16*)(pt.args[p_index])))));
					}
				} else if (ch1 == 'l') {
					d1 = ((u64)(*(((u64*)(pt.args[p_index])))));
				} else {
					d1 = ((u64)(*(((u32*)(pt.args[p_index])))));
				};
				strings__Builder_write(&res, strconv__format_dec(d1, (strconv__BF_param){
					.pad_ch = pad_ch,
					.len0 = len0,
					.len1 = 0,
					.positive = positive,
					.sign_flag = sign,
					.allign = allign,
					.rm_tail_zero = false,
				}));
				status = strconv__Char_parse_state_reset_params;
				p_index++;
				i++;
				continue;
			} else if ((ch == 'x' || ch == 'X')) {
				string s = tos_lit("");
				if (ch1 == 'h') {
					if (ch2 == 'h') {
						i8 x = *(((i8*)(pt.args[p_index])));
						s = i8_hex(x);
					} else {
						i16 x = *(((i16*)(pt.args[p_index])));
						s = i16_hex(x);
					}
				} else if (ch1 == 'l') {
					i64 x = *(((i64*)(pt.args[p_index])));
					s = i64_hex(x);
				} else {
					int x = *(((int*)(pt.args[p_index])));
					s = int_hex(x);
				};
				if (ch == 'X') {
					s = string_to_upper(s);
				}
				strings__Builder_write(&res, strconv__format_str(s, (strconv__BF_param){
					.pad_ch = pad_ch,
					.len0 = len0,
					.len1 = 0,
					.positive = true,
					.sign_flag = false,
					.allign = allign,
					.rm_tail_zero = false,
				}));
				status = strconv__Char_parse_state_reset_params;
				p_index++;
				i++;
				continue;
			}
			if ((ch == 'f' || ch == 'F')) {
				f64 x = *(((f64*)(pt.args[p_index])));
				bool positive = x >= ((f64)(0.0));
				len1 = (len1 >= 0 ? (len1) : (def_len1));
				string s = strconv__format_fl(((f64)(x)), (strconv__BF_param){
					.pad_ch = pad_ch,
					.len0 = len0,
					.len1 = len1,
					.positive = positive,
					.sign_flag = sign,
					.allign = allign,
					.rm_tail_zero = false,
				});
				strings__Builder_write(&res, (ch == 'F' ? (string_to_upper(s)) : (s)));
				status = strconv__Char_parse_state_reset_params;
				p_index++;
				i++;
				continue;
			} else if ((ch == 'e' || ch == 'E')) {
				f64 x = *(((f64*)(pt.args[p_index])));
				bool positive = x >= ((f64)(0.0));
				len1 = (len1 >= 0 ? (len1) : (def_len1));
				string s = strconv__format_es(((f64)(x)), (strconv__BF_param){
					.pad_ch = pad_ch,
					.len0 = len0,
					.len1 = len1,
					.positive = positive,
					.sign_flag = sign,
					.allign = allign,
					.rm_tail_zero = false,
				});
				strings__Builder_write(&res, (ch == 'E' ? (string_to_upper(s)) : (s)));
				status = strconv__Char_parse_state_reset_params;
				p_index++;
				i++;
				continue;
			} else if ((ch == 'g' || ch == 'G')) {
				f64 x = *(((f64*)(pt.args[p_index])));
				bool positive = x >= ((f64)(0.0));
				string s = tos_lit("");
				f64 tx = strconv__fabs(x);
				if (tx < 999999.0 && tx >= 0.00001) {
					len1 = (len1 >= 0 ? (len1 + 1) : (def_len1));
					s = strconv__format_fl(x, (strconv__BF_param){
						.pad_ch = pad_ch,
						.len0 = len0,
						.len1 = len1,
						.positive = positive,
						.sign_flag = sign,
						.allign = allign,
						.rm_tail_zero = true,
					});
				} else {
					len1 = (len1 >= 0 ? (len1 + 1) : (def_len1));
					s = strconv__format_es(x, (strconv__BF_param){
						.pad_ch = pad_ch,
						.len0 = len0,
						.len1 = len1,
						.positive = positive,
						.sign_flag = sign,
						.allign = allign,
						.rm_tail_zero = true,
					});
				}
				strings__Builder_write(&res, (ch == 'G' ? (string_to_upper(s)) : (s)));
				status = strconv__Char_parse_state_reset_params;
				p_index++;
				i++;
				continue;
			} else if (ch == 's') {
				string s1 = *(((string*)(pt.args[p_index])));
				pad_ch = ' ';
				strings__Builder_write(&res, strconv__format_str(s1, (strconv__BF_param){
					.pad_ch = pad_ch,
					.len0 = len0,
					.len1 = 0,
					.positive = true,
					.sign_flag = false,
					.allign = allign,
					.rm_tail_zero = false,
				}));
				status = strconv__Char_parse_state_reset_params;
				p_index++;
				i++;
				continue;
			}
		}
		status = strconv__Char_parse_state_reset_params;
		p_index++;
		i++;
	}
	return strings__Builder_str(&res);
}

static f64 strconv__fabs(f64 x) {
	if (x < 0.0) {
		return -x;
	}
	return x;
}

// Attr: [inline]
inline string strconv__ftoa_64(f64 f) {
	return strconv__f64_to_str(f, 17);
}

// Attr: [inline]
inline string strconv__ftoa_long_64(f64 f) {
	return strconv__f64_to_str_l(f);
}

// Attr: [inline]
inline string strconv__ftoa_32(f32 f) {
	return strconv__f32_to_str(f, 8);
}

// Attr: [inline]
inline string strconv__ftoa_long_32(f32 f) {
	return strconv__f32_to_str_l(f);
}

static void strconv__assert1(bool t, string msg) {
	if (!t) {
		v_panic(msg);
	}
}

// Attr: [inline]
inline static int strconv__bool_to_int(bool b) {
	if (b) {
		return 1;
	}
	return 0;
}

// Attr: [inline]
inline static u32 strconv__bool_to_u32(bool b) {
	if (b) {
		return ((u32)(1));
	}
	return ((u32)(0));
}

// Attr: [inline]
inline static u64 strconv__bool_to_u64(bool b) {
	if (b) {
		return ((u64)(1));
	}
	return ((u64)(0));
}

static string strconv__get_string_special(bool neg, bool expZero, bool mantZero) {
	if (!mantZero) {
		return tos_lit("nan");
	}
	if (!expZero) {
		if (neg) {
			return tos_lit("-inf");
		} else {
			return tos_lit("+inf");
		}
	}
	if (neg) {
		return tos_lit("-0e+00");
	}
	return tos_lit("0e+00");
}

static int strconv__decimal_len_32(u32 u) {
	strconv__assert1(u < 1000000000, tos_lit("too big"));
	if (u >= 100000000) {
		return 9;
	} else if (u >= 10000000) {
		return 8;
	} else if (u >= 1000000) {
		return 7;
	} else if (u >= 100000) {
		return 6;
	} else if (u >= 10000) {
		return 5;
	} else if (u >= 1000) {
		return 4;
	} else if (u >= 100) {
		return 3;
	} else if (u >= 10) {
		return 2;
	}
	return 1;
}

static u32 strconv__mul_shift_32(u32 m, u64 mul, int ishift) {
	multi_return_u64_u64 mr_1854 = math__bits__mul_64(((u64)(m)), mul);
	u64 hi = mr_1854.arg0;
	u64 lo = mr_1854.arg1;
	u64 shifted_sum = (lo >> ((u64)(ishift))) + (hi << ((u64)(64 - ishift)));
	strconv__assert1(shifted_sum <= 2147483647, tos_lit("shiftedSum <= math.max_u32"));
	return ((u32)(shifted_sum));
}

static u32 strconv__mul_pow5_invdiv_pow2(u32 m, u32 q, int j) {
	return strconv__mul_shift_32(m, (*(u64*)array_get(_const_strconv__pow5_inv_split_32, q)), j);
}

static u32 strconv__mul_pow5_div_pow2(u32 m, u32 i, int j) {
	return strconv__mul_shift_32(m, (*(u64*)array_get(_const_strconv__pow5_split_32, i)), j);
}

static u32 strconv__pow5_factor_32(u32 i_v) {
	u32 v = i_v;
	for (u32 n = ((u32)(0)); ; n++) {
		u32 q = v / 5;
		u32 r = v % 5;
		if (r != 0) {
			return n;
		}
		v = q;
	}
	return v;
}

static bool strconv__multiple_of_power_of_five_32(u32 v, u32 p) {
	return strconv__pow5_factor_32(v) >= p;
}

static bool strconv__multiple_of_power_of_two_32(u32 v, u32 p) {
	return ((u32)(math__bits__trailing_zeros_32(v))) >= p;
}

static u32 strconv__log10_pow2(int e) {
	strconv__assert1(e >= 0, tos_lit("e >= 0"));
	strconv__assert1(e <= 1650, tos_lit("e <= 1650"));
	return (((u32)(e)) * 78913) >> 18;
}

static u32 strconv__log10_pow5(int e) {
	strconv__assert1(e >= 0, tos_lit("e >= 0"));
	strconv__assert1(e <= 2620, tos_lit("e <= 2620"));
	return (((u32)(e)) * 732923) >> 20;
}

static int strconv__pow5_bits(int e) {
	strconv__assert1(e >= 0, tos_lit("e >= 0"));
	strconv__assert1(e <= 3528, tos_lit("e <= 3528"));
	return ((int)(((((u32)(e)) * 1217359) >> 19) + 1));
}

static int strconv__decimal_len_64(u64 u) {
	int log2 = 64 - math__bits__leading_zeros_64(u) - 1;
	int t = (log2 + 1) * 1233 >> 12;
	return t - strconv__bool_to_int(u < (*(u64*)array_get(_const_strconv__powers_of_10, t))) + 1;
}

static u64 strconv__shift_right_128(strconv__Uint128 v, int shift) {
	strconv__assert1(shift < 64, tos_lit("shift < 64"));
	return ((v.hi << ((u64)(64 - shift))) | (v.lo >> ((u32)(shift))));
}

static u64 strconv__mul_shift_64(u64 m, strconv__Uint128 mul, int shift) {
	multi_return_u64_u64 mr_4387 = math__bits__mul_64(m, mul.hi);
	u64 hihi = mr_4387.arg0;
	u64 hilo = mr_4387.arg1;
	multi_return_u64_u64 mr_4425 = math__bits__mul_64(m, mul.lo);
	u64 lohi = mr_4425.arg0;
	strconv__Uint128 sum = (strconv__Uint128){.lo = lohi + hilo,.hi = hihi,};
	if (sum.lo < lohi) {
		sum.hi++;
	}
	return strconv__shift_right_128(sum, shift - 64);
}

static u32 strconv__pow5_factor_64(u64 v_i) {
	u64 v = v_i;
	for (u32 n = ((u32)(0)); ; n++) {
		u64 q = v / 5;
		u64 r = v % 5;
		if (r != 0) {
			return n;
		}
		v = q;
	}
	return ((u32)(0));
}

static bool strconv__multiple_of_power_of_five_64(u64 v, u32 p) {
	return strconv__pow5_factor_64(v) >= p;
}

static bool strconv__multiple_of_power_of_two_64(u64 v, u32 p) {
	return ((u32)(math__bits__trailing_zeros_64(v))) >= p;
}

string strconv__f32_to_str_l(f64 f) {
	return strconv__f64_to_str_l(((f32)(f)));
}

string strconv__f64_to_str_l(f64 f) {
	string s = strconv__f64_to_str(f, 18);
	if (s.len > 2 && (string_at(s, 0) == 'n' || string_at(s, 1) == 'i')) {
		return s;
	}
	bool m_sgn_flag = false;
	int sgn = 1;
	array_fixed_byte_26 b = {0};
	int d_pos = 1;
	int i = 0;
	int i1 = 0;
	int exp = 0;
	int exp_sgn = 1;
	for (int _t14 = 0; _t14 < s.len; ++_t14) {
		byte c = s.str[_t14];
		if (c == '-') {
			sgn = -1;
			i++;
		} else if (c == '+') {
			sgn = 1;
			i++;
		} else if (c >= '0' && c <= '9') {
			b[i1++] = c;
			i++;
		} else if (c == '.') {
			if (sgn > 0) {
				d_pos = i;
			} else {
				d_pos = i - 1;
			}
			i++;
		} else if (c == 'e') {
			i++;
			break;
		} else {
			return tos_lit("Float conversion error!!");
		}
	}
	b[i1] = 0;
	if (string_at(s, i) == '-') {
		exp_sgn = -1;
		i++;
	} else if (string_at(s, i) == '+') {
		exp_sgn = 1;
		i++;
	}
	for (int _t15 = 0; _t15 < string_substr(s, i, s.len).len; ++_t15) {
		byte c = string_substr(s, i, s.len).str[_t15];
		exp = exp * 10 + ((int)(c - '0'));
	}
	array_byte res = array_repeat(new_array_from_c_array(1, 1, sizeof(byte), _MOV((byte[1]){'0'})), exp + 32);
	int r_i = 0;
	if (sgn == 1) {
		if (m_sgn_flag) {
			array_set(&res, r_i++, &(byte[]) { '+' });
		}
	} else {
		array_set(&res, r_i++, &(byte[]) { '-' });
	}
	i = 0;
	if (exp_sgn >= 0) {
		while (b[i] != 0) {
			array_set(&res, r_i++, &(byte[]) { b[i] });
			i++;
			if (i >= d_pos && exp >= 0) {
				if (exp == 0) {
					array_set(&res, r_i++, &(byte[]) { '.' });
				}
				exp--;
			}
		}
		while (exp >= 0) {
			array_set(&res, r_i++, &(byte[]) { '0' });
			exp--;
		}
	} else {
		bool dot_p = true;
		while (exp > 0) {
			array_set(&res, r_i++, &(byte[]) { '0' });
			exp--;
			if (dot_p) {
				array_set(&res, r_i++, &(byte[]) { '.' });
				dot_p = false;
			}
		}
		while (b[i] != 0) {
			array_set(&res, r_i++, &(byte[]) { b[i] });
			i++;
		}
	}
	array_set(&res, r_i, &(byte[]) { 0 });
	return tos(&(*(byte*)array_get(res, 0)), r_i);
}

static array __new_array(int mylen, int cap, int elm_size) {
	int cap_ = (cap < mylen ? (mylen) : (cap));
	array arr = (array){.element_size = elm_size,.data = vcalloc(cap_ * elm_size),.len = mylen,.cap = cap_,};
	return arr;
}

static array __new_array_with_default(int mylen, int cap, int elm_size, voidptr val) {
	int cap_ = (cap < mylen ? (mylen) : (cap));
	array arr = (array){.element_size = elm_size,.data = vcalloc(cap_ * elm_size),.len = mylen,.cap = cap_,};
	if (val != 0) {
		for (int i = 0; i < arr.len; ++i) {
			{ // Unsafe block
				array_set_unsafe(&arr, i, val);
			}
		}
	}
	return arr;
}

static array __new_array_with_array_default(int mylen, int cap, int elm_size, array val) {
	int cap_ = (cap < mylen ? (mylen) : (cap));
	array arr = (array){.element_size = elm_size,.data = vcalloc(cap_ * elm_size),.len = mylen,.cap = cap_,};
	for (int i = 0; i < arr.len; ++i) {
		array val_clone = array_clone(&val);
		{ // Unsafe block
			array_set_unsafe(&arr, i, &val_clone);
		}
	}
	return arr;
}

static array new_array_from_c_array(int len, int cap, int elm_size, voidptr c_array) {
	int cap_ = (cap < len ? (len) : (cap));
	array arr = (array){.element_size = elm_size,.data = vcalloc(cap_ * elm_size),.len = len,.cap = cap_,};
	{ // Unsafe block
		memcpy(arr.data, c_array, len * elm_size);
	}
	return arr;
}

static array new_array_from_c_array_no_alloc(int len, int cap, int elm_size, voidptr c_array) {
	array arr = (array){.element_size = elm_size,.data = c_array,.len = len,.cap = cap,};
	return arr;
}

// Attr: [inline]
inline static void array_ensure_cap(array* a, int required) {
	if (required <= a->cap) {
		return;
	}
	int cap = (a->cap == 0 ? (2) : (a->cap * 2));
	while (required > cap) {
		cap *= 2;
	}
	if (a->cap == 0) {
		a->data = vcalloc(cap * a->element_size);
	} else {
		a->data = v_realloc(a->data, ((u32)(cap * a->element_size)));
	}
	a->cap = cap;
}

array array_repeat(array a, int count) {
	if (count < 0) {
		v_panic(_STR("array.repeat: count is negative: %"PRId32"", 1, count));
	}
	int size = count * a.len * a.element_size;
	if (size == 0) {
		size = a.element_size;
	}
	array arr = (array){.element_size = a.element_size,.data = vcalloc(size),.len = count * a.len,.cap = count * a.len,};
	for (int i = 0; i < count; ++i) {
		if (a.len > 0 && _us32_eq(/*SizeOfType*/ sizeof(struct array),a.element_size)) {
			array ary = (array){.element_size = 0,.data = 0,.len = 0,.cap = 0,};
			{ // Unsafe block
				memcpy(&ary, a.data, /*SizeOfType*/ sizeof(struct array));
			}
			array ary_clone = array_clone(&ary);
			{ // Unsafe block
				memcpy(array_get_unsafe(arr, i * a.len), &ary_clone, a.len * a.element_size);
			}
		} else {
			{ // Unsafe block
				memcpy(array_get_unsafe(arr, i * a.len), ((byteptr)(a.data)), a.len * a.element_size);
			}
		}
	}
	return arr;
}

void array_sort_with_compare(array* a, voidptr compare) {
	qsort(a->data, a->len, a->element_size, compare);
}

void array_insert(array* a, int i, voidptr val) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (i < 0 || i > a->len) {
		v_panic(_STR("array.insert: index out of range (i == %"PRId32"\000, a.len == %"PRId32"\000)", 3, i, a->len));
	}
#endif
// } no_bounds_checking
	array_ensure_cap(a, a->len + 1);
	{ // Unsafe block
		memmove(array_get_unsafe(/*rec*/*a, i + 1), array_get_unsafe(/*rec*/*a, i), (a->len - i) * a->element_size);
		array_set_unsafe(a, i, val);
	}
	a->len++;
}

void array_insert_many(array* a, int i, voidptr val, int size) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (i < 0 || i > a->len) {
		v_panic(_STR("array.insert_many: index out of range (i == %"PRId32"\000, a.len == %"PRId32"\000)", 3, i, a->len));
	}
#endif
// } no_bounds_checking
	array_ensure_cap(a, a->len + size);
	int elem_size = a->element_size;
	{ // Unsafe block
		voidptr iptr = array_get_unsafe(/*rec*/*a, i);
		memmove(array_get_unsafe(/*rec*/*a, i + size), iptr, (a->len - i) * elem_size);
		memcpy(iptr, val, size * elem_size);
	}
	a->len += size;
}

void array_prepend(array* a, voidptr val) {
	array_insert(a, 0, val);
}

void array_prepend_many(array* a, voidptr val, int size) {
	array_insert_many(a, 0, val, size);
}

void array_delete(array* a, int i) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (i < 0 || i >= a->len) {
		v_panic(_STR("array.delete: index out of range (i == %"PRId32"\000, a.len == %"PRId32"\000)", 3, i, a->len));
	}
#endif
// } no_bounds_checking
	{ // Unsafe block
		memmove(array_get_unsafe(/*rec*/*a, i), array_get_unsafe(/*rec*/*a, i + 1), (a->len - i - 1) * a->element_size);
	}
	a->len--;
}

void array_clear(array* a) {
	a->len = 0;
}

void array_trim(array* a, int index) {
	if (index < a->len) {
		a->len = index;
	}
}

// Attr: [inline]
// Attr: [unsafe_fn]
inline static voidptr array_get_unsafe(array a, int i) {
	{ // Unsafe block
		return ((byteptr)(a.data)) + i * a.element_size;
	}
}

static voidptr array_get(array a, int i) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (i < 0 || i >= a.len) {
		v_panic(_STR("array.get: index out of range (i == %"PRId32"\000, a.len == %"PRId32"\000)", 3, i, a.len));
	}
#endif
// } no_bounds_checking
	{ // Unsafe block
		return ((byteptr)(a.data)) + i * a.element_size;
	}
}

voidptr array_first(array a) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (a.len == 0) {
		v_panic(tos_lit("array.first: array is empty"));
	}
#endif
// } no_bounds_checking
	return a.data;
}

voidptr array_last(array a) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (a.len == 0) {
		v_panic(tos_lit("array.last: array is empty"));
	}
#endif
// } no_bounds_checking
	{ // Unsafe block
		return ((byteptr)(a.data)) + (a.len - 1) * a.element_size;
	}
}

voidptr array_pop(array* a) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (a->len == 0) {
		v_panic(tos_lit("array.pop: array is empty"));
	}
#endif
// } no_bounds_checking
	int new_len = a->len - 1;
	byteptr last_elem = ((byteptr)(a->data)) + (new_len) * a->element_size;
	a->len = new_len;
	return memdup(last_elem, a->element_size);
}

static array array_slice(array a, int start, int _end) {
	int end = _end;
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (start > end) {
		v_panic(_STR("array.slice: invalid slice index (%"PRId32"\000 > %"PRId32"\000)", 3, start, end));
	}
	if (end > a.len) {
		v_panic(_STR("array.slice: slice bounds out of range (%"PRId32"\000 >= %"PRId32"\000)", 3, end, a.len));
	}
	if (start < 0) {
		v_panic(_STR("array.slice: slice bounds out of range (%"PRId32"\000 < 0)", 2, start));
	}
#endif
// } no_bounds_checking
	byteptr data = ((byteptr)(0));
	{ // Unsafe block
		data = ((byteptr)(a.data)) + start * a.element_size;
	}
	int l = end - start;
	array res = (array){.element_size = a.element_size,.data = data,.len = l,.cap = l,};
	return res;
}

static array array_slice2(array a, int start, int _end, bool end_max) {
	int end = (end_max ? (a.len) : (_end));
	return array_slice(a, start, end);
}

static array array_clone_static(array a) {
	return array_clone(&a);
}

array array_clone(array* a) {
	int size = a->cap * a->element_size;
	if (size == 0) {
		size++;
	}
	array arr = (array){.element_size = a->element_size,.data = vcalloc(size),.len = a->len,.cap = a->cap,};
	if (_us32_eq(/*SizeOfType*/ sizeof(struct array),a->element_size)) {
		for (int i = 0; i < a->len; ++i) {
			array ar = (array){.element_size = 0,.data = 0,.len = 0,.cap = 0,};
			{ // Unsafe block
				memcpy(&ar, array_get_unsafe(/*rec*/*a, i), /*SizeOfType*/ sizeof(struct array));
			}
			array ar_clone = array_clone(&ar);
			{ // Unsafe block
				array_set_unsafe(&arr, i, &ar_clone);
			}
		}
	} else {
		{ // Unsafe block
			memcpy(((byteptr)(arr.data)), a->data, a->cap * a->element_size);
		}
	}
	return arr;
}

static array array_slice_clone(array* a, int start, int _end) {
	int end = _end;
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (start > end) {
		v_panic(_STR("array.slice: invalid slice index (%"PRId32"\000 > %"PRId32"\000)", 3, start, end));
	}
	if (end > a->len) {
		v_panic(_STR("array.slice: slice bounds out of range (%"PRId32"\000 >= %"PRId32"\000)", 3, end, a->len));
	}
	if (start < 0) {
		v_panic(_STR("array.slice: slice bounds out of range (%"PRId32"\000 < 0)", 2, start));
	}
#endif
// } no_bounds_checking
	byteptr data = ((byteptr)(0));
	{ // Unsafe block
		data = ((byteptr)(a->data)) + start * a->element_size;
	}
	int l = end - start;
	array res = (array){.element_size = a->element_size,.data = data,.len = l,.cap = l,};
	return array_clone(&res);
}

// Attr: [inline]
// Attr: [unsafe_fn]
inline static void array_set_unsafe(array* a, int i, voidptr val) {
	{ // Unsafe block
		memcpy(((byteptr)(a->data)) + a->element_size * i, val, a->element_size);
	}
}

static void array_set(array* a, int i, voidptr val) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (i < 0 || i >= a->len) {
		v_panic(_STR("array.set: index out of range (i == %"PRId32"\000, a.len == %"PRId32"\000)", 3, i, a->len));
	}
#endif
// } no_bounds_checking
	{ // Unsafe block
		memcpy(((byteptr)(a->data)) + a->element_size * i, val, a->element_size);
	}
}

static void array_push(array* a, voidptr val) {
	array_ensure_cap(a, a->len + 1);
	{ // Unsafe block
		memcpy(((byteptr)(a->data)) + a->element_size * a->len, val, a->element_size);
	}
	a->len++;
}

void array_push_many(array* a3, voidptr val, int size) {
	if (a3->data == val) {
		array copy = array_clone(a3);
		array_ensure_cap(a3, a3->len + size);
		{ // Unsafe block
			memcpy(array_get_unsafe(/*rec*/*a3, a3->len), copy.data, a3->element_size * size);
		}
	} else {
		array_ensure_cap(a3, a3->len + size);
		{ // Unsafe block
			memcpy(array_get_unsafe(/*rec*/*a3, a3->len), val, a3->element_size * size);
		}
	}
	a3->len += size;
}

void array_reverse_in_place(array* a) {
	if (a->len < 2) {
		return;
	}
	{ // Unsafe block
		byteptr tmp_value = v_malloc(a->element_size);
		for (int i = 0; i < a->len / 2; ++i) {
			memcpy(tmp_value, ((byteptr)(a->data)) + i * a->element_size, a->element_size);
			memcpy(((byteptr)(a->data)) + i * a->element_size, ((byteptr)(a->data)) + (a->len - 1 - i) * a->element_size, a->element_size);
			memcpy(((byteptr)(a->data)) + (a->len - 1 - i) * a->element_size, tmp_value, a->element_size);
		}
		v_free(tmp_value);
	}
}

array array_reverse(array a) {
	if (a.len < 2) {
		return a;
	}
	array arr = (array){.element_size = a.element_size,.data = vcalloc(a.cap * a.element_size),.len = a.len,.cap = a.cap,};
	for (int i = 0; i < a.len; ++i) {
		{ // Unsafe block
			array_set_unsafe(&arr, i, array_get_unsafe(a, a.len - 1 - i));
		}
	}
	return arr;
}

// Attr: [unsafe_fn]
void array_free(array* a) {
// $if  prealloc {
#ifdef _VPREALLOC
	return;
#endif
// } prealloc
	free(a->data);
}

string array_string_str(array_string a) {
	strings__Builder sb = strings__new_builder(a.len * 3);
	strings__Builder_write(&sb, tos_lit("["));
	for (int i = 0; i < a.len; ++i) {
		string val = (*(string*)array_get(a, i));
		strings__Builder_write(&sb, tos_lit("\'"));
		strings__Builder_write(&sb, val);
		strings__Builder_write(&sb, tos_lit("\'"));
		if (i < a.len - 1) {
			strings__Builder_write(&sb, tos_lit(", "));
		}
	}
	strings__Builder_write(&sb, tos_lit("]"));
	return strings__Builder_str(&sb);
}

string array_byte_hex(array_byte b) {
	byteptr hex = v_malloc(b.len * 2 + 1);
	int dst_i = 0;
	// FOR IN array
	array _t16 = b;
	for (int _t17 = 0; _t17 < _t16.len; ++_t17) {
		byte i = ((byte*)_t16.data)[_t17];
		byte n0 = i >> 4;
		{ // Unsafe block
			hex[dst_i++] = (n0 < 10 ? (n0 + '0') : (n0 + ((byte)(87))));
		}
		byte n1 = (i & 0xF);
		{ // Unsafe block
			hex[dst_i++] = (n1 < 10 ? (n1 + '0') : (n1 + ((byte)(87))));
		}
	}
	{ // Unsafe block
		hex[dst_i] = '\0';
		return tos(hex, dst_i);
	}
}

int copy(array_byte dst, array_byte src) {
	if (dst.len > 0 && src.len > 0) {
		int min = 0;
		min = (dst.len < src.len ? (dst.len) : (src.len));
		{ // Unsafe block
			memcpy(((byteptr)(dst.data)), array_slice(src, 0, min).data, dst.element_size * min);
		}
		return min;
	}
	return 0;
}

static int compare_ints(int* a, int* b) {
	if (*a < *b) {
		return -1;
	}
	if (*a > *b) {
		return 1;
	}
	return 0;
}

void array_int_sort(array_int* a) {
	array_sort_with_compare(a, compare_ints);
}

int array_string_index(array_string a, string v) {
	for (int i = 0; i < a.len; ++i) {
		if (string_eq((*(string*)array_get(a, i)), v)) {
			return i;
		}
	}
	return -1;
}

int array_int_index(array_int a, int v) {
	for (int i = 0; i < a.len; ++i) {
		if ((*(int*)array_get(a, i)) == v) {
			return i;
		}
	}
	return -1;
}

int array_byte_index(array_byte a, byte v) {
	for (int i = 0; i < a.len; ++i) {
		if ((*(byte*)array_get(a, i)) == v) {
			return i;
		}
	}
	return -1;
}

int array_char_index(array_char a, char v) {
	for (int i = 0; i < a.len; ++i) {
		if ((*(char*)array_get(a, i)) == v) {
			return i;
		}
	}
	return -1;
}

int array_int_reduce(array_int a, int (*iter)(int accum, int curr), int accum_start) {
	int accum_ = accum_start;
	// FOR IN array
	array _t18 = a;
	for (int _t19 = 0; _t19 < _t18.len; ++_t19) {
		int i = ((int*)_t18.data)[_t19];
		accum_ = iter(accum_, i);
	}
	return accum_;
}

bool array_string_eq(array_string a1, array_string a2) {
	if (a1.len != a2.len) {
		return false;
	}
	for (int i = 0; i < a1.len; ++i) {
		if (string_ne((*(string*)array_get(a1, i)), (*(string*)array_get(a2, i)))) {
			return false;
		}
	}
	return true;
}

int compare_i64(i64* a, i64* b) {
	if (*a < *b) {
		return -1;
	}
	if (*a > *b) {
		return 1;
	}
	return 0;
}

int compare_f64(f64* a, f64* b) {
	if (*a < *b) {
		return -1;
	}
	if (*a > *b) {
		return 1;
	}
	return 0;
}

int compare_f32(f32* a, f32* b) {
	if (*a < *b) {
		return -1;
	}
	if (*a > *b) {
		return 1;
	}
	return 0;
}

array_voidptr array_pointers(array a) {
	array_voidptr res = __new_array_with_default(0, 0, sizeof(voidptr), 0);
	for (int i = 0; i < a.len; ++i) {
		{ // Unsafe block
			array_push(&res, _MOV((voidptr[]){ array_get_unsafe(a, i) }));
		}
	}
	return res;
}

void v_exit(int code) {
	exit(code);
}

bool isnil(voidptr v) {
	return v == 0;
}

void print_backtrace() {
	print_backtrace_skipping_top_frames(2);
}

static void panic_debug(int line_no, string file, string mod, string fn_name, string s) {
	eprintln(tos_lit("================ V panic ================"));
	eprintln(_STR("   module: %.*s", 1, mod));
	eprintln(_STR(" function: %.*s\000()", 2, fn_name));
	eprintln(_STR("  message: %.*s", 1, s));
	eprintln(_STR("     file: %.*s", 1, file));
	eprintln(string_add(tos_lit("     line: "), int_str(line_no)));
	eprintln(tos_lit("========================================="));
// $if !tinyc {
#ifndef __TINYC__
	print_backtrace_skipping_top_frames(1);
#endif
// } tinyc
	break_if_debugger_attached();
	exit(1);
}

void v_panic(string s) {
	eprintln(_STR("V panic: %.*s", 1, s));
// $if !tinyc {
#ifndef __TINYC__
	print_backtrace();
#endif
// } tinyc
	break_if_debugger_attached();
	exit(1);
}

void eprintln(string s) {
	if (s.str == 0) {
		eprintln(tos_lit("eprintln(NIL)"));
	}
// $if !windows {
#ifndef _WIN32
	fflush(stdout);
	fflush(stderr);
	fprintf(stderr, "%.*s\n", s.len, s.str);
	fflush(stderr);
	return;
#endif
// } windows
	println(s);
}

void eprint(string s) {
	if (s.str == 0) {
		eprintln(tos_lit("eprint(NIL)"));
	}
// $if !windows {
#ifndef _WIN32
	fflush(stdout);
	fflush(stderr);
	fprintf(stderr, "%.*s", s.len, s.str);
	fflush(stderr);
	return;
#endif
// } windows
	print(s);
}

void print(string s) {
// $if  windows {
#ifdef _WIN32
#else
	printf("%.*s", s.len, s.str);
#endif
// } windows
}

void println(string s) {
// $if  windows {
#ifdef _WIN32
#else
	printf("%.*s\n", s.len, s.str);
#endif
// } windows
}

static void looo() {
}

// Attr: [unsafe_fn]
byteptr v_malloc(int n) {
	if (n <= 0) {
		v_panic(tos_lit("malloc(<=0)"));
	}
// $if  prealloc {
#ifdef _VPREALLOC
	byteptr res = g_m2_ptr;
	{ // Unsafe block
		g_m2_ptr += n;
	}
	nr_mallocs++;
	return res;
#else
	byteptr ptr = malloc(n);
	if (ptr == 0) {
		v_panic(_STR("malloc(%"PRId32"\000) failed", 2, n));
	}
	return ptr;
#endif
// } prealloc
}

// Attr: [unsafe_fn]
byteptr v_realloc(byteptr b, u32 n) {
// $if  prealloc {
#ifdef _VPREALLOC
	{ // Unsafe block
		byteptr new_ptr = v_malloc(((int)(n)));
		int size = 0;
		memcpy(new_ptr, b, size);
		return new_ptr;
	}
#else
	byteptr ptr = realloc(b, n);
	if (ptr == 0) {
		v_panic(_STR("realloc(%"PRIu32"\000) failed", 2, n));
	}
	return ptr;
#endif
// } prealloc
}

// Attr: [unsafe_fn]
byteptr v_calloc(int n) {
	return calloc(1, n);
}

// Attr: [unsafe_fn]
byteptr vcalloc(int n) {
	if (n < 0) {
		v_panic(tos_lit("calloc(<=0)"));
	} else if (n == 0) {
		return ((byteptr)(0));
	}
	return calloc(1, n);
}

// Attr: [unsafe_fn]
void v_free(voidptr ptr) {
// $if  prealloc {
#ifdef _VPREALLOC
	return;
#endif
// } prealloc
	free(ptr);
}

voidptr memdup(voidptr src, int sz) {
	if (sz == 0) {
		return vcalloc(1);
	}
	{ // Unsafe block
		byteptr mem = v_malloc(sz);
		return memcpy(mem, src, sz);
	}
}

static void v_ptr_free(voidptr ptr) {
// $if  prealloc {
#ifdef _VPREALLOC
	return;
#endif
// } prealloc
	free(ptr);
}

int is_atty(int fd) {
// $if  windows {
#ifdef _WIN32
#else
	return isatty(fd);
#endif
// } windows
}

static voidptr __as_cast(voidptr obj, int obj_type, int expected_type) {
	if (obj_type != expected_type) {
		v_panic(_STR("as cast: cannot cast %"PRId32"\000 to %"PRId32"", 2, obj_type, expected_type));
	}
	return obj;
}

static void __print_assert_failure(VAssertMetaInfo* i) {
	eprintln(_STR("%.*s\000:%"PRId32"\000: FAIL: fn %.*s\000: assert %.*s", 4, i->fpath, i->line_nr + 1, i->fn_name, i->src));
	if (i->op.len > 0 && string_ne(i->op, tos_lit("call"))) {
		eprintln(_STR("   left value: %.*s\000 = %.*s", 2, i->llabel, i->lvalue));
		if (string_eq(i->rlabel, i->rvalue)) {
			eprintln(_STR("  right value: %.*s", 1, i->rlabel));
		} else {
			eprintln(_STR("  right value: %.*s\000 = %.*s", 2, i->rlabel, i->rvalue));
		}
	}
}

static void builtin_init() {
}

static bool print_backtrace_skipping_top_frames(int xskipframes) {
	int skipframes = xskipframes + 2;
// $if  linux {
#ifdef __linux__
	return print_backtrace_skipping_top_frames_linux(skipframes);
#endif
// } linux
	println(_STR("print_backtrace_skipping_top_frames is not implemented. skipframes: %"PRId32"", 1, skipframes));
	return false;
}

static bool print_backtrace_skipping_top_frames_mac(int skipframes) {
	return true;
}

static bool print_backtrace_skipping_top_frames_freebsd(int skipframes) {
	return true;
}

static bool print_backtrace_skipping_top_frames_linux(int skipframes) {
// $if !glibc {
#ifndef __GLIBC__
	eprintln(tos_lit("backtrace_symbols is missing => printing backtraces is not available."));
	eprintln(tos_lit("Some libc implementations like musl simply do not provide it."));
	return false;
#endif
// } glibc
	array_fixed_byteptr_100 buffer = {0};
	int nr_ptrs = backtrace(buffer, 100);
	int nr_actual_frames = nr_ptrs - skipframes;
	array_string sframes = __new_array_with_default(0, 0, sizeof(string), 0);
	charptr* csymbols = backtrace_symbols(&buffer[skipframes], nr_actual_frames);
	for (int i = 0; i < nr_actual_frames; ++i) {
		array_push(&sframes, _MOV((string[]){ tos2(((byteptr)(csymbols[i]))) }));
	}
	// FOR IN array
	array _t22 = sframes;
	for (int _t23 = 0; _t23 < _t22.len; ++_t23) {
		string sframe = ((string*)_t22.data)[_t23];
		string executable = string_all_before(sframe, tos_lit("("));
		string addr = string_all_before(string_all_after(sframe, tos_lit("[")), tos_lit("]"));
		string beforeaddr = string_all_before(sframe, tos_lit("["));
		string cmd = _STR("addr2line -e %.*s\000 %.*s", 2, executable, addr);
		voidptr f = popen(((charptr)(cmd.str)), "r");
		if (isnil(f)) {
			eprintln(sframe);
			continue;
		}
		array_fixed_byte_1000 buf = {0};
		string output = tos_lit("");
		while (fgets(((charptr)(buf)), 1000, f) != 0) {
			output = /*f*/string_add(output, tos(((byteptr)(buf)), vstrlen(((byteptr)(buf)))));
		}
		output = string_add(string_trim_space(output), tos_lit(":"));
		if (pclose(f) != 0) {
			eprintln(sframe);
			continue;
		}
		if ((string_eq(output, tos_lit("??:0:")) || string_eq(output, tos_lit("??:?:")))) {
			output = tos_lit("");
		}
		output = string_replace(output, tos_lit(" (discriminator"), tos_lit(": (d."));
		eprintln(_STR("%*.*s\000 | %*.*s\000 | %.*s", 3, output, -46, addr, 14, beforeaddr));
	}
	return true;
}

static void break_if_debugger_attached() {
	{ // Unsafe block
		voidptr* ptr = ((voidptr*)(0));
		*ptr = 0;
	}
}

int proc_pidpath(int, voidptr, int);

// Attr: [trusted_fn]
// Attr: [trusted_fn]
// Attr: [trusted_fn]
// Attr: [inline]
inline string f64_str(f64 x) {
	f64 abs_x = f64_abs(x);
	if (abs_x >= 0.0001 && abs_x < 1.0e6) {
		return strconv__f64_to_str_l(x);
	} else {
		return strconv__ftoa_64(x);
	}
}

// Attr: [inline]
inline string any_float_str(any_float d) {
	return f64_str(((f64)(d)));
}

// Attr: [inline]
inline string f64_strsci(f64 x, int digit_num) {
	int n_digit = digit_num;
	if (n_digit < 1) {
		n_digit = 1;
	} else if (n_digit > 17) {
		n_digit = 17;
	}
	return strconv__f64_to_str(x, n_digit);
}

// Attr: [inline]
inline string f64_strlong(f64 x) {
	return strconv__f64_to_str_l(x);
}

// Attr: [inline]
inline string f32_str(f32 x) {
	f32 abs_x = f32_abs(x);
	if (abs_x >= 0.0001 && abs_x < 1.0e6) {
		return strconv__f32_to_str_l(x);
	} else {
		return strconv__ftoa_32(x);
	}
}

// Attr: [inline]
inline string f32_strsci(f32 x, int digit_num) {
	int n_digit = digit_num;
	if (n_digit < 1) {
		n_digit = 1;
	} else if (n_digit > 8) {
		n_digit = 8;
	}
	return strconv__f32_to_str(x, n_digit);
}

// Attr: [inline]
inline string f32_strlong(f32 x) {
	return strconv__f32_to_str_l(x);
}

// Attr: [inline]
inline f32 f32_abs(f32 a) {
	return (a < 0 ? (-a) : (a));
}

// Attr: [inline]
inline static f64 f64_abs(f64 a) {
	return (a < 0 ? (-a) : (a));
}

// Attr: [inline]
inline f32 f32_max(f32 a, f32 b) {
	return (a > b ? (a) : (b));
}

// Attr: [inline]
inline f32 f32_min(f32 a, f32 b) {
	return (a < b ? (a) : (b));
}

// Attr: [inline]
inline f64 f64_max(f64 a, f64 b) {
	return (a > b ? (a) : (b));
}

// Attr: [inline]
inline static f64 f64_min(f64 a, f64 b) {
	return (a < b ? (a) : (b));
}

// Attr: [inline]
inline bool f32_eq_epsilon(f32 a, f32 b) {
	f32 hi = f32_max(f32_abs(a), f32_abs(b));
	f32 delta = f32_abs(a - b);
	if (hi > ((f32)(1.0))) {
		return delta <= hi * (4 * ((f32)(FLT_EPSILON)));
	} else {
		return (1 / (4 * ((f32)(FLT_EPSILON)))) * delta <= hi;
	}
}

// Attr: [inline]
inline bool f64_eq_epsilon(f64 a, f64 b) {
	f64 hi = f64_max(f64_abs(a), f64_abs(b));
	f64 delta = f64_abs(a - b);
	if (hi > 1.0) {
		return delta <= hi * (4 * ((f64)(DBL_EPSILON)));
	} else {
		return (1 / (4 * ((f64)(DBL_EPSILON)))) * delta <= hi;
	}
}

string ptr_str(voidptr ptr) {
	string buf1 = u64_hex(((u64)(ptr)));
	return buf1;
}

// Attr: [inline]
inline string int_str_l(int nn, int max) {
	int n = nn;
	int d = 0;
	if (n == 0) {
		return tos_lit("0");
	}
	byteptr buf = v_malloc(max + 1);
	bool is_neg = false;
	if (n < 0) {
		n = -n;
		is_neg = true;
	}
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		int n1 = n / 100;
		d = ((n - (n1 * 100)) << 1);
		n = n1;
		{ // Unsafe block
			buf[index--] = _const_digit_pairs.str[d++];
			buf[index--] = _const_digit_pairs.str[d];
		}
	}
	index++;
	if (d < 20) {
		index++;
	}
	if (is_neg) {
		index--;
		{ // Unsafe block
			buf[index] = '-';
		}
	}
	{ // Unsafe block
		memmove(buf, buf + index, (max - index) + 1);
		return tos(buf, (max - index));
	}
}

string i8_str(i8 n) {
	return int_str_l(((int)(n)), 5);
}

string i16_str(i16 n) {
	return int_str_l(((int)(n)), 7);
}

string u16_str(u16 n) {
	return int_str_l(((int)(n)), 7);
}

string int_str(int n) {
	return int_str_l(n, 12);
}

string u32_str(u32 nn) {
	u32 n = nn;
	u32 d = ((u32)(0));
	if (n == 0) {
		return tos_lit("0");
	}
	int max = 12;
	byteptr buf = v_malloc(max + 1);
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		u32 n1 = n / ((u32)(100));
		d = ((n - (n1 * ((u32)(100)))) << ((u32)(1)));
		n = n1;
		{ // Unsafe block
			buf[index--] = string_at(_const_digit_pairs, d++);
			buf[index--] = string_at(_const_digit_pairs, d);
		}
	}
	index++;
	if (d < ((u32)(20))) {
		index++;
	}
	{ // Unsafe block
		memmove(buf, buf + index, (max - index) + 1);
		return tos(buf, (max - index));
	}
}

// Attr: [inline]
inline string any_int_str(any_int n) {
	return i64_str(((i64)(n)));
}

string i64_str(i64 nn) {
	i64 n = nn;
	i64 d = ((i64)(0));
	if (n == 0) {
		return tos_lit("0");
	}
	int max = 20;
	byteptr buf = vcalloc(max + 1);
	bool is_neg = false;
	if (n < 0) {
		n = -n;
		is_neg = true;
	}
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		i64 n1 = n / ((i64)(100));
		d = ((n - (n1 * ((i64)(100)))) << ((i64)(1)));
		n = n1;
		{ // Unsafe block
			buf[index--] = string_at(_const_digit_pairs, d++);
			buf[index--] = string_at(_const_digit_pairs, d);
		}
	}
	index++;
	if (d < ((i64)(20))) {
		index++;
	}
	if (is_neg) {
		index--;
		{ // Unsafe block
			buf[index] = '-';
		}
	}
	{ // Unsafe block
		memmove(buf, buf + index, (max - index) + 1);
		return tos(buf, (max - index));
	}
}

string u64_str(u64 nn) {
	u64 n = nn;
	u64 d = ((u64)(0));
	if (n == 0) {
		return tos_lit("0");
	}
	int max = 20;
	byteptr buf = vcalloc(max + 1);
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		u64 n1 = n / 100;
		d = ((n - (n1 * 100)) << 1);
		n = n1;
		{ // Unsafe block
			buf[index--] = string_at(_const_digit_pairs, d++);
			buf[index--] = string_at(_const_digit_pairs, d);
		}
	}
	index++;
	if (d < 20) {
		index++;
	}
	{ // Unsafe block
		memmove(buf, buf + index, (max - index) + 1);
		return tos(buf, (max - index));
	}
}

string bool_str(bool b) {
	if (b) {
		return tos_lit("true");
	}
	return tos_lit("false");
}

string byte_hex(byte nn) {
	if (nn == 0) {
		return tos_lit("0");
	}
	byte n = nn;
	int max = 2;
	byteptr buf = v_malloc(max + 1);
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		byte d = (n & 0xF);
		n = n >> 4;
		{ // Unsafe block
			buf[index--] = (d < 10 ? (d + '0') : (d + 87));
		}
	}
	index++;
	{ // Unsafe block
		return tos(buf + index, (max - index));
	}
}

string i8_hex(i8 nn) {
	return byte_hex(((byte)(nn)));
}

string u16_hex(u16 nn) {
	if (nn == 0) {
		return tos_lit("0");
	}
	u16 n = nn;
	int max = 5;
	byteptr buf = v_malloc(max + 1);
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		byte d = ((byte)((n & 0xF)));
		n = n >> 4;
		{ // Unsafe block
			buf[index--] = (d < 10 ? (d + '0') : (d + 87));
		}
	}
	index++;
	{ // Unsafe block
		return tos(buf + index, (max - index));
	}
}

string i16_hex(i16 nn) {
	return u16_hex(((u16)(nn)));
}

string u32_hex(u32 nn) {
	if (nn == 0) {
		return tos_lit("0");
	}
	u32 n = nn;
	int max = 10;
	byteptr buf = v_malloc(max + 1);
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		byte d = ((byte)((n & 0xF)));
		n = n >> 4;
		{ // Unsafe block
			buf[index--] = (d < 10 ? (d + '0') : (d + 87));
		}
	}
	index++;
	{ // Unsafe block
		return tos(buf + index, (max - index));
	}
}

string int_hex(int nn) {
	return u32_hex(((u32)(nn)));
}

string int_hex2(int n) {
	return string_add(tos_lit("0x"), int_hex(n));
}

string u64_hex(u64 nn) {
	if (nn == 0) {
		return tos_lit("0");
	}
	u64 n = nn;
	int max = 18;
	byteptr buf = v_malloc(max + 1);
	int index = max;
	{ // Unsafe block
		buf[index--] = '\0';
	}
	while (n > 0) {
		byte d = ((byte)((n & 0xF)));
		n = n >> 4;
		{ // Unsafe block
			buf[index--] = (d < 10 ? (d + '0') : (d + 87));
		}
	}
	index++;
	{ // Unsafe block
		memmove(buf, buf + index, (max - index) + 1);
		return tos(buf, (max - index));
	}
}

string i64_hex(i64 nn) {
	return u64_hex(((u64)(nn)));
}

string any_int_hex(any_int nn) {
	return u64_hex(((u64)(nn)));
}

string voidptr_str(voidptr nn) {
	return u64_hex(((u64)(nn)));
}

string byteptr_str(byteptr nn) {
	return u64_hex(((u64)(nn)));
}

string byte_str(byte c) {
	string str = (string){.str = v_malloc(2), .len = 1};
	{ // Unsafe block
		str.str[0] = c;
		str.str[1] = '\0';
	}
	return str;
}

bool byte_is_capital(byte c) {
	return c >= 'A' && c <= 'Z';
}

array_byte array_byte_clone(array_byte b) {
	array_byte res = __new_array_with_default(b.len, 0, sizeof(byte), 0);
	for (int i = 0; i < b.len; ++i) {
		array_set(&res, i, &(byte[]) { (*(byte*)array_get(b, i)) });
	}
	return res;
}

bool array_byte_contains(array_byte a, byte val) {
	// FOR IN array
	array _t24 = a;
	for (int _t25 = 0; _t25 < _t24.len; ++_t25) {
		byte aa = ((byte*)_t24.data)[_t25];
		if (aa == val) {
			return true;
		}
	}
	return false;
}

static bool array_int_contains(array_int ar, int val) {
	// FOR IN array
	array _t26 = ar;
	for (int _t27 = 0; _t27 < _t26.len; ++_t27) {
		int s = ((int*)_t26.data)[_t27];
		if (s == val) {
			return true;
		}
	}
	return false;
}

bool array_u64_contains(array_u64 a, u64 val) {
	// FOR IN array
	array _t28 = a;
	for (int _t29 = 0; _t29 < _t28.len; ++_t29) {
		u64 aa = ((u64*)_t28.data)[_t29];
		if (aa == val) {
			return true;
		}
	}
	return false;
}

// Attr: [inline]
inline static bool fast_string_eq(string a, string b) {
	if (a.len != b.len) {
		return false;
	}
	{ // Unsafe block
		return memcmp(a.str, b.str, b.len) == 0;
	}
}

// Attr: [inline]
// Attr: [unsafe_fn]
inline static DenseArray new_dense_array(int value_bytes) {
	return (DenseArray){
		.value_bytes = value_bytes,
		.cap = 8,
		.len = 0,
		.deletes = 0,
		.keys = ((string*)(v_malloc(((int*)(8 * /*SizeOfType*/ sizeof(string)))))),
		.values = v_malloc(8 * value_bytes),
	};
}

// Attr: [inline]
inline static u32 DenseArray_push(DenseArray* d, string key, voidptr value) {
	if (d->cap == d->len) {
		d->cap += d->cap >> 3;
		{ // Unsafe block
			d->keys = ((string*)(v_realloc(d->keys, /*SizeOfType*/ sizeof(string) * d->cap)));
			d->values = v_realloc(d->values, ((u32)(d->value_bytes)) * d->cap);
		}
	}
	u32 push_index = d->len;
	{ // Unsafe block
		d->keys[push_index] = key;
		memcpy(d->values + push_index * ((u32)(d->value_bytes)), value, d->value_bytes);
	}
	d->len++;
	return push_index;
}

static voidptr DenseArray_get(DenseArray d, int i) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (i < 0 || i >= ((int)(d.len))) {
		v_panic(_STR("DenseArray.get: index out of range (i == %"PRId32"\000, d.len == %"PRIu32"\000)", 3, i, d.len));
	}
#endif
// } no_bounds_checking
	{ // Unsafe block
		return ((byteptr)(d.keys)) + i * ((int)(/*SizeOfType*/ sizeof(string)));
	}
}

static void DenseArray_zeros_to_end(DenseArray* d) {
	byteptr tmp_value = v_malloc(d->value_bytes);
	u32 count = ((u32)(0));
	for (int i = 0; i < d->len; ++i) {
		if (d->keys[i].str != 0) {
			{ // Unsafe block
				string tmp_key = d->keys[count];
				d->keys[count] = d->keys[i];
				d->keys[i] = tmp_key;
			}
			{ // Unsafe block
				memcpy(tmp_value, d->values + count * ((u32)(d->value_bytes)), d->value_bytes);
				memcpy(d->values + count * ((u32)(d->value_bytes)), d->values + i * d->value_bytes, d->value_bytes);
				memcpy(d->values + i * d->value_bytes, tmp_value, d->value_bytes);
			}
			count++;
		}
	}
	v_free(tmp_value);
	d->deletes = 0;
	d->len = count;
	d->cap = (count < 8 ? (((u32)(8))) : (count));
	{ // Unsafe block
		d->keys = ((string*)(v_realloc(d->keys, /*SizeOfType*/ sizeof(string) * d->cap)));
		d->values = v_realloc(d->values, ((u32)(d->value_bytes)) * d->cap);
	}
}

static map new_map_1(int value_bytes) {
	return (map){
		.value_bytes = value_bytes,
		.cap = _const_init_cap,
		.cached_hashbits = _const_max_cached_hashbits,
		.shift = _const_init_log_capicity,
		.key_values = new_dense_array(value_bytes),
		.metas = ((u32*)(vcalloc(((int*)(/*SizeOfType*/ sizeof(u32) * (_const_init_capicity + _const_extra_metas_inc)))))),
		.extra_metas = _const_extra_metas_inc,
		.len = 0,
	};
}

static map new_map_init(int n, int value_bytes, string* keys, voidptr values) {
	map out = new_map_1(value_bytes);
	for (int i = 0; i < n; ++i) {
		{ // Unsafe block
			map_set(&out, keys[i], ((byteptr)(values)) + i * value_bytes);
		}
	}
	return out;
}

// Attr: [inline]
inline static multi_return_u32_u32 map_key_to_index(map* m, string key) {
	u64 hash = hash__wyhash_c(key.str, ((u64)(key.len)), 0);
	u64 index = (hash & m->cap);
	u64 meta = ((((hash >> m->shift) & _const_hash_mask)) | _const_probe_inc);
	return (multi_return_u32_u32){.arg0=((u32)(index)), .arg1=((u32)(meta))};
}

// Attr: [inline]
inline static multi_return_u32_u32 map_meta_less(map* m, u32 _index, u32 _metas) {
	u32 index = _index;
	u32 meta = _metas;
	while (meta < m->metas[index]) {
		index += 2;
		meta += _const_probe_inc;
	}
	return (multi_return_u32_u32){.arg0=index, .arg1=meta};
}

// Attr: [inline]
inline static void map_meta_greater(map* m, u32 _index, u32 _metas, u32 kvi) {
	u32 meta = _metas;
	u32 index = _index;
	u32 kv_index = kvi;
	while (m->metas[index] != 0) {
		if (meta > m->metas[index]) {
			{ // Unsafe block
				u32 tmp_meta = m->metas[index];
				m->metas[index] = meta;
				meta = tmp_meta;
			}
			u32 tmp_index = m->metas[index + 1];
			{ // Unsafe block
				m->metas[index + 1] = kv_index;
			}
			kv_index = tmp_index;
		}
		index += 2;
		meta += _const_probe_inc;
	}
	{ // Unsafe block
		m->metas[index] = meta;
		m->metas[index + 1] = kv_index;
	}
	u32 probe_count = (meta >> _const_hashbits) - 1;
	map_ensure_extra_metas(m, probe_count);
}

// Attr: [inline]
inline static void map_ensure_extra_metas(map* m, u32 probe_count) {
	if ((probe_count << 1) == m->extra_metas) {
		m->extra_metas += _const_extra_metas_inc;
		u32 mem_size = (m->cap + 2 + m->extra_metas);
		{ // Unsafe block
			m->metas = ((u32*)(v_realloc(m->metas, /*SizeOfType*/ sizeof(u32) * mem_size)));
			memset(m->metas + mem_size - _const_extra_metas_inc, 0, /*SizeOfType*/ sizeof(u32) * _const_extra_metas_inc);
		}
		if (probe_count == 252) {
			v_panic(tos_lit("Probe overflow"));
		}
	}
}

static void map_set(map* m, string k, voidptr value) {
	string key = string_clone(k);
	f32 load_factor = ((f32)(m->len << 1)) / ((f32)(m->cap));
	if (load_factor > _const_max_load_factor) {
		map_expand(m);
	}
	multi_return_u32_u32 mr_9250 = map_key_to_index(m, key);
	u32 index = mr_9250.arg0;
	u32 meta = mr_9250.arg1;
	multi_return_u32_u32 mr_9285 = map_meta_less(m, index, meta);
	index = mr_9285.arg0;
	meta = mr_9285.arg1;
	while (meta == m->metas[index]) {
		u32 kv_index = m->metas[index + 1];
		if (fast_string_eq(key, m->key_values.keys[kv_index])) {
			{ // Unsafe block
				memcpy(m->key_values.values + kv_index * ((u32)(m->value_bytes)), value, m->value_bytes);
			}
			return;
		}
		index += 2;
		meta += _const_probe_inc;
	}
	u32 kv_index = DenseArray_push(&m->key_values, key, value);
	map_meta_greater(m, index, meta, kv_index);
	m->len++;
}

static void map_expand(map* m) {
	u32 old_cap = m->cap;
	m->cap = ((m->cap + 2) << 1) - 2;
	if (m->cached_hashbits == 0) {
		m->shift += _const_max_cached_hashbits;
		m->cached_hashbits = _const_max_cached_hashbits;
		map_rehash(m);
	} else {
		map_cached_rehash(m, old_cap);
		m->cached_hashbits--;
	}
}

static void map_rehash(map* m) {
	u32 meta_bytes = /*SizeOfType*/ sizeof(u32) * (m->cap + 2 + m->extra_metas);
	{ // Unsafe block
		m->metas = ((u32*)(v_realloc(m->metas, meta_bytes)));
		memset(m->metas, 0, meta_bytes);
	}
	for (u32 i = ((u32)(0)); i < m->key_values.len; i++) {
		if (m->key_values.keys[i].str == 0) {
			continue;
		}
		multi_return_u32_u32 mr_10664 = map_key_to_index(m, m->key_values.keys[i]);
		u32 index = mr_10664.arg0;
		u32 meta = mr_10664.arg1;
		multi_return_u32_u32 mr_10726 = map_meta_less(m, index, meta);
		index = mr_10726.arg0;
		meta = mr_10726.arg1;
		map_meta_greater(m, index, meta, i);
	}
}

static void map_cached_rehash(map* m, u32 old_cap) {
	u32* old_metas = m->metas;
	m->metas = ((u32*)(vcalloc(((int*)(/*SizeOfType*/ sizeof(u32) * (m->cap + 2 + m->extra_metas))))));
	u32 old_extra_metas = m->extra_metas;
	for (u32 i = ((u32)(0)); i <= old_cap + old_extra_metas; i += 2) {
		if (old_metas[i] == 0) {
			continue;
		}
		u32 old_meta = old_metas[i];
		u32 old_probe_count = ((old_meta >> _const_hashbits) - 1) << 1;
		u32 old_index = ((i - old_probe_count) & (m->cap >> 1));
		u32 index = (((old_index | (old_meta << m->shift))) & m->cap);
		u32 meta = (((old_meta & _const_hash_mask)) | _const_probe_inc);
		multi_return_u32_u32 mr_11461 = map_meta_less(m, index, meta);
		index = mr_11461.arg0;
		meta = mr_11461.arg1;
		u32 kv_index = old_metas[i + 1];
		map_meta_greater(m, index, meta, kv_index);
	}
	{ // Unsafe block
		v_free(old_metas);
	}
}

static voidptr map_get_and_set(map* m, string key, voidptr zero) {
	while (1) {
		multi_return_u32_u32 mr_11907 = map_key_to_index(m, key);
		u32 index = mr_11907.arg0;
		u32 meta = mr_11907.arg1;
		while (1) {
			if (meta == m->metas[index]) {
				u32 kv_index = m->metas[index + 1];
				if (fast_string_eq(key, m->key_values.keys[kv_index])) {
					{ // Unsafe block
						return ((voidptr)(m->key_values.values + kv_index * ((u32)(m->value_bytes))));
					}
				}
			}
			index += 2;
			meta += _const_probe_inc;
			if (meta > m->metas[index]) {
				break;
			}
		}
		map_set(m, key, zero);
	}
}

static voidptr map_get(map m, string key, voidptr zero) {
	multi_return_u32_u32 mr_12584 = map_key_to_index(&m, key);
	u32 index = mr_12584.arg0;
	u32 meta = mr_12584.arg1;
	while (1) {
		if (meta == m.metas[index]) {
			u32 kv_index = m.metas[index + 1];
			if (fast_string_eq(key, m.key_values.keys[kv_index])) {
				{ // Unsafe block
					return ((voidptr)(m.key_values.values + kv_index * ((u32)(m.value_bytes))));
				}
			}
		}
		index += 2;
		meta += _const_probe_inc;
		if (meta > m.metas[index]) {
			break;
		}
	}
	return zero;
}

static bool map_exists(map m, string key) {
	multi_return_u32_u32 mr_13072 = map_key_to_index(&m, key);
	u32 index = mr_13072.arg0;
	u32 meta = mr_13072.arg1;
	while (1) {
		if (meta == m.metas[index]) {
			u32 kv_index = m.metas[index + 1];
			if (fast_string_eq(key, m.key_values.keys[kv_index])) {
				return true;
			}
		}
		index += 2;
		meta += _const_probe_inc;
		if (meta > m.metas[index]) {
			break;
		}
	}
	return false;
}

void map_delete(map* m, string key) {
	multi_return_u32_u32 mr_13492 = map_key_to_index(m, key);
	u32 index = mr_13492.arg0;
	u32 meta = mr_13492.arg1;
	multi_return_u32_u32 mr_13527 = map_meta_less(m, index, meta);
	index = mr_13527.arg0;
	meta = mr_13527.arg1;
	while (meta == m->metas[index]) {
		u32 kv_index = m->metas[index + 1];
		if (fast_string_eq(key, m->key_values.keys[kv_index])) {
			while ((m->metas[index + 2] >> _const_hashbits) > 1) {
				{ // Unsafe block
					m->metas[index] = m->metas[index + 2] - _const_probe_inc;
					m->metas[index + 1] = m->metas[index + 3];
				}
				index += 2;
			}
			m->len--;
			{ // Unsafe block
				m->metas[index] = 0;
			}
			m->key_values.deletes++;
			{ // Unsafe block
				string_free(&m->key_values.keys[kv_index]);
				memset(&m->key_values.keys[kv_index], 0, /*SizeOfType*/ sizeof(string));
			}
			if (m->key_values.len <= 32) {
				return;
			}
			if (m->key_values.deletes >= (m->key_values.len >> 1)) {
				DenseArray_zeros_to_end(&m->key_values);
				map_rehash(m);
				m->key_values.deletes = 0;
			}
			return;
		}
		index += 2;
		meta += _const_probe_inc;
	}
}

array_string map_keys(map* m) {
	array_string keys = __new_array_with_default(m->len, 0, sizeof(string), &(string[]){tos_lit("")});
	int j = 0;
	for (u32 i = ((u32)(0)); i < m->key_values.len; i++) {
		if (m->key_values.keys[i].str == 0) {
			continue;
		}
		array_set(&keys, j, &(string[]) { string_clone(m->key_values.keys[i]) });
		j++;
	}
	return keys;
}

// Attr: [unsafe_fn]
DenseArray DenseArray_clone(DenseArray d) {
	DenseArray res = (DenseArray){
		.value_bytes = d.value_bytes,
		.cap = d.cap,
		.len = d.len,
		.deletes = d.deletes,
		.keys = ((string*)(v_malloc(((int*)(d.cap * /*SizeOfType*/ sizeof(string)))))),
		.values = ((byteptr)(v_malloc(((int)(d.cap * ((u32)(d.value_bytes))))))),
	};
	{ // Unsafe block
		memcpy(res.keys, d.keys, d.cap * /*SizeOfType*/ sizeof(string));
		memcpy(res.values, d.values, d.cap * ((u32)(d.value_bytes)));
	}
	return res;
}

// Attr: [unsafe_fn]
map map_clone(map m) {
	u32 metas_size = /*SizeOfType*/ sizeof(u32) * (m.cap + 2 + m.extra_metas);
	map res = (map){
		.value_bytes = m.value_bytes,
		.cap = m.cap,
		.cached_hashbits = m.cached_hashbits,
		.shift = m.shift,
		.key_values = DenseArray_clone(m.key_values),
		.metas = ((u32*)(v_malloc(((int*)(metas_size))))),
		.extra_metas = m.extra_metas,
		.len = m.len,
	};
	{ // Unsafe block
		memcpy(res.metas, m.metas, metas_size);
	}
	return res;
}

// Attr: [unsafe_fn]
void map_free(map* m) {
	{ // Unsafe block
		v_free(m->metas);
	}
	for (u32 i = ((u32)(0)); i < m->key_values.len; i++) {
		if (m->key_values.keys[i].str == 0) {
			continue;
		}
		{ // Unsafe block
			string_free(&m->key_values.keys[i]);
		}
	}
	{ // Unsafe block
		v_free(m->key_values.keys);
		v_free(m->key_values.values);
	}
}

string map_string_str(map_string m) {
	if (m.len == 0) {
		return tos_lit("{}");
	}
	strings__Builder sb = strings__new_builder(50);
	strings__Builder_writeln(&sb, tos_lit("{"));
	strings__Builder_writeln(&sb, tos_lit("}"));
	return strings__Builder_str(&sb);
}

string OptionBase_str(OptionBase o) {
	if (o.ok && !o.is_none) {
		return tos_lit("Option{ valid }");
	}
	if (o.is_none) {
		return tos_lit("Option{ none }");
	}
	return _STR("Option{ error: \"%.*s\000\" }", 2, o.v_error);
}

static void opt_ok2(voidptr data, OptionBase* option, int size) {
	{ // Unsafe block
		*option = (OptionBase){.ok = true,.is_none = 0,.v_error = (string){.str=(byteptr)""},.ecode = 0,};
		memcpy(((byteptr)(&option->ecode)) + /*SizeOfType*/ sizeof(int), data, size);
	}
}

string Option_str(Option o) {
	if (o.ok && !o.is_none) {
		return string_add(string_add(tos_lit("Option{ data: "), array_byte_hex(array_slice(new_array_from_c_array(_ARR_LEN(o.data), _ARR_LEN(o.data), sizeof(o.data[0]), o.data), 0, 32))), tos_lit(" }"));
	}
	if (o.is_none) {
		return tos_lit("Option{ none }");
	}
	return _STR("Option{ error: \"%.*s\000\" }", 2, o.v_error);
}

static Option opt_ok(voidptr data, int size) {
	if (size >= 400) {
		v_panic(_STR("option size too big: %"PRId32"\000 (max is 400), this is a temporary limit", 2, size));
	}
	Option res = (Option){.ok = true,.is_none = 0,.v_error = (string){.str=(byteptr)""},.ecode = 0,.data = {0},};
	{ // Unsafe block
		memcpy(res.data, data, size);
	}
	return res;
}

static Option opt_none() {
	return (Option){.ok = false,.is_none = true,.v_error = (string){.str=(byteptr)""},.ecode = 0,.data = {0},};
}

Option v_error(string s) {
	return (Option){.ok = false,.is_none = false,.v_error = s,.ecode = 0,.data = {0},};
}

Option error_with_code(string s, int code) {
	return (Option){.ok = false,.is_none = false,.v_error = s,.ecode = code,.data = {0},};
}

static SortedMap new_sorted_map(int n, int value_bytes) {
	return (SortedMap){.value_bytes = value_bytes,.root = new_node(),.len = 0,};
}

static SortedMap new_sorted_map_init(int n, int value_bytes, string* keys, voidptr values) {
	SortedMap out = new_sorted_map(n, value_bytes);
	for (int i = 0; i < n; ++i) {
		{ // Unsafe block
			SortedMap_set(&out, keys[i], ((byteptr)(values)) + i * value_bytes);
		}
	}
	return out;
}

static mapnode* new_node() {
	return (mapnode*)memdup(&(mapnode){.children = 0,.len = 0,.keys = {0},.values = {0},}, sizeof(mapnode));
}

static void SortedMap_set(SortedMap* m, string key, voidptr value) {
	mapnode* node = m->root;
	int child_index = 0;
	mapnode* parent = ((mapnode*)(0));
	while (1) {
		if (node->len == _const_max_len) {
			if (isnil(parent)) {
				parent = new_node();
				m->root = parent;
			}
			mapnode_split_child(parent, child_index, node);
			if (string_eq(key, parent->keys[child_index])) {
				{ // Unsafe block
					memcpy(parent->values[child_index], value, m->value_bytes);
				}
				return;
			}
			node = (string_lt(key, parent->keys[child_index]) ? (((mapnode*)(parent->children[child_index]))) : (((mapnode*)(parent->children[child_index + 1]))));
		}
		int i = 0;
		while (i < node->len && string_gt(key, node->keys[i])) {
			i++;
		}
		if (i != node->len && string_eq(key, node->keys[i])) {
			{ // Unsafe block
				memcpy(node->values[i], value, m->value_bytes);
			}
			return;
		}
		if (isnil(node->children)) {
			int j = node->len - 1;
			while (j >= 0 && string_lt(key, node->keys[j])) {
				node->keys[j + 1] = node->keys[j];
				node->values[j + 1] = node->values[j];
				j--;
			}
			node->keys[j + 1] = key;
			node->values[j + 1] = v_malloc(m->value_bytes);
			{ // Unsafe block
				memcpy(node->values[j + 1], value, m->value_bytes);
			}
			node->len++;
			m->len++;
			return;
		}
		parent = node;
		child_index = i;
		node = ((mapnode*)(node->children[child_index]));
	}
}

static void mapnode_split_child(mapnode* n, int child_index, mapnode* y) {
	mapnode* z = new_node();
	z->len = _const_mid_index;
	y->len = _const_mid_index;
	for (int j = _const_mid_index - 1; j >= 0; j--) {
		z->keys[j] = y->keys[j + _const_degree];
		z->values[j] = y->values[j + _const_degree];
	}
	if (!isnil(y->children)) {
		z->children = ((voidptr*)(v_malloc(((int*)(_const_children_bytes)))));
		for (int jj = _const_degree - 1; jj >= 0; jj--) {
			z->children[jj] = y->children[jj + _const_degree];
		}
	}
	if (isnil(n->children)) {
		n->children = ((voidptr*)(v_malloc(((int*)(_const_children_bytes)))));
	}
	n->children[n->len + 1] = n->children[n->len];
	for (int j = n->len; j > child_index; j--) {
		n->keys[j] = n->keys[j - 1];
		n->values[j] = n->values[j - 1];
		n->children[j] = n->children[j - 1];
	}
	n->keys[child_index] = y->keys[_const_mid_index];
	n->values[child_index] = y->values[_const_mid_index];
	n->children[child_index] = ((voidptr)(y));
	n->children[child_index + 1] = ((voidptr)(z));
	n->len++;
}

static bool SortedMap_get(SortedMap m, string key, voidptr out) {
	mapnode* node = m.root;
	while (1) {
		int i = node->len - 1;
		while (i >= 0 && string_lt(key, node->keys[i])) {
			i--;
		}
		if (i != -1 && string_eq(key, node->keys[i])) {
			{ // Unsafe block
				memcpy(out, node->values[i], m.value_bytes);
			}
			return true;
		}
		if (isnil(node->children)) {
			break;
		}
		node = ((mapnode*)(node->children[i + 1]));
	}
	return false;
}

static bool SortedMap_exists(SortedMap m, string key) {
	if (isnil(m.root)) {
		return false;
	}
	mapnode* node = m.root;
	while (1) {
		int i = node->len - 1;
		while (i >= 0 && string_lt(key, node->keys[i])) {
			i--;
		}
		if (i != -1 && string_eq(key, node->keys[i])) {
			return true;
		}
		if (isnil(node->children)) {
			break;
		}
		node = ((mapnode*)(node->children[i + 1]));
	}
	return false;
}

static int mapnode_find_key(mapnode* n, string k) {
	int idx = 0;
	while (idx < n->len && string_lt(n->keys[idx], k)) {
		idx++;
	}
	return idx;
}

static bool mapnode_remove_key(mapnode* n, string k) {
	int idx = mapnode_find_key(n, k);
	if (idx < n->len && string_eq(n->keys[idx], k)) {
		if (isnil(n->children)) {
			mapnode_remove_from_leaf(n, idx);
		} else {
			mapnode_remove_from_non_leaf(n, idx);
		}
		return true;
	} else {
		if (isnil(n->children)) {
			return false;
		}
		bool flag = (idx == n->len ? (true) : (false));
		if ((((mapnode*)(n->children[idx])))->len < _const_degree) {
			mapnode_fill(n, idx);
		}
		if (flag && idx > n->len) {
			return mapnode_remove_key((((mapnode*)(n->children[idx - 1]))), k);
		} else {
			return mapnode_remove_key((((mapnode*)(n->children[idx]))), k);
		}
	}
}

static void mapnode_remove_from_leaf(mapnode* n, int idx) {
	for (int i = idx + 1; i < n->len; i++) {
		n->keys[i - 1] = n->keys[i];
		n->values[i - 1] = n->values[i];
	}
	n->len--;
}

static void mapnode_remove_from_non_leaf(mapnode* n, int idx) {
	string k = n->keys[idx];
	if (((mapnode*)(n->children[idx]))->len >= _const_degree) {
		mapnode* current = ((mapnode*)(n->children[idx]));
		while (!isnil(current->children)) {
			current = ((mapnode*)(current->children[current->len]));
		}
		string predecessor = current->keys[current->len - 1];
		n->keys[idx] = predecessor;
		n->values[idx] = current->values[current->len - 1];
		mapnode_remove_key((((mapnode*)(n->children[idx]))), predecessor);
	} else if (((mapnode*)(n->children[idx + 1]))->len >= _const_degree) {
		mapnode* current = ((mapnode*)(n->children[idx + 1]));
		while (!isnil(current->children)) {
			current = ((mapnode*)(current->children[0]));
		}
		string successor = current->keys[0];
		n->keys[idx] = successor;
		n->values[idx] = current->values[0];
		mapnode_remove_key((((mapnode*)(n->children[idx + 1]))), successor);
	} else {
		mapnode_merge(n, idx);
		mapnode_remove_key((((mapnode*)(n->children[idx]))), k);
	}
}

static void mapnode_fill(mapnode* n, int idx) {
	if (idx != 0 && ((mapnode*)(n->children[idx - 1]))->len >= _const_degree) {
		mapnode_borrow_from_prev(n, idx);
	} else if (idx != n->len && ((mapnode*)(n->children[idx + 1]))->len >= _const_degree) {
		mapnode_borrow_from_next(n, idx);
	} else if (idx != n->len) {
		mapnode_merge(n, idx);
	} else {
		mapnode_merge(n, idx - 1);
	}
}

static void mapnode_borrow_from_prev(mapnode* n, int idx) {
	mapnode* child = ((mapnode*)(n->children[idx]));
	mapnode* sibling = ((mapnode*)(n->children[idx - 1]));
	for (int i = child->len - 1; i >= 0; i--) {
		child->keys[i + 1] = child->keys[i];
		child->values[i + 1] = child->values[i];
	}
	if (!isnil(child->children)) {
		for (int i = child->len; i >= 0; i--) {
			child->children[i + 1] = child->children[i];
		}
	}
	child->keys[0] = n->keys[idx - 1];
	child->values[0] = n->values[idx - 1];
	if (!isnil(child->children)) {
		child->children[0] = sibling->children[sibling->len];
	}
	n->keys[idx - 1] = sibling->keys[sibling->len - 1];
	n->values[idx - 1] = sibling->values[sibling->len - 1];
	child->len++;
	sibling->len--;
}

static void mapnode_borrow_from_next(mapnode* n, int idx) {
	mapnode* child = ((mapnode*)(n->children[idx]));
	mapnode* sibling = ((mapnode*)(n->children[idx + 1]));
	child->keys[child->len] = n->keys[idx];
	child->values[child->len] = n->values[idx];
	if (!isnil(child->children)) {
		child->children[child->len + 1] = sibling->children[0];
	}
	n->keys[idx] = sibling->keys[0];
	n->values[idx] = sibling->values[0];
	for (int i = 1; i < sibling->len; i++) {
		sibling->keys[i - 1] = sibling->keys[i];
		sibling->values[i - 1] = sibling->values[i];
	}
	if (!isnil(sibling->children)) {
		for (int i = 1; i <= sibling->len; i++) {
			sibling->children[i - 1] = sibling->children[i];
		}
	}
	child->len++;
	sibling->len--;
}

static void mapnode_merge(mapnode* n, int idx) {
	mapnode* child = ((mapnode*)(n->children[idx]));
	mapnode* sibling = ((mapnode*)(n->children[idx + 1]));
	child->keys[_const_mid_index] = n->keys[idx];
	child->values[_const_mid_index] = n->values[idx];
	for (int i = 0; i < sibling->len; ++i) {
		child->keys[i + _const_degree] = sibling->keys[i];
		child->values[i + _const_degree] = sibling->values[i];
	}
	if (!isnil(child->children)) {
		for (int i = 0; i <= sibling->len; i++) {
			child->children[i + _const_degree] = sibling->children[i];
		}
	}
	for (int i = idx + 1; i < n->len; i++) {
		n->keys[i - 1] = n->keys[i];
		n->values[i - 1] = n->values[i];
	}
	for (int i = idx + 2; i <= n->len; i++) {
		n->children[i - 1] = n->children[i];
	}
	child->len += sibling->len + 1;
	n->len--;
}

void SortedMap_delete(SortedMap* m, string key) {
	if (m->root->len == 0) {
		return;
	}
	bool removed = mapnode_remove_key(m->root, key);
	if (removed) {
		m->len--;
	}
	if (m->root->len == 0) {
		if (isnil(m->root->children)) {
			return;
		} else {
			m->root = ((mapnode*)(m->root->children[0]));
		}
	}
}

static int mapnode_subkeys(mapnode* n, array_string* keys, int at) {
	int position = at;
	if (!isnil(n->children)) {
		for (int i = 0; i < n->len; ++i) {
			mapnode* child = ((mapnode*)(n->children[i]));
			position += mapnode_subkeys(child, keys, position);
			array_set(keys, position, &(string[]) { n->keys[i] });
			position++;
		}
		mapnode* child = ((mapnode*)(n->children[n->len]));
		position += mapnode_subkeys(child, keys, position);
	} else {
		for (int i = 0; i < n->len; ++i) {
			array_set(keys, position + i, &(string[]) { n->keys[i] });
		}
		position += n->len;
	}
	return position - at;
}

array_string SortedMap_keys(SortedMap* m) {
	array_string keys = __new_array_with_default(m->len, 0, sizeof(string), &(string[]){tos_lit("")});
	if (isnil(m->root) || m->root->len == 0) {
		return keys;
	}
	mapnode_subkeys(m->root, &/*arr*/keys, 0);
	return keys;
}

static void mapnode_free(mapnode* n) {
	println(tos_lit("TODO"));
}

void SortedMap_free(SortedMap* m) {
	if (isnil(m->root)) {
		return;
	}
	mapnode_free(m->root);
}

void SortedMap_print(SortedMap m) {
	println(tos_lit("TODO"));
}

// Attr: [unsafe_fn]
int vstrlen(byteptr s) {
	return strlen(((charptr)(s)));
}

// Attr: [unsafe_fn]
string tos(byteptr s, int len) {
	if (s == 0) {
		v_panic(tos_lit("tos(): nil string"));
	}
	return (string){.str = s, .len = len};
}

string tos_clone(byteptr s) {
	return string_clone(tos2(s));
}

string tos2(byteptr s) {
	if (s == 0) {
		v_panic(tos_lit("tos2: nil string"));
	}
	return (string){.str = s, .len = vstrlen(s)};
}

string tos3(charptr s) {
	if (s == 0) {
		v_panic(tos_lit("tos3: nil string"));
	}
	return (string){.str = ((byteptr)(s)), .len = strlen(s)};
}

string tos_lit(charptr s) {
	return (string){.str = ((byteptr)(s)), .len = strlen(s), .is_lit = 1};
}

static string string_clone_static(string a) {
	return string_clone(a);
}

string string_clone(string a) {
	string b = (string){.str = v_malloc(a.len + 1), .len = a.len};
	{ // Unsafe block
		memcpy(b.str, a.str, a.len);
		b.str[a.len] = '\0';
	}
	return b;
}

string cstring_to_vstring(byteptr cstr) {
	return tos_clone(cstr);
}

string string_replace_once(string s, string rep, string with) {
	Option_int _t30 = string_index(s, rep);
	if (!_t30.ok) {
		string err = _t30.v_error;
		int errcode = _t30.ecode;
		return string_clone(s);
	}
	int index = *(int*)_t30.data;
	return string_add(string_add(string_substr(s, 0, index), with), string_substr(s, index + rep.len, s.len));
}

string string_replace(string s, string rep, string with) {
	if (s.len == 0 || rep.len == 0) {
		return string_clone(s);
	}
	array_int idxs = __new_array_with_default(0, 0, sizeof(int), 0);
	int idx = 0;
	while (1) {
		idx = string_index_after(s, rep, idx);
		if (idx == -1) {
			break;
		}
		array_push(&idxs, _MOV((int[]){ idx }));
		idx += rep.len;
	}
	if (idxs.len == 0) {
		return string_clone(s);
	}
	int new_len = s.len + idxs.len * (with.len - rep.len);
	byteptr b = v_malloc(new_len + 1);
	int idx_pos = 0;
	int cur_idx = (*(int*)array_get(idxs, idx_pos));
	int b_i = 0;
	for (int i = 0; i < s.len; i++) {
		if (i == cur_idx) {
			for (int j = 0; j < with.len; ++j) {
				{ // Unsafe block
					b[b_i] = string_at(with, j);
				}
				b_i++;
			}
			i += rep.len - 1;
			idx_pos++;
			if (idx_pos < idxs.len) {
				cur_idx = (*(int*)array_get(idxs, idx_pos));
			}
		} else {
			{ // Unsafe block
				b[b_i] = string_at(s, i);
			}
			b_i++;
		}
	}
	{ // Unsafe block
		b[new_len] = '\0';
		return tos(b, new_len);
	}
}

static int compare_rep_index(RepIndex* a, RepIndex* b) {
	if (a->idx < b->idx) {
		return -1;
	}
	if (a->idx > b->idx) {
		return 1;
	}
	return 0;
}

static void array_RepIndex_sort(array_RepIndex* a) {
	array_sort_with_compare(a, compare_rep_index);
}

string string_replace_each(string s, array_string vals) {
	if (s.len == 0 || vals.len == 0) {
		return s;
	}
	if (vals.len % 2 != 0) {
		println(tos_lit("string.replace_each(): odd number of strings"));
		return s;
	}
	int new_len = s.len;
	array_RepIndex idxs = __new_array_with_default(0, 0, sizeof(RepIndex), 0);
	int idx = 0;
	for (int rep_i = 0; rep_i < vals.len; rep_i += 2) {
		string rep = (*(string*)array_get(vals, rep_i));
		string with = (*(string*)array_get(vals, rep_i + 1));
		while (1) {
			idx = string_index_after(s, rep, idx);
			if (idx == -1) {
				break;
			}
			array_push(&idxs, _MOV((RepIndex[]){ (RepIndex){.idx = idx,.val_idx = rep_i,} }));
			idx++;
			new_len += with.len - rep.len;
		}
	}
	if (idxs.len == 0) {
		return s;
	}
	array_RepIndex_sort(&idxs);
	byteptr b = v_malloc(new_len + 1);
	int idx_pos = 0;
	RepIndex cur_idx = (*(RepIndex*)array_get(idxs, idx_pos));
	int b_i = 0;
	for (int i = 0; i < s.len; i++) {
		if (i == cur_idx.idx) {
			string rep = (*(string*)array_get(vals, cur_idx.val_idx));
			string with = (*(string*)array_get(vals, cur_idx.val_idx + 1));
			for (int j = 0; j < with.len; ++j) {
				{ // Unsafe block
					b[b_i] = string_at(with, j);
				}
				b_i++;
			}
			i += rep.len - 1;
			idx_pos++;
			if (idx_pos < idxs.len) {
				cur_idx = (*(RepIndex*)array_get(idxs, idx_pos));
			}
		} else {
			{ // Unsafe block
				b[b_i] = s.str[i];
			}
			b_i++;
		}
	}
	{ // Unsafe block
		b[new_len] = '\0';
		return tos(b, new_len);
	}
}

bool string_bool(string s) {
	return string_eq(s, tos_lit("true")) || string_eq(s, tos_lit("t"));
}

int string_int(string s) {
	return ((int)(strconv__common_parse_int(s, 0, 32, false, false)));
}

i64 string_i64(string s) {
	return strconv__common_parse_int(s, 0, 64, false, false);
}

i8 string_i8(string s) {
	return ((i8)(strconv__common_parse_int(s, 0, 8, false, false)));
}

i16 string_i16(string s) {
	return ((i16)(strconv__common_parse_int(s, 0, 16, false, false)));
}

f32 string_f32(string s) {
	return ((f32)(strconv__atof64(s)));
}

f64 string_f64(string s) {
	return strconv__atof64(s);
}

u16 string_u16(string s) {
	return ((u16)(strconv__common_parse_uint(s, 0, 16, false, false)));
}

u32 string_u32(string s) {
	return ((u32)(strconv__common_parse_uint(s, 0, 32, false, false)));
}

u64 string_u64(string s) {
	return strconv__common_parse_uint(s, 0, 64, false, false);
}

static bool string_eq(string s, string a) {
	if (s.str == 0) {
		v_panic(tos_lit("string.eq(): nil string"));
	}
	if (s.len != a.len) {
		return false;
	}
	{ // Unsafe block
		return memcmp(s.str, a.str, a.len) == 0;
	}
}

static bool string_ne(string s, string a) {
	return !string_eq(s, a);
}

static bool string_lt(string s, string a) {
	for (int i = 0; i < s.len; ++i) {
		if (i >= a.len || string_at(s, i) > string_at(a, i)) {
			return false;
		} else if (string_at(s, i) < string_at(a, i)) {
			return true;
		}
	}
	if (s.len < a.len) {
		return true;
	}
	return false;
}

static bool string_le(string s, string a) {
	return string_lt(s, a) || string_eq(s, a);
}

static bool string_gt(string s, string a) {
	return !string_le(s, a);
}

static bool string_ge(string s, string a) {
	return !string_lt(s, a);
}

static string string_add(string s, string a) {
	int new_len = a.len + s.len;
	string res = (string){.str = v_malloc(new_len + 1), .len = new_len};
	for (int j = 0; j < s.len; ++j) {
		{ // Unsafe block
			res.str[j] = s.str[j];
		}
	}
	for (int j = 0; j < a.len; ++j) {
		{ // Unsafe block
			res.str[s.len + j] = a.str[j];
		}
	}
	{ // Unsafe block
		res.str[new_len] = '\0';
	}
	return res;
}

array_string string_split(string s, string delim) {
	return string_split_nth(s, delim, 0);
}

array_string string_split_nth(string s, string delim, int nth) {
	array_string res = __new_array_with_default(0, 0, sizeof(string), 0);
	int i = 0;
	if (delim.len == 0) {
		i = 1;
		for (int _t33 = 0; _t33 < s.len; ++_t33) {
			byte ch = s.str[_t33];
			if (nth > 0 && i >= nth) {
				array_push(&res, _MOV((string[]){ string_substr(s, i, s.len) }));
				break;
			}
			array_push(&res, _MOV((string[]){ byte_str(ch) }));
			i++;
		}
		return res;
	}
	int start = 0;
	int nth_1 = nth - 1;
	while (i <= s.len) {
		bool is_delim = s.str[i] == delim.str[0];
		int j = 0;
		while (is_delim && j < delim.len) {
			is_delim = is_delim && s.str[i + j] == delim.str[j];
			j++;
		}
		bool last = i == s.len - 1;
		if (is_delim || last) {
			if (!is_delim && last) {
				i++;
			}
			string val = string_substr(s, start, i);
			if (string_starts_with(val, delim)) {
				val = string_right(val, delim.len);
			}
			bool was_last = nth > 0 && res.len == nth_1;
			if (was_last) {
				array_push(&res, _MOV((string[]){ string_right(s, start) }));
				break;
			}
			array_push(&res, _MOV((string[]){ val }));
			start = i + delim.len;
		}
		i++;
	}
	if (string_ends_with(s, delim) && (nth < 1 || res.len < nth)) {
		array_push(&res, _MOV((string[]){ tos_lit("") }));
	}
	return res;
}

array_string string_split_into_lines(string s) {
	array_string res = __new_array_with_default(0, 0, sizeof(string), 0);
	if (s.len == 0) {
		return res;
	}
	int start = 0;
	for (int i = 0; i < s.len; i++) {
		bool is_lf = s.str[i] == '\n';
		bool is_crlf = i != s.len - 1 && s.str[i] == '\r' && s.str[i + 1] == '\n';
		bool is_eol = is_lf || is_crlf;
		bool is_last = (is_crlf ? (i == s.len - 2) : (i == s.len - 1));
		if (is_eol || is_last) {
			if (is_last && !is_eol) {
				i++;
			}
			string line = string_substr(s, start, i);
			array_push(&res, _MOV((string[]){ line }));
			if (is_crlf) {
				i++;
			}
			start = i + 1;
		}
	}
	return res;
}

static string string_left(string s, int n) {
	if (n >= s.len) {
		return s;
	}
	return string_substr(s, 0, n);
}

static string string_right(string s, int n) {
	if (n >= s.len) {
		return tos_lit("");
	}
	return string_substr(s, n, s.len);
}

static string string_substr2(string s, int start, int _end, bool end_max) {
	int end = (end_max ? (s.len) : (_end));
	return string_substr(s, start, end);
}

string string_substr(string s, int start, int end) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (start > end || start > s.len || end > s.len || start < 0 || end < 0) {
		v_panic(_STR("substr(%"PRId32"\000, %"PRId32"\000) out of bounds (len=%"PRId32"\000)", 4, start, end, s.len));
	}
#endif
// } no_bounds_checking
	int len = end - start;
	string res = (string){.str = v_malloc(len + 1), .len = len};
	for (int i = 0; i < len; ++i) {
		{ // Unsafe block
			res.str[i] = s.str[start + i];
		}
	}
	{ // Unsafe block
		res.str[len] = '\0';
	}
	return res;
}

int string_index_old(string s, string p) {
	if (p.len > s.len || p.len == 0) {
		return -1;
	}
	int i = 0;
	while (i < s.len) {
		int j = 0;
		while (j < p.len && s.str[i + j] == p.str[j]) {
			j++;
		}
		if (j == p.len) {
			return i;
		}
		i++;
	}
	return -1;
}

Option_int string_index(string s, string p) {
	if (p.len > s.len || p.len == 0) {
		Option _t40 = opt_none();
		return *(Option_int*)&_t40;
	}
	int i = 0;
	while (i < s.len) {
		int j = 0;
		while (j < p.len && s.str[i + j] == p.str[j]) {
			j++;
		}
		if (j == p.len) {
			Option_int _t41;
			opt_ok2(&(int[]) { i }, (OptionBase*)(&_t41), sizeof(int));
			return _t41;
		}
		i++;
	}
	Option _t42 = opt_none();
	return *(Option_int*)&_t42;
}

static int string_index_kmp(string s, string p) {
	if (p.len > s.len) {
		return -1;
	}
	array_int prefix = __new_array_with_default(p.len, 0, sizeof(int), 0);
	int j = 0;
	for (int i = 1; i < p.len; i++) {
		while (p.str[j] != p.str[i] && j > 0) {
			j = (*(int*)array_get(prefix, j - 1));
		}
		if (p.str[j] == p.str[i]) {
			j++;
		}
		array_set(&prefix, i, &(int[]) { j });
	}
	j = 0;
	for (int i = 0; i < s.len; ++i) {
		while (p.str[j] != s.str[i] && j > 0) {
			j = (*(int*)array_get(prefix, j - 1));
		}
		if (p.str[j] == s.str[i]) {
			j++;
		}
		if (j == p.len) {
			return i - p.len + 1;
		}
	}
	return -1;
}

int string_index_any(string s, string chars) {
	for (int _t43 = 0; _t43 < chars.len; ++_t43) {
		byte c = chars.str[_t43];
		Option_int _t44 = string_index(s, byte_str(c));
		if (!_t44.ok) {
			string err = _t44.v_error;
			int errcode = _t44.ecode;
			continue;
		}
		int index = *(int*)_t44.data;
		return index;
	}
	return -1;
}

Option_int string_last_index(string s, string p) {
	if (p.len > s.len || p.len == 0) {
		Option _t45 = opt_none();
		return *(Option_int*)&_t45;
	}
	int i = s.len - p.len;
	while (i >= 0) {
		int j = 0;
		while (j < p.len && s.str[i + j] == p.str[j]) {
			j++;
		}
		if (j == p.len) {
			Option_int _t46;
			opt_ok2(&(int[]) { i }, (OptionBase*)(&_t46), sizeof(int));
			return _t46;
		}
		i--;
	}
	Option _t47 = opt_none();
	return *(Option_int*)&_t47;
}

int string_index_after(string s, string p, int start) {
	if (p.len > s.len) {
		return -1;
	}
	int strt = start;
	if (start < 0) {
		strt = 0;
	}
	if (start >= s.len) {
		return -1;
	}
	int i = strt;
	while (i < s.len) {
		int j = 0;
		int ii = i;
		while (j < p.len && s.str[ii] == p.str[j]) {
			j++;
			ii++;
		}
		if (j == p.len) {
			return i;
		}
		i++;
	}
	return -1;
}

int string_index_byte(string s, byte c) {
	for (int i = 0; i < s.len; ++i) {
		if (s.str[i] == c) {
			return i;
		}
	}
	return -1;
}

int string_last_index_byte(string s, byte c) {
	for (int i = s.len - 1; i >= 0; i--) {
		if (s.str[i] == c) {
			return i;
		}
	}
	return -1;
}

int string_count(string s, string substr) {
	if (s.len == 0 || substr.len == 0) {
		return 0;
	}
	if (substr.len > s.len) {
		return 0;
	}
	int n = 0;
	int i = 0;
	while (1) {
		i = string_index_after(s, substr, i);
		if (i == -1) {
			return n;
		}
		i += substr.len;
		n++;
	}
	return 0;
}

bool string_contains(string s, string p) {
	if (p.len == 0) {
		return true;
	}
	Option_int _t48 = string_index(s, p);
	if (!_t48.ok) {
		string err = _t48.v_error;
		int errcode = _t48.ecode;
		return false;
	};
	return true;
}

bool string_starts_with(string s, string p) {
	if (p.len > s.len) {
		return false;
	}
	for (int i = 0; i < p.len; ++i) {
		if (s.str[i] != p.str[i]) {
			return false;
		}
	}
	return true;
}

bool string_ends_with(string s, string p) {
	if (p.len > s.len) {
		return false;
	}
	for (int i = 0; i < p.len; ++i) {
		if (string_at(p, i) != string_at(s, s.len - p.len + i)) {
			return false;
		}
	}
	return true;
}

string string_to_lower(string s) {
	{ // Unsafe block
		byteptr b = v_malloc(s.len + 1);
		for (int i = 0; i < s.len; ++i) {
			b[i] = ((byte)(tolower(s.str[i])));
		}
		return tos(b, s.len);
	}
}

bool string_is_lower(string s) {
	for (int i = 0; i < s.len; ++i) {
		if (string_at(s, i) >= 'A' && string_at(s, i) <= 'Z') {
			return false;
		}
	}
	return true;
}

string string_to_upper(string s) {
	{ // Unsafe block
		byteptr b = v_malloc(s.len + 1);
		for (int i = 0; i < s.len; ++i) {
			b[i] = ((byte)(toupper(s.str[i])));
		}
		return tos(b, s.len);
	}
}

bool string_is_upper(string s) {
	for (int i = 0; i < s.len; ++i) {
		if (string_at(s, i) >= 'a' && string_at(s, i) <= 'z') {
			return false;
		}
	}
	return true;
}

string string_capitalize(string s) {
	if (s.len == 0) {
		return tos_lit("");
	}
	string sl = string_to_lower(s);
	string cap = string_add(string_to_upper(byte_str(string_at(sl, 0))), string_right(sl, 1));
	return cap;
}

bool string_is_capital(string s) {
	if (s.len == 0 || !(string_at(s, 0) >= 'A' && string_at(s, 0) <= 'Z')) {
		return false;
	}
	for (int i = 1; i < s.len; ++i) {
		if (string_at(s, i) >= 'A' && string_at(s, i) <= 'Z') {
			return false;
		}
	}
	return true;
}

string string_title(string s) {
	array_string words = string_split(s, tos_lit(" "));
	array_string tit = __new_array_with_default(0, 0, sizeof(string), 0);
	// FOR IN array
	array _t49 = words;
	for (int _t50 = 0; _t50 < _t49.len; ++_t50) {
		string word = ((string*)_t49.data)[_t50];
		array_push(&tit, _MOV((string[]){ string_capitalize(word) }));
	}
	string title = array_string_join(tit, tos_lit(" "));
	return title;
}

bool string_is_title(string s) {
	array_string words = string_split(s, tos_lit(" "));
	// FOR IN array
	array _t52 = words;
	for (int _t53 = 0; _t53 < _t52.len; ++_t53) {
		string word = ((string*)_t52.data)[_t53];
		if (!string_is_capital(word)) {
			return false;
		}
	}
	return true;
}

string string_find_between(string s, string start, string end) {
	Option_int _t54 = string_index(s, start);
	if (!_t54.ok) {
		string err = _t54.v_error;
		int errcode = _t54.ecode;
		return tos_lit("");
	}
	int start_pos = *(int*)_t54.data;
	string val = string_right(s, start_pos + start.len);
	Option_int _t55 = string_index(val, end);
	if (!_t55.ok) {
		string err = _t55.v_error;
		int errcode = _t55.ecode;
		return val;
	}
	int end_pos = *(int*)_t55.data;
	return string_left(val, end_pos);
}

static bool array_string_contains(array_string ar, string val) {
	// FOR IN array
	array _t56 = ar;
	for (int _t57 = 0; _t57 < _t56.len; ++_t57) {
		string s = ((string*)_t56.data)[_t57];
		if (string_eq(s, val)) {
			return true;
		}
	}
	return false;
}

bool byte_is_space(byte c) {
	return (c == ' ' || c == '\n' || c == '\t' || c == '\v' || c == '\f' || c == '\r' || c == 0x85 || c == 0xa0);
}

string string_trim_space(string s) {
	return string_trim(s, tos_lit(" \n\t\v\f\r"));
}

string string_trim(string s, string cutset) {
	if (s.len < 1 || cutset.len < 1) {
		return s;
	}
	array_byte cs_arr = string_bytes(cutset);
	int pos_left = 0;
	int pos_right = s.len - 1;
	bool cs_match = true;
	while (pos_left <= s.len && pos_right >= -1 && cs_match) {
		cs_match = false;
		if (_IN(byte, string_at(s, pos_left), cs_arr)) {
			pos_left++;
			cs_match = true;
		}
		if (_IN(byte, string_at(s, pos_right), cs_arr)) {
			pos_right--;
			cs_match = true;
		}
		if (pos_left > pos_right) {
			return tos_lit("");
		}
	}
	return string_substr(s, pos_left, pos_right + 1);
}

string string_trim_left(string s, string cutset) {
	if (s.len < 1 || cutset.len < 1) {
		return s;
	}
	array_byte cs_arr = string_bytes(cutset);
	int pos = 0;
	while (pos < s.len && _IN(byte, string_at(s, pos), cs_arr)) {
		pos++;
	}
	return string_right(s, pos);
}

string string_trim_right(string s, string cutset) {
	if (s.len < 1 || cutset.len < 1) {
		return s;
	}
	array_byte cs_arr = string_bytes(cutset);
	int pos = s.len - 1;
	while (pos >= 0 && _IN(byte, string_at(s, pos), cs_arr)) {
		pos--;
	}
	return (pos < 0 ? (tos_lit("")) : (string_left(s, pos + 1)));
}

string string_trim_prefix(string s, string str) {
	if (string_starts_with(s, str)) {
		return string_substr(s, str.len, s.len);
	}
	return s;
}

string string_trim_suffix(string s, string str) {
	if (string_ends_with(s, str)) {
		return string_substr(s, 0, s.len - str.len);
	}
	return s;
}

int compare_strings(string* a, string* b) {
	if (string_lt(/*rec*/*a, *b)) {
		return -1;
	}
	if (string_gt(/*rec*/*a, *b)) {
		return 1;
	}
	return 0;
}

static int compare_strings_by_len(string* a, string* b) {
	if (a->len < b->len) {
		return -1;
	}
	if (a->len > b->len) {
		return 1;
	}
	return 0;
}

static int compare_lower_strings(string* a, string* b) {
	string aa = string_to_lower(/*rec*/*a);
	string bb = string_to_lower(/*rec*/*b);
	return compare_strings((voidptr)&/*qq*/aa, (voidptr)&/*qq*/bb);
}

void array_string_sort(array_string* s) {
	array_sort_with_compare(s, compare_strings);
}

void array_string_sort_ignore_case(array_string* s) {
	array_sort_with_compare(s, compare_lower_strings);
}

void array_string_sort_by_len(array_string* s) {
	array_sort_with_compare(s, compare_strings_by_len);
}

string string_str(string s) {
	return s;
}

string ustring_str(ustring s) {
	return s.s;
}

ustring string_ustring(string s) {
	ustring res = (ustring){.s = s,.runes = __new_array(0, s.len, ((int)(/*SizeOfType*/ sizeof(int)))),.len = 0,};
	for (int i = 0; i < s.len; i++) {
		int char_len = utf8_char_len(s.str[i]);
		array_push(&res.runes, _MOV((int[]){ i }));
		i += char_len - 1;
		res.len++;
	}
	return res;
}

ustring string_ustring_tmp(string s) {
	if (g_ustring_runes.len == 0) {
		g_ustring_runes = __new_array(0, 128, ((int)(/*SizeOfType*/ sizeof(int))));
	}
	ustring res = (ustring){.s = s,.runes = __new_array(0, 1, sizeof(int)),.len = 0,};
	res.runes = g_ustring_runes;
	res.runes.len = s.len;
	int j = 0;
	for (int i = 0; i < s.len; i++) {
		int char_len = utf8_char_len(s.str[i]);
		(*(int*)array_get(res.runes, j)) = i;
		j++;
		i += char_len - 1;
		res.len++;
	}
	return res;
}

static bool ustring_eq(ustring u, ustring a) {
	if (u.len != a.len || string_ne(u.s, a.s)) {
		return false;
	}
	return true;
}

static bool ustring_ne(ustring u, ustring a) {
	return !ustring_eq(u, a);
}

static bool ustring_lt(ustring u, ustring a) {
	return string_lt(u.s, a.s);
}

static bool ustring_le(ustring u, ustring a) {
	return ustring_lt(u, a) || ustring_eq(u, a);
}

static bool ustring_gt(ustring u, ustring a) {
	return !ustring_le(u, a);
}

static bool ustring_ge(ustring u, ustring a) {
	return !ustring_lt(u, a);
}

ustring ustring_add(ustring u, ustring a) {
	ustring res = (ustring){.s = string_add(u.s, a.s),.runes = __new_array(0, u.s.len + a.s.len, ((int)(/*SizeOfType*/ sizeof(int)))),.len = 0,};
	int j = 0;
	for (int i = 0; i < u.s.len; i++) {
		int char_len = utf8_char_len(u.s.str[i]);
		array_push(&res.runes, _MOV((int[]){ j }));
		i += char_len - 1;
		j += char_len;
		res.len++;
	}
	for (int i = 0; i < a.s.len; i++) {
		int char_len = utf8_char_len(a.s.str[i]);
		array_push(&res.runes, _MOV((int[]){ j }));
		i += char_len - 1;
		j += char_len;
		res.len++;
	}
	return res;
}

int ustring_index_after(ustring u, ustring p, int start) {
	if (p.len > u.len) {
		return -1;
	}
	int strt = start;
	if (start < 0) {
		strt = 0;
	}
	if (start > u.len) {
		return -1;
	}
	int i = strt;
	while (i < u.len) {
		int j = 0;
		int ii = i;
		while (j < p.len && string_eq(ustring_at(u, ii), ustring_at(p, j))) {
			j++;
			ii++;
		}
		if (j == p.len) {
			return i;
		}
		i++;
	}
	return -1;
}

int ustring_count(ustring u, ustring substr) {
	if (u.len == 0 || substr.len == 0) {
		return 0;
	}
	if (substr.len > u.len) {
		return 0;
	}
	int n = 0;
	int i = 0;
	while (1) {
		i = ustring_index_after(u, substr, i);
		if (i == -1) {
			return n;
		}
		i += substr.len;
		n++;
	}
	return 0;
}

string ustring_substr(ustring u, int _start, int _end) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (_start > _end || _start > u.len || _end > u.len || _start < 0 || _end < 0) {
		v_panic(_STR("substr(%"PRId32"\000, %"PRId32"\000) out of bounds (len=%"PRId32"\000)", 4, _start, _end, u.len));
	}
#endif
// } no_bounds_checking
	int end = (_end >= u.len ? (u.s.len) : ((*(int*)array_get(u.runes, _end))));
	return string_substr(u.s, (*(int*)array_get(u.runes, _start)), end);
}

string ustring_left(ustring u, int pos) {
	if (pos >= u.len) {
		return u.s;
	}
	return ustring_substr(u, 0, pos);
}

string ustring_right(ustring u, int pos) {
	if (pos >= u.len) {
		return tos_lit("");
	}
	return ustring_substr(u, pos, u.len);
}

static byte string_at(string s, int idx) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (idx < 0 || idx >= s.len) {
		v_panic(_STR("string index out of range: %"PRId32"\000 / %"PRId32"", 2, idx, s.len));
	}
#endif
// } no_bounds_checking
	{ // Unsafe block
		return s.str[idx];
	}
}

string ustring_at(ustring u, int idx) {
// $if !no_bounds_checking {
#ifndef CUSTOM_DEFINE_no_bounds_checking
	if (idx < 0 || idx >= u.len) {
		v_panic(_STR("string index out of range: %"PRId32"\000 / %"PRId32"", 2, idx, u.runes.len));
	}
#endif
// } no_bounds_checking
	return ustring_substr(u, idx, idx + 1);
}

// Attr: [unsafe_fn]
static void ustring_free(ustring* u) {
// $if  prealloc {
#ifdef _VPREALLOC
	return;
#endif
// } prealloc
	{ // Unsafe block
		array_free(&u->runes);
	}
}

bool byte_is_digit(byte c) {
	return c >= '0' && c <= '9';
}

bool byte_is_hex_digit(byte c) {
	return byte_is_digit(c) || (c >= 'a' && c <= 'f') || (c >= 'A' && c <= 'F');
}

bool byte_is_oct_digit(byte c) {
	return c >= '0' && c <= '7';
}

bool byte_is_bin_digit(byte c) {
	return c == '0' || c == '1';
}

bool byte_is_letter(byte c) {
	return (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z');
}

void string_free(string* s) {
// $if  prealloc {
#ifdef _VPREALLOC
	return;
#endif
// } prealloc
	if (s->is_lit == -98761234) {
		printf("double string.free() detected\n");
		return;
	}
	if (s->is_lit == 1 || s->len == 0) {
		return;
	}
	v_free(s->str);
	s->is_lit = -98761234;
}

string string_all_before(string s, string dot) {
	Option_int _t61 = string_index(s, dot);
	if (!_t61.ok) {
		string err = _t61.v_error;
		int errcode = _t61.ecode;
		return s;
	}
	int pos = *(int*)_t61.data;
	return string_left(s, pos);
}

string string_all_before_last(string s, string dot) {
	Option_int _t62 = string_last_index(s, dot);
	if (!_t62.ok) {
		string err = _t62.v_error;
		int errcode = _t62.ecode;
		return s;
	}
	int pos = *(int*)_t62.data;
	return string_left(s, pos);
}

string string_all_after(string s, string dot) {
	Option_int _t63 = string_index(s, dot);
	if (!_t63.ok) {
		string err = _t63.v_error;
		int errcode = _t63.ecode;
		return s;
	}
	int pos = *(int*)_t63.data;
	return string_right(s, pos + dot.len);
}

string string_all_after_last(string s, string dot) {
	Option_int _t64 = string_last_index(s, dot);
	if (!_t64.ok) {
		string err = _t64.v_error;
		int errcode = _t64.ecode;
		return s;
	}
	int pos = *(int*)_t64.data;
	return string_right(s, pos + dot.len);
}

string string_after(string s, string dot) {
	return string_all_after_last(s, dot);
}

string string_after_char(string s, byte dot) {
	int pos = 0;
	for (int i = 0; i < s.len; ++i) {
		byte c = s.str[i];
		if (c == dot) {
			pos = i;
			break;
		}
	}
	if (pos == 0) {
		return s;
	}
	return string_right(s, pos + 1);
}

string array_string_join(array_string a, string del) {
	if (a.len == 0) {
		return tos_lit("");
	}
	int len = 0;
	// FOR IN array
	array _t65 = a;
	for (int _t66 = 0; _t66 < _t65.len; ++_t66) {
		string val = ((string*)_t65.data)[_t66];
		len += val.len + del.len;
	}
	len -= del.len;
	string res = tos_lit("");
	res.len = len;
	res.str = v_malloc(res.len + 1);
	int idx = 0;
	// FOR IN array
	array _t67 = a;
	for (int i = 0; i < _t67.len; ++i) {
		string val = ((string*)_t67.data)[i];
		for (int j = 0; j < val.len; ++j) {
			{ // Unsafe block
				res.str[idx] = val.str[j];
			}
			idx++;
		}
		if (i != a.len - 1) {
			for (int k = 0; k < del.len; ++k) {
				{ // Unsafe block
					res.str[idx] = del.str[k];
				}
				idx++;
			}
		}
	}
	{ // Unsafe block
		res.str[res.len] = '\0';
	}
	return res;
}

string array_string_join_lines(array_string s) {
	return array_string_join(s, tos_lit("\n"));
}

string string_reverse(string s) {
	if (s.len == 0 || s.len == 1) {
		return s;
	}
	string res = (string){.str = v_malloc(s.len), .len = s.len};
	for (int i = s.len - 1; i >= 0; i--) {
		{ // Unsafe block
			res.str[s.len - i - 1] = string_at(s, i);
		}
	}
	return res;
}

string string_limit(string s, int max) {
	ustring u = string_ustring(s);
	if (u.len <= max) {
		return s;
	}
	return ustring_substr(u, 0, max);
}

// Attr: [deprecated]
bool byte_is_white(byte c) {
	eprintln(tos_lit("warning: `string.is_white` has been deprecated, use `string.is_space` instead"));
	return byte_is_space(c);
}

int string_hash(string s) {
	u32 h = ((u32)(0));
	if (h == 0 && s.len > 0) {
		for (int _t68 = 0; _t68 < s.len; ++_t68) {
			byte c = s.str[_t68];
			h = h * 31 + ((u32)(c));
		}
	}
	return ((int)(h));
}

array_byte string_bytes(string s) {
	if (s.len == 0) {
		return __new_array_with_default(0, 0, sizeof(byte), 0);
	}
	array_byte buf = __new_array_with_default(s.len, 0, sizeof(byte), 0);
	{ // Unsafe block
		memcpy(buf.data, s.str, s.len);
	}
	return buf;
}

string string_repeat(string s, int count) {
	if (count < 0) {
		v_panic(_STR("string.repeat: count is negative: %"PRId32"", 1, count));
	} else if (count == 0) {
		return tos_lit("");
	} else if (count == 1) {
		return s;
	}
	byteptr ret = v_malloc(s.len * count + 1);
	for (int i = 0; i < count; ++i) {
		for (int j = 0; j < s.len; ++j) {
			{ // Unsafe block
				ret[i * s.len + j] = string_at(s, j);
			}
		}
	}
	{ // Unsafe block
		ret[s.len * count] = 0;
	}
	return tos2((byteptr)ret);
}

array_string string_fields(string s) {
	return string_split(string_replace(s, tos_lit("\t"), tos_lit(" ")), tos_lit(" "));
}

string string_map(string s, byte (*func)(byte)) {
	{ // Unsafe block
		byteptr res = v_malloc(s.len + 1);
		for (int i = 0; i < s.len; ++i) {
			res[i] = func(string_at(s, i));
		}
		return tos(res, s.len);
	}
}

string string_filter(string s, bool (*func)(byte b)) {
	int new_len = 0;
	byteptr buf = v_malloc(s.len + 1);
	for (int i = 0; i < s.len; ++i) {
		byte b = string_at(s, i);
		if (func(b)) {
			buf[new_len] = b;
			new_len++;
		}
	}
	buf[new_len] = 0;
	return tos((byteptr)buf, new_len);
}

string string_strip_margin(string s) {
	return string_strip_margin_custom(s, '|');
}

string string_strip_margin_custom(string s, byte del) {
	byte sep = del;
	if (byte_is_space(sep)) {
		eprintln(tos_lit("Warning: `strip_margin` cannot use white-space as a delimiter"));
		eprintln(tos_lit("    Defaulting to `|`"));
		sep = '|';
	}
	byteptr ret = v_malloc(s.len + 1);
	int count = 0;
	for (int i = 0; i < s.len; i++) {
		if ((string_at(s, i) == '\n' || string_at(s, i) == '\r')) {
			{ // Unsafe block
				ret[count] = string_at(s, i);
			}
			count++;
			if (string_at(s, i) == '\r' && i < s.len - 1 && string_at(s, i + 1) == '\n') {
				{ // Unsafe block
					ret[count] = string_at(s, i + 1);
				}
				count++;
				i++;
			}
			while (string_at(s, i) != sep) {
				i++;
				if (i >= s.len) {
					break;
				}
			}
		} else {
			{ // Unsafe block
				ret[count] = string_at(s, i);
			}
			count++;
		}
	}
	{ // Unsafe block
		ret[count] = 0;
	}
	return tos2((byteptr)ret);
}

int utf8_char_len(byte b) {
	return (((0xe5000000 >> (((b >> 3) & 0x1e))) & 3)) + 1;
}

string utf32_to_str(u32 code) {
	int icode = ((int)(code));
	byteptr buffer = v_malloc(5);
	if (icode <= 127) {
		buffer[0] = ((byte)(icode));
		return tos(buffer, 1);
	}
	if (icode <= 2047) {
		buffer[0] = (192 | ((byte)(icode >> 6)));
		buffer[1] = (128 | ((byte)((icode & 63))));
		return tos(buffer, 2);
	}
	if (icode <= 65535) {
		buffer[0] = (224 | ((byte)(icode >> 12)));
		buffer[1] = (128 | ((((byte)(icode >> 6)) & 63)));
		buffer[2] = (128 | ((byte)((icode & 63))));
		return tos(buffer, 3);
	}
	if (icode <= 1114111) {
		buffer[0] = (240 | ((byte)(icode >> 18)));
		buffer[1] = (128 | ((((byte)(icode >> 12)) & 63)));
		buffer[2] = (128 | ((((byte)(icode >> 6)) & 63)));
		buffer[3] = (128 | ((byte)((icode & 63))));
		return tos(buffer, 4);
	}
	return tos_lit("");
}

string utf32_to_str_no_malloc(u32 code, voidptr buf) {
	int icode = ((int)(code));
	byteptr buffer = ((byteptr)(buf));
	if (icode <= 127) {
		buffer[0] = ((byte)(icode));
		return tos(buffer, 1);
	}
	if (icode <= 2047) {
		buffer[0] = (192 | ((byte)(icode >> 6)));
		buffer[1] = (128 | ((byte)((icode & 63))));
		return tos(buffer, 2);
	}
	if (icode <= 65535) {
		buffer[0] = (224 | ((byte)(icode >> 12)));
		buffer[1] = (128 | ((((byte)(icode >> 6)) & 63)));
		buffer[2] = (128 | ((byte)((icode & 63))));
		return tos(buffer, 3);
	}
	if (icode <= 1114111) {
		buffer[0] = (240 | ((byte)(icode >> 18)));
		buffer[1] = (128 | ((((byte)(icode >> 12)) & 63)));
		buffer[2] = (128 | ((((byte)(icode >> 6)) & 63)));
		buffer[3] = (128 | ((byte)((icode & 63))));
		return tos(buffer, 4);
	}
	return tos_lit("");
}

int string_utf32_code(string _rune) {
	if (_rune.len == 0) {
		return 0;
	}
	if (_rune.len == 1) {
		return ((int)(string_at(_rune, 0)));
	}
	byte b = ((byte)(((int)(string_at(_rune, 0)))));
	b = b << _rune.len;
	int res = ((int)(b));
	int shift = 6 - _rune.len;
	for (int i = 1; i < _rune.len; i++) {
		int c = ((int)(string_at(_rune, i)));
		res = res << shift;
		res |= (c & 63);
		shift = 6;
	}
	return res;
}

u16* string_to_wide(string _str) {
// $if  windows {
#ifdef _WIN32
#else
	return 0;
#endif
// } windows
}

string string_from_wide(u16* _wstr) {
// $if  windows {
#ifdef _WIN32
#else
	return tos_lit("");
#endif
// } windows
}

string string_from_wide2(u16* _wstr, int len) {
// $if  windows {
#ifdef _WIN32
#else
	return tos_lit("");
#endif
// } windows
}

static int utf8_len(byte c) {
	int b = 0;
	byte x = c;
	if (((x & 240)) != 0) {
		x >>= 4;
	} else {
		b += 4;
	}
	if (((x & 12)) != 0) {
		x >>= 2;
	} else {
		b += 2;
	}
	if (((x & 2)) == 0) {
		b++;
	}
	return b;
}

static int utf8_str_len(string s) {
	int l = 0;
	for (int i = 0; i < s.len; i++) {
		l++;
		byte c = s.str[i];
		if (((c & (1 << 7))) != 0) {
			for (byte t = ((byte)(1 << 6)); ((c & t)) != 0; t >>= 1) {
				i++;
			}
		}
	}
	return l;
}

static int utf8_str_visible_length(string s) {
	int l = 0;
	int ul = 1;
	for (int i = 0; i < s.len; i += ul) {
		ul = 1;
		byte c = s.str[i];
		if (((c & (1 << 7))) != 0) {
			for (byte t = ((byte)(1 << 6)); ((c & t)) != 0; t >>= 1) {
				ul++;
			}
		}
		if (i + ul > s.len) {
			return l;
		}
		l++;
		if (c == 0xcc || c == 0xcd) {
			u16 r = ((((u16)(c)) << 8) | s.str[i + 1]);
			if (r >= 0xcc80 && r < 0xcdb0) {
				l--;
			}
		} else if (c == 0xe1 || c == 0xe2 || c == 0xef) {
			u32 r = (((((u32)(c)) << 16) | (((u32)(s.str[i + 1])) << 8)) | s.str[i + 2]);
			if ((r >= 0xe1aab0 && r < 0xe1ac80) || (r >= 0xe1b780 && r < 0xe1b880) || (r >= 0xe28390 && r < 0xe28480) || (r >= 0xefb8a0 && r < 0xefb8b0)) {
				l--;
			}
		}
	}
	return l;
}

int utf8_getchar() {
	int c = getchar();
	int len = utf8_len(((byte)(~c)));
	if (c < 0) {
		return 0;
	} else if (len == 0) {
		return c;
	} else if (len == 1) {
		return -1;
	} else {
		int uc = (c & ((1 << (7 - len)) - 1));
		for (int i = 0; i + 1 < len; i++) {
			int c2 = getchar();
			if (c2 != -1 && (c2 >> 6) == 2) {
				uc <<= 6;
				uc |= ((c2 & 63));
			} else if (c2 == -1) {
				return 0;
			} else {
				return -1;
			}
		}
		return uc;
	}
}

Option_voidptr json__decode(voidptr typ, string s) {
	Option_voidptr _t69;
	opt_ok2(&(voidptr[]) { 0 }, (OptionBase*)(&_t69), sizeof(voidptr));
	return _t69;
}

string json__encode(voidptr x) {
	return tos_lit("");
}

static int json__decode_int(struct cJSON* root) {
	if (isnil(root)) {
		return 0;
	}
	return root->valueint;
}

static i8 json__decode_i8(struct cJSON* root) {
	if (isnil(root)) {
		return ((i8)(0));
	}
	return ((i8)(root->valueint));
}

static i16 json__decode_i16(struct cJSON* root) {
	if (isnil(root)) {
		return ((i16)(0));
	}
	return ((i16)(root->valueint));
}

static i64 json__decode_i64(struct cJSON* root) {
	if (isnil(root)) {
		return ((i64)(0));
	}
	return ((i64)(root->valuedouble));
}

static byte json__decode_byte(struct cJSON* root) {
	if (isnil(root)) {
		return ((byte)(0));
	}
	return ((byte)(root->valueint));
}

static u16 json__decode_u16(struct cJSON* root) {
	if (isnil(root)) {
		return ((u16)(0));
	}
	return ((u16)(root->valueint));
}

static u32 json__decode_u32(struct cJSON* root) {
	if (isnil(root)) {
		return ((u32)(0));
	}
	return ((u32)(root->valueint));
}

static u64 json__decode_u64(struct cJSON* root) {
	if (isnil(root)) {
		return ((u64)(0));
	}
	return ((u64)(root->valueint));
}

static f32 json__decode_f32(struct cJSON* root) {
	if (isnil(root)) {
		return ((f32)(0));
	}
	return root->valuedouble;
}

static f64 json__decode_f64(struct cJSON* root) {
	if (isnil(root)) {
		return ((f64)(0));
	}
	return ((f64)(root->valuedouble));
}

static string json__decode_string(struct cJSON* root) {
	if (isnil(root)) {
		return tos_lit("");
	}
	if (isnil(root->valuestring)) {
		return tos_lit("");
	}
	return tos_clone(root->valuestring);
}

static bool json__decode_bool(struct cJSON* root) {
	if (isnil(root)) {
		return false;
	}
	return cJSON_IsTrue(root);
}

static struct cJSON* json__encode_int(int val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_i8(i8 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_i16(i16 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_i64(i64 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_byte(byte val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_u16(u16 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_u32(u32 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_u64(u64 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_f32(f32 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_f64(f64 val) {
	return cJSON_CreateNumber(val);
}

static struct cJSON* json__encode_bool(bool val) {
	return cJSON_CreateBool(val);
}

static struct cJSON* json__encode_string(string val) {
	return cJSON_CreateString(val.str);
}

static struct cJSON* json__json_parse(string s) {
	return cJSON_Parse(s.str);
}

static string json__json_print(struct cJSON* json) {
	byteptr s = cJSON_PrintUnformatted(json);
	return tos(s, strlen(s));
}

string os__getenv(string key) {
// $if  windows {
#ifdef _WIN32
#else
	char* s = getenv(((charptr)(key.str)));
	if (s == ((voidptr)(0))) {
		return tos_lit("");
	}
	return cstring_to_vstring(((byteptr)(s)));
#endif
// } windows
}

int os__setenv(string name, string value, bool overwrite) {
// $if  windows {
#ifdef _WIN32
#else
	{ // Unsafe block
		return setenv(((charptr)(name.str)), ((charptr)(value.str)), overwrite);
	}
#endif
// } windows
}

int os__unsetenv(string name) {
// $if  windows {
#ifdef _WIN32
#else
	return unsetenv(((charptr)(name.str)));
#endif
// } windows
}

map_string_string os__environ() {
	map_string_string res = new_map_1(sizeof(string));
// $if  windows {
#ifdef _WIN32
#else
	charptr* e = ((charptr*)(environ));
	for (int i = 0; !isnil(e[i]); i++) {
		string eline = cstring_to_vstring(((byteptr)(e[i])));
		int eq_index = string_index_byte(eline, '=');
		if (eq_index > 0) {
			map_set(&res, string_substr(eline, 0, eq_index), &(string[]) { string_substr(eline, eq_index + 1, eline.len) });
		}
	}
#endif
// } windows
	return res;
}

os__FileMode os__inode(string path) {
	struct stat attr;
	{ // Unsafe block
		stat(((charptr)(path.str)), &attr);
	}
	os__FileType typ = os__FileType_regular;
	if ((attr.st_mode & ((u32)(S_IFMT))) == ((u32)(S_IFDIR))) {
		typ = os__FileType_directory;
	}
// $if !windows {
#ifndef _WIN32
	if ((attr.st_mode & ((u32)(S_IFMT))) == ((u32)(S_IFCHR))) {
		typ = os__FileType_character_device;
	} else if ((attr.st_mode & ((u32)(S_IFMT))) == ((u32)(S_IFBLK))) {
		typ = os__FileType_block_device;
	} else if ((attr.st_mode & ((u32)(S_IFMT))) == ((u32)(S_IFIFO))) {
		typ = os__FileType_fifo;
	} else if ((attr.st_mode & ((u32)(S_IFMT))) == ((u32)(S_IFLNK))) {
		typ = os__FileType_symbolic_link;
	} else if ((attr.st_mode & ((u32)(S_IFMT))) == ((u32)(S_IFSOCK))) {
		typ = os__FileType_socket;
	}
#endif
// } windows
// $if  windows {
#ifdef _WIN32
#else
	return (os__FileMode){.typ = typ,.owner = (os__FilePermission){.read = ((bool)((attr.st_mode & ((u32)(S_IRUSR))))),.write = ((bool)((attr.st_mode & ((u32)(S_IWUSR))))),.execute = ((bool)((attr.st_mode & ((u32)(S_IXUSR))))),},.group = (os__FilePermission){.read = ((bool)((attr.st_mode & ((u32)(S_IRGRP))))),.write = ((bool)((attr.st_mode & ((u32)(S_IWGRP))))),.execute = ((bool)((attr.st_mode & ((u32)(S_IXGRP))))),},.others = (os__FilePermission){.read = ((bool)((attr.st_mode & ((u32)(S_IROTH))))),.write = ((bool)((attr.st_mode & ((u32)(S_IWOTH))))),.execute = ((bool)((attr.st_mode & ((u32)(S_IXOTH))))),},};
#endif
// } windows
}

bool os__File_is_opened(os__File f) {
	return f.opened;
}

void os__File_write(os__File* f, string s) {
	if (!f->opened) {
		return;
	}
	fwrite(s.str, s.len, 1, f->cfile);
}

void os__File_writeln(os__File* f, string s) {
	if (!f->opened) {
		return;
	}
	fwrite(s.str, s.len, 1, f->cfile);
	fputs("\n", f->cfile);
}

int os__File_write_bytes(os__File* f, voidptr data, int size) {
	return fwrite(data, 1, size, f->cfile);
}

int os__File_write_bytes_at(os__File* f, voidptr data, int size, int pos) {
	fseek(f->cfile, pos, SEEK_SET);
	int res = fwrite(data, 1, size, f->cfile);
	fseek(f->cfile, 0, SEEK_END);
	return res;
}

array_byte os__File_read_bytes(os__File* f, int size) {
	return os__File_read_bytes_at(f, size, 0);
}

array_byte os__File_read_bytes_at(os__File* f, int size, int pos) {
	array_byte arr = array_repeat(new_array_from_c_array(1, 1, sizeof(byte), _MOV((byte[1]){'0'})), size);
	fseek(f->cfile, pos, SEEK_SET);
	int nreadbytes = fread(arr.data, 1, size, f->cfile);
	fseek(f->cfile, 0, SEEK_SET);
	return array_slice(arr, 0, nreadbytes);
}

Option_array_byte os__read_bytes(string path) {
	FILE* fp = os__vfopen(path, tos_lit("rb"));
	if (isnil(fp)) {
		Option _t70 = v_error(_STR("failed to open file \"%.*s\000\"", 2, path));
		return *(Option_array_byte*)&_t70;
	}
	fseek(fp, 0, SEEK_END);
	int fsize = ftell(fp);
	rewind(fp);
	array_byte res = array_repeat(new_array_from_c_array(1, 1, sizeof(byte), _MOV((byte[1]){'0'})), fsize);
	int nr_read_elements = fread(res.data, fsize, 1, fp);
	fclose(fp);
	Option_array_byte _t71;
	opt_ok2(&(array_byte[]) { array_slice(res, 0, nr_read_elements * fsize) }, (OptionBase*)(&_t71), sizeof(array_byte));
	return _t71;
}

Option_string os__read_file(string path) {
	string mode = tos_lit("rb");
	FILE* fp = os__vfopen(path, mode);
	if (isnil(fp)) {
		Option _t72 = v_error(_STR("failed to open file \"%.*s\000\"", 2, path));
		return *(Option_string*)&_t72;
	}
	fseek(fp, 0, SEEK_END);
	int fsize = ftell(fp);
	rewind(fp);
	byte* str = ((byte*)(0));
	{ // Unsafe block
		str = v_malloc(fsize + 1);
	}
	fread(str, fsize, 1, fp);
	str[fsize] = 0;
	// Defer begin
	fclose(fp);
	// Defer end
	Option_string _t73;
	opt_ok2(&(string[]) { tos((byteptr)str, fsize) }, (OptionBase*)(&_t73), sizeof(string));
	return _t73;
}

void os__File_flush(os__File* f) {
	if (!f->opened) {
		return;
	}
	fflush(f->cfile);
}

int os__file_size(string path) {
	struct stat s;
	{ // Unsafe block
// $if  windows {
#ifdef _WIN32
#else
		stat(((charptr)(path.str)), &s);
#endif
// } windows
	}
	return s.st_size;
}

void os__mv(string old, string v_new) {
// $if  windows {
#ifdef _WIN32
#else
	rename(((charptr)(old.str)), ((charptr)(v_new.str)));
#endif
// } windows
}

Option_void os__cp(string old, string v_new) {
// $if  windows {
#ifdef _WIN32
#else
	int fp_from = open(((charptr)(old.str)), O_RDONLY);
	if (fp_from < 0) {
		Option _t74 = error_with_code(_STR("cp: failed to open %.*s", 1, old), ((int)(fp_from)));
		return *(Option_void*)&_t74;
	}
	int fp_to = open(((charptr)(v_new.str)), ((O_WRONLY | O_CREAT) | O_TRUNC), (S_IWUSR | S_IRUSR));
	if (fp_to < 0) {
		close(fp_from);
		Option _t75 = error_with_code(_STR("cp: failed to write to %.*s", 1, v_new), ((int)(fp_to)));
		return *(Option_void*)&_t75;
	}
	array_fixed_byte_1024 buf = {0};
	int count = 0;
	while (1) {
		count = read(fp_from, buf, 1024);
		if (count == 0) {
			break;
		}
		if (write(fp_to, buf, count) < 0) {
			Option _t76 = error_with_code(_STR("cp: failed to write to %.*s", 1, v_new), ((int)(-1)));
			return *(Option_void*)&_t76;
		}
	}
	struct stat from_attr;
	{ // Unsafe block
		stat(((charptr)(old.str)), &from_attr);
	}
	if (chmod(((charptr)(v_new.str)), from_attr.st_mode) < 0) {
		Option _t77 = error_with_code(_STR("failed to set permissions for %.*s", 1, v_new), ((int)(-1)));
		return *(Option_void*)&_t77;
	}
#endif
// } windows
	Option_void _t78 = {.ok = true};
	return _t78;
}

// Attr: [deprecated]
Option_void os__cp_r(string osource_path, string odest_path, bool overwrite) {
	eprintln(tos_lit("warning: `os.cp_r` has been deprecated, use `os.cp_all` instead"));
	return os__cp_all(osource_path, odest_path, overwrite);
}

Option_void os__cp_all(string osource_path, string odest_path, bool overwrite) {
	string source_path = os__real_path(osource_path);
	string dest_path = os__real_path(odest_path);
	if (!os__exists(source_path)) {
		Option _t79 = v_error(tos_lit("Source path doesn\'t exist"));
		return *(Option_void*)&_t79;
	}
	if (!os__is_dir(source_path)) {
		string adjusted_path = (os__is_dir(dest_path) ? (os__join_path(dest_path, (varg_string){.len=1,.args={os__file_name(source_path)}})) : (dest_path));
		if (os__exists(adjusted_path)) {
			if (overwrite) {
				os__rm(adjusted_path);
			} else {
				Option _t80 = v_error(tos_lit("Destination file path already exist"));
				return *(Option_void*)&_t80;
			}
		}
		Option_void _t81 = os__cp(source_path, adjusted_path);
		if (!_t81.ok && !_t81.is_none) {
			string err = _t81.v_error;
			int errcode = _t81.ecode;
			Option _t82 = v_error(err);
			return *(Option_void*)&_t82;
		};
		Option_void _t83 = {.ok = true};
		return _t83;
	}
	if (!os__is_dir(dest_path)) {
		Option _t84 = v_error(tos_lit("Destination path is not a valid directory"));
		return *(Option_void*)&_t84;
	}
	Option_array_string _t85 = os__ls(source_path);
	if (!_t85.ok) {
		string err = _t85.v_error;
		int errcode = _t85.ecode;
		Option _t86 = v_error(err);
		return *(Option_void*)&_t86;
	}
	array_string files = *(array_string*)_t85.data;
	// FOR IN array
	array _t87 = files;
	for (int _t88 = 0; _t88 < _t87.len; ++_t88) {
		string file = ((string*)_t87.data)[_t88];
		string sp = os__join_path(source_path, (varg_string){.len=1,.args={file}});
		string dp = os__join_path(dest_path, (varg_string){.len=1,.args={file}});
		if (os__is_dir(sp)) {
			Option_bool _t89 = os__mkdir(dp);
			if (!_t89.ok) {
				string err = _t89.v_error;
				int errcode = _t89.ecode;
				Option _t90 = v_error(err);
				return *(Option_void*)&_t90;
			};
		}
		Option_void _t91 = os__cp_all(sp, dp, overwrite);
		if (!_t91.ok && !_t91.is_none) {
			string err = _t91.v_error;
			int errcode = _t91.ecode;
			os__rmdir(dp);
			Option _t92 = v_error(err);
			return *(Option_void*)&_t92;
		};
	}
	Option_void _t93 = {.ok = true};
	return _t93;
}

Option_void os__mv_by_cp(string source, string target) {
	Option_void _t94 = os__cp(source, target);
	if (!_t94.ok && !_t94.is_none) {
		string err = _t94.v_error;
		int errcode = _t94.ecode;
		Option _t95 = v_error(err);
		return *(Option_void*)&_t95;
	};
	Option_void _t96 = os__rm(source);
	if (!_t96.ok && !_t96.is_none) {
		string err = _t96.v_error;
		int errcode = _t96.ecode;
		Option _t97 = v_error(err);
		return *(Option_void*)&_t97;
	};
	Option_void _t98 = {.ok = true};
	return _t98;
}

FILE* os__vfopen(string path, string mode) {
// $if  windows {
#ifdef _WIN32
#else
	return fopen(((charptr)(path.str)), ((charptr)(mode.str)));
#endif
// } windows
}

int os__fileno(voidptr cfile) {
// $if  windows {
#ifdef _WIN32
#else
	FILE* cfile_casted = ((FILE*)(0));
	cfile_casted = cfile;
	return fileno(cfile_casted);
#endif
// } windows
}

Option_array_string os__read_lines(string path) {
	Option_string _t99 = os__read_file(path);
	if (!_t99.ok) {
		string err = _t99.v_error;
		int errcode = _t99.ecode;
		Option _t100 = v_error(err);
		return *(Option_array_string*)&_t100;
	}
	string buf = *(string*)_t99.data;
	Option_array_string _t101;
	opt_ok2(&(array_string[]) { string_split_into_lines(buf) }, (OptionBase*)(&_t101), sizeof(array_string));
	return _t101;
}

static Option_array_ustring os__read_ulines(string path) {
	Option_array_string _t102 = os__read_lines(path);
	if (!_t102.ok) {
		string err = _t102.v_error;
		int errcode = _t102.ecode;
		Option _t103 = v_error(err);
		return *(Option_array_ustring*)&_t103;
	}
	array_string lines = *(array_string*)_t102.data;
	array_ustring ulines = __new_array_with_default(0, 0, sizeof(ustring), 0);
	// FOR IN array
	array _t104 = lines;
	for (int _t105 = 0; _t105 < _t104.len; ++_t105) {
		string myline = ((string*)_t104.data)[_t105];
		array_push(&ulines, _MOV((ustring[]){ string_ustring(myline) }));
	}
	Option_array_ustring _t107;
	opt_ok2(&(array_ustring[]) { ulines }, (OptionBase*)(&_t107), sizeof(array_ustring));
	return _t107;
}

Option_os__File os__open_append(string path) {
	os__File file = (os__File){.cfile = 0,.fd = 0,.opened = 0,};
// $if  windows {
#ifdef _WIN32
#else
	byteptr cpath = path.str;
	file = (os__File){.cfile = fopen(((charptr)(cpath)), "ab"),.fd = 0,.opened = 0,};
#endif
// } windows
	if (isnil(file.cfile)) {
		Option _t108 = v_error(_STR("failed to create(append) file \"%.*s\000\"", 2, path));
		return *(Option_os__File*)&_t108;
	}
	file.opened = true;
	Option_os__File _t109;
	opt_ok2(&(os__File[]) { file }, (OptionBase*)(&_t109), sizeof(os__File));
	return _t109;
}

Option_os__File os__open_file(string path, string mode, varg_int options) {
	int flags = 0;
	for (int _t110 = 0; _t110 < mode.len; ++_t110) {
		byte m = mode.str[_t110];
		if (m == 'r') {
			flags |= _const_os__o_rdonly;
		} else if (m == 'w') {
			flags |= (_const_os__o_create | _const_os__o_trunc);
		} else if (m == 'a') {
			flags |= (_const_os__o_create | _const_os__o_append);
		} else if (m == 's') {
			flags |= _const_os__o_sync;
		} else if (m == 'n') {
			flags |= _const_os__o_nonblock;
		} else if (m == 'c') {
			flags |= _const_os__o_noctty;
		} else if (m == '+') {
			flags |= _const_os__o_rdwr;
		} else {
		};
	}
	int permission = 0666;
	if (options.len > 0) {
		permission = options.args[0];
	}
	string p = path;
	int fd = open(((charptr)(p.str)), flags, permission);
	if (fd == -1) {
		Option _t112 = v_error(os__posix_get_error_msg(errno));
		return *(Option_os__File*)&_t112;
	}
	voidptr cfile = fdopen(fd, ((charptr)(mode.str)));
	if (isnil(cfile)) {
		Option _t113 = v_error(_STR("Failed to open or create file \"%.*s\000\"", 2, path));
		return *(Option_os__File*)&_t113;
	}
	Option_os__File _t114;
	opt_ok2(&(os__File[]) { (os__File){.cfile = cfile,.fd = fd,.opened = true,} }, (OptionBase*)(&_t114), sizeof(os__File));
	return _t114;
}

static voidptr os__vpopen(string path) {
// $if  windows {
#ifdef _WIN32
#else
	byteptr cpath = path.str;
	return popen(((charptr)(cpath)), "r");
#endif
// } windows
}

static multi_return_int_bool os__posix_wait4_to_exit_status(int waitret) {
// $if  windows {
#ifdef _WIN32
#else
	int ret = 0;
	bool is_signaled = true;
	if (WIFEXITED(waitret)) {
		ret = WEXITSTATUS(waitret);
		is_signaled = false;
	} else if (WIFSIGNALED(waitret)) {
		ret = WTERMSIG(waitret);
		is_signaled = true;
	}
	return (multi_return_int_bool){.arg0=ret, .arg1=is_signaled};
#endif
// } windows
}

string os__posix_get_error_msg(int code) {
	charptr ptr_text = strerror(code);
	if (ptr_text == 0) {
		return tos_lit("");
	}
	return tos3(ptr_text);
}

static int os__vpclose(voidptr f) {
// $if  windows {
#ifdef _WIN32
#else
	multi_return_int_bool mr_9936 = os__posix_wait4_to_exit_status(pclose(f));
	int ret = mr_9936.arg0;
	return ret;
#endif
// } windows
}

int os__system(string cmd) {
	int ret = 0;
// $if  windows {
#ifdef _WIN32
#else
	{ // Unsafe block
		ret = system(((charptr)(cmd.str)));
	}
#endif
// } windows
	if (ret == -1) {
		os__print_c_errno();
	}
// $if !windows {
#ifndef _WIN32
	multi_return_int_bool mr_10743 = os__posix_wait4_to_exit_status(ret);
	int pret = mr_10743.arg0;
	bool is_signaled = mr_10743.arg1;
	if (is_signaled) {
		println(string_add(string_add(_STR("Terminated by signal %2"PRId32"\000 (", 2, ret), os__sigint_to_signal_name(pret)), tos_lit(")")));
	}
	ret = pret;
#endif
// } windows
	return ret;
}

string os__sigint_to_signal_name(int si) {
	if (si == 1) {
		return tos_lit("SIGHUP");
	} else if (si == 2) {
		return tos_lit("SIGINT");
	} else if (si == 3) {
		return tos_lit("SIGQUIT");
	} else if (si == 4) {
		return tos_lit("SIGILL");
	} else if (si == 6) {
		return tos_lit("SIGABRT");
	} else if (si == 8) {
		return tos_lit("SIGFPE");
	} else if (si == 9) {
		return tos_lit("SIGKILL");
	} else if (si == 11) {
		return tos_lit("SIGSEGV");
	} else if (si == 13) {
		return tos_lit("SIGPIPE");
	} else if (si == 14) {
		return tos_lit("SIGALRM");
	} else if (si == 15) {
		return tos_lit("SIGTERM");
	} else {
	};
// $if  linux {
#ifdef __linux__
	if (si == 10) {
		return tos_lit("SIGUSR1");
	} else if (si == 12) {
		return tos_lit("SIGUSR2");
	} else if (si == 17) {
		return tos_lit("SIGCHLD");
	} else if (si == 18) {
		return tos_lit("SIGCONT");
	} else if (si == 19) {
		return tos_lit("SIGSTOP");
	} else if (si == 20) {
		return tos_lit("SIGTSTP");
	} else if (si == 21) {
		return tos_lit("SIGTTIN");
	} else if (si == 22) {
		return tos_lit("SIGTTOU");
	} else if (si == 5) {
		return tos_lit("SIGTRAP");
	} else if (si == 7) {
		return tos_lit("SIGBUS");
	} else {
	};
#endif
// } linux
	return tos_lit("unknown");
}

bool os__exists(string path) {
// $if  windows {
#ifdef _WIN32
#else
	return access(((charptr)(path.str)), _const_os__f_ok) != -1;
#endif
// } windows
}

bool os__is_executable(string path) {
	return access(((charptr)(path.str)), _const_os__x_ok) != -1;
}

Option_bool os__is_writable_folder(string folder) {
	if (!os__exists(folder)) {
		Option _t117 = v_error(_STR("`%.*s\000` does not exist", 2, folder));
		return *(Option_bool*)&_t117;
	}
	if (!os__is_dir(folder)) {
		Option _t118 = v_error(tos_lit("`folder` is not a folder"));
		return *(Option_bool*)&_t118;
	}
	string tmp_perm_check = os__join_path(folder, (varg_string){.len=1,.args={tos_lit("tmp_perm_check")}});
	Option_os__File _t119 = os__open_file(tmp_perm_check, tos_lit("w+"), (varg_int){.len=1,.args={0700}});
	if (!_t119.ok) {
		string err = _t119.v_error;
		int errcode = _t119.ecode;
		Option _t120 = v_error(_STR("cannot write to folder `%.*s\000`: %.*s", 2, folder, err));
		return *(Option_bool*)&_t120;
	}
	os__File f = *(os__File*)_t119.data;
	os__File_close(&f);
	os__rm(tmp_perm_check);
	Option_bool _t121;
	opt_ok2(&(bool[]) { true }, (OptionBase*)(&_t121), sizeof(bool));
	return _t121;
}

bool os__is_writable(string path) {
// $if  windows {
#ifdef _WIN32
#else
	return access(((charptr)(path.str)), _const_os__w_ok) != -1;
#endif
// } windows
}

bool os__is_readable(string path) {
// $if  windows {
#ifdef _WIN32
#else
	return access(((charptr)(path.str)), _const_os__r_ok) != -1;
#endif
// } windows
}

// Attr: [deprecated]
bool os__file_exists(string _path) {
	eprintln(tos_lit("warning: `os.file_exists` has been deprecated, use `os.exists` instead"));
	return os__exists(_path);
}

Option_void os__rm(string path) {
// $if  windows {
#ifdef _WIN32
#else
	int rc = remove(((charptr)(path.str)));
	if (rc == -1) {
		Option _t122 = v_error(os__posix_get_error_msg(errno));
		return *(Option_void*)&_t122;
	}
#endif
// } windows
	Option_void _t123 = {.ok = true};
	return _t123;
}

Option_void os__rmdir(string path) {
// $if  windows {
#ifdef _WIN32
#else
	int rc = rmdir(((charptr)(path.str)));
	if (rc == -1) {
		Option _t124 = v_error(os__posix_get_error_msg(errno));
		return *(Option_void*)&_t124;
	}
#endif
// } windows
	Option_void _t125 = {.ok = true};
	return _t125;
}

// Attr: [deprecated]
void os__rmdir_recursive(string path) {
	eprintln(tos_lit("warning: `os.rmdir_recursive` has been deprecated, use `os.rmdir_all` instead"));
	os__rmdir_all(path);
}

Option_void os__rmdir_all(string path) {
	string ret_err = tos_lit("");
	Option_array_string _t126 = os__ls(path);
	if (!_t126.ok) {
		string err = _t126.v_error;
		int errcode = _t126.ecode;
		Option _t127 = v_error(err);
		return *(Option_void*)&_t127;
	}
	array_string items = *(array_string*)_t126.data;
	// FOR IN array
	array _t128 = items;
	for (int _t129 = 0; _t129 < _t128.len; ++_t129) {
		string item = ((string*)_t128.data)[_t129];
		if (os__is_dir(os__join_path(path, (varg_string){.len=1,.args={item}}))) {
			os__rmdir_all(os__join_path(path, (varg_string){.len=1,.args={item}}));
		}
		Option_void _t130 = os__rm(os__join_path(path, (varg_string){.len=1,.args={item}}));
		if (!_t130.ok && !_t130.is_none) {
			string err = _t130.v_error;
			int errcode = _t130.ecode;
			ret_err = err;
		};
	}
	Option_void _t131 = os__rmdir(path);
	if (!_t131.ok && !_t131.is_none) {
		string err = _t131.v_error;
		int errcode = _t131.ecode;
		ret_err = err;
	};
	if (ret_err.len > 0) {
		Option _t132 = v_error(ret_err);
		return *(Option_void*)&_t132;
	}
	Option_void _t133 = {.ok = true};
	return _t133;
}

bool os__is_dir_empty(string path) {
	Option_array_string _t134 = os__ls(path);
	if (!_t134.ok) {
		string err = _t134.v_error;
		int errcode = _t134.ecode;
		return true;
	}
	array_string items = *(array_string*)_t134.data;
	return items.len == 0;
}

static void os__print_c_errno() {
	int e = errno;
	string se = tos_clone(((byteptr)(strerror(errno))));
	println(_STR("errno=%"PRId32"\000 err=%.*s", 2, e, se));
}

string os__file_ext(string path) {
	Option_int _t135 = string_last_index(path, tos_lit("."));
	if (!_t135.ok) {
		string err = _t135.v_error;
		int errcode = _t135.ecode;
		return tos_lit("");
	}
	int pos = *(int*)_t135.data;
	return string_substr(path, pos, path.len);
}

string os__dir(string path) {
	Option_int _t136 = string_last_index(path, _const_os__path_separator);
	if (!_t136.ok) {
		string err = _t136.v_error;
		int errcode = _t136.ecode;
		return tos_lit(".");
	}
	int pos = *(int*)_t136.data;
	return string_substr(path, 0, pos);
}

string os__base_dir(string path) {
	Option_int _t137 = string_last_index(path, _const_os__path_separator);
	if (!_t137.ok) {
		string err = _t137.v_error;
		int errcode = _t137.ecode;
		return path;
	}
	int posx = *(int*)_t137.data;
	return string_substr(path, 0, posx);
}

string os__file_name(string path) {
	return string_all_after_last(path, _const_os__path_separator);
}

string os__input(string prompt) {
	print(prompt);
	os__flush();
	return os__get_line();
}

string os__get_line() {
	string str = os__get_raw_line();
// $if  windows {
#ifdef _WIN32
#else
	return string_trim_right(str, tos_lit("\n"));
#endif
// } windows
}

string os__get_raw_line() {
// $if  windows {
#ifdef _WIN32
#else
	size_t max = ((size_t)(0));
	charptr buf = ((charptr)(0));
	int nr_chars = getline(&buf, &max, stdin);
	if (nr_chars == 0 || nr_chars == -1) {
		return tos_lit("");
	}
	return tos3(buf);
#endif
// } windows
}

array_byte os__get_raw_stdin() {
// $if  windows {
#ifdef _WIN32
#else
	v_panic(tos_lit("get_raw_stdin not implemented on this platform..."));
#endif
// } windows
}

array_string os__get_lines() {
	string line = tos_lit("");
	array_string inputstr = __new_array_with_default(0, 0, sizeof(string), 0);
	while (1) {
		line = os__get_line();
		if (line.len <= 0) {
			break;
		}
		line = string_trim_space(line);
		array_push(&inputstr, _MOV((string[]){ line }));
	}
	return inputstr;
}

string os__get_lines_joined() {
	string line = tos_lit("");
	string inputstr = tos_lit("");
	while (1) {
		line = os__get_line();
		if (line.len <= 0) {
			break;
		}
		line = string_trim_space(line);
		inputstr = /*f*/string_add(inputstr, line);
	}
	return inputstr;
}

string os__user_os() {
// $if  linux {
#ifdef __linux__
	return tos_lit("linux");
#endif
// } linux
	return tos_lit("unknown");
}

string os__home_dir() {
// $if  windows {
#ifdef _WIN32
#else
	return string_add(os__getenv(tos_lit("HOME")), _const_os__path_separator);
#endif
// } windows
}

Option_void os__write_file(string path, string text) {
	Option_os__File _t139 = os__create(path);
	if (!_t139.ok) {
		string err = _t139.v_error;
		int errcode = _t139.ecode;
		Option _t140 = v_error(err);
		return *(Option_void*)&_t140;
	}
	os__File f = *(os__File*)_t139.data;
	os__File_write(&f, text);
	os__File_close(&f);
	Option_void _t141 = {.ok = true};
	return _t141;
}

Option_void os__write_file_array(string path, array buffer) {
	Option_os__File _t142 = os__create(path);
	if (!_t142.ok) {
		string err = _t142.v_error;
		int errcode = _t142.ecode;
		Option _t143 = v_error(err);
		return *(Option_void*)&_t143;
	}
	os__File f = *(os__File*)_t142.data;
	os__File_write_bytes_at(&f, buffer.data, (buffer.len * buffer.element_size), 0);
	os__File_close(&f);
	Option_void _t144 = {.ok = true};
	return _t144;
}


void os__on_segfault(voidptr f) {
}

string os__executable() {
// $if  linux {
#ifdef __linux__
	byteptr result = vcalloc(_const_os__max_path_len);
	int count = readlink("/proc/self/exe", ((charptr)(result)), _const_os__max_path_len);
	if (count < 0) {
		eprintln(tos_lit("os.executable() failed at reading /proc/self/exe to get exe path"));
		return os__executable_fallback();
	}
	return tos2((byteptr)result);
#endif
// } linux
	return os__executable_fallback();
}

static string os__executable_fallback() {
	if (_const_os__args.len == 0) {
		return tos_lit("");
	}
	string exepath = (*(string*)array_get(_const_os__args, 0));
	if (!os__is_abs_path(exepath)) {
		if (string_contains(exepath, _const_os__path_separator)) {
			exepath = os__join_path(_const_os__wd_at_startup, (varg_string){.len=1,.args={exepath}});
		} else {
			Option_string _t145 = os__find_abs_path_of_executable(exepath);
			if (!_t145.ok) {
				string err = _t145.v_error;
				int errcode = _t145.ecode;
				*(string*) _t145.data = tos_lit("");
			}
			string foundpath = *(string*)_t145.data;
			if (foundpath.len > 0) {
				exepath = foundpath;
			}
		}
	}
	exepath = os__real_path(exepath);
	return exepath;
}

Option_string os__find_abs_path_of_executable(string exepath) {
	if (os__is_abs_path(exepath)) {
		Option_string _t146;
		opt_ok2(&(string[]) { exepath }, (OptionBase*)(&_t146), sizeof(string));
		return _t146;
	}
	string res = tos_lit("");
	string env_path_delimiter = (string_eq(os__user_os(), tos_lit("windows")) ? (tos_lit(";")) : (tos_lit(":")));
	array_string paths = string_split(os__getenv(tos_lit("PATH")), env_path_delimiter);
	// FOR IN array
	array _t147 = paths;
	for (int _t148 = 0; _t148 < _t147.len; ++_t148) {
		string p = ((string*)_t147.data)[_t148];
		string found_abs_path = os__join_path(p, (varg_string){.len=1,.args={exepath}});
		if (os__exists(found_abs_path) && os__is_executable(found_abs_path)) {
			res = found_abs_path;
			break;
		}
	}
	if (res.len > 0) {
		Option_string _t149;
		opt_ok2(&(string[]) { res }, (OptionBase*)(&_t149), sizeof(string));
		return _t149;
	}
	Option _t150 = v_error(tos_lit("failed to find executable"));
	return *(Option_string*)&_t150;
}

bool os__exists_in_system_path(string prog) {
	Option_string _t151 = os__find_abs_path_of_executable(prog);
	if (!_t151.ok) {
		string err = _t151.v_error;
		int errcode = _t151.ecode;
		return false;
	};
	return true;
}

// Attr: [deprecated]
bool os__dir_exists(string path) {
	eprintln(tos_lit("warning: `os.dir_exists` has been deprecated, use `os.is_dir` instead"));
	return os__is_dir(path);
}

bool os__is_dir(string path) {
// $if  windows {
#ifdef _WIN32
#else
	struct stat statbuf;
	if (stat(((charptr)(path.str)), &statbuf) != 0) {
		return false;
	}
	int val = (((int)(statbuf.st_mode)) & _const_os__s_ifmt);
	return val == _const_os__s_ifdir;
#endif
// } windows
}

bool os__is_link(string path) {
// $if  windows {
#ifdef _WIN32
#else
	struct stat statbuf;
	if (lstat(((charptr)(path.str)), &statbuf) != 0) {
		return false;
	}
	return (((int)(statbuf.st_mode)) & _const_os__s_ifmt) == _const_os__s_iflnk;
#endif
// } windows
}

void os__chdir(string path) {
// $if  windows {
#ifdef _WIN32
#else
	chdir(((charptr)(path.str)));
#endif
// } windows
}

string os__getwd() {
// $if  windows {
#ifdef _WIN32
#else
	byteptr buf = vcalloc(512);
	if (getcwd(((charptr)(buf)), 512) == 0) {
		return tos_lit("");
	}
	return tos2((byteptr)buf);
#endif
// } windows
}

string os__real_path(string fpath) {
	byteptr fullpath = vcalloc(_const_os__max_path_len);
	charptr ret = ((charptr)(0));
// $if  windows {
#ifdef _WIN32
#else
	ret = ((charptr)(realpath(((charptr)(fpath.str)), ((charptr)(fullpath)))));
	if (ret == 0) {
		return fpath;
	}
#endif
// } windows
	return tos2((byteptr)fullpath);
}

bool os__is_abs_path(string path) {
	return string_at(path, 0) == '/';
}

string os__join_path(string base, varg_string dirs) {
	array_string result = __new_array_with_default(0, 0, sizeof(string), 0);
	array_push(&result, _MOV((string[]){ string_trim_right(base, tos_lit("\\/")) }));
	// FOR IN cond_type/variadic
	for (int _t153 = 0; _t153 < dirs.len; ++_t153) {
		string d = dirs.args[_t153];
		array_push(&result, _MOV((string[]){ d }));
	}
	return array_string_join(result, _const_os__path_separator);
}

array_string os__walk_ext(string path, string ext) {
	if (!os__is_dir(path)) {
		return __new_array_with_default(0, 0, sizeof(string), 0);
	}
	Option_array_string _t155 = os__ls(path);
	if (!_t155.ok) {
		string err = _t155.v_error;
		int errcode = _t155.ecode;
		return __new_array_with_default(0, 0, sizeof(string), 0);
	}
	array_string files = *(array_string*)_t155.data;
	array_string res = __new_array_with_default(0, 0, sizeof(string), 0);
	string separator = (string_ends_with(path, _const_os__path_separator) ? (tos_lit("")) : (_const_os__path_separator));
	// FOR IN array
	array _t156 = files;
	for (int _t157 = 0; _t157 < _t156.len; ++_t157) {
		string file = ((string*)_t156.data)[_t157];
		if (string_starts_with(file, tos_lit("."))) {
			continue;
		}
		string p = string_add(string_add(path, separator), file);
		if (os__is_dir(p) && !os__is_link(p)) {
			_PUSH_MANY(&res, (os__walk_ext(p, ext)), _t158, array_string);
		} else if (string_ends_with(file, ext)) {
			array_push(&res, _MOV((string[]){ p }));
		}
	}
	return res;
}

void os__walk(string path, void (*f)(string path)) {
	if (!os__is_dir(path)) {
		return;
	}
	Option_array_string _t160 = os__ls(path);
	if (!_t160.ok) {
		string err = _t160.v_error;
		int errcode = _t160.ecode;
		return;
	}
	array_string files = *(array_string*)_t160.data;
	// FOR IN array
	array _t161 = files;
	for (int _t162 = 0; _t162 < _t161.len; ++_t162) {
		string file = ((string*)_t161.data)[_t162];
		string p = string_add(string_add(path, _const_os__path_separator), file);
		if (os__is_dir(p) && !os__is_link(p)) {
			os__walk(p, f);
		} else if (os__exists(p)) {
			f(p);
		}
	}
	return;
}

// Attr: [unsafe_fn]
void os__signal(int signum, voidptr handler) {
	{ // Unsafe block
		signal(signum, handler);
	}
}

int os__fork() {
	int pid = -1;
// $if !windows {
#ifndef _WIN32
	pid = fork();
#endif
// } windows
	return pid;
}

int os__wait() {
	int pid = -1;
// $if !windows {
#ifndef _WIN32
	pid = wait(0);
#endif
// } windows
	return pid;
}

int os__file_last_mod_unix(string path) {
	struct stat attr;
	{ // Unsafe block
		stat(((charptr)(path.str)), &attr);
	}
	return attr.st_mtime;
}

void os__log(string s) {
	println(string_add(tos_lit("os.log: "), s));
}

// Attr: [deprecated]
void os__flush_stdout() {
	eprintln(tos_lit("warning: `os.flush_stdout` has been deprecated, use `os.flush` instead"));
	os__flush();
}

void os__flush() {
	fflush(stdout);
}

Option_void os__mkdir_all(string path) {
	string p = (string_starts_with(path, _const_os__path_separator) ? (_const_os__path_separator) : (tos_lit("")));
	array_string path_parts = string_split(string_trim_left(path, _const_os__path_separator), _const_os__path_separator);
	// FOR IN array
	array _t163 = path_parts;
	for (int _t164 = 0; _t164 < _t163.len; ++_t164) {
		string subdir = ((string*)_t163.data)[_t164];
		p = /*f*/string_add(p, string_add(subdir, _const_os__path_separator));
		if (os__exists(p) && os__is_dir(p)) {
			continue;
		}
		Option_bool _t165 = os__mkdir(p);
		if (!_t165.ok) {
			string err = _t165.v_error;
			int errcode = _t165.ecode;
			Option _t166 = v_error(_STR("folder: %.*s\000, error: %.*s", 2, p, err));
			return *(Option_void*)&_t166;
		};
	}
	Option_void _t167 = {.ok = true};
	return _t167;
}

string os__cache_dir() {
// $if !windows {
#ifndef _WIN32
	string xdg_cache_home = os__getenv(tos_lit("XDG_CACHE_HOME"));
	if (string_ne(xdg_cache_home, tos_lit(""))) {
		return xdg_cache_home;
	}
#endif
// } windows
	string cdir = string_add(os__home_dir(), tos_lit(".cache"));
	if (!os__is_dir(cdir) && !os__is_link(cdir)) {
		Option_bool _t168 = os__mkdir(cdir);
		if (!_t168.ok) {
			string err = _t168.v_error;
			int errcode = _t168.ecode;
			v_panic(err);
		};
	}
	return cdir;
}

string os__temp_dir() {
	string path = os__getenv(tos_lit("TMPDIR"));
	if (string_eq(path, tos_lit(""))) {
		path = os__cache_dir();
	}
	if (string_eq(path, tos_lit(""))) {
		path = tos_lit("/tmp");
	}
	return path;
}

void os__chmod(string path, int mode) {
	chmod(((charptr)(path.str)), mode);
}

string os__resource_abs_path(string path) {
	string base_path = os__real_path(os__dir(os__executable()));
	string vresource = os__getenv(tos_lit("V_RESOURCE_PATH"));
	if (vresource.len != 0) {
		base_path = vresource;
	}
	return os__real_path(os__join_path(base_path, (varg_string){.len=1,.args={path}}));
}

Option_os__File os__open(string path) {
	FILE* cfile = os__vfopen(path, tos_lit("rb"));
	if (cfile == ((voidptr)(0))) {
		Option _t169 = v_error(_STR("failed to open file \"%.*s\000\"", 2, path));
		return *(Option_os__File*)&_t169;
	}
	int fd = os__fileno(cfile);
	Option_os__File _t170;
	opt_ok2(&(os__File[]) { (os__File){.cfile = cfile,.fd = fd,.opened = true,} }, (OptionBase*)(&_t170), sizeof(os__File));
	return _t170;
}

Option_os__File os__create(string path) {
	FILE* cfile = os__vfopen(path, tos_lit("wb"));
	if (cfile == ((voidptr)(0))) {
		Option _t171 = v_error(_STR("failed to create file \"%.*s\000\"", 2, path));
		return *(Option_os__File*)&_t171;
	}
	int fd = os__fileno(cfile);
	Option_os__File _t172;
	opt_ok2(&(os__File[]) { (os__File){.cfile = cfile,.fd = fd,.opened = true,} }, (OptionBase*)(&_t172), sizeof(os__File));
	return _t172;
}

os__Uname os__uname() {
	os__Uname u = (os__Uname){.sysname = (string){.str=(byteptr)""},.nodename = (string){.str=(byteptr)""},.release = (string){.str=(byteptr)""},.version = (string){.str=(byteptr)""},.machine = (string){.str=(byteptr)""},};
	struct utsname* d = ((struct utsname*)(v_malloc(((int*)(/*SizeOfType*/ sizeof(struct utsname))))));
	if (uname(d) == 0) {
		u.sysname = cstring_to_vstring(((byteptr)(d->sysname)));
		u.nodename = cstring_to_vstring(((byteptr)(d->nodename)));
		u.release = cstring_to_vstring(((byteptr)(d->release)));
		u.version = cstring_to_vstring(((byteptr)(d->version)));
		u.machine = cstring_to_vstring(((byteptr)(d->machine)));
	}
	v_free(d);
	return u;
}

static array_string os__init_os_args(int argc, byte** argv) {
	array_string args = __new_array_with_default(0, 0, sizeof(string), 0);
	for (int i = 0; i < argc; ++i) {
		array_push(&args, _MOV((string[]){ tos2((byteptr)argv[i]) }));
	}
	return args;
}

Option_array_string os__ls(string path) {
	array_string res = __new_array_with_default(0, 0, sizeof(string), 0);
	voidptr dir = opendir(((charptr)(path.str)));
	if (isnil(dir)) {
		Option _t174 = v_error(_STR("ls() couldnt open dir \"%.*s\000\"", 2, path));
		return *(Option_array_string*)&_t174;
	}
	struct dirent* ent = ((struct dirent*)(0));
	while (1) {
		ent = readdir(dir);
		if (isnil(ent)) {
			break;
		}
		string name = tos_clone(((byteptr)(ent->d_name)));
		if (string_ne(name, tos_lit(".")) && string_ne(name, tos_lit("..")) && string_ne(name, tos_lit(""))) {
			array_push(&res, _MOV((string[]){ name }));
		}
	}
	closedir(dir);
	Option_array_string _t176;
	opt_ok2(&(array_string[]) { res }, (OptionBase*)(&_t176), sizeof(array_string));
	return _t176;
}

Option_bool os__mkdir(string path) {
	if (string_eq(path, tos_lit("."))) {
		Option_bool _t177;
		opt_ok2(&(bool[]) { true }, (OptionBase*)(&_t177), sizeof(bool));
		return _t177;
	}
	string apath = os__real_path(path);
	int r = mkdir(((charptr)(apath.str)), 511);
	if (r == -1) {
		Option _t178 = v_error(os__posix_get_error_msg(errno));
		return *(Option_bool*)&_t178;
	}
	Option_bool _t179;
	opt_ok2(&(bool[]) { true }, (OptionBase*)(&_t179), sizeof(bool));
	return _t179;
}

Option_os__Result os__exec(string cmd) {
	string pcmd = _STR("%.*s\000 2>&1", 2, cmd);
	voidptr f = os__vpopen(pcmd);
	if (isnil(f)) {
		Option _t180 = v_error(_STR("exec(\"%.*s\000\") failed", 2, cmd));
		return *(Option_os__Result*)&_t180;
	}
	array_fixed_byte_4096 buf = {0};
	strings__Builder res = strings__new_builder(1024);
	while (fgets(((charptr)(buf)), 4096, f) != 0) {
		byteptr bufbp = ((byteptr)(buf));
		strings__Builder_write_bytes(&res, bufbp, vstrlen(bufbp));
	}
	string soutput = strings__Builder_str(&res);
	int exit_code = os__vpclose(f);
	Option_os__Result _t181;
	opt_ok2(&(os__Result[]) { (os__Result){.exit_code = exit_code,.output = soutput,} }, (OptionBase*)(&_t181), sizeof(os__Result));
	return _t181;
}

Option_bool os__symlink(string origin, string target) {
	int res = symlink(((charptr)(origin.str)), ((charptr)(target.str)));
	if (res == 0) {
		Option_bool _t182;
		opt_ok2(&(bool[]) { true }, (OptionBase*)(&_t182), sizeof(bool));
		return _t182;
	}
	Option _t183 = v_error(os__posix_get_error_msg(errno));
	return *(Option_bool*)&_t183;
}

string os__get_error_msg(int code) {
	return os__posix_get_error_msg(code);
}

void os__File_close(os__File* f) {
	if (!f->opened) {
		return;
	}
	f->opened = false;
	fflush(f->cfile);
	fclose(f->cfile);
}

bool os__debugger_present() {
	return false;
}

string time__Time_format(time__Time t) {
	return time__Time_get_fmt_str(t, time__FormatDelimiter_hyphen, time__FormatTime_hhmm24, time__FormatDate_yyyymmdd);
}

string time__Time_format_ss(time__Time t) {
	return time__Time_get_fmt_str(t, time__FormatDelimiter_hyphen, time__FormatTime_hhmmss24, time__FormatDate_yyyymmdd);
}

string time__Time_hhmm(time__Time t) {
	return time__Time_get_fmt_time_str(t, time__FormatTime_hhmm24);
}

string time__Time_hhmmss(time__Time t) {
	return time__Time_get_fmt_time_str(t, time__FormatTime_hhmmss24);
}

string time__Time_hhmm12(time__Time t) {
	return time__Time_get_fmt_time_str(t, time__FormatTime_hhmm12);
}

string time__Time_ymmdd(time__Time t) {
	return time__Time_get_fmt_date_str(t, time__FormatDelimiter_hyphen, time__FormatDate_yyyymmdd);
}

string time__Time_ddmmy(time__Time t) {
	return time__Time_get_fmt_date_str(t, time__FormatDelimiter_dot, time__FormatDate_ddmmyyyy);
}

string time__Time_md(time__Time t) {
	return time__Time_get_fmt_date_str(t, time__FormatDelimiter_space, time__FormatDate_mmmd);
}

string time__Time_clean(time__Time t) {
	time__Time znow = time__now();
	if (t.month == znow.month && t.year == znow.year && t.day == znow.day) {
		return time__Time_get_fmt_time_str(t, time__FormatTime_hhmm24);
	}
	if (t.year == znow.year) {
		return time__Time_get_fmt_str(t, time__FormatDelimiter_space, time__FormatTime_hhmm24, time__FormatDate_mmmd);
	}
	return time__Time_format(t);
}

string time__Time_clean12(time__Time t) {
	time__Time znow = time__now();
	if (t.month == znow.month && t.year == znow.year && t.day == znow.day) {
		return time__Time_get_fmt_time_str(t, time__FormatTime_hhmm12);
	}
	if (t.year == znow.year) {
		return time__Time_get_fmt_str(t, time__FormatDelimiter_space, time__FormatTime_hhmm12, time__FormatDate_mmmd);
	}
	return time__Time_format(t);
}

string time__Time_get_fmt_time_str(time__Time t, time__FormatTime fmt_time) {
	if (fmt_time == time__FormatTime_no_time) {
		return tos_lit("");
	}
	string tp = (t.hour > 11 ? (tos_lit("p.m.")) : (tos_lit("a.m.")));
	int hour = (t.hour > 12 ? (t.hour - 12) : t.hour == 0 ? (12) : (t.hour));
	return (fmt_time == time__FormatTime_hhmm12) ? (_STR("%"PRId32"\000:%02"PRId32"\000 %.*s", 3, hour, t.minute, tp)) : (fmt_time == time__FormatTime_hhmm24) ? (_STR("%02"PRId32"\000:%02"PRId32"", 2, t.hour, t.minute)) : (fmt_time == time__FormatTime_hhmmss12) ? (_STR("%"PRId32"\000:%02"PRId32"\000:%02"PRId32"\000 %.*s", 4, hour, t.minute, t.second, tp)) : (fmt_time == time__FormatTime_hhmmss24) ? (_STR("%02"PRId32"\000:%02"PRId32"\000:%02"PRId32"", 3, t.hour, t.minute, t.second)) : (_STR("unknown enumeration %.*s", 1, time__FormatTime_str(fmt_time)));
}

string time__Time_get_fmt_date_str(time__Time t, time__FormatDelimiter fmt_dlmtr, time__FormatDate fmt_date) {
	if (fmt_date == time__FormatDate_no_date) {
		return tos_lit("");
	}
	string month = _STR("%.*s", 1, time__Time_smonth(t));
	string year = string_substr(int_str(t.year), 2, int_str(t.year).len);
	string res = (fmt_date == time__FormatDate_ddmmyy) ? (_STR("%02"PRId32"\000|%02"PRId32"\000|%.*s", 3, t.day, t.month, year)) : (fmt_date == time__FormatDate_ddmmyyyy) ? (_STR("%02"PRId32"\000|%02"PRId32"\000|%"PRId32"", 3, t.day, t.month, t.year)) : (fmt_date == time__FormatDate_mmddyy) ? (_STR("%02"PRId32"\000|%02"PRId32"\000|%.*s", 3, t.month, t.day, year)) : (fmt_date == time__FormatDate_mmddyyyy) ? (_STR("%02"PRId32"\000|%02"PRId32"\000|%"PRId32"", 3, t.month, t.day, t.year)) : (fmt_date == time__FormatDate_mmmd) ? (_STR("%.*s\000|%"PRId32"", 2, month, t.day)) : (fmt_date == time__FormatDate_mmmdd) ? (_STR("%.*s\000|%02"PRId32"", 2, month, t.day)) : (fmt_date == time__FormatDate_mmmddyyyy) ? (_STR("%.*s\000|%02"PRId32"\000|%"PRId32"", 3, month, t.day, t.year)) : (fmt_date == time__FormatDate_yyyymmdd) ? (_STR("%"PRId32"\000|%02"PRId32"\000|%02"PRId32"", 3, t.year, t.month, t.day)) : (_STR("unknown enumeration %.*s", 1, time__FormatDate_str(fmt_date)));
	res = string_replace(res, tos_lit("|"), (fmt_dlmtr == time__FormatDelimiter_dot) ? (tos_lit(".")) : (fmt_dlmtr == time__FormatDelimiter_hyphen) ? (tos_lit("-")) : (fmt_dlmtr == time__FormatDelimiter_slash) ? (tos_lit("/")) : (fmt_dlmtr == time__FormatDelimiter_space) ? (tos_lit(" ")) : (tos_lit("")));
	return res;
}

string time__Time_get_fmt_str(time__Time t, time__FormatDelimiter fmt_dlmtr, time__FormatTime fmt_time, time__FormatDate fmt_date) {
	if (fmt_date == time__FormatDate_no_date) {
		if (fmt_time == time__FormatTime_no_time) {
			return tos_lit("");
		} else {
			return time__Time_get_fmt_time_str(t, fmt_time);
		}
	} else {
		if (fmt_time != time__FormatTime_no_time) {
			return string_add(string_add(time__Time_get_fmt_date_str(t, fmt_dlmtr, fmt_date), tos_lit(" ")), time__Time_get_fmt_time_str(t, fmt_time));
		} else {
			return time__Time_get_fmt_date_str(t, fmt_dlmtr, fmt_date);
		}
	}
}

string time__Time_utc_string(time__Time time) {
	string day_str = time__Time_weekday_str(time);
	string month_str = time__Time_smonth(time);
	string utc_string = _STR("%.*s\000, %"PRId32"\000 %.*s\000 %"PRId32"\000 %02"PRId32"\000:%02"PRId32"\000:%02"PRId32"\000 UTC", 8, day_str, time.day, month_str, time.year, time.hour, time.minute, time.second);
	return utc_string;
}

// Attr: [inline]
inline bool time__Time_eq(time__Time t1, time__Time t2) {
	if (t1.v_unix == t2.v_unix && t1.microsecond == t2.microsecond) {
		return true;
	}
	return false;
}

bool time__Time_ne(time__Time t1, time__Time t2) {
	return !time__Time_eq(t1, t2);
}

bool time__Time_lt(time__Time t1, time__Time t2) {
	if (t1.v_unix < t2.v_unix || (t1.v_unix == t2.v_unix && t1.microsecond < t2.microsecond)) {
		return true;
	}
	return false;
}

bool time__Time_le(time__Time t1, time__Time t2) {
	return time__Time_lt(t1, t2) || time__Time_eq(t1, t2);
}

bool time__Time_gt(time__Time t1, time__Time t2) {
	if (t1.v_unix > t2.v_unix || (t1.v_unix == t2.v_unix && t1.microsecond > t2.microsecond)) {
		return true;
	}
	return false;
}

bool time__Time_ge(time__Time t1, time__Time t2) {
	return time__Time_gt(t1, t2) || time__Time_eq(t1, t2);
}

Option_time__Time time__parse(string s) {
	Option_int _t187 = string_index(s, tos_lit(" "));
	if (!_t187.ok) {
		string err = _t187.v_error;
		int errcode = _t187.ecode;
		Option _t188 = v_error(_STR("Invalid time format: %.*s", 1, s));
		return *(Option_time__Time*)&_t188;
	}
	int pos = *(int*)_t187.data;
	string symd = string_substr(s, 0, pos);
	array_string ymd = string_split(symd, tos_lit("-"));
	if (ymd.len != 3) {
		Option _t189 = v_error(_STR("Invalid time format: %.*s", 1, s));
		return *(Option_time__Time*)&_t189;
	}
	string shms = string_substr(s, pos, s.len);
	array_string hms = string_split(shms, tos_lit(":"));
	string hour = string_substr((*(string*)array_get(hms, 0)), 1, (*(string*)array_get(hms, 0)).len);
	string minute = (*(string*)array_get(hms, 1));
	string second = (*(string*)array_get(hms, 2));
	time__Time res = time__new_time((time__Time){
		.year = string_int((*(string*)array_get(ymd, 0))),
		.month = string_int((*(string*)array_get(ymd, 1))),
		.day = string_int((*(string*)array_get(ymd, 2))),
		.hour = string_int(hour),
		.minute = string_int(minute),
		.second = string_int(second),
		.microsecond = 0,
		.v_unix = 0,
	});
	Option_time__Time _t190;
	opt_ok2(&(time__Time[]) { res }, (OptionBase*)(&_t190), sizeof(time__Time));
	return _t190;
}

Option_time__Time time__parse_rfc2822(string s) {
	array_string fields = string_split(s, tos_lit(" "));
	if (fields.len < 5) {
		Option _t191 = v_error(_STR("Invalid time format: %.*s", 1, s));
		return *(Option_time__Time*)&_t191;
	}
	Option_int _t192 = string_index(_const_time__months_string, (*(string*)array_get(fields, 2)));
	if (!_t192.ok) {
		string err = _t192.v_error;
		int errcode = _t192.ecode;
		Option _t193 = v_error(_STR("Invalid time format: %.*s", 1, s));
		return *(Option_time__Time*)&_t193;
	}
	int pos = *(int*)_t192.data;
	int mm = pos / 3 + 1;
	byteptr tmstr = ((byteptr)(0));
	{ // Unsafe block
		tmstr = v_malloc(s.len * 2);
	}
	int count = snprintf(((charptr)(tmstr)), (s.len * 2), "%s-%02d-%s %s", (*(string*)array_get(fields, 3)).str, mm, (*(string*)array_get(fields, 1)).str, (*(string*)array_get(fields, 4)).str);
	return time__parse(tos(tmstr, count));
}

Option_time__Time time__parse_iso8601(string s) {
	int year = 0;
	int month = 0;
	int day = 0;
	int hour = 0;
	int minute = 0;
	int second = 0;
	int mic_second = 0;
	byte time_char = 'a';
	byte plus_min = 'a';
	int offset_hour = 0;
	int offset_min = 0;
	int count = sscanf(((charptr)(s.str)), "%4d-%2d-%2d%c%2d:%2d:%2d.%6d%c%2d:%2d", &year, &month, &day, &time_char, &hour, &minute, &second, &mic_second, &plus_min, &offset_hour, &offset_min);
	if (count != 11) {
		Option _t194 = v_error(tos_lit("Invalid 8601 format"));
		return *(Option_time__Time*)&_t194;
	}
	if (time_char != 'T' && time_char != ' ') {
		Option _t195 = v_error(tos_lit("Invalid 8601 format, expected space or `T` as time separator"));
		return *(Option_time__Time*)&_t195;
	}
	if (plus_min != '+' && plus_min != '-') {
		Option _t196 = v_error(tos_lit("Invalid 8601 format, expected `+` or `-` as time separator"));
		return *(Option_time__Time*)&_t196;
	}
	time__Time t = time__new_time((time__Time){
		.year = year,
		.month = month,
		.day = day,
		.hour = hour,
		.minute = minute,
		.second = second,
		.microsecond = mic_second,
		.v_unix = 0,
	});
	u64 unix_time = t.v_unix;
	int unix_offset = ((int)(0));
	if (offset_hour > 0) {
		unix_offset += 3600 * offset_hour;
	}
	if (offset_min > 0) {
		unix_offset += 60 * offset_min;
	}
	if (unix_offset != 0) {
		if (plus_min == '+') {
			unix_time -= ((u64)(unix_offset));
		} else {
			unix_time += ((u64)(unix_offset));
		}
		t = time__unix2(((int)(unix_time)), t.microsecond);
	}
	Option_time__Time _t197;
	opt_ok2(&(time__Time[]) { time__to_local_time(t) }, (OptionBase*)(&_t197), sizeof(time__Time));
	return _t197;
}

time__StopWatch time__new_stopwatch(time__StopWatchOptions opts) {
	u64 initial = ((u64)(0));
	if (opts.auto_start) {
		initial = time__sys_mono_now();
	}
	return (time__StopWatch){.elapsed = 0,.start = initial,.end = 0,};
}

void time__StopWatch_start(time__StopWatch* t) {
	t->start = time__sys_mono_now();
	t->end = 0;
}

void time__StopWatch_restart(time__StopWatch* t) {
	t->start = time__sys_mono_now();
	t->end = 0;
	t->elapsed = 0;
}

void time__StopWatch_stop(time__StopWatch* t) {
	t->end = time__sys_mono_now();
}

void time__StopWatch_pause(time__StopWatch* t) {
	if (t->start > 0) {
		if (t->end == 0) {
			t->elapsed += time__sys_mono_now() - t->start;
		} else {
			t->elapsed += t->end - t->start;
		}
	}
	t->start = 0;
}

time__Duration time__StopWatch_elapsed(time__StopWatch t) {
	if (t.start > 0) {
		if (t.end == 0) {
			return ((time__Duration)(time__sys_mono_now() - t.start + t.elapsed));
		} else {
			return ((time__Duration)(t.end - t.start + t.elapsed));
		}
	}
	return ((time__Duration)(t.elapsed));
}

time__Time time__now() {
// $if  linux {
#ifdef __linux__
	return time__linux_now();
#endif
// } linux
	time_t t = time(0);
	struct tm* now = localtime(&t);
	return time__convert_ctime(*now, 0);
}

time__Time time__utc() {
// $if  linux {
#ifdef __linux__
	return time__linux_utc();
#endif
// } linux
	time_t t = time(0);
	time(&t);
	return time__unix2(((int)(t)), 0);
}

string time__Time_smonth(time__Time t) {
	int i = t.month - 1;
	return string_substr(_const_time__months_string, i * 3, (i + 1) * 3);
}

time__Time time__new_time(time__Time t) {
	return (time__Time){
		.year = t.year,
		.month = t.month,
		.day = t.day,
		.hour = t.hour,
		.minute = t.minute,
		.second = t.second,
		.microsecond = t.microsecond,
		.v_unix = ((u64)(time__Time_unix_time(t))),
	};
}

int time__Time_unix_time(time__Time t) {
	if (t.v_unix != 0) {
		return ((int)(t.v_unix));
	}
	struct tm tt = (struct tm){
		.tm_sec = t.second,
		.tm_min = t.minute,
		.tm_hour = t.hour,
		.tm_mday = t.day,
		.tm_mon = t.month - 1,
		.tm_year = t.year - 1900,
		.tm_wday = 0,
		.tm_yday = 0,
		.tm_isdst = 0,
	};
	return time__make_unix_time(tt);
}

time__Time time__Time_add_seconds(time__Time t, int seconds) {
	return time__unix(((int)(t.v_unix + ((u64)(seconds)))));
}

time__Time time__Time_add_days(time__Time t, int days) {
	return time__unix(((int)(t.v_unix + ((u64)(((i64)(days)) * 3600 * 24)))));
}

static int time__since(time__Time t) {
	return 0;
}

string time__Time_relative(time__Time t) {
	time__Time znow = time__now();
	u64 secs = znow.v_unix - t.v_unix;
	if (secs <= 30) {
		return tos_lit("now");
	}
	if (secs < 60) {
		return tos_lit("1m");
	}
	if (secs < 3600) {
		u64 m = secs / 60;
		if (m == 1) {
			return tos_lit("1 minute ago");
		}
		return _STR("%"PRIu64"\000 minutes ago", 2, m);
	}
	if (secs < 3600 * 24) {
		u64 h = secs / 3600;
		if (h == 1) {
			return tos_lit("1 hour ago");
		}
		return _STR("%"PRIu64"\000 hours ago", 2, h);
	}
	if (secs < 3600 * 24 * 5) {
		u64 d = secs / 3600 / 24;
		if (d == 1) {
			return tos_lit("1 day ago");
		}
		return _STR("%"PRIu64"\000 days ago", 2, d);
	}
	if (secs > 3600 * 24 * 10000) {
		return tos_lit("");
	}
	return time__Time_md(t);
}

string time__Time_relative_short(time__Time t) {
	time__Time znow = time__now();
	u64 secs = znow.v_unix - t.v_unix;
	if (secs <= 30) {
		return tos_lit("now");
	}
	if (secs < 60) {
		return tos_lit("1m");
	}
	if (secs < 3600) {
		return _STR("%"PRIu64"\000m", 2, secs / 60);
	}
	if (secs < 3600 * 24) {
		return _STR("%"PRIu64"\000h", 2, secs / 3600);
	}
	if (secs < 3600 * 24 * 5) {
		return _STR("%"PRIu64"\000d", 2, secs / 3600 / 24);
	}
	if (secs > 3600 * 24 * 10000) {
		return tos_lit("");
	}
	return time__Time_md(t);
}

int time__day_of_week(int y, int m, int d) {
	array_int t = new_array_from_c_array(12, 12, sizeof(int), _MOV((int[12]){
			0, 3, 2, 5, 0, 3, 5, 1, 4, 6, 2, 4}));
	int sy = y;
	if (m < 3) {
		sy = sy - 1;
	}
	return (sy + sy / 4 - sy / 100 + sy / 400 + (*(int*)array_get(t, m - 1)) + d - 1) % 7 + 1;
}

int time__Time_day_of_week(time__Time t) {
	return time__day_of_week(t.year, t.month, t.day);
}

string time__Time_weekday_str(time__Time t) {
	int i = time__Time_day_of_week(t) - 1;
	return string_substr(_const_time__days_string, i * 3, (i + 1) * 3);
}

i64 time__ticks() {
// $if  windows {
#ifdef _WIN32
#else
	struct timeval ts = (struct timeval){.tv_sec = 0,.tv_usec = 0,};
	gettimeofday(&ts, 0);
	return ((i64)(ts.tv_sec * ((u64)(1000)) + (ts.tv_usec / ((u64)(1000)))));
#endif
// } windows
}

void time__sleep(int seconds) {
// $if  windows {
#ifdef _WIN32
#else
	sleep(seconds);
#endif
// } windows
}

void time__sleep_ms(int milliseconds) {
// $if  windows {
#ifdef _WIN32
#else
	usleep(milliseconds * 1000);
#endif
// } windows
}

void time__usleep(int microseconds) {
// $if  windows {
#ifdef _WIN32
#else
	usleep(microseconds);
#endif
// } windows
}

bool time__is_leap_year(int year) {
	return (year % 4 == 0) && (year % 100 != 0 || year % 400 == 0);
}

Option_int time__days_in_month(int month, int year) {
	if (month > 12 || month < 1) {
		Option _t198 = v_error(_STR("Invalid month: %"PRId32"", 1, month));
		return *(Option_int*)&_t198;
	}
	int extra = (month == 2 && time__is_leap_year(year) ? (1) : (0));
	int res = (*(int*)array_get(_const_time__month_days, month - 1)) + extra;
	Option_int _t199;
	opt_ok2(&(int[]) { res }, (OptionBase*)(&_t199), sizeof(int));
	return _t199;
}

string time__Time_str(time__Time t) {
	return time__Time_format_ss(t);
}

static time__Time time__convert_ctime(struct tm t, int microsecond) {
	return (time__Time){
		.year = t.tm_year + 1900,
		.month = t.tm_mon + 1,
		.day = t.tm_mday,
		.hour = t.tm_hour,
		.minute = t.tm_min,
		.second = t.tm_sec,
		.microsecond = microsecond,
		.v_unix = ((u64)(time__make_unix_time(t))),
	};
}

// TypeDecl
i64 time__Duration_nanoseconds(time__Duration d) {
	return ((i64)(d));
}

i64 time__Duration_microseconds(time__Duration d) {
	return ((i64)(d)) / 1000;
}

i64 time__Duration_milliseconds(time__Duration d) {
	return ((i64)(d)) / 1000000;
}

f64 time__Duration_seconds(time__Duration d) {
	i64 sec = d / _const_time__second;
	i64 nsec = d % _const_time__second;
	return ((f64)(sec)) + ((f64)(nsec)) / 1e9;
}

f64 time__Duration_minutes(time__Duration d) {
	i64 min = d / _const_time__minute;
	i64 nsec = d % _const_time__minute;
	return ((f64)(min)) + ((f64)(nsec)) / (60 * 1e9);
}

f64 time__Duration_hours(time__Duration d) {
	i64 hr = d / _const_time__hour;
	i64 nsec = d % _const_time__hour;
	return ((f64)(hr)) + ((f64)(nsec)) / (60 * 60 * 1e9);
}

// Attr: [inline]
inline static time__Time time__linux_now() {
	struct timespec ts = (struct timespec){.tv_sec = 0,.tv_nsec = 0,};
	clock_gettime(CLOCK_REALTIME, &ts);
	struct tm loc_tm = (struct tm){.tm_sec = 0,.tm_min = 0,.tm_hour = 0,.tm_mday = 0,.tm_mon = 0,.tm_year = 0,.tm_wday = 0,.tm_yday = 0,.tm_isdst = 0,};
	localtime_r(&ts.tv_sec, &loc_tm);
	return time__convert_ctime(loc_tm, ((int)(ts.tv_nsec / 1000)));
}

// Attr: [inline]
inline static time__Time time__linux_utc() {
	struct timespec ts = (struct timespec){.tv_sec = 0,.tv_nsec = 0,};
	clock_gettime(CLOCK_REALTIME, &ts);
	return time__unix2(((int)(ts.tv_sec)), ((int)(ts.tv_nsec / 1000)));
}

static u64 time__sys_mono_now_darwin() {
	return 0;
}

time__Time time__darwin_now() {
	return (time__Time){.year = 0,.month = 0,.day = 0,.hour = 0,.minute = 0,.second = 0,.microsecond = 0,.v_unix = 0,};
}

time__Time time__solaris_now() {
	return (time__Time){.year = 0,.month = 0,.day = 0,.hour = 0,.minute = 0,.second = 0,.microsecond = 0,.v_unix = 0,};
}

time__Time time__darwin_utc() {
	return (time__Time){.year = 0,.month = 0,.day = 0,.hour = 0,.minute = 0,.second = 0,.microsecond = 0,.v_unix = 0,};
}

time__Time time__solaris_utc() {
	return (time__Time){.year = 0,.month = 0,.day = 0,.hour = 0,.minute = 0,.second = 0,.microsecond = 0,.v_unix = 0,};
}

static int time__make_unix_time(struct tm t) {
	return ((int)(timegm(&t)));
}

static time__Time time__to_local_time(time__Time t) {
	struct tm loc_tm = (struct tm){.tm_sec = 0,.tm_min = 0,.tm_hour = 0,.tm_mday = 0,.tm_mon = 0,.tm_year = 0,.tm_wday = 0,.tm_yday = 0,.tm_isdst = 0,};
	localtime_r(((time__time_t)(&t.v_unix)), &loc_tm);
	return time__convert_ctime(loc_tm, t.microsecond);
}

// TypeDecl
u64 time__sys_mono_now() {
// $if  macos {
#ifdef __APPLE__
#else
	struct timespec ts = (struct timespec){.tv_sec = 0,.tv_nsec = 0,};
	clock_gettime(CLOCK_MONOTONIC, &ts);
	return ((u64)(ts.tv_sec)) * 1000000000 + ((u64)(ts.tv_nsec));
#endif
// } macos
}

// Attr: [inline]
inline static u64 time__vpc_now() {
	struct timespec ts = (struct timespec){.tv_sec = 0,.tv_nsec = 0,};
	clock_gettime(CLOCK_MONOTONIC, &ts);
	return ((u64)(ts.tv_sec)) * 1000000000 + ((u64)(ts.tv_nsec));
}

time__Time time__win_now() {
	return (time__Time){.year = 0,.month = 0,.day = 0,.hour = 0,.minute = 0,.second = 0,.microsecond = 0,.v_unix = 0,};
}

time__Time time__win_utc() {
	return (time__Time){.year = 0,.month = 0,.day = 0,.hour = 0,.minute = 0,.second = 0,.microsecond = 0,.v_unix = 0,};
}

struct timespec time__Duration_timespec(time__Duration d) {
	struct timespec ts = (struct timespec){.tv_sec = 0,.tv_nsec = 0,};
	clock_gettime(CLOCK_REALTIME, &ts);
	i64 d_sec = d / _const_time__second;
	i64 d_nsec = d % _const_time__second;
	ts.tv_sec += d_sec;
	ts.tv_nsec += d_nsec;
	if (ts.tv_nsec > _const_time__second) {
		ts.tv_nsec -= _const_time__second;
		ts.tv_sec++;
	}
	return ts;
}

struct timespec time__zero_timespec() {
	struct timespec ts = (struct timespec){.tv_sec = 0,.tv_nsec = 0,};
	return ts;
}

time__Time time__unix(int abs) {
	int day_offset = abs / _const_time__seconds_per_day;
	if (abs % _const_time__seconds_per_day < 0) {
		day_offset--;
	}
	multi_return_int_int_int mr_470 = time__calculate_date_from_offset(day_offset);
	int year = mr_470.arg0;
	int month = mr_470.arg1;
	int day = mr_470.arg2;
	multi_return_int_int_int mr_524 = time__calculate_time_from_offset(abs % _const_time__seconds_per_day);
	int hr = mr_524.arg0;
	int min = mr_524.arg1;
	int sec = mr_524.arg2;
	return (time__Time){
		.year = year,
		.month = month,
		.day = day,
		.hour = hr,
		.minute = min,
		.second = sec,
		.microsecond = 0,
		.v_unix = ((u64)(abs)),
	};
}

time__Time time__unix2(int abs, int microsecond) {
	int day_offset = abs / _const_time__seconds_per_day;
	if (abs % _const_time__seconds_per_day < 0) {
		day_offset--;
	}
	multi_return_int_int_int mr_1019 = time__calculate_date_from_offset(day_offset);
	int year = mr_1019.arg0;
	int month = mr_1019.arg1;
	int day = mr_1019.arg2;
	multi_return_int_int_int mr_1073 = time__calculate_time_from_offset(abs % _const_time__seconds_per_day);
	int hr = mr_1073.arg0;
	int min = mr_1073.arg1;
	int sec = mr_1073.arg2;
	return (time__Time){
		.year = year,
		.month = month,
		.day = day,
		.hour = hr,
		.minute = min,
		.second = sec,
		.microsecond = microsecond,
		.v_unix = ((u64)(abs)),
	};
}

// Attr: [inline]
inline static multi_return_int_int_int time__calculate_date_from_offset(int day_offset_) {
	int day_offset = day_offset_;
	int year = 2001;
	day_offset -= 31 * 365 + 8;
	year += (day_offset / _const_time__days_per_400_years) * 400;
	day_offset %= _const_time__days_per_400_years;
	if (day_offset == _const_time__days_per_100_years * 4) {
		year += 300;
		day_offset -= _const_time__days_per_100_years * 3;
	} else {
		year += (day_offset / _const_time__days_per_100_years) * 100;
		day_offset %= _const_time__days_per_100_years;
	}
	if (day_offset == _const_time__days_per_4_years * 25) {
		year += 96;
		day_offset -= _const_time__days_per_4_years * 24;
	} else {
		year += (day_offset / _const_time__days_per_4_years) * 4;
		day_offset %= _const_time__days_per_4_years;
	}
	if (day_offset == 365 * 4) {
		year += 3;
		day_offset -= 365 * 3;
	} else {
		year += (day_offset / 365);
		day_offset %= 365;
	}
	if (day_offset < 0) {
		year--;
		if (time__is_leap_year(year)) {
			day_offset += 366;
		} else {
			day_offset += 365;
		}
	}
	if (time__is_leap_year(year)) {
		if (day_offset > 31 + 29 - 1) {
			day_offset--;
		} else if (day_offset == 31 + 29 - 1) {
			return (multi_return_int_int_int){.arg0=year, .arg1=2, .arg2=29};
		}
	}
	int estimated_month = day_offset / 31;
	while (day_offset >= (*(int*)array_get(_const_time__days_before, estimated_month + 1))) {
		estimated_month++;
	}
	while (day_offset < (*(int*)array_get(_const_time__days_before, estimated_month))) {
		if (estimated_month == 0) {
			break;
		}
		estimated_month--;
	}
	day_offset -= (*(int*)array_get(_const_time__days_before, estimated_month));
	return (multi_return_int_int_int){.arg0=year, .arg1=estimated_month + 1, .arg2=day_offset + 1};
}

// Attr: [inline]
inline static multi_return_int_int_int time__calculate_time_from_offset(int second_offset_) {
	int second_offset = second_offset_;
	if (second_offset < 0) {
		second_offset += _const_time__seconds_per_day;
	}
	int hour = second_offset / _const_time__seconds_per_hour;
	second_offset %= _const_time__seconds_per_hour;
	int min = second_offset / _const_time__seconds_per_minute;
	second_offset %= _const_time__seconds_per_minute;
	return (multi_return_int_int_int){.arg0=hour, .arg1=min, .arg2=second_offset};
}

multi_return_string_int_int hl__highlight_text(string st, string ext, bool commit) {
	if (!commit) {
		if (string_eq(string_to_lower(*(string*)array_last(string_split(ext, tos_lit(".")))), tos_lit("md"))) {
			string output = st;
			return (multi_return_string_int_int){.arg0=output, .arg1=0, .arg2=0};
		}
	}
	Option_hl__Lang _t200 = hl__extension_to_lang(ext);
	if (!_t200.ok) {
		string err = _t200.v_error;
		int errcode = _t200.ecode;
		*(hl__Lang*) _t200.data = (hl__Lang){.keywords = __new_array(0, 1, sizeof(string)),.lang_extensions = __new_array(0, 1, sizeof(string)),.string_start = __new_array(0, 1, sizeof(string)),.line_comments = (string){.str=(byteptr)""},.mline_comments = __new_array(0, 1, sizeof(string)),.color = (string){.str=(byteptr)""},.name = (string){.str=(byteptr)""},};
	}
	hl__Lang lang = *(hl__Lang*)_t200.data;
	string text = _STR("%.*s\000 ", 2, st);
	array_byte res = __new_array_with_default(0, 0, sizeof(byte), 0);
	int lines = 0;
	int sloc = 0;
	byte ss = ((byte)(' '));
	string lc = lang.line_comments;
	string mlc = tos_lit("");
	string mlc_end = tos_lit("");
	if (lang.mline_comments.len >= 2) {
		mlc = (*(string*)array_get(lang.mline_comments, 0));
		mlc_end = (*(string*)array_get(lang.mline_comments, 1));
	}
	_PUSH_MANY(&res, (string_bytes(tos_lit("<table class=\"hl_table\">"))), _t201, array_byte);
	array_push(&res, _MOV((byte[]){ '\n' }));
	if (!hl__is_single_line(st)) {
		_PUSH_MANY(&res, (string_bytes(tos_lit("<tr><td><a id=\"1\" class=\"no_select\" href=\"#1\">1</a></td><td>"))), _t203, array_byte);
		lines++;
	}
	bool in_comment = false;
	bool in_line_comment = false;
	bool in_string = false;
	array_byte runes = string_bytes(text);
	for (int pos = 0; pos < runes.len - 1; pos++) {
		byte c = (*(byte*)array_get(runes, pos));
		if (c == '\n') {
			lines++;
			if (commit) {
				string v_class = tos_lit("");
				if ((*(byte*)array_get(runes, pos + 1)) == '+') {
					v_class = tos_lit("class=\"a\"");
				} else if ((*(byte*)array_get(runes, pos + 1)) == '-') {
					v_class = tos_lit("class=\"d\"");
				}
				_PUSH_MANY(&res, (string_bytes(_STR("</td></tr>\n<tr><td><a id=\"%"PRId32"\000\" class=\"no_select\" href=\"#%"PRId32"\000\">%"PRId32"\000</a></td><td %.*s\000>", 5, lines, lines, lines, v_class))), _t204, array_byte);
			} else {
				_PUSH_MANY(&res, (string_bytes(_STR("</td></tr>\n<tr><td><a id=\"%"PRId32"\000\" class=\"no_select\" href=\"#%"PRId32"\000\">%"PRId32"\000</a></td><td>", 4, lines, lines, lines))), _t205, array_byte);
			}
			if (in_line_comment) {
				in_line_comment = false;
				_PUSH_MANY(&res, (string_bytes(tos_lit("</i>"))), _t206, array_byte);
			}
			if (in_comment) {
				_PUSH_MANY(&res, (string_bytes(tos_lit("<i>"))), _t207, array_byte);
			}
			if (!in_comment && !in_line_comment && (*(byte*)array_get(runes, pos + 1)) != (*(byte*)array_get(string_bytes(tos_lit("\n")), 0))) {
				sloc++;
			}
			continue;
		}
		if (c == '\t') {
			_PUSH_MANY(&res, (string_bytes(_const_hl__tab)), _t208, array_byte);
			continue;
		}
		if (in_comment) {
			_PUSH_MANY(&res, (hl__write(c)), _t209, array_byte);
			if (c == (*(byte*)array_get(string_bytes(mlc_end), 0)) && hl__is_line_comment(runes, pos, mlc_end)) {
				in_comment = false;
				array_push(&res, _MOV((byte[]){ (*(byte*)array_get(runes, pos + 1)) }));
				pos++;
				_PUSH_MANY(&res, (string_bytes(tos_lit("</i>"))), _t211, array_byte);
			}
			continue;
		}
		if (in_line_comment) {
			_PUSH_MANY(&res, (hl__write(c)), _t212, array_byte);
			continue;
		}
		if (in_string) {
			_PUSH_MANY(&res, (hl__write(c)), _t213, array_byte);
			if ((*(byte*)array_get(runes, pos - 1)) == '\\' && ss == (*(byte*)array_get(string_bytes(tos_lit("\"")), 0))) {
				continue;
			}
			if (c == ss) {
				in_string = false;
				_PUSH_MANY(&res, (string_bytes(tos_lit("</u>"))), _t214, array_byte);
			}
			continue;
		}
		if (hl__is_letter(c, lang)) {
			int word_start = pos;
			while (hl__is_letter(c, lang)) {
				pos++;
				c = (*(byte*)array_get(runes, pos));
			}
			int delta = pos - word_start;
			array_byte data = __new_array_with_default(0, 0, sizeof(byte), 0);
			for (int i = 0; i < delta; ++i) {
				array_push(&data, _MOV((byte[]){ (*(byte*)array_get(runes, word_start + i)) }));
			}
			string w = tos2((byteptr)data.data);
			pos--;
			if (_IN(string, w, lang.keywords)) {
				_PUSH_MANY(&res, (string_bytes(_STR("<b>%.*s\000</b>", 2, w))), _t216, array_byte);
			} else {
				_PUSH_MANY(&res, (string_bytes(w)), _t217, array_byte);
			}
			continue;
		}
		if (hl__is_string_token(c, lang)) {
			in_string = true;
			ss = c;
			_PUSH_MANY(&res, (string_bytes(tos_lit("<u>"))), _t218, array_byte);
		} else if (string_ne(mlc, tos_lit("")) && c == (*(byte*)array_get(string_bytes(mlc), 0)) && hl__is_line_comment(runes, pos, mlc)) {
			in_comment = true;
			_PUSH_MANY(&res, (string_bytes(tos_lit("<i>"))), _t219, array_byte);
		} else if (string_ne(lc, tos_lit("")) && c == (*(byte*)array_get(string_bytes(lc), 0)) && hl__is_line_comment(runes, pos, lc)) {
			in_line_comment = true;
			_PUSH_MANY(&res, (string_bytes(tos_lit("<i>"))), _t220, array_byte);
		}
		_PUSH_MANY(&res, (hl__write(c)), _t221, array_byte);
	}
	_PUSH_MANY(&res, (string_bytes(tos_lit("</tr>"))), _t222, array_byte);
	_PUSH_MANY(&res, (string_bytes(tos_lit("</table>"))), _t223, array_byte);
	return (multi_return_string_int_int){.arg0=tos((byteptr)res.data, res.len), .arg1=lines, .arg2=sloc};
}

static array_byte hl__write(byte c) {
	array_byte tmp = __new_array_with_default(0, 0, sizeof(byte), 0);
	if (c == (*(byte*)array_get(string_bytes(tos_lit("<")), 0))) {
		_PUSH_MANY(&tmp, (string_bytes(tos_lit("&lt;"))), _t224, array_byte);
	} else if (c == (*(byte*)array_get(string_bytes(tos_lit(">")), 0))) {
		_PUSH_MANY(&tmp, (string_bytes(tos_lit("&gt;"))), _t225, array_byte);
	} else {
		array_push(&tmp, _MOV((byte[]){ c }));
	}
	return tmp;
}

static bool hl__is_letter(byte c, hl__Lang lang) {
	string name = string_to_lower(lang.name);
	if ((string_eq(name, tos_lit("cpp")) || string_eq(name, tos_lit("c")) || string_eq(name, tos_lit("swift"))) && c == (*(byte*)array_get(string_bytes(tos_lit("#")), 0))) {
		return true;
	}
	return byte_is_letter(c) || c == '_';
}

static bool hl__is_string_token(byte c, hl__Lang lang) {
	// FOR IN array
	array _t227 = lang.string_start;
	for (int _t228 = 0; _t228 < _t227.len; ++_t228) {
		string val = ((string*)_t227.data)[_t228];
		if (c == (*(byte*)array_get(string_bytes(val), 0))) {
			return true;
		}
	}
	return false;
}

static bool hl__is_line_comment(array_byte s, int pos, string lc) {
	for (int i = 0; i < lc.len; ++i) {
		if ((*(byte*)array_get(s, pos + i)) != (*(byte*)array_get(string_bytes(lc), i))) {
			return false;
		}
	}
	return true;
}

static bool hl__is_single_line(string s) {
	int cnt = 0;
	for (int i = 0; i < s.len; ++i) {
		if ((*(byte*)array_get(string_bytes(s), i)) == (*(byte*)array_get(string_bytes(tos_lit("\n")), 0))) {
			cnt++;
			if (cnt > 1) {
				return false;
			}
		}
	}
	return true;
}

static hl__Lang hl__init_c() {
	return (hl__Lang){
		.keywords = new_array_from_c_array(45, 45, sizeof(string), _MOV((string[45]){
				tos_lit("auto"), tos_lit("double"), tos_lit("int"), tos_lit("struct"), tos_lit("break"), tos_lit("else"), tos_lit("long"), tos_lit("switch"), tos_lit("case"), tos_lit("enum"), tos_lit("register"), tos_lit("typedef"), tos_lit("char"), tos_lit("extern"), tos_lit("return"), tos_lit("union"), tos_lit("const"), tos_lit("float"), tos_lit("short"), tos_lit("unsigned"), tos_lit("continue"), tos_lit("for"), tos_lit("signed"), tos_lit("void"), tos_lit("default"), tos_lit("goto"), tos_lit("sizeof"), tos_lit("volatile"), tos_lit("do"), tos_lit("if"), tos_lit("static"), tos_lit("while"), tos_lit("#if"), tos_lit("#else"), tos_lit("#elif"), tos_lit("#endif"), tos_lit("#define"), tos_lit("#undef"), tos_lit("#warning"), tos_lit("#error"), tos_lit("#line"), tos_lit("#pragma"), tos_lit("#ifdef"), tos_lit("#ifndef"), tos_lit("#include")})),
		.lang_extensions = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("c")})),
		.string_start = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("\""), tos_lit("\'")})),
		.line_comments = tos_lit("//"),
		.mline_comments = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/*"), tos_lit("*/")})),
		.color = tos_lit("#555555"),
		.name = tos_lit("C"),
	};
}

static hl__Lang hl__init_cpp() {
	return (hl__Lang){
		.keywords = new_array_from_c_array(83, 83, sizeof(string), _MOV((string[83]){
				tos_lit("int"), tos_lit("float"), tos_lit("while"), tos_lit("private"), tos_lit("char"), tos_lit("catch"), tos_lit("export"), tos_lit("virtual"), tos_lit("operator"), tos_lit("sizeof"), tos_lit("typedef"), tos_lit("const"), tos_lit("struct"), tos_lit("for"), tos_lit("static_cast"), tos_lit("union"), tos_lit("namespace"), tos_lit("unsigned"), tos_lit("long"), tos_lit("volatile"), tos_lit("static"), tos_lit("protected"), tos_lit("bool"), tos_lit("template"), tos_lit("mutable"), tos_lit("if"), tos_lit("public"), tos_lit("friend"), tos_lit("do"), tos_lit("goto"), tos_lit("auto"), tos_lit("void"), tos_lit("enum"), tos_lit("else"), tos_lit("break"), tos_lit("extern"), tos_lit("using"), tos_lit("class"), tos_lit("asm"), tos_lit("case"), tos_lit("typeid"), tos_lit("short"), tos_lit("default"), tos_lit("double"), tos_lit("register"), tos_lit("explicit"), tos_lit("signed"), tos_lit("typename"), tos_lit("try"), tos_lit("this"), tos_lit("switch"), tos_lit("continue"), tos_lit("inline"), tos_lit("delete"), tos_lit("alignof"), tos_lit("constexpr"), tos_lit("decltype"), tos_lit("noexcept"), tos_lit("static_assert"), tos_lit("thread_local"), tos_lit("restrict"), tos_lit("_Bool"), tos_lit("complex"), tos_lit("return"), tos_lit("throw"), tos_lit("new"), tos_lit("true"), tos_lit("false"), tos_lit("nullptr"), tos_lit("#if"), tos_lit("#else"), tos_lit("#elif"), tos_lit("#endif"), tos_lit("#define"), tos_lit("#undef"), tos_lit("#warning"), tos_lit("#error"), tos_lit("#line"), tos_lit("#pragma"), tos_lit("#ifdef"), tos_lit("#ifndef"), tos_lit("#include"), tos_lit("#endif")})),
		.lang_extensions = new_array_from_c_array(4, 4, sizeof(string), _MOV((string[4]){tos_lit("cpp"), tos_lit("cc"), tos_lit("hh"), tos_lit("h")})),
		.string_start = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("\""), tos_lit("\'")})),
		.line_comments = tos_lit("//"),
		.mline_comments = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/*"), tos_lit("*/")})),
		.color = tos_lit("#f34b7d"),
		.name = tos_lit("C++"),
	};
}

static hl__Lang hl__init_go() {
	return (hl__Lang){
		.keywords = new_array_from_c_array(39, 39, sizeof(string), _MOV((string[39]){
				tos_lit("break"), tos_lit("chan"), tos_lit("const"), tos_lit("continue"), tos_lit("complex64"), tos_lit("complex128"), tos_lit("defer"), tos_lit("else"), tos_lit("func"), tos_lit("for"), tos_lit("fallthrough"), tos_lit("go"), tos_lit("goto"), tos_lit("if"), tos_lit("import"), tos_lit("interface"), tos_lit("iota"), tos_lit("nil"), tos_lit("package"), tos_lit("range"), tos_lit("return"), tos_lit("switch"), tos_lit("struct"), tos_lit("type"), tos_lit("bool"), tos_lit("string"), tos_lit("int"), tos_lit("int8"), tos_lit("int16"), tos_lit("int8"), tos_lit("int64"), tos_lit("byte"), tos_lit("uint8"), tos_lit("uint16"), tos_lit("uint32"), tos_lit("uint64"), tos_lit("rune"), tos_lit("float32"), tos_lit("float64")})),
		.lang_extensions = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("go")})),
		.string_start = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("\""), tos_lit("`")})),
		.line_comments = tos_lit("//"),
		.mline_comments = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/*"), tos_lit("*/")})),
		.color = tos_lit("#00add8"),
		.name = tos_lit("Go"),
	};
}

static hl__Lang hl__init_js() {
	return (hl__Lang){
		.keywords = new_array_from_c_array(27, 27, sizeof(string), _MOV((string[27]){
				tos_lit("break"), tos_lit("do"), tos_lit("instanceof"), tos_lit("typeof"), tos_lit("case"), tos_lit("else"), tos_lit("new"), tos_lit("var"), tos_lit("catch"), tos_lit("finally"), tos_lit("return"), tos_lit("void"), tos_lit("continue"), tos_lit("for"), tos_lit("switch"), tos_lit("while"), tos_lit("debugger"), tos_lit("function"), tos_lit("this"), tos_lit("with"), tos_lit("default"), tos_lit("if"), tos_lit("throw"), tos_lit("delete"), tos_lit("in"), tos_lit("try"), tos_lit("as")})),
		.lang_extensions = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("js"), tos_lit("mjs")})),
		.string_start = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("\""), tos_lit("\'")})),
		.line_comments = tos_lit("//"),
		.mline_comments = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/*"), tos_lit("*/")})),
		.color = tos_lit("#f1e05a"),
		.name = tos_lit("JavaScript"),
	};
}

static hl__Lang hl__init_v() {
	return (hl__Lang){
		.keywords = new_array_from_c_array(25, 25, sizeof(string), _MOV((string[25]){
				tos_lit("break"), tos_lit("const"), tos_lit("continue"), tos_lit("defer"), tos_lit("else"), tos_lit("enum"), tos_lit("fn"), tos_lit("for"), tos_lit("go"), tos_lit("goto"), tos_lit("if"), tos_lit("import"), tos_lit("in"), tos_lit("interface"), tos_lit("match"), tos_lit("module"), tos_lit("none"), tos_lit("or"), tos_lit("pub"), tos_lit("return"), tos_lit("struct"), tos_lit("type"), tos_lit("mut"), tos_lit("true"), tos_lit("false")})),
		.lang_extensions = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("v"), tos_lit("vsh")})),
		.string_start = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("\""), tos_lit("\'")})),
		.line_comments = tos_lit("//"),
		.mline_comments = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/*"), tos_lit("*/")})),
		.color = tos_lit("#5d87bd"),
		.name = tos_lit("V"),
	};
}

static bool hl__is_source(string ext) {
	Option_hl__Lang _t229 = hl__extension_to_lang(ext);
	if (!_t229.ok) {
		string err = _t229.v_error;
		int errcode = _t229.ecode;
		return false;
	};
	return true;
}

Option_hl__Lang hl__extension_to_lang(string ext) {
	string ending = *(string*)array_last(string_split(ext, tos_lit(".")));
	// FOR IN array
	array _t230 = _const_hl__langs;
	for (int _t231 = 0; _t231 < _t230.len; ++_t231) {
		hl__Lang lang = ((hl__Lang*)_t230.data)[_t231];
		if (_IN(string, ending, lang.lang_extensions)) {
			Option_hl__Lang _t232;
			opt_ok2(&(hl__Lang[]) { lang }, (OptionBase*)(&_t232), sizeof(hl__Lang));
			return _t232;
		}
	}
	Option _t233 = v_error(tos_lit("No language found"));
	return *(Option_hl__Lang*)&_t233;
}

static array_hl__Lang hl__init_langs() {
	array_hl__Lang langs = __new_array_with_default(0, 10, sizeof(hl__Lang), 0);
	array_push(&langs, _MOV((hl__Lang[]){ hl__init_c() }));
	array_push(&langs, _MOV((hl__Lang[]){ hl__init_v() }));
	array_push(&langs, _MOV((hl__Lang[]){ hl__init_js() }));
	array_push(&langs, _MOV((hl__Lang[]){ hl__init_go() }));
	array_push(&langs, _MOV((hl__Lang[]){ hl__init_cpp() }));
	return langs;
}

Option_sqlite__DB sqlite__connect(string path) {
	struct sqlite3* db = ((struct sqlite3*)(0));
	if (sqlite3_open(path.str, &db) != 0) {
		Option _t239 = v_error(tos_lit("sqlite db error"));
		return *(Option_sqlite__DB*)&_t239;
	}
	Option_sqlite__DB _t240;
	opt_ok2(&(sqlite__DB[]) { (sqlite__DB){.conn = db,} }, (OptionBase*)(&_t240), sizeof(sqlite__DB));
	return _t240;
}

static struct sqlite3_stmt* sqlite__DB_init_stmt(sqlite__DB db, string query) {
	struct sqlite3_stmt* stmt = ((struct sqlite3_stmt*)(0));
	sqlite3_prepare_v2(db.conn, query.str, -1, &stmt, 0);
	return stmt;
}

static int sqlite__get_int_from_stmt(struct sqlite3_stmt* stmt) {
	int x = sqlite3_step(stmt);
	if (x != SQLITE_OK && x != SQLITE_DONE) {
		puts(sqlite3_errstr(x));
	}
	int res = sqlite3_column_int(stmt, 0);
	sqlite3_finalize(stmt);
	return res;
}

int sqlite__DB_q_int(sqlite__DB db, string query) {
	struct sqlite3_stmt* stmt = ((struct sqlite3_stmt*)(0));
	sqlite3_prepare_v2(db.conn, query.str, -1, &stmt, 0);
	sqlite3_step(stmt);
	int res = sqlite3_column_int(stmt, 0);
	sqlite3_finalize(stmt);
	return res;
}

string sqlite__DB_q_string(sqlite__DB db, string query) {
	struct sqlite3_stmt* stmt = ((struct sqlite3_stmt*)(0));
	sqlite3_prepare_v2(db.conn, query.str, -1, &stmt, 0);
	sqlite3_step(stmt);
	string res = tos_clone(sqlite3_column_text(stmt, 0));
	sqlite3_finalize(stmt);
	return res;
}

multi_return_array_sqlite__Row_int sqlite__DB_exec(sqlite__DB db, string query) {
	struct sqlite3_stmt* stmt = ((struct sqlite3_stmt*)(0));
	sqlite3_prepare_v2(db.conn, query.str, -1, &stmt, 0);
	int nr_cols = sqlite3_column_count(stmt);
	int res = 0;
	array_sqlite__Row rows = __new_array_with_default(0, 0, sizeof(sqlite__Row), 0);
	while (1) {
		res = sqlite3_step(stmt);
		if (res != 100) {
			break;
		}
		sqlite__Row row = (sqlite__Row){.vals = __new_array(0, 1, sizeof(string)),};
		for (int i = 0; i < nr_cols; ++i) {
			string val = tos_clone(sqlite3_column_text(stmt, i));
			array_push(&row.vals, _MOV((string[]){ val }));
		}
		array_push(&rows, _MOV((sqlite__Row[]){ row }));
	}
	return (multi_return_array_sqlite__Row_int){.arg0=rows, .arg1=res};
}

Option_sqlite__Row sqlite__DB_exec_one(sqlite__DB db, string query) {
	multi_return_array_sqlite__Row_int mr_3159 = sqlite__DB_exec(db, query);
	array_sqlite__Row rows = mr_3159.arg0;
	int code = mr_3159.arg1;
	if (rows.len == 0 || code != 101) {
		Option _t243 = v_error(_STR("SQL Error: Rows #%"PRId32"\000 Return code %"PRId32"", 2, rows.len, code));
		return *(Option_sqlite__Row*)&_t243;
	}
	Option_sqlite__Row _t244;
	opt_ok2(&(sqlite__Row[]) { (*(sqlite__Row*)array_get(rows, 0)) }, (OptionBase*)(&_t244), sizeof(sqlite__Row));
	return _t244;
}

int sqlite__DB_exec_none(sqlite__DB db, string query) {
	multi_return_array_sqlite__Row_int mr_3456 = sqlite__DB_exec(db, query);
	int code = mr_3456.arg1;
	return code;
}


f64 math__inf(int sign) {
	u64 v = (sign >= 0 ? (_const_math__uvinf) : (_const_math__uvneginf));
	return math__f64_from_bits(v);
}

f64 math__nan() {
	return math__f64_from_bits(_const_math__uvnan);
}

bool math__is_nan(f64 f) {
	return f != f;
}

bool math__is_inf(f64 f, int sign) {
	return (sign >= 0 && f > _const_math__max_f64) || (sign <= 0 && f < -_const_math__max_f64);
}

// Attr: [inline]
inline f64 math__abs(f64 a) {
	return fabs(a);
}

// Attr: [inline]
inline f64 math__acos(f64 a) {
	return acos(a);
}

// Attr: [inline]
inline f64 math__asin(f64 a) {
	return asin(a);
}

// Attr: [inline]
inline f64 math__atan(f64 a) {
	return atan(a);
}

// Attr: [inline]
inline f64 math__atan2(f64 a, f64 b) {
	return atan2(a, b);
}

// Attr: [inline]
inline f64 math__cbrt(f64 a) {
	return cbrt(a);
}

// Attr: [inline]
inline f64 math__ceil(f64 a) {
	return ceil(a);
}

// Attr: [inline]
inline f64 math__cos(f64 a) {
	return cos(a);
}

// Attr: [inline]
inline f32 math__cosf(f32 a) {
	return cosf(a);
}

// Attr: [inline]
inline f64 math__cosh(f64 a) {
	return cosh(a);
}

// Attr: [inline]
inline f64 math__exp(f64 a) {
	return exp(a);
}

// Attr: [inline]
inline f64 math__erf(f64 a) {
	return erf(a);
}

// Attr: [inline]
inline f64 math__erfc(f64 a) {
	return erfc(a);
}

// Attr: [inline]
inline f64 math__exp2(f64 a) {
	return exp2(a);
}

// Attr: [inline]
inline f64 math__floor(f64 a) {
	return floor(a);
}

// Attr: [inline]
inline f64 math__fmod(f64 a, f64 b) {
	return fmod(a, b);
}

// Attr: [inline]
inline f64 math__gamma(f64 a) {
	return tgamma(a);
}

// Attr: [inline]
inline f64 math__hypot(f64 a, f64 b) {
	return hypot(a, b);
}

// Attr: [inline]
inline f64 math__log(f64 a) {
	return log(a);
}

// Attr: [inline]
inline f64 math__log2(f64 a) {
	return log2(a);
}

// Attr: [inline]
inline f64 math__log10(f64 a) {
	return log10(a);
}

// Attr: [inline]
inline f64 math__log_gamma(f64 a) {
	return lgamma(a);
}

// Attr: [inline]
inline f64 math__log_n(f64 a, f64 b) {
	return log(a) / log(b);
}

// Attr: [inline]
inline f64 math__pow(f64 a, f64 b) {
	return pow(a, b);
}

// Attr: [inline]
inline f32 math__powf(f32 a, f32 b) {
	return powf(a, b);
}

// Attr: [inline]
inline f64 math__round(f64 f) {
	return round(f);
}

// Attr: [inline]
inline f64 math__sin(f64 a) {
	return sin(a);
}

// Attr: [inline]
inline f32 math__sinf(f32 a) {
	return sinf(a);
}

// Attr: [inline]
inline f64 math__sinh(f64 a) {
	return sinh(a);
}

// Attr: [inline]
inline f64 math__sqrt(f64 a) {
	return sqrt(a);
}

// Attr: [inline]
inline f32 math__sqrtf(f32 a) {
	return sqrtf(a);
}

// Attr: [inline]
inline f64 math__tan(f64 a) {
	return tan(a);
}

// Attr: [inline]
inline f32 math__tanf(f32 a) {
	return tanf(a);
}

// Attr: [inline]
inline f64 math__tanh(f64 a) {
	return tanh(a);
}

// Attr: [inline]
inline f64 math__trunc(f64 a) {
	return trunc(a);
}

f64 math__aprox_sin(f64 a) {
	f64 a0 = 1.91059300966915117e-31;
	f64 a1 = 1.00086760103908896;
	f64 a2 = -1.21276126894734565e-2;
	f64 a3 = -1.38078780785773762e-1;
	f64 a4 = -2.67353392911981221e-2;
	f64 a5 = 2.08026600266304389e-2;
	f64 a6 = -3.03996055049204407e-3;
	f64 a7 = 1.38235642404333740e-4;
	return a0 + a * (a1 + a * (a2 + a * (a3 + a * (a4 + a * (a5 + a * (a6 + a * a7))))));
}

f64 math__aprox_cos(f64 a) {
	f64 a0 = 9.9995999154986614e-1;
	f64 a1 = 1.2548995793001028e-3;
	f64 a2 = -5.0648546280678015e-1;
	f64 a3 = 1.2942246466519995e-2;
	f64 a4 = 2.8668384702547972e-2;
	f64 a5 = 7.3726485210586547e-3;
	f64 a6 = -3.8510875386947414e-3;
	f64 a7 = 4.7196604604366623e-4;
	f64 a8 = -1.8776444013090451e-5;
	return a0 + a * (a1 + a * (a2 + a * (a3 + a * (a4 + a * (a5 + a * (a6 + a * (a7 + a * a8)))))));
}

f64 math__copysign(f64 x, f64 y) {
	return math__f64_from_bits((((math__f64_bits(x) & ~_const_math__sign_mask)) | ((math__f64_bits(y) & _const_math__sign_mask))));
}

f64 math__degrees(f64 radians) {
	return radians * (180.0 / _const_math__pi);
}

array_int math__digits(int _n, int base) {
	if (base < 2) {
		v_panic(_STR("digits: Cannot find digits of n with base %"PRId32"", 1, base));
	}
	int n = _n;
	int sign = 1;
	if (n < 0) {
		sign = -1;
		n = -n;
	}
	array_int res = __new_array_with_default(0, 0, sizeof(int), 0);
	while (n != 0) {
		array_push(&res, _MOV((int[]){ (n % base) * sign }));
		n /= base;
	}
	return res;
}

f64 math__fabs(f64 x) {
	if (x < 0.0) {
		return -x;
	}
	return x;
}

i64 math__gcd(i64 a_, i64 b_) {
	i64 a = a_;
	i64 b = b_;
	if (a < 0) {
		a = -a;
	}
	if (b < 0) {
		b = -b;
	}
	while (b != 0) {
		a %= b;
		if (a == 0) {
			return b;
		}
		b %= a;
	}
	return a;
}

i64 math__lcm(i64 a, i64 b) {
	if (a == 0) {
		return a;
	}
	i64 res = a * (b / math__gcd(b, a));
	if (res < 0) {
		return -res;
	}
	return res;
}

f64 math__max(f64 a, f64 b) {
	if (a > b) {
		return a;
	}
	return b;
}

f64 math__min(f64 a, f64 b) {
	if (a < b) {
		return a;
	}
	return b;
}

f64 math__radians(f64 degrees) {
	return degrees * (_const_math__pi / 180.0);
}

u32 math__f32_bits(f32 f) {
	u32* p = ((u32*)(&f));
	return *p;
}

f32 math__f32_from_bits(u32 b) {
	f32* p = ((f32*)(&b));
	return *p;
}

u64 math__f64_bits(f64 f) {
	u64* p = ((u64*)(&f));
	return *p;
}

f64 math__f64_from_bits(u64 b) {
	f64* p = ((f64*)(&b));
	return *p;
}

static string net__urllib__error_msg(string message, string val) {
	string msg = _STR("net.urllib.%.*s", 1, message);
	if (string_ne(val, tos_lit(""))) {
		msg = _STR("%.*s\000 (%.*s\000)", 3, msg, val);
	}
	return msg;
}

static bool net__urllib__should_escape(byte c, net__urllib__EncodingMode mode) {
	if (('a' <= c && c <= 'z') || ('A' <= c && c <= 'Z') || ('0' <= c && c <= '9')) {
		return false;
	}
	if (mode == net__urllib__EncodingMode_encode_host || mode == net__urllib__EncodingMode_encode_zone) {
		if ((c == '!' || c == '$' || c == '&' || c == '\\' || c == '(' || c == ')' || c == '*' || c == '+' || c == ',' || c == ';' || c == '=' || c == ':' || c == '[' || c == ']' || c == '<' || c == '>' || c == '"')) {
			return false;
		}
	}
	if (c == '-' || c == '_' || c == '.' || c == '~') {
		return false;
	} else if (c == '$' || c == '&' || c == '+' || c == ',' || c == '/' || c == ':' || c == ';' || c == '=' || c == '?' || c == '@') {
		if (mode == net__urllib__EncodingMode_encode_path) {
			return c == '?';
		} else if (mode == net__urllib__EncodingMode_encode_path_segment) {
			return c == '/' || c == ';' || c == ',' || c == '?';
		} else if (mode == net__urllib__EncodingMode_encode_user_password) {
			return c == '@' || c == '/' || c == '?' || c == ':';
		} else if (mode == net__urllib__EncodingMode_encode_query_component) {
			return true;
		} else if (mode == net__urllib__EncodingMode_encode_fragment) {
			return false;
		} else {
		};
	} else {
	};
	if (mode == net__urllib__EncodingMode_encode_fragment) {
		if (c == '!' || c == '(' || c == ')' || c == '*') {
			return false;
		} else {
		};
	}
	return true;
}

Option_string net__urllib__query_unescape(string s) {
	return net__urllib__unescape(s, net__urllib__EncodingMode_encode_query_component);
}

Option_string net__urllib__path_unescape(string s) {
	return net__urllib__unescape(s, net__urllib__EncodingMode_encode_path_segment);
}

static Option_string net__urllib__unescape(string s_, net__urllib__EncodingMode mode) {
	string s = s_;
	int n = 0;
	bool has_plus = false;
	for (int i = 0; i < s.len; ) {
		byte x = string_at(s, i);
		if (x == '%') {
			if (string_eq(s, tos_lit(""))) {
				break;
			}
			n++;
			if (i + 2 >= s.len || !net__urllib__ishex(string_at(s, i + 1)) || !net__urllib__ishex(string_at(s, i + 2))) {
				s = string_substr(s, i, s.len);
				if (s.len > 3) {
					s = string_substr(s, 0, 3);
				}
				Option _t250 = v_error(net__urllib__error_msg(_const_net__urllib__err_msg_escape, s));
				return *(Option_string*)&_t250;
			}
			if (mode == net__urllib__EncodingMode_encode_host && net__urllib__unhex(string_at(s, i + 1)) < 8 && string_ne(string_substr(s, i, i + 3), tos_lit("%25"))) {
				Option _t251 = v_error(net__urllib__error_msg(_const_net__urllib__err_msg_escape, string_substr(s, i, i + 3)));
				return *(Option_string*)&_t251;
			}
			if (mode == net__urllib__EncodingMode_encode_zone) {
				byte v = (((net__urllib__unhex(string_at(s, i + 1)) << ((byte)(4))) | net__urllib__unhex(string_at(s, i + 2))));
				if (string_ne(string_substr(s, i, i + 3), tos_lit("%25")) && v != ' ' && net__urllib__should_escape(v, net__urllib__EncodingMode_encode_host)) {
					v_error(net__urllib__error_msg(_const_net__urllib__err_msg_escape, string_substr(s, i, i + 3)));
				}
			}
			i += 3;
		} else if (x == '+') {
			has_plus = mode == net__urllib__EncodingMode_encode_query_component;
			i++;
		} else {
			if ((mode == net__urllib__EncodingMode_encode_host || mode == net__urllib__EncodingMode_encode_zone) && string_at(s, i) < 0x80 && net__urllib__should_escape(string_at(s, i), mode)) {
				v_error(net__urllib__error_msg(tos_lit("unescape: invalid character in host name"), string_substr(s, i, i + 1)));
			}
			i++;
		};
	}
	if (n == 0 && !has_plus) {
		Option_string _t252;
		opt_ok2(&(string[]) { s }, (OptionBase*)(&_t252), sizeof(string));
		return _t252;
	}
	strings__Builder t = strings__new_builder(s.len - 2 * n);
	for (int i = 0; i < s.len; i++) {
		byte x = string_at(s, i);
		if (x == '%') {
			strings__Builder_write(&t, byte_str((((net__urllib__unhex(string_at(s, i + 1)) << ((byte)(4))) | net__urllib__unhex(string_at(s, i + 2))))));
			i += 2;
		} else if (x == '+') {
			if (mode == net__urllib__EncodingMode_encode_query_component) {
				strings__Builder_write(&t, tos_lit(" "));
			} else {
				strings__Builder_write(&t, tos_lit("+"));
			}
		} else {
			strings__Builder_write(&t, byte_str(string_at(s, i)));
		};
	}
	Option_string _t254;
	opt_ok2(&(string[]) { strings__Builder_str(&t) }, (OptionBase*)(&_t254), sizeof(string));
	return _t254;
}

string net__urllib__query_escape(string s) {
	return net__urllib__escape(s, net__urllib__EncodingMode_encode_query_component);
}

string net__urllib__path_escape(string s) {
	return net__urllib__escape(s, net__urllib__EncodingMode_encode_path_segment);
}

static string net__urllib__escape(string s, net__urllib__EncodingMode mode) {
	int space_count = 0;
	int hex_count = 0;
	byte c = ((byte)(0));
	for (int i = 0; i < s.len; ++i) {
		c = string_at(s, i);
		if (net__urllib__should_escape(c, mode)) {
			if (c == ' ' && mode == net__urllib__EncodingMode_encode_query_component) {
				space_count++;
			} else {
				hex_count++;
			}
		}
	}
	if (space_count == 0 && hex_count == 0) {
		return s;
	}
	array_byte buf = __new_array_with_default((64), 0, sizeof(byte), 0);
	array_byte t = __new_array_with_default(0, 0, sizeof(byte), 0);
	int required = s.len + 2 * hex_count;
	if (required <= buf.len) {
		t = array_slice(buf, 0, required);
	} else {
		t = __new_array_with_default((required), 0, sizeof(byte), 0);
	}
	if (hex_count == 0) {
		copy(t, string_bytes(s));
		for (int i = 0; i < s.len; ++i) {
			if (string_at(s, i) == ' ') {
				array_set(&t, i, &(byte[]) { '+' });
			}
		}
		return tos((byteptr)t.data, t.len);
	}
	string upperhex = tos_lit("0123456789ABCDEF");
	int j = 0;
	for (int i = 0; i < s.len; ++i) {
		byte c1 = string_at(s, i);
		if (c1 == ' ' && mode == net__urllib__EncodingMode_encode_query_component) {
			array_set(&t, j, &(byte[]) { '+' });
			j++;
		} else if (net__urllib__should_escape(c1, mode)) {
			array_set(&t, j, &(byte[]) { '%' });
			array_set(&t, j + 1, &(byte[]) { string_at(upperhex, c1 >> 4) });
			array_set(&t, j + 2, &(byte[]) { string_at(upperhex, (c1 & 15)) });
			j += 3;
		} else {
			array_set(&t, j, &(byte[]) { string_at(s, i) });
			j++;
		}
	}
	return tos((byteptr)t.data, t.len);
}

net__urllib__Userinfo* net__urllib__user(string username) {
	return (net__urllib__Userinfo*)memdup(&(net__urllib__Userinfo){.username = username,.password = tos_lit(""),.password_set = false,}, sizeof(net__urllib__Userinfo));
}

static net__urllib__Userinfo* net__urllib__user_password(string username, string password) {
	return (net__urllib__Userinfo*)memdup(&(net__urllib__Userinfo){.username = username,.password = password,.password_set = true,}, sizeof(net__urllib__Userinfo));
}

static bool net__urllib__Userinfo_empty(net__urllib__Userinfo* u) {
	return string_eq(u->username, tos_lit("")) && string_eq(u->password, tos_lit(""));
}

static string net__urllib__Userinfo_string(net__urllib__Userinfo* u) {
	if (net__urllib__Userinfo_empty(u)) {
		return tos_lit("");
	}
	string s = net__urllib__escape(u->username, net__urllib__EncodingMode_encode_user_password);
	if (u->password_set) {
		s = /*f*/string_add(s, string_add(tos_lit(":"), net__urllib__escape(u->password, net__urllib__EncodingMode_encode_user_password)));
	}
	return s;
}

static Option_array_string net__urllib__split_by_scheme(string rawurl) {
	for (int i = 0; i < rawurl.len; ++i) {
		byte c = string_at(rawurl, i);
		if (('a' <= c && c <= 'z') || ('A' <= c && c <= 'Z')) {
		} else if (('0' <= c && c <= '9') || (c == '+' || c == '-' || c == '.')) {
			if (i == 0) {
				Option_array_string _t255;
				opt_ok2(&(array_string[]) { new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit(""), rawurl})) }, (OptionBase*)(&_t255), sizeof(array_string));
				return _t255;
			}
		} else if (c == ':') {
			if (i == 0) {
				Option _t256 = v_error(net__urllib__error_msg(tos_lit("split_by_scheme: missing protocol scheme"), tos_lit("")));
				return *(Option_array_string*)&_t256;
			}
			Option_array_string _t257;
			opt_ok2(&(array_string[]) { new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){string_substr(rawurl, 0, i), string_substr(rawurl, i + 1, rawurl.len)})) }, (OptionBase*)(&_t257), sizeof(array_string));
			return _t257;
		} else {
			Option_array_string _t258;
			opt_ok2(&(array_string[]) { new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit(""), rawurl})) }, (OptionBase*)(&_t258), sizeof(array_string));
			return _t258;
		}
	}
	Option_array_string _t259;
	opt_ok2(&(array_string[]) { new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit(""), rawurl})) }, (OptionBase*)(&_t259), sizeof(array_string));
	return _t259;
}

static Option_string net__urllib__get_scheme(string rawurl) {
	Option_array_string _t260 = net__urllib__split_by_scheme(rawurl);
	if (!_t260.ok) {
		string err = _t260.v_error;
		int errcode = _t260.ecode;
		Option_string _t261;
		opt_ok2(&(string[]) { err }, (OptionBase*)(&_t261), sizeof(string));
		return _t261;
	}
	array_string split = *(array_string*)_t260.data;
	Option_string _t262;
	opt_ok2(&(string[]) { (*(string*)array_get(split, 0)) }, (OptionBase*)(&_t262), sizeof(string));
	return _t262;
}

static multi_return_string_string net__urllib__split(string s, byte sep, bool cutc) {
	int i = string_index_byte(s, sep);
	if (i < 0) {
		return (multi_return_string_string){.arg0=s, .arg1=tos_lit("")};
	}
	if (cutc) {
		return (multi_return_string_string){.arg0=string_substr(s, 0, i), .arg1=string_substr(s, i + 1, s.len)};
	}
	return (multi_return_string_string){.arg0=string_substr(s, 0, i), .arg1=string_substr(s, i, s.len)};
}

Option_net__urllib__URL net__urllib__parse(string rawurl) {
	multi_return_string_string mr_12903 = net__urllib__split(rawurl, '#', true);
	string u = mr_12903.arg0;
	string frag = mr_12903.arg1;
	Option_net__urllib__URL _t263 = net__urllib__parse_url(u, false);
	if (!_t263.ok) {
		string err = _t263.v_error;
		int errcode = _t263.ecode;
		Option _t264 = v_error(net__urllib__error_msg(_const_net__urllib__err_msg_parse, u));
		return *(Option_net__urllib__URL*)&_t264;
	}
	net__urllib__URL url = *(net__urllib__URL*)_t263.data;
	if (string_eq(frag, tos_lit(""))) {
		Option_net__urllib__URL _t265;
		opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t265), sizeof(net__urllib__URL));
		return _t265;
	}
	Option_string _t266 = net__urllib__unescape(frag, net__urllib__EncodingMode_encode_fragment);
	if (!_t266.ok) {
		string err = _t266.v_error;
		int errcode = _t266.ecode;
		Option _t267 = v_error(net__urllib__error_msg(_const_net__urllib__err_msg_parse, u));
		return *(Option_net__urllib__URL*)&_t267;
	}
	string f = *(string*)_t266.data;
	url.fragment = f;
	Option_net__urllib__URL _t268;
	opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t268), sizeof(net__urllib__URL));
	return _t268;
}

static Option_net__urllib__URL net__urllib__parse_request_uri(string rawurl) {
	return net__urllib__parse_url(rawurl, true);
}

static Option_net__urllib__URL net__urllib__parse_url(string rawurl, bool via_request) {
	if (net__urllib__string_contains_ctl_byte(rawurl)) {
		Option _t269 = v_error(net__urllib__error_msg(tos_lit("parse_url: invalid control character in URL"), rawurl));
		return *(Option_net__urllib__URL*)&_t269;
	}
	if (string_eq(rawurl, tos_lit("")) && via_request) {
		Option _t270 = v_error(net__urllib__error_msg(tos_lit("parse_url: empty URL"), rawurl));
		return *(Option_net__urllib__URL*)&_t270;
	}
	net__urllib__URL url = (net__urllib__URL){.scheme = (string){.str=(byteptr)""},.opaque = (string){.str=(byteptr)""},.user = 0,.host = (string){.str=(byteptr)""},.path = (string){.str=(byteptr)""},.raw_path = (string){.str=(byteptr)""},.force_query = 0,.raw_query = (string){.str=(byteptr)""},.fragment = (string){.str=(byteptr)""},};
	if (string_eq(rawurl, tos_lit("*"))) {
		url.path = tos_lit("*");
		Option_net__urllib__URL _t271;
		opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t271), sizeof(net__urllib__URL));
		return _t271;
	}
	Option_array_string _t272 = net__urllib__split_by_scheme(rawurl);
	if (!_t272.ok) {
		string err = _t272.v_error;
		int errcode = _t272.ecode;
		Option _t273 = v_error(err);
		return *(Option_net__urllib__URL*)&_t273;
	}
	array_string p = *(array_string*)_t272.data;
	url.scheme = (*(string*)array_get(p, 0));
	string rest = (*(string*)array_get(p, 1));
	url.scheme = string_to_lower(url.scheme);
	if (string_ends_with(rest, tos_lit("?")) && !string_contains(string_substr(rest, 0, 1), tos_lit("?"))) {
		url.force_query = true;
		rest = string_substr(rest, 0, rest.len - 1);
	} else {
		multi_return_string_string mr_14652 = net__urllib__split(rest, '?', true);
		string r = mr_14652.arg0;
		string raw_query = mr_14652.arg1;
		rest = r;
		url.raw_query = raw_query;
	}
	if (!string_starts_with(rest, tos_lit("/"))) {
		if (string_ne(url.scheme, tos_lit(""))) {
			url.opaque = rest;
			Option_net__urllib__URL _t274;
			opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t274), sizeof(net__urllib__URL));
			return _t274;
		}
		if (via_request) {
			Option _t275 = v_error(net__urllib__error_msg(tos_lit("parse_url: invalid URI for request"), tos_lit("")));
			return *(Option_net__urllib__URL*)&_t275;
		}
		Option_int _t276 = string_index(rest, tos_lit(":"));
		if (!_t276.ok) {
			string err = _t276.v_error;
			int errcode = _t276.ecode;
			Option _t277 = v_error(tos_lit("there should be a : in the URL"));
			return *(Option_net__urllib__URL*)&_t277;
		}
		int colon = *(int*)_t276.data;
		Option_int _t278 = string_index(rest, tos_lit("/"));
		if (!_t278.ok) {
			string err = _t278.v_error;
			int errcode = _t278.ecode;
			Option _t279 = v_error(tos_lit("there should be a / in the URL"));
			return *(Option_net__urllib__URL*)&_t279;
		}
		int slash = *(int*)_t278.data;
		if (colon >= 0 && (slash < 0 || colon < slash)) {
			Option _t280 = v_error(net__urllib__error_msg(tos_lit("parse_url: first path segment in URL cannot contain colon"), tos_lit("")));
			return *(Option_net__urllib__URL*)&_t280;
		}
	}
	if (((string_ne(url.scheme, tos_lit("")) || !via_request) && !string_starts_with(rest, tos_lit("///"))) && string_starts_with(rest, tos_lit("//"))) {
		multi_return_string_string mr_15754 = net__urllib__split(string_substr(rest, 2, rest.len), '/', false);
		string authority = mr_15754.arg0;
		string r = mr_15754.arg1;
		rest = r;
		Option_net__urllib__ParseAuthorityRes _t281 = net__urllib__parse_authority(authority);
		if (!_t281.ok) {
			string err = _t281.v_error;
			int errcode = _t281.ecode;
			Option _t282 = v_error(err);
			return *(Option_net__urllib__URL*)&_t282;
		}
		net__urllib__ParseAuthorityRes a = *(net__urllib__ParseAuthorityRes*)_t281.data;
		url.user = a.user;
		url.host = a.host;
	}
	Option_bool _t283 = net__urllib__URL_set_path(&url, rest);
	if (!_t283.ok) {
		string err = _t283.v_error;
		int errcode = _t283.ecode;
		Option _t284 = v_error(err);
		return *(Option_net__urllib__URL*)&_t284;
	};
	Option_net__urllib__URL _t285;
	opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t285), sizeof(net__urllib__URL));
	return _t285;
}

static Option_net__urllib__ParseAuthorityRes net__urllib__parse_authority(string authority) {
	Option_int _t286 = string_last_index(authority, tos_lit("@"));
	if (!_t286.ok) {
		string err = _t286.v_error;
		int errcode = _t286.ecode;
		*(int*) _t286.data = -1;
	}
	int i = *(int*)_t286.data;
	string host = tos_lit("");
	net__urllib__Userinfo* zuser = net__urllib__user(tos_lit(""));
	if (i < 0) {
		Option_string _t287 = net__urllib__parse_host(authority);
		if (!_t287.ok) {
			string err = _t287.v_error;
			int errcode = _t287.ecode;
			Option _t288 = v_error(err);
			return *(Option_net__urllib__ParseAuthorityRes*)&_t288;
		}
		string h = *(string*)_t287.data;
		host = h;
	} else {
		Option_string _t289 = net__urllib__parse_host(string_substr(authority, i + 1, authority.len));
		if (!_t289.ok) {
			string err = _t289.v_error;
			int errcode = _t289.ecode;
			Option _t290 = v_error(err);
			return *(Option_net__urllib__ParseAuthorityRes*)&_t290;
		}
		string h = *(string*)_t289.data;
		host = h;
	}
	if (i < 0) {
		Option_net__urllib__ParseAuthorityRes _t291;
		opt_ok2(&(net__urllib__ParseAuthorityRes[]) { (net__urllib__ParseAuthorityRes){.user = zuser,.host = host,} }, (OptionBase*)(&_t291), sizeof(net__urllib__ParseAuthorityRes));
		return _t291;
	}
	string userinfo = string_substr(authority, 0, i);
	if (!net__urllib__valid_userinfo(userinfo)) {
		Option _t292 = v_error(net__urllib__error_msg(tos_lit("parse_authority: invalid userinfo"), tos_lit("")));
		return *(Option_net__urllib__ParseAuthorityRes*)&_t292;
	}
	if (!string_contains(userinfo, tos_lit(":"))) {
		Option_string _t293 = net__urllib__unescape(userinfo, net__urllib__EncodingMode_encode_user_password);
		if (!_t293.ok) {
			string err = _t293.v_error;
			int errcode = _t293.ecode;
			Option _t294 = v_error(err);
			return *(Option_net__urllib__ParseAuthorityRes*)&_t294;
		}
		string u = *(string*)_t293.data;
		userinfo = u;
		zuser = net__urllib__user(userinfo);
	} else {
		multi_return_string_string mr_16967 = net__urllib__split(userinfo, ':', true);
		string username = mr_16967.arg0;
		string password = mr_16967.arg1;
		Option_string _t295 = net__urllib__unescape(username, net__urllib__EncodingMode_encode_user_password);
		if (!_t295.ok) {
			string err = _t295.v_error;
			int errcode = _t295.ecode;
			Option _t296 = v_error(err);
			return *(Option_net__urllib__ParseAuthorityRes*)&_t296;
		}
		string u = *(string*)_t295.data;
		username = u;
		Option_string _t297 = net__urllib__unescape(password, net__urllib__EncodingMode_encode_user_password);
		if (!_t297.ok) {
			string err = _t297.v_error;
			int errcode = _t297.ecode;
			Option _t298 = v_error(err);
			return *(Option_net__urllib__ParseAuthorityRes*)&_t298;
		}
		string p = *(string*)_t297.data;
		password = p;
		zuser = net__urllib__user_password(username, password);
	}
	Option_net__urllib__ParseAuthorityRes _t299;
	opt_ok2(&(net__urllib__ParseAuthorityRes[]) { (net__urllib__ParseAuthorityRes){.user = zuser,.host = host,} }, (OptionBase*)(&_t299), sizeof(net__urllib__ParseAuthorityRes));
	return _t299;
}

static Option_string net__urllib__parse_host(string host) {
	if (string_starts_with(host, tos_lit("["))) {
		Option_int _t300 = string_last_index(host, tos_lit("]"));
		if (!_t300.ok) {
			string err = _t300.v_error;
			int errcode = _t300.ecode;
			Option _t301 = v_error(net__urllib__error_msg(tos_lit("parse_host: missing \']\' in host"), tos_lit("")));
			return *(Option_string*)&_t301;
		}
		int i = *(int*)_t300.data;
		string colon_port = string_substr(host, i + 1, host.len);
		if (!net__urllib__valid_optional_port(colon_port)) {
			Option _t302 = v_error(net__urllib__error_msg(_STR("parse_host: invalid port %.*s\000 after host ", 2, colon_port), tos_lit("")));
			return *(Option_string*)&_t302;
		}
		{ /* if guard */ 
		Option_int _t303;
		if (_t303 = string_index(string_substr(host, 0, i), tos_lit("%25")), _t303.ok) {
			Option_int zone = _t303;
			Option_string _t304 = net__urllib__unescape(string_substr(host, 0, /*opt*/(*(int*)zone.data)), net__urllib__EncodingMode_encode_host);
			if (!_t304.ok) {
				string err = _t304.v_error;
				int errcode = _t304.ecode;
				Option_string _t305;
				opt_ok2(&(string[]) { err }, (OptionBase*)(&_t305), sizeof(string));
				return _t305;
			}
			string host1 = *(string*)_t304.data;
			Option_string _t306 = net__urllib__unescape(string_substr(host, /*opt*/(*(int*)zone.data), i), net__urllib__EncodingMode_encode_zone);
			if (!_t306.ok) {
				string err = _t306.v_error;
				int errcode = _t306.ecode;
				Option_string _t307;
				opt_ok2(&(string[]) { err }, (OptionBase*)(&_t307), sizeof(string));
				return _t307;
			}
			string host2 = *(string*)_t306.data;
			Option_string _t308 = net__urllib__unescape(string_substr(host, i, host.len), net__urllib__EncodingMode_encode_host);
			if (!_t308.ok) {
				string err = _t308.v_error;
				int errcode = _t308.ecode;
				Option_string _t309;
				opt_ok2(&(string[]) { err }, (OptionBase*)(&_t309), sizeof(string));
				return _t309;
			}
			string host3 = *(string*)_t308.data;
			Option_string _t310;
			opt_ok2(&(string[]) { string_add(string_add(host1, host2), host3) }, (OptionBase*)(&_t310), sizeof(string));
			return _t310;
		}}
		{ /* if guard */ 
		Option_int _t311;
		if (_t311 = string_last_index(host, tos_lit(":")), _t311.ok) {
			Option_int idx = _t311;
			colon_port = string_substr(host, /*opt*/(*(int*)idx.data), host.len);
			if (!net__urllib__valid_optional_port(colon_port)) {
				Option _t312 = v_error(net__urllib__error_msg(_STR("parse_host: invalid port %.*s\000 after host ", 2, colon_port), tos_lit("")));
				return *(Option_string*)&_t312;
			}
		}}
	}
	Option_string _t313 = net__urllib__unescape(host, net__urllib__EncodingMode_encode_host);
	if (!_t313.ok) {
		string err = _t313.v_error;
		int errcode = _t313.ecode;
		Option_string _t314;
		opt_ok2(&(string[]) { err }, (OptionBase*)(&_t314), sizeof(string));
		return _t314;
	}
	string h = *(string*)_t313.data;
	Option_string _t315;
	opt_ok2(&(string[]) { h }, (OptionBase*)(&_t315), sizeof(string));
	return _t315;
}

Option_bool net__urllib__URL_set_path(net__urllib__URL* u, string p) {
	Option_string _t316 = net__urllib__unescape(p, net__urllib__EncodingMode_encode_path);
	if (!_t316.ok) {
		string err = _t316.v_error;
		int errcode = _t316.ecode;
		Option _t317 = v_error(err);
		return *(Option_bool*)&_t317;
	}
	string path = *(string*)_t316.data;
	u->path = path;
	string escp = net__urllib__escape(path, net__urllib__EncodingMode_encode_path);
	if (string_eq(p, escp)) {
		u->raw_path = tos_lit("");
	} else {
		u->raw_path = p;
	}
	Option_bool _t318;
	opt_ok2(&(bool[]) { true }, (OptionBase*)(&_t318), sizeof(bool));
	return _t318;
}

static string net__urllib__URL_escaped_path(net__urllib__URL* u) {
	if (string_ne(u->raw_path, tos_lit("")) && net__urllib__valid_encoded_path(u->raw_path)) {
		Option_string _t319 = net__urllib__unescape(u->raw_path, net__urllib__EncodingMode_encode_path);
		if (!_t319.ok) {
			string err = _t319.v_error;
			int errcode = _t319.ecode;
			return tos_lit("");
		};
		return u->raw_path;
	}
	if (string_eq(u->path, tos_lit("*"))) {
		return tos_lit("*");
	}
	return net__urllib__escape(u->path, net__urllib__EncodingMode_encode_path);
}

static bool net__urllib__valid_encoded_path(string s) {
	for (int i = 0; i < s.len; ++i) {
		byte x = string_at(s, i);
		if (x == '!' || x == '$' || x == '&' || x == '\\' || x == '(' || x == ')' || x == '*' || x == '+' || x == ',' || x == ';' || x == '=' || x == ':' || x == '@') {
		} else if (x == '[' || x == ']') {
		} else if (x == '%') {
		} else {
			if (net__urllib__should_escape(string_at(s, i), net__urllib__EncodingMode_encode_path)) {
				return false;
			}
		};
	}
	return true;
}

static bool net__urllib__valid_optional_port(string port) {
	if (string_eq(port, tos_lit(""))) {
		return true;
	}
	if (string_at(port, 0) != ':') {
		return false;
	}
	for (int _t321 = 0; _t321 < string_substr(port, 1, port.len).len; ++_t321) {
		byte b = string_substr(port, 1, port.len).str[_t321];
		if (b < '0' || b > '9') {
			return false;
		}
	}
	return true;
}

string net__urllib__URL_str(net__urllib__URL u) {
	strings__Builder buf = strings__new_builder(200);
	if (string_ne(u.scheme, tos_lit(""))) {
		strings__Builder_write(&buf, u.scheme);
		strings__Builder_write(&buf, tos_lit(":"));
	}
	if (string_ne(u.opaque, tos_lit(""))) {
		strings__Builder_write(&buf, u.opaque);
	} else {
		if (string_ne(u.scheme, tos_lit("")) || string_ne(u.host, tos_lit("")) || (u.user != 0 && !net__urllib__Userinfo_empty(u.user))) {
			if (string_ne(u.host, tos_lit("")) || string_ne(u.path, tos_lit("")) || !net__urllib__Userinfo_empty(u.user)) {
				strings__Builder_write(&buf, tos_lit("//"));
			}
			if (!net__urllib__Userinfo_empty(u.user)) {
				strings__Builder_write(&buf, net__urllib__Userinfo_string(u.user));
				strings__Builder_write(&buf, tos_lit("@"));
			}
			if (string_ne(u.host, tos_lit(""))) {
				strings__Builder_write(&buf, net__urllib__escape(u.host, net__urllib__EncodingMode_encode_host));
			}
		}
		string path = net__urllib__URL_escaped_path(&u);
		if (string_ne(path, tos_lit("")) && string_at(path, 0) != '/' && string_ne(u.host, tos_lit(""))) {
			strings__Builder_write(&buf, tos_lit("/"));
		}
		if (buf.len == 0) {
			int i = string_index_byte(path, ':');
			if (i > -1 && string_index_byte(string_substr(path, 0, i), '/') == -1) {
				strings__Builder_write(&buf, tos_lit("./"));
			}
		}
		strings__Builder_write(&buf, path);
	}
	if (u.force_query || string_ne(u.raw_query, tos_lit(""))) {
		strings__Builder_write(&buf, tos_lit("?"));
		strings__Builder_write(&buf, u.raw_query);
	}
	if (string_ne(u.fragment, tos_lit(""))) {
		strings__Builder_write(&buf, tos_lit("#"));
		strings__Builder_write(&buf, net__urllib__escape(u.fragment, net__urllib__EncodingMode_encode_fragment));
	}
	return strings__Builder_str(&buf);
}

Option_net__urllib__Values net__urllib__parse_query(string query) {
	net__urllib__Values m = net__urllib__new_values();
	Option_bool _t322 = net__urllib__parse_query_values((voidptr)&/*qq*/m, query);
	if (!_t322.ok) {
		string err = _t322.v_error;
		int errcode = _t322.ecode;
		Option _t323 = v_error(err);
		return *(Option_net__urllib__Values*)&_t323;
	};
	Option_net__urllib__Values _t324;
	opt_ok2(&(net__urllib__Values[]) { m }, (OptionBase*)(&_t324), sizeof(net__urllib__Values));
	return _t324;
}

static net__urllib__Values net__urllib__parse_query_silent(string query) {
	net__urllib__Values m = net__urllib__new_values();
	net__urllib__parse_query_values((voidptr)&/*qq*/m, query);
	return m;
}

static Option_bool net__urllib__parse_query_values(net__urllib__Values* m, string query) {
	bool had_error = false;
	string q = query;
	while (string_ne(q, tos_lit(""))) {
		string key = q;
		int i = string_index_any(key, tos_lit("&;"));
		if (i >= 0) {
			q = string_substr(key, i + 1, key.len);
			key = string_substr(key, 0, i);
		} else {
			q = tos_lit("");
		}
		if (string_eq(key, tos_lit(""))) {
			continue;
		}
		string value = tos_lit("");
		{ /* if guard */ 
		Option_int _t325;
		if (_t325 = string_index(key, tos_lit("=")), _t325.ok) {
			Option_int idx = _t325;
			i = /*opt*/(*(int*)idx.data);
			value = string_substr(key, i + 1, key.len);
			key = string_substr(key, 0, i);
		}}
		Option_string _t326 = net__urllib__query_unescape(key);
		if (!_t326.ok) {
			string err = _t326.v_error;
			int errcode = _t326.ecode;
			had_error = true;
			continue;
		}
		string k = *(string*)_t326.data;
		key = k;
		Option_string _t327 = net__urllib__query_unescape(value);
		if (!_t327.ok) {
			string err = _t327.v_error;
			int errcode = _t327.ecode;
			had_error = true;
			continue;
		}
		string v = *(string*)_t327.data;
		value = v;
		net__urllib__Values_add(m, key, value);
	}
	if (had_error) {
		Option _t328 = v_error(net__urllib__error_msg(tos_lit("parse_query_values: failed parsing query string"), tos_lit("")));
		return *(Option_bool*)&_t328;
	}
	Option_bool _t329;
	opt_ok2(&(bool[]) { true }, (OptionBase*)(&_t329), sizeof(bool));
	return _t329;
}

string net__urllib__Values_encode(net__urllib__Values v) {
	if (v.len == 0) {
		return tos_lit("");
	}
	strings__Builder buf = strings__new_builder(200);
	array_string keys = __new_array_with_default(0, 0, sizeof(string), 0);
	// FOR IN map
	map_string_net__urllib__Value _t332 = v.data;
	array_string keys__t330 = map_keys(&_t332);
	for (int _t331 = 0; _t331 < keys__t330.len; ++_t331) {
		string k = /*kkkk*/ string_clone( ((string*)keys__t330.data)[_t331] );
		array_push(&keys, _MOV((string[]){ k }));
	}
	/*for in map cleanup*/
	for (int _t331 = 0; _t331 < keys__t330.len; ++_t331) { string_free(&((string*)keys__t330.data)[_t331]); }
	array_free(&keys__t330);
	array_string_sort(&keys);
	// FOR IN array
	array _t334 = keys;
	for (int _t335 = 0; _t335 < _t334.len; ++_t335) {
		string k = ((string*)_t334.data)[_t335];
		net__urllib__Value vs = (*(net__urllib__Value*)map_get(v.data, k, &(net__urllib__Value[]){ {0} }));
		string key_kscaped = net__urllib__query_escape(k);
		// FOR IN array
		array _t336 = vs.data;
		for (int _t337 = 0; _t337 < _t336.len; ++_t337) {
			string val = ((string*)_t336.data)[_t337];
			if (buf.len > 0) {
				strings__Builder_write(&buf, tos_lit("&"));
			}
			strings__Builder_write(&buf, key_kscaped);
			strings__Builder_write(&buf, tos_lit("="));
			strings__Builder_write(&buf, net__urllib__query_escape(val));
		}
	}
	return strings__Builder_str(&buf);
}

static string net__urllib__resolve_path(string base, string ref) {
	string full = tos_lit("");
	if (string_eq(ref, tos_lit(""))) {
		full = base;
	} else if (string_at(ref, 0) != '/') {
		Option_int _t338 = string_last_index(base, tos_lit("/"));
		if (!_t338.ok) {
			string err = _t338.v_error;
			int errcode = _t338.ecode;
			*(int*) _t338.data = -1;
		}
		int i = *(int*)_t338.data;
		full = string_add(string_substr(base, 0, i + 1), ref);
	} else {
		full = ref;
	}
	if (string_eq(full, tos_lit(""))) {
		return tos_lit("");
	}
	array_string dst = __new_array_with_default(0, 0, sizeof(string), 0);
	array_string src = string_split(full, tos_lit("/"));
	// FOR IN array
	array _t339 = src;
	for (int _t340 = 0; _t340 < _t339.len; ++_t340) {
		string elem = ((string*)_t339.data)[_t340];
		if (string_eq(elem, tos_lit("."))) {
		} else if (string_eq(elem, tos_lit(".."))) {
			if (dst.len > 0) {
				dst = array_slice(dst, 0, dst.len - 1);
			}
		} else {
			array_push(&dst, _MOV((string[]){ elem }));
		};
	}
	string last = (*(string*)array_get(src, src.len - 1));
	if (string_eq(last, tos_lit(".")) || string_eq(last, tos_lit(".."))) {
		array_push(&dst, _MOV((string[]){ tos_lit("") }));
	}
	return string_add(tos_lit("/"), string_trim_left(array_string_join(dst, tos_lit("/")), tos_lit("/")));
}

bool net__urllib__URL_is_abs(net__urllib__URL* u) {
	return string_ne(u->scheme, tos_lit(""));
}

Option_net__urllib__URL net__urllib__URL_parse(net__urllib__URL* u, string ref) {
	Option_net__urllib__URL _t344 = net__urllib__parse(ref);
	if (!_t344.ok) {
		string err = _t344.v_error;
		int errcode = _t344.ecode;
		Option _t345 = v_error(err);
		return *(Option_net__urllib__URL*)&_t345;
	}
	net__urllib__URL refurl = *(net__urllib__URL*)_t344.data;
	return net__urllib__URL_resolve_reference(u, (voidptr)&/*qq*/refurl);
}

Option_net__urllib__URL net__urllib__URL_resolve_reference(net__urllib__URL* u, net__urllib__URL* ref) {
	net__urllib__URL url = *ref;
	if (string_eq(ref->scheme, tos_lit(""))) {
		url.scheme = u->scheme;
	}
	if (string_ne(ref->scheme, tos_lit("")) || string_ne(ref->host, tos_lit("")) || !net__urllib__Userinfo_empty(ref->user)) {
		Option_bool _t346 = net__urllib__URL_set_path(&url, net__urllib__resolve_path(net__urllib__URL_escaped_path(ref), tos_lit("")));
		if (!_t346.ok) {
			string err = _t346.v_error;
			int errcode = _t346.ecode;
			Option _t347 = v_error(err);
			return *(Option_net__urllib__URL*)&_t347;
		};
		Option_net__urllib__URL _t348;
		opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t348), sizeof(net__urllib__URL));
		return _t348;
	}
	if (string_ne(ref->opaque, tos_lit(""))) {
		url.user = net__urllib__user(tos_lit(""));
		url.host = tos_lit("");
		url.path = tos_lit("");
		Option_net__urllib__URL _t349;
		opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t349), sizeof(net__urllib__URL));
		return _t349;
	}
	if (string_eq(ref->path, tos_lit("")) && string_eq(ref->raw_query, tos_lit(""))) {
		url.raw_query = u->raw_query;
		if (string_eq(ref->fragment, tos_lit(""))) {
			url.fragment = u->fragment;
		}
	}
	url.host = u->host;
	url.user = u->user;
	Option_bool _t350 = net__urllib__URL_set_path(&url, net__urllib__resolve_path(net__urllib__URL_escaped_path(u), net__urllib__URL_escaped_path(ref)));
	if (!_t350.ok) {
		string err = _t350.v_error;
		int errcode = _t350.ecode;
		Option _t351 = v_error(err);
		return *(Option_net__urllib__URL*)&_t351;
	};
	Option_net__urllib__URL _t352;
	opt_ok2(&(net__urllib__URL[]) { url }, (OptionBase*)(&_t352), sizeof(net__urllib__URL));
	return _t352;
}

net__urllib__Values net__urllib__URL_query(net__urllib__URL* u) {
	net__urllib__Values v = net__urllib__parse_query_silent(u->raw_query);
	return v;
}

string net__urllib__URL_request_uri(net__urllib__URL* u) {
	string result = u->opaque;
	if (string_eq(result, tos_lit(""))) {
		result = net__urllib__URL_escaped_path(u);
		if (string_eq(result, tos_lit(""))) {
			result = tos_lit("/");
		}
	} else {
		if (string_starts_with(result, tos_lit("//"))) {
			result = string_add(string_add(u->scheme, tos_lit(":")), result);
		}
	}
	if (u->force_query || string_ne(u->raw_query, tos_lit(""))) {
		result = /*f*/string_add(result, string_add(tos_lit("?"), u->raw_query));
	}
	return result;
}

string net__urllib__URL_hostname(net__urllib__URL* u) {
	multi_return_string_string mr_29018 = net__urllib__split_host_port(u->host);
	string host = mr_29018.arg0;
	return host;
}

string net__urllib__URL_port(net__urllib__URL* u) {
	multi_return_string_string mr_29236 = net__urllib__split_host_port(u->host);
	string port = mr_29236.arg1;
	return port;
}

static multi_return_string_string net__urllib__split_host_port(string hostport) {
	string host = hostport;
	string port = tos_lit("");
	int colon = string_last_index_byte(host, ':');
	if (colon != -1 && net__urllib__valid_optional_port(string_substr(host, colon, host.len))) {
		port = string_substr(host, colon + 1, host.len);
		host = string_substr(host, 0, colon);
	}
	if (string_starts_with(host, tos_lit("[")) && string_ends_with(host, tos_lit("]"))) {
		host = string_substr(host, 1, host.len - 1);
	}
	return (multi_return_string_string){.arg0=host, .arg1=port};
}

bool net__urllib__valid_userinfo(string s) {
	for (int _t353 = 0; _t353 < s.len; ++_t353) {
		byte r = s.str[_t353];
		if ('A' <= r && r <= 'Z') {
			continue;
		}
		if ('a' <= r && r <= 'z') {
			continue;
		}
		if ('0' <= r && r <= '9') {
			continue;
		}
		if (r == '-' || r == '.' || r == '_' || r == ':' || r == '~' || r == '!' || r == '$' || r == '&' || r == '\\' || r == '(' || r == ')' || r == '*' || r == '+' || r == ',' || r == ';' || r == '=' || r == '%' || r == '@') {
			continue;
		} else {
			return false;
		};
	}
	return true;
}

static bool net__urllib__string_contains_ctl_byte(string s) {
	for (int i = 0; i < s.len; ++i) {
		byte b = string_at(s, i);
		if (b < ' ' || b == 0x7f) {
			return true;
		}
	}
	return false;
}

bool net__urllib__ishex(byte c) {
	if ('0' <= c && c <= '9') {
		return true;
	} else if ('a' <= c && c <= 'f') {
		return true;
	} else if ('A' <= c && c <= 'F') {
		return true;
	}
	return false;
}

static byte net__urllib__unhex(byte c) {
	if ('0' <= c && c <= '9') {
		return c - '0';
	} else if ('a' <= c && c <= 'f') {
		return c - 'a' + 10;
	} else if ('A' <= c && c <= 'F') {
		return c - 'A' + 10;
	}
	return 0;
}

net__urllib__Values net__urllib__new_values() {
	return (net__urllib__Values){.data = new_map_1(sizeof(net__urllib__Value)),.len = 0,};
}

array_string net__urllib__Value_all(net__urllib__Value* v) {
	return v->data;
}

string net__urllib__Values_get(net__urllib__Values* v, string key) {
	if (v->data.len == 0) {
		return tos_lit("");
	}
	net__urllib__Value vs = (*(net__urllib__Value*)map_get(v->data, key, &(net__urllib__Value[]){ {0} }));
	if (vs.data.len == 0) {
		return tos_lit("");
	}
	return (*(string*)array_get(vs.data, 0));
}

array_string net__urllib__Values_get_all(net__urllib__Values* v, string key) {
	if (v->data.len == 0) {
		return __new_array_with_default(0, 0, sizeof(string), 0);
	}
	net__urllib__Value vs = (*(net__urllib__Value*)map_get(v->data, key, &(net__urllib__Value[]){ {0} }));
	if (vs.data.len == 0) {
		return __new_array_with_default(0, 0, sizeof(string), 0);
	}
	return vs.data;
}

void net__urllib__Values_set(net__urllib__Values* v, string key, string value) {
	net__urllib__Value a = (*(net__urllib__Value*)map_get(v->data, key, &(net__urllib__Value[]){ {0} }));
	a.data = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){value}));
	map_set(&v->data, key, &(net__urllib__Value[]) { a });
	v->len = v->data.len;
}

void net__urllib__Values_add(net__urllib__Values* v, string key, string value) {
	net__urllib__Value a = (*(net__urllib__Value*)map_get(v->data, key, &(net__urllib__Value[]){ {0} }));
	if (a.data.len == 0) {
		a.data = __new_array_with_default(0, 0, sizeof(string), 0);
	}
	array_push(&a.data, _MOV((string[]){ value }));
	map_set(&v->data, key, &(net__urllib__Value[]) { a });
	v->len = v->data.len;
}

void net__urllib__Values_del(net__urllib__Values* v, string key) {
	map_delete(&v->data, key);
	v->len = v->data.len;
}

// Attr: [inline]
inline u16 encoding__binary__little_endian_u16(array_byte b) {
	{byte _ = (*(byte*)array_get(b, 1));}
	;
	return (((u16)((*(byte*)array_get(b, 0)))) | (((u16)((*(byte*)array_get(b, 1)))) << ((u16)(8))));
}

// Attr: [inline]
inline void encoding__binary__little_endian_put_u16(array_byte* b, u16 v) {
	{byte _ = (*(byte*)array_get(*b, 1));}
	;
	array_set(b, 0, &(byte[]) { ((byte)(v)) });
	array_set(b, 1, &(byte[]) { ((byte)(v >> ((u16)(8)))) });
}

// Attr: [inline]
inline u32 encoding__binary__little_endian_u32(array_byte b) {
	{byte _ = (*(byte*)array_get(b, 3));}
	;
	return (((((u32)((*(byte*)array_get(b, 0)))) | (((u32)((*(byte*)array_get(b, 1)))) << ((u32)(8)))) | (((u32)((*(byte*)array_get(b, 2)))) << ((u32)(16)))) | (((u32)((*(byte*)array_get(b, 3)))) << ((u32)(24))));
}

// Attr: [inline]
inline void encoding__binary__little_endian_put_u32(array_byte* b, u32 v) {
	{byte _ = (*(byte*)array_get(*b, 3));}
	;
	array_set(b, 0, &(byte[]) { ((byte)(v)) });
	array_set(b, 1, &(byte[]) { ((byte)(v >> ((u32)(8)))) });
	array_set(b, 2, &(byte[]) { ((byte)(v >> ((u32)(16)))) });
	array_set(b, 3, &(byte[]) { ((byte)(v >> ((u32)(24)))) });
}

// Attr: [inline]
inline u64 encoding__binary__little_endian_u64(array_byte b) {
	{byte _ = (*(byte*)array_get(b, 7));}
	;
	return (((((((((u64)((*(byte*)array_get(b, 0)))) | (((u64)((*(byte*)array_get(b, 1)))) << ((u64)(8)))) | (((u64)((*(byte*)array_get(b, 2)))) << ((u64)(16)))) | (((u64)((*(byte*)array_get(b, 3)))) << ((u64)(24)))) | (((u64)((*(byte*)array_get(b, 4)))) << ((u64)(32)))) | (((u64)((*(byte*)array_get(b, 5)))) << ((u64)(40)))) | (((u64)((*(byte*)array_get(b, 6)))) << ((u64)(48)))) | (((u64)((*(byte*)array_get(b, 7)))) << ((u64)(56))));
}

// Attr: [inline]
inline void encoding__binary__little_endian_put_u64(array_byte* b, u64 v) {
	{byte _ = (*(byte*)array_get(*b, 7));}
	;
	array_set(b, 0, &(byte[]) { ((byte)(v)) });
	array_set(b, 1, &(byte[]) { ((byte)(v >> ((u64)(8)))) });
	array_set(b, 2, &(byte[]) { ((byte)(v >> ((u64)(16)))) });
	array_set(b, 3, &(byte[]) { ((byte)(v >> ((u64)(24)))) });
	array_set(b, 4, &(byte[]) { ((byte)(v >> ((u64)(32)))) });
	array_set(b, 5, &(byte[]) { ((byte)(v >> ((u64)(40)))) });
	array_set(b, 6, &(byte[]) { ((byte)(v >> ((u64)(48)))) });
	array_set(b, 7, &(byte[]) { ((byte)(v >> ((u64)(56)))) });
}

// Attr: [inline]
inline u16 encoding__binary__big_endian_u16(array_byte b) {
	{byte _ = (*(byte*)array_get(b, 1));}
	;
	return (((u16)((*(byte*)array_get(b, 1)))) | (((u16)((*(byte*)array_get(b, 0)))) << ((u16)(8))));
}

// Attr: [inline]
inline void encoding__binary__big_endian_put_u16(array_byte* b, u16 v) {
	{byte _ = (*(byte*)array_get(*b, 1));}
	;
	array_set(b, 0, &(byte[]) { ((byte)(v >> ((u16)(8)))) });
	array_set(b, 1, &(byte[]) { ((byte)(v)) });
}

// Attr: [inline]
inline u32 encoding__binary__big_endian_u32(array_byte b) {
	{byte _ = (*(byte*)array_get(b, 3));}
	;
	return (((((u32)((*(byte*)array_get(b, 3)))) | (((u32)((*(byte*)array_get(b, 2)))) << ((u32)(8)))) | (((u32)((*(byte*)array_get(b, 1)))) << ((u32)(16)))) | (((u32)((*(byte*)array_get(b, 0)))) << ((u32)(24))));
}

// Attr: [inline]
inline void encoding__binary__big_endian_put_u32(array_byte* b, u32 v) {
	{byte _ = (*(byte*)array_get(*b, 3));}
	;
	array_set(b, 0, &(byte[]) { ((byte)(v >> ((u32)(24)))) });
	array_set(b, 1, &(byte[]) { ((byte)(v >> ((u32)(16)))) });
	array_set(b, 2, &(byte[]) { ((byte)(v >> ((u32)(8)))) });
	array_set(b, 3, &(byte[]) { ((byte)(v)) });
}

// Attr: [inline]
inline u64 encoding__binary__big_endian_u64(array_byte b) {
	{byte _ = (*(byte*)array_get(b, 7));}
	;
	return (((((((((u64)((*(byte*)array_get(b, 7)))) | (((u64)((*(byte*)array_get(b, 6)))) << ((u64)(8)))) | (((u64)((*(byte*)array_get(b, 5)))) << ((u64)(16)))) | (((u64)((*(byte*)array_get(b, 4)))) << ((u64)(24)))) | (((u64)((*(byte*)array_get(b, 3)))) << ((u64)(32)))) | (((u64)((*(byte*)array_get(b, 2)))) << ((u64)(40)))) | (((u64)((*(byte*)array_get(b, 1)))) << ((u64)(48)))) | (((u64)((*(byte*)array_get(b, 0)))) << ((u64)(56))));
}

// Attr: [inline]
inline void encoding__binary__big_endian_put_u64(array_byte* b, u64 v) {
	{byte _ = (*(byte*)array_get(*b, 7));}
	;
	array_set(b, 0, &(byte[]) { ((byte)(v >> ((u64)(56)))) });
	array_set(b, 1, &(byte[]) { ((byte)(v >> ((u64)(48)))) });
	array_set(b, 2, &(byte[]) { ((byte)(v >> ((u64)(40)))) });
	array_set(b, 3, &(byte[]) { ((byte)(v >> ((u64)(32)))) });
	array_set(b, 4, &(byte[]) { ((byte)(v >> ((u64)(24)))) });
	array_set(b, 5, &(byte[]) { ((byte)(v >> ((u64)(16)))) });
	array_set(b, 6, &(byte[]) { ((byte)(v >> ((u64)(8)))) });
	array_set(b, 7, &(byte[]) { ((byte)(v)) });
}

static void net__openssl__init() {
	SSL_library_init();
}

static int net__http__chunked__ChunkScanner_read_chunk_size(net__http__chunked__ChunkScanner* s) {
	int n = 0;
	while (1) {
		if (s->pos >= s->text.len) {
			break;
		}
		byte c = string_at(s->text, s->pos);
		if (!byte_is_hex_digit(c)) {
			break;
		}
		n = n << 4;
		n += ((int)(net__http__chunked__unhex(c)));
		s->pos++;
	}
	return n;
}

static byte net__http__chunked__unhex(byte c) {
	if ('0' <= c && c <= '9') {
		return c - '0';
	} else if ('a' <= c && c <= 'f') {
		return c - 'a' + 10;
	} else if ('A' <= c && c <= 'F') {
		return c - 'A' + 10;
	}
	return 0;
}

static void net__http__chunked__ChunkScanner_skip_crlf(net__http__chunked__ChunkScanner* s) {
	s->pos += 2;
}

static string net__http__chunked__ChunkScanner_read_chunk(net__http__chunked__ChunkScanner* s, int chunksize) {
	int startpos = s->pos;
	s->pos += chunksize;
	return string_substr(s->text, startpos, s->pos);
}

string net__http__chunked__decode(string text) {
	strings__Builder sb = strings__new_builder(100);
	net__http__chunked__ChunkScanner cscanner = (net__http__chunked__ChunkScanner){.pos = 0,.text = text,};
	while (1) {
		int csize = net__http__chunked__ChunkScanner_read_chunk_size(&cscanner);
		if (0 == csize) {
			break;
		}
		net__http__chunked__ChunkScanner_skip_crlf(&cscanner);
		strings__Builder_write(&sb, net__http__chunked__ChunkScanner_read_chunk(&cscanner, csize));
		net__http__chunked__ChunkScanner_skip_crlf(&cscanner);
	}
	net__http__chunked__ChunkScanner_skip_crlf(&cscanner);
	return strings__Builder_str(&sb);
}

static void crypto__sha1__Digest_reset(crypto__sha1__Digest* d) {
	d->x = __new_array_with_default((_const_crypto__sha1__chunk), 0, sizeof(byte), 0);
	d->h = __new_array_with_default((5), 0, sizeof(u32), 0);
	(*(u32*)array_get(d->h, 0)) = ((u32)(_const_crypto__sha1__init0));
	(*(u32*)array_get(d->h, 1)) = ((u32)(_const_crypto__sha1__init1));
	(*(u32*)array_get(d->h, 2)) = ((u32)(_const_crypto__sha1__init2));
	(*(u32*)array_get(d->h, 3)) = ((u32)(_const_crypto__sha1__init3));
	(*(u32*)array_get(d->h, 4)) = ((u32)(_const_crypto__sha1__init4));
	d->nx = 0;
	d->len = 0;
}

crypto__sha1__Digest* crypto__sha1__new() {
	crypto__sha1__Digest* d = (crypto__sha1__Digest*)memdup(&(crypto__sha1__Digest){.h = __new_array(0, 1, sizeof(u32)),.x = __new_array(0, 1, sizeof(byte)),.nx = 0,.len = 0,}, sizeof(crypto__sha1__Digest));
	crypto__sha1__Digest_reset(d);
	return d;
}

int crypto__sha1__Digest_write(crypto__sha1__Digest* d, array_byte p_) {
	array_byte p = p_;
	int nn = p.len;
	d->len += ((u64)(nn));
	if (d->nx > 0) {
		int n = copy(array_slice(d->x, d->nx, d->x.len), p);
		d->nx += n;
		if (d->nx == _const_crypto__sha1__chunk) {
			crypto__sha1__block(d, d->x);
			d->nx = 0;
		}
		if (n >= p.len) {
			p = __new_array_with_default(0, 0, sizeof(byte), 0);
		} else {
			p = array_slice(p, n, p.len);
		}
	}
	if (p.len >= _const_crypto__sha1__chunk) {
		int n = (p.len & ~(_const_crypto__sha1__chunk - 1));
		crypto__sha1__block(d, array_slice(p, 0, n));
		if (n >= p.len) {
			p = __new_array_with_default(0, 0, sizeof(byte), 0);
		} else {
			p = array_slice(p, n, p.len);
		}
	}
	if (p.len > 0) {
		d->nx = copy(d->x, p);
	}
	return nn;
}

array_byte crypto__sha1__Digest_sum(crypto__sha1__Digest* d, array_byte b_in) {
	crypto__sha1__Digest d0 = *d;
	array_byte hash = crypto__sha1__Digest_checksum(&d0);
	array_byte b_out = array_clone(&b_in);
	// FOR IN array
	array _t356 = hash;
	for (int _t357 = 0; _t357 < _t356.len; ++_t357) {
		byte b = ((byte*)_t356.data)[_t357];
		array_push(&b_out, _MOV((byte[]){ b }));
	}
	return b_out;
}

static array_byte crypto__sha1__Digest_checksum(crypto__sha1__Digest* d) {
	u64 len = d->len;
	array_byte tmp = __new_array_with_default((64), 0, sizeof(byte), 0);
	array_set(&tmp, 0, &(byte[]) { 0x80 });
	if (((int)(len)) % 64 < 56) {
		crypto__sha1__Digest_write(d, array_slice(tmp, 0, 56 - ((int)(len)) % 64));
	} else {
		crypto__sha1__Digest_write(d, array_slice(tmp, 0, 64 + 56 - ((int)(len)) % 64));
	}
	len <<= 3;
	encoding__binary__big_endian_put_u64(&/*arr*/tmp, len);
	crypto__sha1__Digest_write(d, array_slice(tmp, 0, 8));
	array_byte digest = __new_array_with_default((_const_crypto__sha1__size), 0, sizeof(byte), 0);
	encoding__binary__big_endian_put_u32(&/*arr*/digest, (*(u32*)array_get(d->h, 0)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 4, digest.len)}[0], (*(u32*)array_get(d->h, 1)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 8, digest.len)}[0], (*(u32*)array_get(d->h, 2)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 12, digest.len)}[0], (*(u32*)array_get(d->h, 3)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 16, digest.len)}[0], (*(u32*)array_get(d->h, 4)));
	return digest;
}

array_byte crypto__sha1__sum(array_byte data) {
	crypto__sha1__Digest* d = crypto__sha1__new();
	crypto__sha1__Digest_write(d, data);
	return crypto__sha1__Digest_checksum(d);
}

static void crypto__sha1__block(crypto__sha1__Digest* dig, array_byte p) {
	crypto__sha1__block_generic(dig, p);
}

int crypto__sha1__Digest_size(crypto__sha1__Digest* d) {
	return _const_crypto__sha1__size;
}

int crypto__sha1__Digest_block_size(crypto__sha1__Digest* d) {
	return _const_crypto__sha1__block_size;
}

string crypto__sha1__hexhash(string s) {
	return array_byte_hex(crypto__sha1__sum(string_bytes(s)));
}

static void crypto__sha1__block_generic(crypto__sha1__Digest* dig, array_byte p_) {
	array_byte p = p_;
	array_u32 w = __new_array_with_default((16), 0, sizeof(u32), 0);
	u32 h0 = (*(u32*)array_get(dig->h, 0));
	u32 h1 = (*(u32*)array_get(dig->h, 1));
	u32 h2 = (*(u32*)array_get(dig->h, 2));
	u32 h3 = (*(u32*)array_get(dig->h, 3));
	u32 h4 = (*(u32*)array_get(dig->h, 4));
	while (p.len >= _const_crypto__sha1__chunk) {
		for (int i = 0; i < 16; ++i) {
			int j = i * 4;
			array_set(&w, i, &(u32[]) { (((((u32)((*(byte*)array_get(p, j)) << 24)) | ((u32)((*(byte*)array_get(p, j + 1)) << 16))) | ((u32)((*(byte*)array_get(p, j + 2)) << 8))) | ((u32)((*(byte*)array_get(p, j + 3))))) });
		}
		u32 a = h0;
		u32 b = h1;
		u32 c = h2;
		u32 d = h3;
		u32 e = h4;
		int i = 0;
		while (i < 16) {
			u32 f = ((b & c) | ((~b) & d));
			u32 t = math__bits__rotate_left_32(a, 5) + f + e + (*(u32*)array_get(w, (i & 0xf))) + ((u32)(_const_crypto__sha1___k0));
			e = d;
			d = c;
			c = math__bits__rotate_left_32(b, 30);
			b = a;
			a = t;
			i++;
		}
		while (i < 20) {
			u32 tmp = ((((*(u32*)array_get(w, ((i - 3) & 0xf))) ^ (*(u32*)array_get(w, ((i - 8) & 0xf)))) ^ (*(u32*)array_get(w, ((i - 14) & 0xf)))) ^ (*(u32*)array_get(w, ((i) & 0xf))));
			array_set(&w, (i & 0xf), &(u32[]) { ((tmp << 1) | (tmp >> (32 - 1))) });
			u32 f = ((b & c) | ((~b) & d));
			u32 t = math__bits__rotate_left_32(a, 5) + f + e + (*(u32*)array_get(w, (i & 0xf))) + ((u32)(_const_crypto__sha1___k0));
			e = d;
			d = c;
			c = math__bits__rotate_left_32(b, 30);
			b = a;
			a = t;
			i++;
		}
		while (i < 40) {
			u32 tmp = ((((*(u32*)array_get(w, ((i - 3) & 0xf))) ^ (*(u32*)array_get(w, ((i - 8) & 0xf)))) ^ (*(u32*)array_get(w, ((i - 14) & 0xf)))) ^ (*(u32*)array_get(w, ((i) & 0xf))));
			array_set(&w, (i & 0xf), &(u32[]) { ((tmp << 1) | (tmp >> (32 - 1))) });
			u32 f = ((b ^ c) ^ d);
			u32 t = math__bits__rotate_left_32(a, 5) + f + e + (*(u32*)array_get(w, (i & 0xf))) + ((u32)(_const_crypto__sha1___k1));
			e = d;
			d = c;
			c = math__bits__rotate_left_32(b, 30);
			b = a;
			a = t;
			i++;
		}
		while (i < 60) {
			u32 tmp = ((((*(u32*)array_get(w, ((i - 3) & 0xf))) ^ (*(u32*)array_get(w, ((i - 8) & 0xf)))) ^ (*(u32*)array_get(w, ((i - 14) & 0xf)))) ^ (*(u32*)array_get(w, ((i) & 0xf))));
			array_set(&w, (i & 0xf), &(u32[]) { ((tmp << 1) | (tmp >> (32 - 1))) });
			u32 f = (((((b | c)) & d)) | ((b & c)));
			u32 t = math__bits__rotate_left_32(a, 5) + f + e + (*(u32*)array_get(w, (i & 0xf))) + ((u32)(_const_crypto__sha1___k2));
			e = d;
			d = c;
			c = math__bits__rotate_left_32(b, 30);
			b = a;
			a = t;
			i++;
		}
		while (i < 80) {
			u32 tmp = ((((*(u32*)array_get(w, ((i - 3) & 0xf))) ^ (*(u32*)array_get(w, ((i - 8) & 0xf)))) ^ (*(u32*)array_get(w, ((i - 14) & 0xf)))) ^ (*(u32*)array_get(w, ((i) & 0xf))));
			array_set(&w, (i & 0xf), &(u32[]) { ((tmp << 1) | (tmp >> (32 - 1))) });
			u32 f = ((b ^ c) ^ d);
			u32 t = math__bits__rotate_left_32(a, 5) + f + e + (*(u32*)array_get(w, (i & 0xf))) + ((u32)(_const_crypto__sha1___k3));
			e = d;
			d = c;
			c = math__bits__rotate_left_32(b, 30);
			b = a;
			a = t;
			i++;
		}
		h0 += a;
		h1 += b;
		h2 += c;
		h3 += d;
		h4 += e;
		if (_const_crypto__sha1__chunk >= p.len) {
			p = __new_array_with_default(0, 0, sizeof(byte), 0);
		} else {
			p = array_slice(p, _const_crypto__sha1__chunk, p.len);
		}
	}
	(*(u32*)array_get(dig->h, 0)) = h0;
	(*(u32*)array_get(dig->h, 1)) = h1;
	(*(u32*)array_get(dig->h, 2)) = h2;
	(*(u32*)array_get(dig->h, 3)) = h3;
	(*(u32*)array_get(dig->h, 4)) = h4;
}

static void crypto__sha256__Digest_reset(crypto__sha256__Digest* d) {
	d->h = __new_array_with_default((8), 0, sizeof(u32), 0);
	d->x = __new_array_with_default((_const_crypto__sha256__chunk), 0, sizeof(byte), 0);
	if (!d->is224) {
		(*(u32*)array_get(d->h, 0)) = ((u32)(_const_crypto__sha256__init0));
		(*(u32*)array_get(d->h, 1)) = ((u32)(_const_crypto__sha256__init1));
		(*(u32*)array_get(d->h, 2)) = ((u32)(_const_crypto__sha256__init2));
		(*(u32*)array_get(d->h, 3)) = ((u32)(_const_crypto__sha256__init3));
		(*(u32*)array_get(d->h, 4)) = ((u32)(_const_crypto__sha256__init4));
		(*(u32*)array_get(d->h, 5)) = ((u32)(_const_crypto__sha256__init5));
		(*(u32*)array_get(d->h, 6)) = ((u32)(_const_crypto__sha256__init6));
		(*(u32*)array_get(d->h, 7)) = ((u32)(_const_crypto__sha256__init7));
	} else {
		(*(u32*)array_get(d->h, 0)) = ((u32)(_const_crypto__sha256__init0_224));
		(*(u32*)array_get(d->h, 1)) = ((u32)(_const_crypto__sha256__init1_224));
		(*(u32*)array_get(d->h, 2)) = ((u32)(_const_crypto__sha256__init2_224));
		(*(u32*)array_get(d->h, 3)) = ((u32)(_const_crypto__sha256__init3_224));
		(*(u32*)array_get(d->h, 4)) = ((u32)(_const_crypto__sha256__init4_224));
		(*(u32*)array_get(d->h, 5)) = ((u32)(_const_crypto__sha256__init5_224));
		(*(u32*)array_get(d->h, 6)) = ((u32)(_const_crypto__sha256__init6_224));
		(*(u32*)array_get(d->h, 7)) = ((u32)(_const_crypto__sha256__init7_224));
	}
	d->nx = 0;
	d->len = 0;
}

crypto__sha256__Digest* crypto__sha256__new() {
	crypto__sha256__Digest* d = (crypto__sha256__Digest*)memdup(&(crypto__sha256__Digest){.h = __new_array(0, 1, sizeof(u32)),.x = __new_array(0, 1, sizeof(byte)),.nx = 0,.len = 0,.is224 = 0,}, sizeof(crypto__sha256__Digest));
	crypto__sha256__Digest_reset(d);
	return d;
}

crypto__sha256__Digest* crypto__sha256__new224() {
	crypto__sha256__Digest* d = (crypto__sha256__Digest*)memdup(&(crypto__sha256__Digest){.h = __new_array(0, 1, sizeof(u32)),.x = __new_array(0, 1, sizeof(byte)),.nx = 0,.len = 0,.is224 = 0,}, sizeof(crypto__sha256__Digest));
	d->is224 = true;
	crypto__sha256__Digest_reset(d);
	return d;
}

static int crypto__sha256__Digest_write(crypto__sha256__Digest* d, array_byte p_) {
	array_byte p = p_;
	int nn = p.len;
	d->len += ((u64)(nn));
	if (d->nx > 0) {
		int n = copy(array_slice(d->x, d->nx, d->x.len), p);
		d->nx += n;
		if (d->nx == _const_crypto__sha256__chunk) {
			crypto__sha256__block(d, d->x);
			d->nx = 0;
		}
		if (n >= p.len) {
			p = __new_array_with_default(0, 0, sizeof(byte), 0);
		} else {
			p = array_slice(p, n, p.len);
		}
	}
	if (p.len >= _const_crypto__sha256__chunk) {
		int n = (p.len & ~(_const_crypto__sha256__chunk - 1));
		crypto__sha256__block(d, array_slice(p, 0, n));
		if (n >= p.len) {
			p = __new_array_with_default(0, 0, sizeof(byte), 0);
		} else {
			p = array_slice(p, n, p.len);
		}
	}
	if (p.len > 0) {
		d->nx = copy(d->x, p);
	}
	return nn;
}

static array_byte crypto__sha256__Digest_sum(crypto__sha256__Digest* d, array_byte b_in) {
	crypto__sha256__Digest d0 = *d;
	array_byte hash = crypto__sha256__Digest_checksum(&d0);
	array_byte b_out = array_clone(&b_in);
	if (d0.is224) {
		// FOR IN array
		array _t359 = array_slice(hash, 0, _const_crypto__sha256__size224);
		for (int _t360 = 0; _t360 < _t359.len; ++_t360) {
			byte b = ((byte*)_t359.data)[_t360];
			array_push(&b_out, _MOV((byte[]){ b }));
		}
	} else {
		// FOR IN array
		array _t362 = hash;
		for (int _t363 = 0; _t363 < _t362.len; ++_t363) {
			byte b = ((byte*)_t362.data)[_t363];
			array_push(&b_out, _MOV((byte[]){ b }));
		}
	}
	return b_out;
}

static array_byte crypto__sha256__Digest_checksum(crypto__sha256__Digest* d) {
	u64 len = d->len;
	array_byte tmp = __new_array_with_default((64), 0, sizeof(byte), 0);
	array_set(&tmp, 0, &(byte[]) { 0x80 });
	if (((int)(len)) % 64 < 56) {
		crypto__sha256__Digest_write(d, array_slice(tmp, 0, 56 - ((int)(len)) % 64));
	} else {
		crypto__sha256__Digest_write(d, array_slice(tmp, 0, 64 + 56 - ((int)(len)) % 64));
	}
	len <<= ((u64)(3));
	encoding__binary__big_endian_put_u64(&/*arr*/tmp, len);
	crypto__sha256__Digest_write(d, array_slice(tmp, 0, 8));
	if (d->nx != 0) {
		v_panic(tos_lit("d.nx != 0"));
	}
	array_byte digest = __new_array_with_default((_const_crypto__sha256__size), 0, sizeof(byte), 0);
	encoding__binary__big_endian_put_u32(&/*arr*/digest, (*(u32*)array_get(d->h, 0)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 4, digest.len)}[0], (*(u32*)array_get(d->h, 1)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 8, digest.len)}[0], (*(u32*)array_get(d->h, 2)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 12, digest.len)}[0], (*(u32*)array_get(d->h, 3)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 16, digest.len)}[0], (*(u32*)array_get(d->h, 4)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 20, digest.len)}[0], (*(u32*)array_get(d->h, 5)));
	encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 24, digest.len)}[0], (*(u32*)array_get(d->h, 6)));
	if (!d->is224) {
		encoding__binary__big_endian_put_u32(&/*111*/(array[]){array_slice(digest, 28, digest.len)}[0], (*(u32*)array_get(d->h, 7)));
	}
	return digest;
}

array_byte crypto__sha256__sum(array_byte data) {
	return crypto__sha256__sum256(data);
}

array_byte crypto__sha256__sum256(array_byte data) {
	crypto__sha256__Digest* d = crypto__sha256__new();
	crypto__sha256__Digest_write(d, data);
	return crypto__sha256__Digest_checksum(d);
}

array_byte crypto__sha256__sum224(array_byte data) {
	crypto__sha256__Digest* d = crypto__sha256__new224();
	crypto__sha256__Digest_write(d, data);
	array_byte sum = crypto__sha256__Digest_checksum(d);
	array_byte sum224 = __new_array_with_default((_const_crypto__sha256__size224), 0, sizeof(byte), 0);
	copy(sum224, array_slice(sum, 0, _const_crypto__sha256__size224));
	return sum224;
}

static void crypto__sha256__block(crypto__sha256__Digest* dig, array_byte p) {
	crypto__sha256__block_generic(dig, p);
}

int crypto__sha256__Digest_size(crypto__sha256__Digest* d) {
	if (!d->is224) {
		return _const_crypto__sha256__size;
	}
	return _const_crypto__sha256__size224;
}

int crypto__sha256__Digest_block_size(crypto__sha256__Digest* d) {
	return _const_crypto__sha256__block_size;
}

string crypto__sha256__hexhash(string s) {
	return array_byte_hex(crypto__sha256__sum256(string_bytes(s)));
}

string crypto__sha256__hexhash_224(string s) {
	return array_byte_hex(crypto__sha256__sum224(string_bytes(s)));
}

static void crypto__sha256__block_generic(crypto__sha256__Digest* dig, array_byte p_) {
	array_byte p = p_;
	array_u32 w = __new_array_with_default((64), 0, sizeof(u32), 0);
	u32 h0 = (*(u32*)array_get(dig->h, 0));
	u32 h1 = (*(u32*)array_get(dig->h, 1));
	u32 h2 = (*(u32*)array_get(dig->h, 2));
	u32 h3 = (*(u32*)array_get(dig->h, 3));
	u32 h4 = (*(u32*)array_get(dig->h, 4));
	u32 h5 = (*(u32*)array_get(dig->h, 5));
	u32 h6 = (*(u32*)array_get(dig->h, 6));
	u32 h7 = (*(u32*)array_get(dig->h, 7));
	while (p.len >= _const_crypto__sha256__chunk) {
		for (int i = 0; i < 16; ++i) {
			int j = i * 4;
			array_set(&w, i, &(u32[]) { (((((u32)((*(byte*)array_get(p, j)) << 24)) | ((u32)((*(byte*)array_get(p, j + 1)) << 16))) | ((u32)((*(byte*)array_get(p, j + 2)) << 8))) | ((u32)((*(byte*)array_get(p, j + 3))))) });
		}
		for (int i = 16; i < 64; i++) {
			u32 v1 = (*(u32*)array_get(w, i - 2));
			u32 t1 = (((math__bits__rotate_left_32(v1, -17)) ^ (math__bits__rotate_left_32(v1, -19))) ^ (v1 >> 10));
			u32 v2 = (*(u32*)array_get(w, i - 15));
			u32 t2 = (((math__bits__rotate_left_32(v2, -7)) ^ (math__bits__rotate_left_32(v2, -18))) ^ (v2 >> 3));
			array_set(&w, i, &(u32[]) { t1 + (*(u32*)array_get(w, i - 7)) + t2 + (*(u32*)array_get(w, i - 16)) });
		}
		u32 a = h0;
		u32 b = h1;
		u32 c = h2;
		u32 d = h3;
		u32 e = h4;
		u32 f = h5;
		u32 g = h6;
		u32 h = h7;
		for (int i = 0; i < 64; ++i) {
			u32 t1 = h + ((((math__bits__rotate_left_32(e, -6)) ^ (math__bits__rotate_left_32(e, -11))) ^ (math__bits__rotate_left_32(e, -25)))) + ((((e & f)) ^ ((~e & g)))) + ((u32)((*(int*)array_get(_const_crypto__sha256___k, i)))) + (*(u32*)array_get(w, i));
			u32 t2 = ((((math__bits__rotate_left_32(a, -2)) ^ (math__bits__rotate_left_32(a, -13))) ^ (math__bits__rotate_left_32(a, -22)))) + (((((a & b)) ^ ((a & c))) ^ ((b & c))));
			h = g;
			g = f;
			f = e;
			e = d + t1;
			d = c;
			c = b;
			b = a;
			a = t1 + t2;
		}
		h0 += a;
		h1 += b;
		h2 += c;
		h3 += d;
		h4 += e;
		h5 += f;
		h6 += g;
		h7 += h;
		if (_const_crypto__sha256__chunk >= p.len) {
			p = __new_array_with_default(0, 0, sizeof(byte), 0);
		} else {
			p = array_slice(p, _const_crypto__sha256__chunk, p.len);
		}
	}
	(*(u32*)array_get(dig->h, 0)) = h0;
	(*(u32*)array_get(dig->h, 1)) = h1;
	(*(u32*)array_get(dig->h, 2)) = h2;
	(*(u32*)array_get(dig->h, 3)) = h3;
	(*(u32*)array_get(dig->h, 4)) = h4;
	(*(u32*)array_get(dig->h, 5)) = h5;
	(*(u32*)array_get(dig->h, 6)) = h6;
	(*(u32*)array_get(dig->h, 7)) = h7;
}

static int net__error_code() {
	return errno;
}

Option_string net__hostname() {
	array_fixed_byte_256 name = {0};
	byteptr namebp = ((byteptr)(name));
	int res = gethostname(namebp, 256);
	if (res != 0) {
		Option _t365 = v_error(_STR("net.hostname: failed with %"PRId32"", 1, res));
		return *(Option_string*)&_t365;
	}
	Option_string _t366;
	opt_ok2(&(string[]) { tos_clone(namebp) }, (OptionBase*)(&_t366), sizeof(string));
	return _t366;
}

Option_net__Socket net__new_socket(int family, int typ, int proto) {
	int sockfd = socket(family, typ, proto);
	int one = 1;
	setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &one, /*SizeOfType*/ sizeof(int));
	if (sockfd == -1) {
		Option _t367 = v_error(tos_lit("net.socket: failed"));
		return *(Option_net__Socket*)&_t367;
	}
	net__Socket s = (net__Socket){.sockfd = sockfd,.family = family,.typ = typ,.proto = proto,.max_single_send_size = 64000,};
	Option_net__Socket _t368;
	opt_ok2(&(net__Socket[]) { s }, (OptionBase*)(&_t368), sizeof(net__Socket));
	return _t368;
}

Option_net__Socket net__socket_udp() {
	return net__new_socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);
}

Option_int net__Socket_setsockopt(net__Socket s, int level, int optname, int* optvalue) {
	int res = setsockopt(s.sockfd, level, optname, optvalue, /*SizeOfType*/ sizeof(int));
	if (res < 0) {
		Option _t369 = v_error(_STR("net.setsocketopt: failed with %"PRId32"", 1, res));
		return *(Option_int*)&_t369;
	}
	Option_int _t370;
	opt_ok2(&(int[]) { res }, (OptionBase*)(&_t370), sizeof(int));
	return _t370;
}

Option_int net__Socket_bind(net__Socket s, int port) {
	struct sockaddr_in addr = (struct sockaddr_in){.sin_family = 0,.sin_port = 0,.sin_addr = {0},};
	addr.sin_family = s.family;
	addr.sin_port = htons(port);
	addr.sin_addr.s_addr = htonl(INADDR_ANY);
	int size = 16;
	voidptr tmp = ((voidptr)(&addr));
	struct sockaddr* skaddr = ((struct sockaddr*)(tmp));
	int res = bind(s.sockfd, skaddr, size);
	if (res < 0) {
		Option _t371 = v_error(_STR("net.bind: failed with %"PRId32"", 1, res));
		return *(Option_int*)&_t371;
	}
	Option_int _t372;
	opt_ok2(&(int[]) { res }, (OptionBase*)(&_t372), sizeof(int));
	return _t372;
}

Option_int net__Socket_listen(net__Socket s) {
	int backlog = 128;
	int res = listen(s.sockfd, backlog);
	if (res < 0) {
		Option _t373 = v_error(_STR("net.listen: failed with %"PRId32"", 1, res));
		return *(Option_int*)&_t373;
	}
// $if  debug {
#ifdef _VDEBUG
	println(_STR("listen res = %"PRId32"", 1, res));
#endif
// } debug
	Option_int _t374;
	opt_ok2(&(int[]) { res }, (OptionBase*)(&_t374), sizeof(int));
	return _t374;
}

Option_int net__Socket_listen_backlog(net__Socket s, int backlog) {
	int n = 0;
	if (backlog > 0) {
		n = backlog;
	}
	int res = listen(s.sockfd, n);
	if (res < 0) {
		Option _t375 = v_error(_STR("net.listen_backlog: failed with %"PRId32"", 1, res));
		return *(Option_int*)&_t375;
	}
	Option_int _t376;
	opt_ok2(&(int[]) { res }, (OptionBase*)(&_t376), sizeof(int));
	return _t376;
}

Option_net__Socket net__listen(int port) {
// $if  debug {
#ifdef _VDEBUG
	println(_STR("net.listen(%"PRId32"\000)", 2, port));
#endif
// } debug
	Option_net__Socket _t377 = net__new_socket(AF_INET, SOCK_STREAM, 0);
	if (!_t377.ok) {
		string err = _t377.v_error;
		int errcode = _t377.ecode;
		Option _t378 = v_error(err);
		return *(Option_net__Socket*)&_t378;
	}
	net__Socket s = *(net__Socket*)_t377.data;
	Option_int _t379 = net__Socket_bind(s, port);
	if (!_t379.ok) {
		string err = _t379.v_error;
		int errcode = _t379.ecode;
		Option _t380 = v_error(err);
		return *(Option_net__Socket*)&_t380;
	};
	Option_int _t381 = net__Socket_listen(s);
	if (!_t381.ok) {
		string err = _t381.v_error;
		int errcode = _t381.ecode;
		Option _t382 = v_error(err);
		return *(Option_net__Socket*)&_t382;
	};
	Option_net__Socket _t383;
	opt_ok2(&(net__Socket[]) { s }, (OptionBase*)(&_t383), sizeof(net__Socket));
	return _t383;
}

Option_net__Socket net__Socket_accept(net__Socket s) {
// $if  debug {
#ifdef _VDEBUG
	println(tos_lit("accept()"));
#endif
// } debug
	struct sockaddr addr = (struct sockaddr){
#ifndef __cplusplus
0
#endif
};
	u32 size = /*SizeOfVar*/ sizeof(addr);
	int sockfd = accept(s.sockfd, &addr, &size);
	if (sockfd < 0) {
		Option _t384 = v_error(_STR("net.accept: failed with %"PRId32"", 1, sockfd));
		return *(Option_net__Socket*)&_t384;
	}
	net__Socket c = (net__Socket){.sockfd = sockfd,.family = s.family,.typ = s.typ,.proto = s.proto,.max_single_send_size = 64000,};
	Option_net__Socket _t385;
	opt_ok2(&(net__Socket[]) { c }, (OptionBase*)(&_t385), sizeof(net__Socket));
	return _t385;
}

Option_string net__Socket_peer_ip(net__Socket s) {
	array_fixed_byte_44 buf = {0};
	struct sockaddr_in peeraddr = (struct sockaddr_in){.sin_family = 0,.sin_port = 0,.sin_addr = {0},};
	u32 speeraddr = /*SizeOfVar*/ sizeof(peeraddr);
	int ok = getpeername(s.sockfd, ((struct sockaddr*)(&peeraddr)), &speeraddr);
	if (ok == -1) {
		Option _t386 = v_error(tos_lit("net.peer_ip: getpeername failed"));
		return *(Option_string*)&_t386;
	}
	charptr cstr = inet_ntop(AF_INET, &peeraddr.sin_addr, buf, /*SizeOfVar*/ sizeof(buf));
	if (cstr == 0) {
		Option _t387 = v_error(tos_lit("net.peer_ip: inet_ntop failed"));
		return *(Option_string*)&_t387;
	}
	Option_string _t388;
	opt_ok2(&(string[]) { cstring_to_vstring(cstr) }, (OptionBase*)(&_t388), sizeof(string));
	return _t388;
}

Option_int net__Socket_connect(net__Socket s, string address, int port) {
	struct addrinfo hints;
	hints.ai_family = s.family;
	hints.ai_socktype = s.typ;
	hints.ai_flags = AI_PASSIVE;
	hints.ai_protocol = s.proto;
	hints.ai_addrlen = 0;
	hints.ai_canonname = NULL;
	hints.ai_addr = NULL;
	hints.ai_next = NULL;
	struct addrinfo* info = ((struct addrinfo*)(0));
	string sport = _STR("%"PRId32"", 1, port);
	int info_res = getaddrinfo(address.str, sport.str, &hints, &info);
	if (info_res != 0) {
		string error_message = os__get_error_msg(net__error_code());
		Option _t389 = v_error(_STR("net.connect: getaddrinfo failed \"%.*s\000\"", 2, error_message));
		return *(Option_int*)&_t389;
	}
	int res = connect(s.sockfd, info->ai_addr, info->ai_addrlen);
	if (res < 0) {
		string error_message = os__get_error_msg(net__error_code());
		Option _t390 = v_error(_STR("net.connect: connect failed \"%.*s\000\"", 2, error_message));
		return *(Option_int*)&_t390;
	}
	Option_int _t391;
	opt_ok2(&(int[]) { res }, (OptionBase*)(&_t391), sizeof(int));
	return _t391;
}

Option_net__Socket net__dial(string address, int port) {
	Option_net__Socket _t392 = net__new_socket(AF_INET, SOCK_STREAM, 0);
	if (!_t392.ok) {
		string err = _t392.v_error;
		int errcode = _t392.ecode;
		Option _t393 = v_error(err);
		return *(Option_net__Socket*)&_t393;
	}
	net__Socket s = *(net__Socket*)_t392.data;
	Option_int _t394 = net__Socket_connect(s, address, port);
	if (!_t394.ok) {
		string err = _t394.v_error;
		int errcode = _t394.ecode;
		Option _t395 = v_error(err);
		return *(Option_net__Socket*)&_t395;
	};
	Option_net__Socket _t396;
	opt_ok2(&(net__Socket[]) { s }, (OptionBase*)(&_t396), sizeof(net__Socket));
	return _t396;
}

Option_int net__Socket_send(net__Socket s, byteptr buf, int len) {
	byteptr dptr = buf;
	int dlen = len;
	while (1) {
		int send_size = (dlen > s.max_single_send_size ? (s.max_single_send_size) : (dlen));
		int sbytes = send(s.sockfd, dptr, send_size, _const_net__msg_nosignal);
		if (sbytes < 0) {
			Option _t397 = v_error(_STR("net.send: failed with %"PRId32"", 1, sbytes));
			return *(Option_int*)&_t397;
		}
		dlen -= sbytes;
		if (dlen <= 0) {
			break;
		}
		{ // Unsafe block
			dptr += sbytes;
		}
	}
	Option_int _t398;
	opt_ok2(&(int[]) { len }, (OptionBase*)(&_t398), sizeof(int));
	return _t398;
}

Option_int net__Socket_send_string(net__Socket s, string sdata) {
	return net__Socket_send(s, sdata.str, sdata.len);
}

multi_return_byteptr_int net__Socket_recv(net__Socket s, int bufsize) {
	byteptr buf = ((byteptr)(0));
	{ // Unsafe block
		buf = v_malloc(bufsize);
	}
	int res = recv(s.sockfd, buf, bufsize, 0);
	return (multi_return_byteptr_int){.arg0=buf, .arg1=res};
}

int net__Socket_cread(net__Socket s, byteptr buffer, int buffersize) {
	return read(s.sockfd, buffer, buffersize);
}

int net__Socket_crecv(net__Socket s, voidptr buffer, int buffersize) {
	return recv(s.sockfd, ((byteptr)(buffer)), buffersize, 0);
}

Option_int net__Socket_close(net__Socket s) {
	int shutdown_res = 0;
// $if  windows {
#ifdef _WIN32
#else
	shutdown_res = shutdown(s.sockfd, SHUT_RDWR);
#endif
// } windows
	int res = 0;
// $if  windows {
#ifdef _WIN32
#else
	res = close(s.sockfd);
#endif
// } windows
	if (res < 0) {
		Option _t399 = v_error(_STR("net.close: failed with %"PRId32"", 1, res));
		return *(Option_int*)&_t399;
	}
	Option_int _t400;
	opt_ok2(&(int[]) { 0 }, (OptionBase*)(&_t400), sizeof(int));
	return _t400;
}

Option_int net__Socket_write(net__Socket s, string str) {
	string line = _STR("%.*s\000%.*s", 2, str, _const_net__crlf);
	int res = send(s.sockfd, line.str, line.len, _const_net__msg_nosignal);
	if (res < 0) {
		Option _t401 = v_error(_STR("net.write: failed with %"PRId32"", 1, res));
		return *(Option_int*)&_t401;
	}
	Option_int _t402;
	opt_ok2(&(int[]) { res }, (OptionBase*)(&_t402), sizeof(int));
	return _t402;
}

string net__Socket_read_line(net__Socket s) {
	array_fixed_byte_400 buf = {0};
	string res = tos_lit("");
	while (1) {
		string line = tos_lit("");
		int n = recv(s.sockfd, buf, _const_net__max_read - 1, _const_net__msg_peek);
		if (n == -1) {
			return res;
		}
		if (n == 0) {
			return res;
		}
		buf[n] = '\0';
		int eol_idx = -1;
		for (int i = 0; i < n; ++i) {
			if (((int)(buf[i])) == '\n') {
				eol_idx = i;
				buf[i + 1] = '\0';
				break;
			}
		}
		byteptr bufbp = ((byteptr)(buf));
		line = tos_clone(bufbp);
		if (eol_idx > 0) {
			recv(s.sockfd, buf, eol_idx + 1, 0);
			res = /*f*/string_add(res, line);
			break;
		}
		recv(s.sockfd, buf, n, 0);
		res = /*f*/string_add(res, line);
		res = /*f*/string_add(res, _const_net__crlf);
		break;
	}
	return res;
}

string net__Socket_read_all(net__Socket s) {
	array_fixed_byte_400 buf = {0};
	string res = tos_lit("");
	while (1) {
		int n = recv(s.sockfd, buf, _const_net__max_read - 1, 0);
		if (n == -1) {
			return res;
		}
		if (n == 0) {
			return res;
		}
		byteptr bufbp = ((byteptr)(buf));
		res = /*f*/string_add(res, tos_clone(bufbp));
	}
	return res;
}

int net__Socket_get_port(net__Socket s) {
	struct sockaddr_in addr = (struct sockaddr_in){.sin_family = 0,.sin_port = 0,.sin_addr = {0},};
	int size = 16;
	voidptr tmp = ((voidptr)(&addr));
	struct sockaddr* skaddr = ((struct sockaddr*)(tmp));
	getsockname(s.sockfd, skaddr, &size);
	return ntohs(addr.sin_port);
}

string term__format(string msg, string open, string close) {
	return string_add(string_add(string_add(string_add(string_add(string_add(tos_lit("\x1b["), open), tos_lit("m")), msg), tos_lit("\x1b[")), close), tos_lit("m"));
}

string term__format_rgb(int r, int g, int b, string msg, string open, string close) {
	return string_add(string_add(string_add(string_add(string_add(string_add(string_add(string_add(string_add(string_add(string_add(string_add(tos_lit("\x1b["), open), tos_lit(";2;")), int_str(r)), tos_lit(";")), int_str(g)), tos_lit(";")), int_str(b)), tos_lit("m")), msg), tos_lit("\x1b[")), close), tos_lit("m"));
}

string term__rgb(int r, int g, int b, string msg) {
	return term__format_rgb(r, g, b, msg, tos_lit("38"), tos_lit("39"));
}

string term__bg_rgb(int r, int g, int b, string msg) {
	return term__format_rgb(r, g, b, msg, tos_lit("48"), tos_lit("49"));
}

string term__hex(int hex, string msg) {
	return term__format_rgb(hex >> 16, (hex >> 8 & 0xFF), (hex & 0xFF), msg, tos_lit("38"), tos_lit("39"));
}

string term__bg_hex(int hex, string msg) {
	return term__format_rgb(hex >> 16, (hex >> 8 & 0xFF), (hex & 0xFF), msg, tos_lit("48"), tos_lit("49"));
}

string term__bg_black(string msg) {
	return term__format(msg, tos_lit("40"), tos_lit("49"));
}

string term__bright_bg_black(string msg) {
	return term__format(msg, tos_lit("100"), tos_lit("49"));
}

string term__bg_blue(string msg) {
	return term__format(msg, tos_lit("44"), tos_lit("49"));
}

string term__bright_bg_blue(string msg) {
	return term__format(msg, tos_lit("104"), tos_lit("49"));
}

string term__bg_cyan(string msg) {
	return term__format(msg, tos_lit("46"), tos_lit("49"));
}

string term__bright_bg_cyan(string msg) {
	return term__format(msg, tos_lit("106"), tos_lit("49"));
}

string term__bg_green(string msg) {
	return term__format(msg, tos_lit("42"), tos_lit("49"));
}

string term__bright_bg_green(string msg) {
	return term__format(msg, tos_lit("102"), tos_lit("49"));
}

string term__bg_magenta(string msg) {
	return term__format(msg, tos_lit("45"), tos_lit("49"));
}

string term__bright_bg_magenta(string msg) {
	return term__format(msg, tos_lit("105"), tos_lit("49"));
}

string term__bg_red(string msg) {
	return term__format(msg, tos_lit("41"), tos_lit("49"));
}

string term__bright_bg_red(string msg) {
	return term__format(msg, tos_lit("101"), tos_lit("49"));
}

string term__bg_white(string msg) {
	return term__format(msg, tos_lit("47"), tos_lit("49"));
}

string term__bright_bg_white(string msg) {
	return term__format(msg, tos_lit("107"), tos_lit("49"));
}

string term__bg_yellow(string msg) {
	return term__format(msg, tos_lit("43"), tos_lit("49"));
}

string term__bright_bg_yellow(string msg) {
	return term__format(msg, tos_lit("103"), tos_lit("49"));
}

string term__black(string msg) {
	return term__format(msg, tos_lit("30"), tos_lit("39"));
}

string term__bright_black(string msg) {
	return term__format(msg, tos_lit("90"), tos_lit("39"));
}

string term__blue(string msg) {
	return term__format(msg, tos_lit("34"), tos_lit("39"));
}

string term__bright_blue(string msg) {
	return term__format(msg, tos_lit("94"), tos_lit("39"));
}

string term__bold(string msg) {
	return term__format(msg, tos_lit("1"), tos_lit("22"));
}

string term__cyan(string msg) {
	return term__format(msg, tos_lit("36"), tos_lit("39"));
}

string term__bright_cyan(string msg) {
	return term__format(msg, tos_lit("96"), tos_lit("39"));
}

string term__dim(string msg) {
	return term__format(msg, tos_lit("2"), tos_lit("22"));
}

string term__green(string msg) {
	return term__format(msg, tos_lit("32"), tos_lit("39"));
}

string term__bright_green(string msg) {
	return term__format(msg, tos_lit("92"), tos_lit("39"));
}

string term__gray(string msg) {
	return term__bright_black(msg);
}

string term__hidden(string msg) {
	return term__format(msg, tos_lit("8"), tos_lit("28"));
}

string term__italic(string msg) {
	return term__format(msg, tos_lit("3"), tos_lit("23"));
}

string term__inverse(string msg) {
	return term__format(msg, tos_lit("7"), tos_lit("27"));
}

string term__magenta(string msg) {
	return term__format(msg, tos_lit("35"), tos_lit("39"));
}

string term__bright_magenta(string msg) {
	return term__format(msg, tos_lit("95"), tos_lit("39"));
}

string term__reset(string msg) {
	return term__format(msg, tos_lit("0"), tos_lit("0"));
}

string term__red(string msg) {
	return term__format(msg, tos_lit("31"), tos_lit("39"));
}

string term__bright_red(string msg) {
	return term__format(msg, tos_lit("91"), tos_lit("39"));
}

string term__strikethrough(string msg) {
	return term__format(msg, tos_lit("9"), tos_lit("29"));
}

string term__underline(string msg) {
	return term__format(msg, tos_lit("4"), tos_lit("24"));
}

string term__white(string msg) {
	return term__format(msg, tos_lit("37"), tos_lit("39"));
}

string term__bright_white(string msg) {
	return term__format(msg, tos_lit("97"), tos_lit("39"));
}

string term__yellow(string msg) {
	return term__format(msg, tos_lit("33"), tos_lit("39"));
}

string term__bright_yellow(string msg) {
	return term__format(msg, tos_lit("93"), tos_lit("39"));
}

void term__set_cursor_position(int x, int y) {
	print(string_add(_STR("\x1b[%"PRId32"\000;%"PRId32"", 2, y, x), tos_lit("H")));
}

void term__move(int n, string direction) {
	print(_STR("\x1b[%"PRId32"\000%.*s", 2, n, direction));
}

void term__cursor_up(int n) {
	term__move(n, tos_lit("A"));
}

void term__cursor_down(int n) {
	term__move(n, tos_lit("B"));
}

void term__cursor_forward(int n) {
	term__move(n, tos_lit("C"));
}

void term__cursor_back(int n) {
	term__move(n, tos_lit("D"));
}

void term__erase_display(string t) {
	print(string_add(string_add(tos_lit("\x1b["), t), tos_lit("J")));
}

void term__erase_toend() {
	term__erase_display(tos_lit("0"));
}

void term__erase_tobeg() {
	term__erase_display(tos_lit("1"));
}

void term__erase_clear() {
	term__erase_display(tos_lit("2"));
}

void term__erase_del_clear() {
	term__erase_display(tos_lit("3"));
}

void term__erase_line(string t) {
	print(string_add(string_add(tos_lit("\x1b["), t), tos_lit("K")));
}

void term__erase_line_toend() {
	term__erase_line(tos_lit("0"));
}

void term__erase_line_tobeg() {
	term__erase_line(tos_lit("1"));
}

void term__erase_line_clear() {
	term__erase_line(tos_lit("2"));
}

void term__show_cursor() {
	print(tos_lit("\x1b[?25h"));
}

void term__hide_cursor() {
	print(tos_lit("\x1b[?25l"));
}

bool term__can_show_color_on_stdout() {
	return term__supports_escape_sequences(1);
}

bool term__can_show_color_on_stderr() {
	return term__supports_escape_sequences(2);
}

string term__ok_message(string s) {
	return (term__can_show_color_on_stdout() ? (term__green(s)) : (s));
}

string term__fail_message(string s) {
	return (term__can_show_color_on_stdout() ? (term__bold(term__bg_red(term__white(s)))) : (s));
}

string term__warn_message(string s) {
	return (term__can_show_color_on_stdout() ? (term__bright_yellow(s)) : (s));
}

string term__h_divider(string divider) {
	multi_return_int_int mr_1363 = term__get_terminal_size();
	int cols = mr_1363.arg0;
	string result = (divider.len > 0 ? (string_repeat(divider, 1 + (cols / divider.len))) : (string_repeat(tos_lit(" "), 1 + cols)));
	return string_substr(result, 0, cols);
}

string term__header(string text, string divider) {
	if (text.len == 0) {
		return term__h_divider(divider);
	}
	multi_return_int_int mr_1775 = term__get_terminal_size();
	int cols = mr_1775.arg0;
	int tlimit = (cols > text.len + 2 + 2 * divider.len ? (text.len) : (cols - 3 - 2 * divider.len));
	int tlimit_alligned = ((tlimit % 2) != (cols % 2) ? (tlimit + 1) : (tlimit));
	int tstart = (cols - tlimit_alligned) / 2;
	string ln = (divider.len > 0 ? (string_substr(string_repeat(divider, 1 + cols / divider.len), 0, cols)) : (string_repeat(tos_lit(" "), 1 + cols)));
	return string_add(string_add(string_add(string_add(string_substr(ln, 0, tstart), tos_lit(" ")), string_substr(text, 0, tlimit)), tos_lit(" ")), string_substr(ln, tstart + tlimit + 2, cols));
}

static bool term__supports_escape_sequences(int fd) {
	if (string_eq(os__getenv(tos_lit("TERM")), tos_lit("dumb"))) {
		return false;
	}
	string vcolors_override = os__getenv(tos_lit("VCOLORS"));
	if (string_eq(vcolors_override, tos_lit("always"))) {
		return true;
	}
// $if  windows {
#ifdef _WIN32
#else
	return is_atty(fd) > 0 && string_ne(os__getenv(tos_lit("TERM")), tos_lit("dumb"));
#endif
// } windows
}

void term__clear() {
// $if !windows {
#ifndef _WIN32
	printf("\x1b[2J");
	printf("\x1b[H");
#endif
// } windows
}

multi_return_int_int term__get_terminal_size() {
	if (is_atty(1) <= 0 || string_eq(os__getenv(tos_lit("TERM")), tos_lit("dumb"))) {
		return (multi_return_int_int){.arg0=_const_term__default_columns_size, .arg1=_const_term__default_rows_size};
	}
	struct winsize w = (struct winsize){.ws_row = 0,.ws_col = 0,.ws_xpixel = 0,.ws_ypixel = 0,};
	ioctl(1, TIOCGWINSZ, &w);
	return (multi_return_int_int){.arg0=((int)(w.ws_col)), .arg1=((int)(w.ws_row))};
}

// Attr: [inline]
inline static u32 rand__util__nr_next(u32 prev) {
	return prev * 1664525 + 1013904223;
}

// Attr: [inline]
inline array_u32 rand__util__time_seed_array(int count) {
	u32 seed = ((u32)(time__Time_unix_time(time__now())));
	array_u32 seed_data = __new_array_with_default(0, count, sizeof(u32), 0);
	for (int _t403 = 0; _t403 < count; ++_t403) {
		seed = rand__util__nr_next(seed);
		array_push(&seed_data, _MOV((u32[]){ rand__util__nr_next(seed) }));
	}
	return seed_data;
}

// Attr: [inline]
inline u32 rand__util__time_seed_32() {
	return (*(u32*)array_get(rand__util__time_seed_array(1), 0));
}

// Attr: [inline]
inline u64 rand__util__time_seed_64() {
	array_u32 seed_data = rand__util__time_seed_array(2);
	u64 lower = ((u64)((*(u32*)array_get(seed_data, 0))));
	u64 upper = ((u64)((*(u32*)array_get(seed_data, 1))));
	return (lower | (upper << 32));
}

int runtime__nr_jobs() {
	int cpus = runtime__nr_cpus();
	int vjobs = string_int(os__getenv(tos_lit("VJOBS")));
	if (vjobs > 0) {
		cpus = vjobs;
	}
	return cpus;
}

bool runtime__is_32bit() {
// $if  x32 {
#ifdef TARGET_IS_32BIT
	return true;
#endif
// } x32
	return false;
}

bool runtime__is_64bit() {
// $if  x64 {
#ifdef TARGET_IS_64BIT
	return true;
#endif
// } x64
	return false;
}

bool runtime__is_little_endian() {
// $if  little_endian {
#ifdef TARGET_ORDER_IS_LITTLE
	return true;
#endif
// } little_endian
	return false;
}

bool runtime__is_big_endian() {
// $if  big_endian {
#ifdef TARGET_ORDER_IS_BIG
	return true;
#endif
// } big_endian
	return false;
}

int runtime__nr_cpus() {
// $if  linux {
#ifdef __linux__
	return ((int)(sysconf(_SC_NPROCESSORS_ONLN)));
#endif
// } linux
	return 1;
}

static string log__tag(log__Level l) {
	return (l == log__Level_fatal) ? (term__red(tos_lit("FATAL"))) : (l == log__Level_error) ? (term__red(tos_lit("ERROR"))) : (l == log__Level_warn) ? (term__yellow(tos_lit("WARN "))) : (l == log__Level_info) ? (term__white(tos_lit("INFO "))) : (term__blue(tos_lit("DEBUG")));
}

void log__Log_set_level(log__Log* l, log__Level level) {
	l->level = level;
}

void log__Log_set_output_level(log__Log* l, log__Level level) {
	l->level = level;
}

void log__Log_set_full_logpath(log__Log* l, string full_log_path) {
	string rlog_file = os__real_path(full_log_path);
	log__Log_set_output_label(l, os__file_name(rlog_file));
	log__Log_set_output_path(l, os__base_dir(rlog_file));
}

void log__Log_set_output_label(log__Log* l, string label) {
	l->output_label = label;
}

void log__Log_set_output_path(log__Log* l, string output_file_path) {
	if (os__File_is_opened(l->ofile)) {
		os__File_close(&l->ofile);
	}
	l->output_to_file = true;
	l->output_file_name = os__join_path(os__real_path(output_file_path), (varg_string){.len=1,.args={l->output_label}});
	Option_os__File _t406 = os__open_append(l->output_file_name);
	if (!_t406.ok) {
		string err = _t406.v_error;
		int errcode = _t406.ecode;
		v_panic(_STR("error while opening log file %.*s\000 for appending", 2, l->output_file_name));
	}
	os__File ofile = *(os__File*)_t406.data;
	l->ofile = ofile;
}

void log__Log_close(log__Log* l) {
	os__File_close(&l->ofile);
}

static void log__Log_log_file(log__Log* l, string s, log__Level level) {
	string timestamp = time__Time_format_ss(time__now());
	string e = log__tag(level);
	os__File_writeln(&l->ofile, _STR("%.*s\000 [%.*s\000] %.*s", 3, timestamp, e, s));
}

static void log__Log_log_cli(log__Log* l, string s, log__Level level) {
	string f = log__tag(level);
	time__Time t = time__now();
	println(_STR("[%.*s\000 %.*s\000] %.*s", 3, f, time__Time_format_ss(t), s));
}

static void log__Log_send_output(log__Log* l, string* s, log__Level level) {
	if (l->output_to_file) {
		log__Log_log_file(l, *s, level);
	} else {
		log__Log_log_cli(l, *s, level);
	}
}

void log__Log_fatal(log__Log* l, string s) {
	if (l->level < log__Level_fatal) {
		return;
	}
	log__Log_send_output(l, (voidptr)&/*qq*/s, log__Level_fatal);
	os__File_close(&l->ofile);
	v_panic(_STR("%.*s\000: %.*s", 2, l->output_label, s));
}

void log__Log_error(log__Log* l, string s) {
	if (l->level < log__Level_error) {
		return;
	}
	log__Log_send_output(l, (voidptr)&/*qq*/s, log__Level_error);
}

void log__Log_warn(log__Log* l, string s) {
	if (l->level < log__Level_warn) {
		return;
	}
	log__Log_send_output(l, (voidptr)&/*qq*/s, log__Level_warn);
}

void log__Log_info(log__Log* l, string s) {
	if (l->level < log__Level_info) {
		return;
	}
	log__Log_send_output(l, (voidptr)&/*qq*/s, log__Level_info);
}

void log__Log_debug(log__Log* l, string s) {
	if (l->level < log__Level_debug) {
		return;
	}
	log__Log_send_output(l, (voidptr)&/*qq*/s, log__Level_debug);
}

static Option_net__http__Response net__http__Request_ssl_do(net__http__Request* req, int port, string method, string host_name, string path) {
	voidptr ssl_method = TLSv1_2_method();
	SSL_CTX* ctx = SSL_CTX_new(ssl_method);
	SSL_CTX_set_verify_depth(ctx, 4);
	int flags = ((SSL_OP_NO_SSLv2 | SSL_OP_NO_SSLv3) | SSL_OP_NO_COMPRESSION);
	SSL_CTX_set_options(ctx, flags);
	int res = SSL_CTX_load_verify_locations(ctx, "random-org-chain.pem", 0);
	voidptr web = BIO_new_ssl_connect(ctx);
	string addr = string_add(string_add(host_name, tos_lit(":")), int_str(port));
	res = BIO_set_conn_hostname(web, addr.str);
	net__openssl__SSL* ssl = ((net__openssl__SSL*)(0));
	BIO_get_ssl(web, &ssl);
	string preferred_ciphers = tos_lit("HIGH:!aNULL:!kRSA:!PSK:!SRP:!MD5:!RC4");
	res = SSL_set_cipher_list(ssl, preferred_ciphers.str);
	if (res != 1) {
		println(tos_lit("http: openssl: cipher failed"));
	}
	res = SSL_set_tlsext_host_name(ssl, host_name.str);
	res = BIO_do_connect(web);
	if (res != 1) {
		Option _t407 = v_error(tos_lit("cannot connect the endpoint"));
		return *(Option_net__http__Response*)&_t407;
	}
	res = BIO_do_handshake(web);
	SSL_get_peer_certificate(ssl);
	res = SSL_get_verify_result(ssl);
	string req_headers = net__http__Request_build_request_headers(req, method, host_name, path);
	BIO_puts(web, req_headers.str);
	strings__Builder content = strings__new_builder(100);
	array_fixed_byte_1536 buff = {0};
	int readcounter = 0;
	while (1) {
		readcounter++;
		int len = BIO_read(web, buff, _const_net__http__bufsize);
		if (len <= 0) {
			break;
		}
// $if  debug_http {
#ifdef CUSTOM_DEFINE_debug_http
		eprintln(_STR("ssl_do, read %4"PRId32"\000 | len: %"PRId32"", 2, readcounter, len));
		eprintln(string_repeat(tos_lit("-"), 20));
		eprintln(tos((voidptr)&/*qq*/buff, len));
		eprintln(string_repeat(tos_lit("-"), 20));
#endif
// } debug_http
		strings__Builder_write_bytes(&content, (voidptr)&/*qq*/buff, len);
	}
	if (web != 0) {
		BIO_free_all(web);
	}
	if (ctx != 0) {
		SSL_CTX_free(ctx);
	}
	Option_net__http__Response _t408;
	opt_ok2(&(net__http__Response[]) { net__http__parse_response(strings__Builder_str(&content)) }, (OptionBase*)(&_t408), sizeof(net__http__Response));
	return _t408;
}

array_net__http__Cookie_ptr net__http__read_set_cookies(map_string_array_string h) {
	array_string cookies_s = (*(array_string*)map_get(h, tos_lit("Set-Cookie"), &(array_string[]){ __new_array(0, 1, sizeof(string)) }));
	int cookie_count = cookies_s.len;
	if (cookie_count == 0) {
		return __new_array_with_default(0, 0, sizeof(net__http__Cookie*), 0);
	}
	array_net__http__Cookie_ptr cookies = __new_array_with_default(0, 0, sizeof(net__http__Cookie*), 0);
	// FOR IN array
	array _t409 = cookies_s;
	for (int _t410 = 0; _t410 < _t409.len; ++_t410) {
		string line = ((string*)_t409.data)[_t410];
		array_string parts = string_split(string_trim_space(line), tos_lit(";"));
		if (parts.len == 1 && string_eq((*(string*)array_get(parts, 0)), tos_lit(""))) {
			continue;
		}
		array_set(&parts, 0, &(string[]) { string_trim_space((*(string*)array_get(parts, 0))) });
		array_string keyval = string_split((*(string*)array_get(parts, 0)), tos_lit("="));
		if (keyval.len != 2) {
			continue;
		}
		string name = (*(string*)array_get(keyval, 0));
		string raw_value = (*(string*)array_get(keyval, 1));
		if (!net__http__is_cookie_name_valid(name)) {
			continue;
		}
		Option_string _t411 = net__http__parse_cookie_value(raw_value, true);
		if (!_t411.ok) {
			string err = _t411.v_error;
			int errcode = _t411.ecode;
			continue;
		}
		string value = *(string*)_t411.data;
		net__http__Cookie* c = (net__http__Cookie*)memdup(&(net__http__Cookie){.name = name,.value = value,.path = (string){.str=(byteptr)""},.domain = (string){.str=(byteptr)""},.expires = {0},.raw_expires = (string){.str=(byteptr)""},.max_age = 0,.secure = 0,.http_only = 0,.same_site = 0,.raw = line,.unparsed = __new_array(0, 1, sizeof(string)),}, sizeof(net__http__Cookie));
		// FOR IN array
		array _t412 = parts;
		for (int i = 0; i < _t412.len; ++i) {
			array_set(&parts, i, &(string[]) { string_trim_space((*(string*)array_get(parts, i))) });
			if ((*(string*)array_get(parts, i)).len == 0) {
				continue;
			}
			string attr = (*(string*)array_get(parts, i));
			string raw_val = tos_lit("");
			if (string_contains(attr, tos_lit("="))) {
				array_string pieces = string_split(attr, tos_lit("="));
				attr = (*(string*)array_get(pieces, 0));
				raw_val = (*(string*)array_get(pieces, 1));
			}
			string lower_attr = string_to_lower(attr);
			Option_string _t413 = net__http__parse_cookie_value(raw_val, false);
			if (!_t413.ok) {
				string err = _t413.v_error;
				int errcode = _t413.ecode;
				array_push(&c->unparsed, _MOV((string[]){ (*(string*)array_get(parts, i)) }));
				continue;
			}
			string val = *(string*)_t413.data;
			if (string_eq(lower_attr, tos_lit("samesite"))) {
				string lower_val = string_to_lower(val);
				if (string_eq(lower_val, tos_lit("lax"))) {
					c->same_site = net__http__SameSite_same_site_lax_mode;
				} else if (string_eq(lower_val, tos_lit("strict"))) {
					c->same_site = net__http__SameSite_same_site_strict_mode;
				} else if (string_eq(lower_val, tos_lit("none"))) {
					c->same_site = net__http__SameSite_same_site_none_mode;
				} else {
					c->same_site = net__http__SameSite_same_site_default_mode;
				};
			} else if (string_eq(lower_attr, tos_lit("secure"))) {
				c->secure = true;
				continue;
			} else if (string_eq(lower_attr, tos_lit("httponly"))) {
				c->http_only = true;
				continue;
			} else if (string_eq(lower_attr, tos_lit("domain"))) {
				c->domain = val;
				continue;
			} else if (string_eq(lower_attr, tos_lit("max-age"))) {
				int secs = string_int(val);
				if (secs != 0 && string_at(val, 0) != '0') {
					break;
				}
				if (secs <= 0) {
					secs = -1;
				}
				c->max_age = secs;
				continue;
			} else if (string_eq(lower_attr, tos_lit("path"))) {
				c->path = val;
				continue;
			} else {
				array_push(&c->unparsed, _MOV((string[]){ (*(string*)array_get(parts, i)) }));
			};
		}
		array_push(&cookies, _MOV((net__http__Cookie*[]){ c }));
	}
	return cookies;
}

array_net__http__Cookie_ptr net__http__read_cookies(map_string_array_string h, string filter) {
	array_string lines = (*(array_string*)map_get(h, tos_lit("Cookie"), &(array_string[]){ __new_array(0, 1, sizeof(string)) }));
	if (lines.len == 0) {
		return __new_array_with_default(0, 0, sizeof(net__http__Cookie*), 0);
	}
	array_net__http__Cookie_ptr cookies = __new_array_with_default(0, 0, sizeof(net__http__Cookie*), 0);
	// FOR IN array
	array _t419 = lines;
	for (int _t420 = 0; _t420 < _t419.len; ++_t420) {
		string line_ = ((string*)_t419.data)[_t420];
		string line = string_trim_space(line_);
		string part = tos_lit("");
		while (line.len > 0) {
			if (string_index_any(line, tos_lit(";")) > 0) {
				array_string line_parts = string_split(line, tos_lit(";"));
				part = (*(string*)array_get(line_parts, 0));
				line = (*(string*)array_get(line_parts, 1));
			} else {
				part = line;
				line = tos_lit("");
			}
			part = string_trim_space(part);
			if (part.len == 0) {
				continue;
			}
			string name = part;
			string val = tos_lit("");
			if (string_contains(part, tos_lit("="))) {
				array_string val_parts = string_split(part, tos_lit("="));
				name = (*(string*)array_get(val_parts, 0));
				val = (*(string*)array_get(val_parts, 1));
			}
			if (!net__http__is_cookie_name_valid(name)) {
				continue;
			}
			if (string_ne(filter, tos_lit("")) && string_ne(filter, name)) {
				continue;
			}
			Option_string _t421 = net__http__parse_cookie_value(val, true);
			if (!_t421.ok) {
				string err = _t421.v_error;
				int errcode = _t421.ecode;
				continue;
			}
			val = *(string*)_t421.data;
			array_push(&cookies, _MOV((net__http__Cookie*[]){ (net__http__Cookie*)memdup(&(net__http__Cookie){.name = name,.value = val,.path = (string){.str=(byteptr)""},.domain = (string){.str=(byteptr)""},.expires = {0},.raw_expires = (string){.str=(byteptr)""},.max_age = 0,.secure = 0,.http_only = 0,.same_site = 0,.raw = (string){.str=(byteptr)""},.unparsed = __new_array(0, 1, sizeof(string)),}, sizeof(net__http__Cookie)) }));
		}
	}
	return cookies;
}

string net__http__Cookie_str(net__http__Cookie* c) {
	if (!net__http__is_cookie_name_valid(c->name)) {
		return tos_lit("");
	}
	int extra_cookie_length = 110;
	strings__Builder b = strings__new_builder(c->name.len + c->value.len + c->domain.len + c->path.len + extra_cookie_length);
	strings__Builder_write(&b, c->name);
	strings__Builder_write(&b, tos_lit("="));
	strings__Builder_write(&b, net__http__sanitize_cookie_value(c->value));
	if (c->path.len > 0) {
		strings__Builder_write(&b, tos_lit("; path="));
		strings__Builder_write(&b, net__http__sanitize_cookie_path(c->path));
	}
	if (c->domain.len > 0) {
		if (net__http__valid_cookie_domain(c->domain)) {
			string d = c->domain;
			if (string_at(d, 0) == '.') {
				d = string_substr(d, 1, d.len);
			}
			strings__Builder_write(&b, tos_lit("; domain="));
			strings__Builder_write(&b, d);
		} else {
		}
	}
	if (c->expires.year > 1600) {
		time__Time e = c->expires;
		string time_str = _STR("%.*s\000, %.*s\000 %.*s\000 %"PRId32"\000 %.*s\000 GMT", 6, time__Time_weekday_str(e), int_str(e.day), time__Time_smonth(e), e.year, time__Time_hhmmss(e));
		strings__Builder_write(&b, tos_lit("; expires="));
		strings__Builder_write(&b, time_str);
	}
	if (c->max_age > 0) {
		strings__Builder_write(&b, tos_lit("; Max-Age="));
		strings__Builder_write(&b, int_str(c->max_age));
	} else if (c->max_age < 0) {
		strings__Builder_write(&b, tos_lit("; Max-Age=0"));
	}
	if (c->http_only) {
		strings__Builder_write(&b, tos_lit("; HttpOnly"));
	}
	if (c->secure) {
		strings__Builder_write(&b, tos_lit("; Secure"));
	}
	if (c->same_site == net__http__SameSite_same_site_default_mode) {
		strings__Builder_write(&b, tos_lit("; SameSite"));
	} else if (c->same_site == net__http__SameSite_same_site_none_mode) {
		strings__Builder_write(&b, tos_lit("; SameSite=None"));
	} else if (c->same_site == net__http__SameSite_same_site_lax_mode) {
		strings__Builder_write(&b, tos_lit("; SameSite=Lax"));
	} else if (c->same_site == net__http__SameSite_same_site_strict_mode) {
		strings__Builder_write(&b, tos_lit("; SameSite=Strict"));
	};
	return strings__Builder_str(&b);
}

static string net__http__sanitize(bool (*valid)(byte b), string v) {
	bool ok = true;
	for (int i = 0; i < v.len; ++i) {
		if (valid(string_at(v, i))) {
			continue;
		}
		ok = false;
		break;
	}
	if (ok) {
		return v;
	}
	array_byte buf = string_bytes(v);
	array_byte bytes = string_bytes(v);
	// FOR IN array
	array _t424 = buf;
	for (int i = 0; i < _t424.len; ++i) {
		if (!valid((*(byte*)array_get(buf, i)))) {
			array_delete(&bytes, i);
		}
	}
	return tos2((byteptr)bytes.data);
}

static string net__http__sanitize_cookie_name(string name) {
	return string_replace_each(name, new_array_from_c_array(4, 4, sizeof(string), _MOV((string[4]){tos_lit("\n"), tos_lit("-"), tos_lit("\r"), tos_lit("-")})));
}

string net__http__sanitize_cookie_value(string v) {
	string val = net__http__sanitize(net__http__valid_cookie_value_byte, v);
	if (v.len == 0) {
		return v;
	}
	if (string_starts_with(val, tos_lit(" ")) || string_ends_with(val, tos_lit(" ")) || string_starts_with(val, tos_lit(",")) || string_ends_with(val, tos_lit(","))) {
		return _STR("\"%.*s\000\"", 2, v);
	}
	return v;
}

static string net__http__sanitize_cookie_path(string v) {
	return net__http__sanitize(net__http__valid_cookie_path_byte, v);
}

static bool net__http__valid_cookie_value_byte(byte b) {
	return 0x20 <= b && b < 0x7f && b != '"' && b != ';' && b != '\\';
}

static bool net__http__valid_cookie_path_byte(byte b) {
	return 0x20 <= b && b < 0x7f && b != '!';
}

static bool net__http__valid_cookie_domain(string v) {
	if (net__http__is_cookie_domain_name(v)) {
		return true;
	}
	return false;
}

bool net__http__is_cookie_domain_name(string _s) {
	string s = _s;
	if (s.len == 0) {
		return false;
	}
	if (s.len > 255) {
		return false;
	}
	if (string_at(s, 0) == '.') {
		s = string_substr(s, 1, s.len);
	}
	byte last = '.';
	bool ok = false;
	int part_len = 0;
	for (int i = 0; i < s.len; ++i) {
		byte c = string_at(s, i);
		if (('a' <= c && c <= 'z') || ('A' <= c && c <= 'Z')) {
			ok = true;
			part_len++;
		} else if ('0' <= c && c <= '9') {
			part_len++;
		} else if (c == '-') {
			if (last == '.') {
				return false;
			}
			part_len++;
		} else if (c == '.') {
			if (last == '.' || last == '-') {
				return false;
			}
			if (part_len > 63 || part_len == 0) {
				return false;
			}
			part_len = 0;
		} else {
			return false;
		}
		last = c;
	}
	if (last == '-' || part_len > 63) {
		return false;
	}
	return ok;
}

static Option_string net__http__parse_cookie_value(string _raw, bool allow_double_quote) {
	string raw = _raw;
	if (allow_double_quote && raw.len > 1 && string_at(raw, 0) == '"' && string_at(raw, raw.len - 1) == '"') {
		raw = string_substr(raw, 1, raw.len - 1);
	}
	for (int i = 0; i < raw.len; ++i) {
		if (!net__http__valid_cookie_value_byte(string_at(raw, i))) {
			Option _t425 = v_error(tos_lit("http.cookie: invalid cookie value"));
			return *(Option_string*)&_t425;
		}
	}
	Option_string _t426;
	opt_ok2(&(string[]) { raw }, (OptionBase*)(&_t426), sizeof(string));
	return _t426;
}

static bool net__http__is_cookie_name_valid(string name) {
	if (string_eq(name, tos_lit(""))) {
		return false;
	}
	for (int _t427 = 0; _t427 < name.len; ++_t427) {
		byte b = name.str[_t427];
		if (b < 33 || b > 126) {
			return false;
		}
	}
	return true;
}

bool net__http__download_file(string url, string out) {
// $if  debug_http {
#ifdef CUSTOM_DEFINE_debug_http
	println(_STR("download file url=%.*s\000 out=%.*s", 2, url, out));
#endif
// } debug_http
	Option_net__http__Response _t428 = net__http__get(url);
	if (!_t428.ok) {
		string err = _t428.v_error;
		int errcode = _t428.ecode;
		return false;
	}
	net__http__Response s = *(net__http__Response*)_t428.data;
	os__write_file(out, s.text);
	return true;
}

// TypeDecl
static void net__http__download_cb(voidptr ptr, size_t size, size_t nmemb, voidptr userp) {
}

void net__http__download_file_with_progress(string url, string out, net__http__DownloadFn cb, void (*cb_finished)()) {
}

static void net__http__empty() {
}

Option_net__http__Request net__http__new_request(string method, string url_, string data) {
	string url = (string_eq(method, tos_lit("GET")) ? (string_add(string_add(url_, tos_lit("?")), data)) : (url_));
	Option_net__http__Request _t429;
	opt_ok2(&(net__http__Request[]) { (net__http__Request){.method = string_to_upper(method),.headers = new_map_1(sizeof(string)),.cookies = new_map_1(sizeof(string)),.data = data,.url = url,.user_agent = tos_lit("v.http"),.verbose = 0,.user_ptr = 0,.ws_func = 0,} }, (OptionBase*)(&_t429), sizeof(net__http__Request));
	return _t429;
}

Option_net__http__Response net__http__get(string url) {
	return net__http__fetch_with_method(tos_lit("GET"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = (string){.str=(byteptr)""},.params = new_map_1(sizeof(string)),.headers = new_map_1(sizeof(string)),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__post(string url, string data) {
	return net__http__fetch_with_method(tos_lit("POST"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = data,.params = new_map_1(sizeof(string)),.headers = new_map_init(1, sizeof(string), _MOV((string[1]){tos_lit("Content-Type"), }), _MOV((string[1]){_const_net__http__content_type_default, })),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__post_json(string url, string data) {
	return net__http__fetch_with_method(tos_lit("POST"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = data,.params = new_map_1(sizeof(string)),.headers = new_map_init(1, sizeof(string), _MOV((string[1]){tos_lit("Content-Type"), }), _MOV((string[1]){tos_lit("application/json"), })),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__post_form(string url, map_string_string data) {
	return net__http__fetch_with_method(tos_lit("POST"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = net__http__url_encode_form_data(data),.params = new_map_1(sizeof(string)),.headers = new_map_init(1, sizeof(string), _MOV((string[1]){tos_lit("Content-Type"), }), _MOV((string[1]){tos_lit("application/x-www-form-urlencoded"), })),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__put(string url, string data) {
	return net__http__fetch_with_method(tos_lit("PUT"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = data,.params = new_map_1(sizeof(string)),.headers = new_map_init(1, sizeof(string), _MOV((string[1]){tos_lit("Content-Type"), }), _MOV((string[1]){_const_net__http__content_type_default, })),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__patch(string url, string data) {
	return net__http__fetch_with_method(tos_lit("PATCH"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = data,.params = new_map_1(sizeof(string)),.headers = new_map_init(1, sizeof(string), _MOV((string[1]){tos_lit("Content-Type"), }), _MOV((string[1]){_const_net__http__content_type_default, })),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__head(string url) {
	return net__http__fetch_with_method(tos_lit("HEAD"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = (string){.str=(byteptr)""},.params = new_map_1(sizeof(string)),.headers = new_map_1(sizeof(string)),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__delete(string url) {
	return net__http__fetch_with_method(tos_lit("DELETE"), url, (net__http__FetchConfig){.method = (string){.str=(byteptr)""},.data = (string){.str=(byteptr)""},.params = new_map_1(sizeof(string)),.headers = new_map_1(sizeof(string)),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
}

Option_net__http__Response net__http__fetch(string _url, net__http__FetchConfig config) {
	if (string_eq(_url, tos_lit(""))) {
		Option _t430 = v_error(tos_lit("http.fetch: empty url"));
		return *(Option_net__http__Response*)&_t430;
	}
	Option_string _t431 = net__http__build_url_from_fetch(_url, config);
	if (!_t431.ok) {
		string err = _t431.v_error;
		int errcode = _t431.ecode;
		Option _t432 = v_error(_STR("http.fetch: invalid url %.*s", 1, _url));
		return *(Option_net__http__Response*)&_t432;
	}
	string url = *(string*)_t431.data;
	string data = config.data;
	string method = string_to_upper(config.method);
	net__http__Request req = (net__http__Request){
		.method = method,
		.headers = config.headers,
		.cookies = config.cookies,
		.data = data,
		.url = url,
		.user_agent = config.user_agent,
		.verbose = config.verbose,
		.user_ptr = 0,
		.ws_func = 0,
	};
	Option_net__http__Response _t433 = net__http__Request_do(&req);
	if (!_t433.ok) {
		string err = _t433.v_error;
		int errcode = _t433.ecode;
		Option _t434 = v_error(err);
		return *(Option_net__http__Response*)&_t434;
	}
	net__http__Response res = *(net__http__Response*)_t433.data;
	Option_net__http__Response _t435;
	opt_ok2(&(net__http__Response[]) { res }, (OptionBase*)(&_t435), sizeof(net__http__Response));
	return _t435;
}

string net__http__get_text(string url) {
	Option_net__http__Response _t436 = net__http__fetch(url, (net__http__FetchConfig){.method = tos_lit("GET"),.data = (string){.str=(byteptr)""},.params = new_map_1(sizeof(string)),.headers = new_map_1(sizeof(string)),.cookies = new_map_1(sizeof(string)),.user_agent = tos_lit("v.http"),.verbose = false,});
	if (!_t436.ok) {
		string err = _t436.v_error;
		int errcode = _t436.ecode;
		return tos_lit("");
	}
	net__http__Response resp = *(net__http__Response*)_t436.data;
	return resp.text;
}

string net__http__url_encode_form_data(map_string_string data) {
	array_string pieces = __new_array_with_default(0, 0, sizeof(string), 0);
	// FOR IN map
	map_string_string _t439 = data;
	array_string keys__t437 = map_keys(&_t439);
	for (int _t438 = 0; _t438 < keys__t437.len; ++_t438) {
		string key_ = /*kkkk*/ string_clone( ((string*)keys__t437.data)[_t438] );
		string value_ = /*vvv*/ (*(string*)map_get(_t439, key_, &(string[]){ (string){.str=(byteptr)""} }));
		string key = net__urllib__query_escape(key_);
		string value = net__urllib__query_escape(value_);
		array_push(&pieces, _MOV((string[]){ _STR("%.*s\000=%.*s", 2, key, value) }));
	}
	/*for in map cleanup*/
	for (int _t438 = 0; _t438 < keys__t437.len; ++_t438) { string_free(&((string*)keys__t437.data)[_t438]); }
	array_free(&keys__t437);
	return array_string_join(pieces, tos_lit("&"));
}

static Option_net__http__Response net__http__fetch_with_method(string method, string url, net__http__FetchConfig _config) {
	net__http__FetchConfig config = _config;
	config.method = method;
	return net__http__fetch(url, config);
}

static Option_string net__http__build_url_from_fetch(string _url, net__http__FetchConfig config) {
	Option_net__urllib__URL _t441 = net__urllib__parse(_url);
	if (!_t441.ok) {
		string err = _t441.v_error;
		int errcode = _t441.ecode;
		Option _t442 = v_error(err);
		return *(Option_string*)&_t442;
	}
	net__urllib__URL url = *(net__urllib__URL*)_t441.data;
	map_string_string params = config.params;
	if (map_keys(&params).len == 0) {
		Option_string _t443;
		opt_ok2(&(string[]) { net__urllib__URL_str(url) }, (OptionBase*)(&_t443), sizeof(string));
		return _t443;
	}
	array_string pieces = __new_array_with_default(0, 0, sizeof(string), 0);
	// FOR IN array
	array _t444 = map_keys(&params);
	for (int _t445 = 0; _t445 < _t444.len; ++_t445) {
		string key = ((string*)_t444.data)[_t445];
		array_push(&pieces, _MOV((string[]){ _STR("%.*s\000=%.*s", 2, key, (*(string*)map_get_and_set(&params, key, &(string[]){ (string){.str=(byteptr)""} }))) }));
	}
	string query = array_string_join(pieces, tos_lit("&"));
	if (url.raw_query.len > 1) {
		query = string_add(string_add(url.raw_query, tos_lit("&")), query);
	}
	url.raw_query = query;
	Option_string _t447;
	opt_ok2(&(string[]) { net__urllib__URL_str(url) }, (OptionBase*)(&_t447), sizeof(string));
	return _t447;
}

static void net__http__Request_free(net__http__Request* req) {
	{ // Unsafe block
		map_free(&req->headers);
	}
}

static void net__http__Response_free(net__http__Response* resp) {
	{ // Unsafe block
		map_free(&resp->headers);
	}
}

void net__http__Request_add_header(net__http__Request* req, string key, string val) {
	map_set(&req->headers, key, &(string[]) { val });
}

map_string_string net__http__parse_headers(array_string lines) {
	map_string_string headers = new_map_1(sizeof(string));
	// FOR IN array
	array _t448 = lines;
	for (int i = 0; i < _t448.len; ++i) {
		string line = ((string*)_t448.data)[i];
		if (i == 0) {
			continue;
		}
		array_string words = string_split(line, tos_lit(": "));
		if (words.len != 2) {
			continue;
		}
		map_set(&headers, (*(string*)array_get(words, 0)), &(string[]) { (*(string*)array_get(words, 1)) });
	}
	return headers;
}

Option_net__http__Response net__http__Request_do(net__http__Request* req) {
	Option_net__urllib__URL _t449 = net__urllib__parse(req->url);
	if (!_t449.ok) {
		string err = _t449.v_error;
		int errcode = _t449.ecode;
		Option _t450 = v_error(_STR("http.Request.do: invalid url %.*s", 1, req->url));
		return *(Option_net__http__Response*)&_t450;
	}
	net__urllib__URL url = *(net__urllib__URL*)_t449.data;
	net__urllib__URL rurl = url;
	net__http__Response resp = (net__http__Response){.text = (string){.str=(byteptr)""},.headers = new_map_1(sizeof(string)),.lheaders = new_map_1(sizeof(string)),.cookies = new_map_1(sizeof(string)),.status_code = 0,};
	int no_redirects = 0;
	while (1) {
		if (no_redirects == _const_net__http__max_redirects) {
			Option _t451 = v_error(_STR("http.request.do: maximum number of redirects reached (%"PRId32"\000)", 2, _const_net__http__max_redirects));
			return *(Option_net__http__Response*)&_t451;
		}
		Option_net__http__Response _t452 = net__http__Request_method_and_url_to_response(req, req->method, rurl);
		if (!_t452.ok) {
			string err = _t452.v_error;
			int errcode = _t452.ecode;
			Option _t453 = v_error(err);
			return *(Option_net__http__Response*)&_t453;
		}
		net__http__Response qresp = *(net__http__Response*)_t452.data;
		resp = qresp;
		if (!(resp.status_code == 301 || resp.status_code == 302 || resp.status_code == 303 || resp.status_code == 307 || resp.status_code == 308)) {
			break;
		}
		string redirect_url = (*(string*)map_get(resp.lheaders, tos_lit("location"), &(string[]){ (string){.str=(byteptr)""} }));
		if (redirect_url.len > 0 && string_at(redirect_url, 0) == '/') {
			Option_bool _t454 = net__urllib__URL_set_path(&url, redirect_url);
			if (!_t454.ok) {
				string err = _t454.v_error;
				int errcode = _t454.ecode;
				Option _t455 = v_error(_STR("http.request.do: invalid path in redirect: \"%.*s\000\"", 2, redirect_url));
				return *(Option_net__http__Response*)&_t455;
			};
			redirect_url = net__urllib__URL_str(url);
		}
		Option_net__urllib__URL _t456 = net__urllib__parse(redirect_url);
		if (!_t456.ok) {
			string err = _t456.v_error;
			int errcode = _t456.ecode;
			Option _t457 = v_error(_STR("http.request.do: invalid URL in redirect \"%.*s\000\"", 2, redirect_url));
			return *(Option_net__http__Response*)&_t457;
		}
		net__urllib__URL qrurl = *(net__urllib__URL*)_t456.data;
		rurl = qrurl;
		no_redirects++;
	}
	Option_net__http__Response _t458;
	opt_ok2(&(net__http__Response[]) { resp }, (OptionBase*)(&_t458), sizeof(net__http__Response));
	return _t458;
}

static Option_net__http__Response net__http__Request_method_and_url_to_response(net__http__Request* req, string method, net__urllib__URL url) {
	string host_name = net__urllib__URL_hostname(&url);
	string scheme = url.scheme;
	string p = string_trim_left(url.path, tos_lit("/"));
	string path = (net__urllib__URL_query(&url).len > 0 ? (_STR("/%.*s\000?%.*s", 2, p, net__urllib__Values_encode(net__urllib__URL_query(&url)))) : (_STR("/%.*s", 1, p)));
	int nport = string_int(net__urllib__URL_port(&url));
	if (nport == 0) {
		if (string_eq(scheme, tos_lit("http"))) {
			nport = 80;
		}
		if (string_eq(scheme, tos_lit("https"))) {
			nport = 443;
		}
	}
	if (string_eq(scheme, tos_lit("https"))) {
		Option_net__http__Response _t459 = net__http__Request_ssl_do(req, nport, method, host_name, path);
		if (!_t459.ok) {
			string err = _t459.v_error;
			int errcode = _t459.ecode;
			Option _t460 = v_error(err);
			return *(Option_net__http__Response*)&_t460;
		}
		net__http__Response res = *(net__http__Response*)_t459.data;
		Option_net__http__Response _t461;
		opt_ok2(&(net__http__Response[]) { res }, (OptionBase*)(&_t461), sizeof(net__http__Response));
		return _t461;
	} else if (string_eq(scheme, tos_lit("http"))) {
		Option_net__http__Response _t462 = net__http__Request_http_do(req, nport, method, host_name, path);
		if (!_t462.ok) {
			string err = _t462.v_error;
			int errcode = _t462.ecode;
			Option _t463 = v_error(err);
			return *(Option_net__http__Response*)&_t463;
		}
		net__http__Response res = *(net__http__Response*)_t462.data;
		Option_net__http__Response _t464;
		opt_ok2(&(net__http__Response[]) { res }, (OptionBase*)(&_t464), sizeof(net__http__Response));
		return _t464;
	}
	Option _t465 = v_error(_STR("http.request.method_and_url_to_response: unsupported scheme: \"%.*s\000\"", 2, scheme));
	return *(Option_net__http__Response*)&_t465;
}

static net__http__Response net__http__parse_response(string resp) {
	map_string_string headers = new_map_1(sizeof(string));
	map_string_string lheaders = new_map_1(sizeof(string));
	map_string_string cookies = new_map_1(sizeof(string));
	string first_header = string_all_before(resp, tos_lit("\n"));
	int status_code = 0;
	if (string_contains(first_header, tos_lit("HTTP/"))) {
		string val = string_find_between(first_header, tos_lit(" "), tos_lit(" "));
		status_code = string_int(val);
	}
	string text = tos_lit("");
	int nl_pos = 3;
	int i = 1;
	while (1) {
		int old_pos = nl_pos;
		nl_pos = string_index_after(resp, tos_lit("\n"), nl_pos + 1);
		if (nl_pos == -1) {
			break;
		}
		string h = string_substr(resp, old_pos + 1, nl_pos);
		if (h.len <= 1) {
			text = string_substr(resp, nl_pos + 1, resp.len);
			break;
		}
		i++;
		Option_int _t466 = string_index(h, tos_lit(":"));
		if (!_t466.ok) {
			string err = _t466.v_error;
			int errcode = _t466.ecode;
			continue;
		}
		int pos = *(int*)_t466.data;
		string key = string_substr(h, 0, pos);
		string lkey = string_to_lower(key);
		string val = string_substr(h, pos + 2, h.len);
		if (string_eq(lkey, tos_lit("set-cookie"))) {
			array_string parts = string_split(string_trim_space(val), tos_lit("="));
			map_set(&cookies, (*(string*)array_get(parts, 0)), &(string[]) { (*(string*)array_get(parts, 1)) });
		}
		string tval = string_trim_space(val);
		map_set(&headers, key, &(string[]) { tval });
		map_set(&lheaders, lkey, &(string[]) { tval });
	}
	if (string_eq((*(string*)map_get(lheaders, tos_lit("transfer-encoding"), &(string[]){ (string){.str=(byteptr)""} })), tos_lit("chunked")) || string_eq((*(string*)map_get(lheaders, tos_lit("content-length"), &(string[]){ (string){.str=(byteptr)""} })), tos_lit(""))) {
		text = net__http__chunked__decode(text);
	}
	return (net__http__Response){.text = text,.headers = headers,.lheaders = lheaders,.cookies = cookies,.status_code = status_code,};
}

static string net__http__Request_build_request_headers(net__http__Request* req, string method, string host_name, string path) {
	string ua = req->user_agent;
	array_string uheaders = __new_array_with_default(0, 0, sizeof(string), 0);
	if (!_IN_MAP(tos_lit("Host"), req->headers)) {
		array_push(&uheaders, _MOV((string[]){ _STR("Host: %.*s\000\r\n", 2, host_name) }));
	}
	if (!_IN_MAP(tos_lit("User-Agent"), req->headers)) {
		array_push(&uheaders, _MOV((string[]){ _STR("User-Agent: %.*s\000\r\n", 2, ua) }));
	}
	if (req->data.len > 0 && !_IN_MAP(tos_lit("Content-Length"), req->headers)) {
		array_push(&uheaders, _MOV((string[]){ _STR("Content-Length: %"PRId32"\000\r\n", 2, req->data.len) }));
	}
	// FOR IN map
	map_string_string _t472 = req->headers;
	array_string keys__t470 = map_keys(&_t472);
	for (int _t471 = 0; _t471 < keys__t470.len; ++_t471) {
		string key = /*kkkk*/ string_clone( ((string*)keys__t470.data)[_t471] );
		string val = /*vvv*/ (*(string*)map_get(_t472, key, &(string[]){ (string){.str=(byteptr)""} }));
		if (string_eq(key, tos_lit("Cookie"))) {
			continue;
		}
		array_push(&uheaders, _MOV((string[]){ _STR("%.*s\000: %.*s\000\r\n", 3, key, val) }));
	}
	/*for in map cleanup*/
	for (int _t471 = 0; _t471 < keys__t470.len; ++_t471) { string_free(&((string*)keys__t470.data)[_t471]); }
	array_free(&keys__t470);
	array_push(&uheaders, _MOV((string[]){ net__http__Request_build_request_cookies_header(req) }));
	return string_add(string_add(string_add(_STR("%.*s\000 %.*s\000 HTTP/1.1\r\n", 3, method, path), array_string_join(uheaders, tos_lit(""))), tos_lit("Connection: close\r\n\r\n")), req->data);
}

static string net__http__Request_build_request_cookies_header(net__http__Request* req) {
	if (map_keys(&req->cookies).len < 1) {
		return tos_lit("");
	}
	array_string cookie = __new_array_with_default(0, 0, sizeof(string), 0);
	// FOR IN map
	map_string_string _t477 = req->cookies;
	array_string keys__t475 = map_keys(&_t477);
	for (int _t476 = 0; _t476 < keys__t475.len; ++_t476) {
		string key = /*kkkk*/ string_clone( ((string*)keys__t475.data)[_t476] );
		string val = /*vvv*/ (*(string*)map_get(_t477, key, &(string[]){ (string){.str=(byteptr)""} }));
		array_push(&cookie, _MOV((string[]){ _STR("%.*s\000: %.*s", 2, key, val) }));
	}
	/*for in map cleanup*/
	for (int _t476 = 0; _t476 < keys__t475.len; ++_t476) { string_free(&((string*)keys__t475.data)[_t476]); }
	array_free(&keys__t475);
	if (_IN_MAP(tos_lit("Cookie"), req->headers) && string_ne((*(string*)map_get(req->headers, tos_lit("Cookie"), &(string[]){ (string){.str=(byteptr)""} })), tos_lit(""))) {
		array_push(&cookie, _MOV((string[]){ (*(string*)map_get_and_set(&req->headers, tos_lit("Cookie"), &(string[]){ (string){.str=(byteptr)""} })) }));
	}
	return string_add(string_add(tos_lit("Cookie: "), array_string_join(cookie, tos_lit("; "))), tos_lit("\r\n"));
}

string net__http__unescape_url(string s) {
	v_panic(tos_lit("http.unescape_url() was replaced with urllib.query_unescape()"));
}

string net__http__escape_url(string s) {
	v_panic(tos_lit("http.escape_url() was replaced with urllib.query_escape()"));
}

string net__http__unescape(string s) {
	v_panic(tos_lit("http.unescape() was replaced with http.unescape_url()"));
}

string net__http__escape(string s) {
	v_panic(tos_lit("http.escape() was replaced with http.escape_url()"));
}

static Option_net__http__Response net__http__Request_http_do(net__http__Request* req, int port, string method, string host_name, string path) {
	array_fixed_byte_1536 rbuffer = {0};
	strings__Builder sb = strings__new_builder(100);
	string s = net__http__Request_build_request_headers(req, method, host_name, path);
	Option_net__Socket _t480 = net__dial(host_name, port);
	if (!_t480.ok) {
		string err = _t480.v_error;
		int errcode = _t480.ecode;
		Option _t481 = v_error(err);
		return *(Option_net__http__Response*)&_t481;
	}
	net__Socket client = *(net__Socket*)_t480.data;
	Option_int _t482 = net__Socket_send(client, s.str, s.len);
	if (!_t482.ok) {
		string err = _t482.v_error;
		int errcode = _t482.ecode;
	};
	while (1) {
		int readbytes = net__Socket_crecv(client, (voidptr)&/*qq*/rbuffer, _const_net__http__bufsize);
		if (readbytes < 0) {
			Option _t483 = v_error(_STR("http.request.http_do: error reading response. readbytes=%"PRId32"", 1, readbytes));
			return *(Option_net__http__Response*)&_t483;
		}
		if (readbytes == 0) {
			break;
		}
		strings__Builder_write(&sb, tos((voidptr)&/*qq*/rbuffer, readbytes));
	}
	Option_int _t484 = net__Socket_close(client);
	if (!_t484.ok) {
		string err = _t484.v_error;
		int errcode = _t484.ecode;
	};
	Option_net__http__Response _t485;
	opt_ok2(&(net__http__Response[]) { net__http__parse_response(strings__Builder_str(&sb)) }, (OptionBase*)(&_t485), sizeof(net__http__Response));
	return _t485;
}

string net__http__Request_referer(net__http__Request* req) {
	return (*(string*)map_get(req->headers, tos_lit("Referer"), &(string[]){ (string){.str=(byteptr)""} }));
}

// TypeDecl
sync__PoolProcessor* sync__new_pool_processor(sync__PoolProcessorConfig context) {
	if (isnil(context.callback)) {
		v_panic(tos_lit("You need to pass a valid callback to new_pool_processor."));
	}
	runtime__nr_jobs();
	sync__PoolProcessor* pool = (sync__PoolProcessor*)memdup(&(sync__PoolProcessor){.thread_cb = ((voidptr)(context.callback)),
		.njobs = context.maxjobs,
		.items = __new_array_with_default(0, 0, sizeof(voidptr), 0),
		.results = __new_array_with_default(0, 0, sizeof(voidptr), 0),
		.ntask = 0,
		.ntask_mtx = sync__new_mutex(),
		.waitgroup = sync__new_waitgroup(),
		.shared_context = ((voidptr)(0)),
		.thread_contexts = __new_array_with_default(0, 0, sizeof(voidptr), 0),
	}, sizeof(sync__PoolProcessor));
	return pool;
}

void sync__PoolProcessor_set_max_jobs(sync__PoolProcessor* pool, int njobs) {
	pool->njobs = njobs;
}

void sync__PoolProcessor_work_on_pointers(sync__PoolProcessor* pool, array_voidptr items) {
	int njobs = runtime__nr_jobs();
	if (pool->njobs > 0) {
		njobs = pool->njobs;
	}
	pool->items = __new_array_with_default(0, 0, sizeof(voidptr), 0);
	pool->results = __new_array_with_default(0, 0, sizeof(voidptr), 0);
	pool->thread_contexts = __new_array_with_default(0, 0, sizeof(voidptr), 0);
	_PUSH_MANY(&pool->items, (items), _t486, array_voidptr);
	pool->results = __new_array_with_default((pool->items.len), 0, sizeof(voidptr), 0);
	_PUSH_MANY(&pool->thread_contexts, (__new_array_with_default((pool->items.len), 0, sizeof(voidptr), 0)), _t487, array_voidptr);
	sync__WaitGroup_add(pool->waitgroup, njobs);
	for (int i = 0; i < njobs; i++) {
		if (njobs > 1) {
			// go
			thread_arg_sync__process_in_thread *arg__t488 = malloc(sizeof(thread_arg_sync__process_in_thread));
			arg__t488->arg1 = pool;
			arg__t488->arg2 = i;
			pthread_t thread__t488;
			pthread_create(&thread__t488, NULL, (void*)sync__process_in_thread_thread_wrapper, arg__t488);
			// endgo

		} else {
			sync__process_in_thread(pool, i);
		}
	}
	sync__WaitGroup_wait(pool->waitgroup);
}

static void sync__process_in_thread(sync__PoolProcessor* pool, int task_id) {
	voidptr (*cb) (sync__PoolProcessor* p, int idx, int task_id) = ((sync__ThreadCB)(pool->thread_cb));
	int idx = 0;
	int ilen = pool->items.len;
	while (1) {
		if (pool->ntask >= ilen) {
			break;
		}
		sync__Mutex_m_lock(pool->ntask_mtx);
		idx = pool->ntask;
		pool->ntask++;
		sync__Mutex_unlock(pool->ntask_mtx);
		if (idx >= ilen) {
			break;
		}
		(*(voidptr*)array_get(pool->results, idx)) = cb(pool, idx, task_id);
	}
	sync__WaitGroup_done(pool->waitgroup);
}

string sync__PoolProcessor_get_string_item(sync__PoolProcessor* pool, int idx) {
	return *((string*)((*(voidptr*)array_get(pool->items, idx))));
}

int sync__PoolProcessor_get_int_item(sync__PoolProcessor* pool, int idx) {
	voidptr item = (*(voidptr*)array_get(pool->items, idx));
	return *(((int*)(item)));
}

void sync__PoolProcessor_set_shared_context(sync__PoolProcessor* pool, voidptr context) {
	pool->shared_context = context;
}

voidptr sync__PoolProcessor_get_shared_context(sync__PoolProcessor* pool) {
	return pool->shared_context;
}

void sync__PoolProcessor_set_thread_context(sync__PoolProcessor* pool, int idx, voidptr context) {
	(*(voidptr*)array_get(pool->thread_contexts, idx)) = context;
}

voidptr sync__PoolProcessor_get_thread_context(sync__PoolProcessor* pool, int idx) {
	return (*(voidptr*)array_get(pool->thread_contexts, idx));
}

void sync__PoolProcessor_work_on_items_s(sync__PoolProcessor* pool, array_string items) {
	sync__PoolProcessor_work_on_pointers(pool, array_pointers(items));
}

void sync__PoolProcessor_work_on_items_i(sync__PoolProcessor* pool, array_int items) {
	sync__PoolProcessor_work_on_pointers(pool, array_pointers(items));
}

array_sync__SResult sync__PoolProcessor_get_results_s(sync__PoolProcessor* pool) {
	array_sync__SResult res = __new_array_with_default(0, 0, sizeof(sync__SResult), 0);
	for (int i = 0; i < pool->results.len; ++i) {
		array_push(&res, _MOV((sync__SResult[]){ *(((sync__SResult*)((*(voidptr*)array_get(pool->results, i))))) }));
	}
	return res;
}

array_sync__IResult sync__PoolProcessor_get_results_i(sync__PoolProcessor* pool) {
	array_sync__IResult res = __new_array_with_default(0, 0, sizeof(sync__IResult), 0);
	for (int i = 0; i < pool->results.len; ++i) {
		array_push(&res, _MOV((sync__IResult[]){ *(((sync__IResult*)((*(voidptr*)array_get(pool->results, i))))) }));
	}
	return res;
}

// Attr: [ref_only]
// Attr: [ref_only]
// Attr: [ref_only]
// Attr: [ref_only]
// Attr: [ref_only]
sync__Mutex* sync__new_mutex() {
	sync__Mutex* m = (sync__Mutex*)memdup(&(sync__Mutex){.mutex = 0,}, sizeof(sync__Mutex));
	pthread_mutex_init(&m->mutex, NULL);
	return m;
}

sync__RwMutex* sync__new_rwmutex() {
	sync__RwMutex* m = (sync__RwMutex*)memdup(&(sync__RwMutex){.mutex = 0,}, sizeof(sync__RwMutex));
	sync__RwMutexAttr* a = (sync__RwMutexAttr*)memdup(&(sync__RwMutexAttr){.attr = 0,}, sizeof(sync__RwMutexAttr));
	pthread_rwlockattr_init(&a->attr);
	pthread_rwlockattr_setkind_np(&a->attr, PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP);
	pthread_rwlockattr_setpshared(&a->attr, PTHREAD_PROCESS_PRIVATE);
	pthread_rwlock_init(&m->mutex, &a->attr);
	return m;
}

void sync__Mutex_m_lock(sync__Mutex* m) {
	pthread_mutex_lock(&m->mutex);
}

void sync__Mutex_unlock(sync__Mutex* m) {
	pthread_mutex_unlock(&m->mutex);
}

void sync__RwMutex_r_lock(sync__RwMutex* m) {
	pthread_rwlock_rdlock(&m->mutex);
}

void sync__RwMutex_w_lock(sync__RwMutex* m) {
	pthread_rwlock_wrlock(&m->mutex);
}

void sync__RwMutex_r_unlock(sync__RwMutex* m) {
	pthread_rwlock_unlock(&m->mutex);
}

void sync__RwMutex_w_unlock(sync__RwMutex* m) {
	pthread_rwlock_unlock(&m->mutex);
}

sync__Semaphore sync__new_semaphore() {
// $if  macos {
#ifdef __APPLE__
#else
	sync__Semaphore s = (sync__Semaphore){.sem = (sync__PosixSemaphore*)memdup(&(sync__PosixSemaphore){.sem = 0,}, sizeof(sync__PosixSemaphore)),};
	sem_init(&((sync__PosixSemaphore*)(s.sem))->sem, 0, 0);
	return s;
#endif
// } macos
}

void sync__Semaphore_post(sync__Semaphore s) {
// $if  macos {
#ifdef __APPLE__
#else
	sem_post(&((sync__PosixSemaphore*)(s.sem))->sem);
#endif
// } macos
}

void sync__Semaphore_wait(sync__Semaphore s) {
// $if  macos {
#ifdef __APPLE__
#else
	sem_wait(&((sync__PosixSemaphore*)(s.sem))->sem);
#endif
// } macos
}

bool sync__Semaphore_try_wait(sync__Semaphore s) {
// $if  macos {
#ifdef __APPLE__
#else
	return sem_trywait(&((sync__PosixSemaphore*)(s.sem))->sem) == 0;
#endif
// } macos
}

bool sync__Semaphore_timed_wait(sync__Semaphore s, time__Duration timeout) {
	struct timespec t_spec = time__Duration_timespec(timeout);
// $if  macos {
#ifdef __APPLE__
#else
	return sem_timedwait(&((sync__PosixSemaphore*)(s.sem))->sem, &t_spec) == 0;
#endif
// } macos
}

// Attr: [ref_only]
void sync__Waiter_wait(sync__Waiter* w) {
	sync__Mutex_m_lock(w->mx);
}

void sync__Waiter_stop(sync__Waiter* w) {
	sync__Mutex_unlock(w->mx);
}

sync__Waiter* sync__new_waiter() {
	sync__Waiter* w = (sync__Waiter*)memdup(&(sync__Waiter){.mx = sync__new_mutex(),}, sizeof(sync__Waiter));
	return w;
}

// Attr: [ref_only]
sync__WaitGroup* sync__new_waitgroup() {
	return (sync__WaitGroup*)memdup(&(sync__WaitGroup){.task_count = 0,.task_count_mutex = sync__new_mutex(),.wait_blocker = sync__new_waiter(),}, sizeof(sync__WaitGroup));
}

void sync__WaitGroup_add(sync__WaitGroup* wg, int delta) {
	sync__Mutex_m_lock(wg->task_count_mutex);
	if (wg->task_count == 0) {
		sync__Waiter_wait(wg->wait_blocker);
	}
	wg->task_count += delta;
	if (wg->task_count < 0) {
		v_panic(tos_lit("Negative number of jobs in waitgroup"));
	}
	if (wg->task_count == 0) {
		sync__Waiter_stop(wg->wait_blocker);
	}
// Defer begin
sync__Mutex_unlock(wg->task_count_mutex);
// Defer end
}

void sync__WaitGroup_done(sync__WaitGroup* wg) {
	sync__WaitGroup_add(wg, -1);
}

void sync__WaitGroup_wait(sync__WaitGroup* wg) {
	sync__Waiter_wait(wg->wait_blocker);
	sync__Waiter_stop(wg->wait_blocker);
}

void rand__wyrand__WyRandRNG_seed(rand__wyrand__WyRandRNG* rng, array_u32 seed_data) {
	if (seed_data.len != 2) {
		eprintln(tos_lit("WyRandRNG needs 2 32-bit unsigned integers as the seed."));
		v_exit(1);
	}
	rng->state = ((*(u32*)array_get(seed_data, 0)) | (((u64)((*(u32*)array_get(seed_data, 1)))) << 32));
	rng->has_extra = false;
}

// Attr: [inline]
inline u32 rand__wyrand__WyRandRNG_u32(rand__wyrand__WyRandRNG* rng) {
	if (rng->has_extra) {
		rng->has_extra = false;
		return rng->extra;
	}
	u64 full_value = rand__wyrand__WyRandRNG_u64(rng);
	u32 lower = ((u32)((full_value & _const_rand__util__lower_mask)));
	u32 upper = ((u32)(full_value >> 32));
	rng->extra = upper;
	rng->has_extra = true;
	return lower;
}

// Attr: [inline]
inline u64 rand__wyrand__WyRandRNG_u64(rand__wyrand__WyRandRNG* rng) {
	{ // Unsafe block
		u64 seed1 = rng->state;
		seed1 += _const_rand__wyrand__wyp0;
		rng->state = seed1;
		return hash__wymum((seed1 ^ _const_rand__wyrand__wyp1), seed1);
	}
	return 0;
}

// Attr: [inline]
inline u32 rand__wyrand__WyRandRNG_u32n(rand__wyrand__WyRandRNG* rng, u32 max) {
	if (max == 0) {
		eprintln(tos_lit("max must be positive integer"));
		v_exit(1);
	}
	int bit_len = math__bits__len_32(max);
	if (bit_len == 32) {
		while (1) {
			u32 value = rand__wyrand__WyRandRNG_u32(rng);
			if (value < max) {
				return value;
			}
		}
	} else {
		u32 mask = (((u32)(1)) << (bit_len + 1)) - 1;
		while (1) {
			u32 value = (rand__wyrand__WyRandRNG_u32(rng) & mask);
			if (value < max) {
				return value;
			}
		}
	}
	return ((u32)(0));
}

// Attr: [inline]
inline u64 rand__wyrand__WyRandRNG_u64n(rand__wyrand__WyRandRNG* rng, u64 max) {
	if (max == 0) {
		eprintln(tos_lit("max must be positive integer"));
		v_exit(1);
	}
	int bit_len = math__bits__len_64(max);
	if (bit_len == 64) {
		while (1) {
			u64 value = rand__wyrand__WyRandRNG_u64(rng);
			if (value < max) {
				return value;
			}
		}
	} else {
		u64 mask = (((u64)(1)) << (bit_len + 1)) - 1;
		while (1) {
			u64 value = (rand__wyrand__WyRandRNG_u64(rng) & mask);
			if (value < max) {
				return value;
			}
		}
	}
	return ((u64)(0));
}

// Attr: [inline]
inline u32 rand__wyrand__WyRandRNG_u32_in_range(rand__wyrand__WyRandRNG* rng, u32 min, u32 max) {
	if (max <= min) {
		eprintln(tos_lit("max must be greater than min"));
		v_exit(1);
	}
	return min + rand__wyrand__WyRandRNG_u32n(rng, max - min);
}

// Attr: [inline]
inline u64 rand__wyrand__WyRandRNG_u64_in_range(rand__wyrand__WyRandRNG* rng, u64 min, u64 max) {
	if (max <= min) {
		eprintln(tos_lit("max must be greater than min"));
		v_exit(1);
	}
	return min + rand__wyrand__WyRandRNG_u64n(rng, max - min);
}

// Attr: [inline]
inline int rand__wyrand__WyRandRNG_int(rand__wyrand__WyRandRNG* rng) {
	return ((int)(rand__wyrand__WyRandRNG_u32(rng)));
}

// Attr: [inline]
inline i64 rand__wyrand__WyRandRNG_i64(rand__wyrand__WyRandRNG* rng) {
	return ((i64)(rand__wyrand__WyRandRNG_u64(rng)));
}

// Attr: [inline]
inline int rand__wyrand__WyRandRNG_int31(rand__wyrand__WyRandRNG* rng) {
	return ((int)((rand__wyrand__WyRandRNG_u32(rng) & _const_rand__util__u31_mask)));
}

// Attr: [inline]
inline i64 rand__wyrand__WyRandRNG_int63(rand__wyrand__WyRandRNG* rng) {
	return ((i64)((rand__wyrand__WyRandRNG_u64(rng) & _const_rand__util__u63_mask)));
}

// Attr: [inline]
inline int rand__wyrand__WyRandRNG_intn(rand__wyrand__WyRandRNG* rng, int max) {
	if (max <= 0) {
		eprintln(tos_lit("max has to be positive."));
		v_exit(1);
	}
	return ((int)(rand__wyrand__WyRandRNG_u32n(rng, ((u32)(max)))));
}

// Attr: [inline]
inline i64 rand__wyrand__WyRandRNG_i64n(rand__wyrand__WyRandRNG* rng, i64 max) {
	if (max <= 0) {
		eprintln(tos_lit("max has to be positive."));
		v_exit(1);
	}
	return ((i64)(rand__wyrand__WyRandRNG_u64n(rng, ((u64)(max)))));
}

// Attr: [inline]
inline int rand__wyrand__WyRandRNG_int_in_range(rand__wyrand__WyRandRNG* rng, int min, int max) {
	if (max <= min) {
		eprintln(tos_lit("max must be greater than min"));
		v_exit(1);
	}
	return min + rand__wyrand__WyRandRNG_intn(rng, max - min);
}

// Attr: [inline]
inline i64 rand__wyrand__WyRandRNG_i64_in_range(rand__wyrand__WyRandRNG* rng, i64 min, i64 max) {
	if (max <= min) {
		eprintln(tos_lit("max must be greater than min"));
		v_exit(1);
	}
	return min + rand__wyrand__WyRandRNG_i64n(rng, max - min);
}

// Attr: [inline]
inline f32 rand__wyrand__WyRandRNG_f32(rand__wyrand__WyRandRNG* rng) {
	return ((f32)(rand__wyrand__WyRandRNG_u32(rng))) / _const_rand__util__max_u32_as_f32;
}

// Attr: [inline]
inline f64 rand__wyrand__WyRandRNG_f64(rand__wyrand__WyRandRNG* rng) {
	return ((f64)(rand__wyrand__WyRandRNG_u64(rng))) / _const_rand__util__max_u64_as_f64;
}

// Attr: [inline]
inline f32 rand__wyrand__WyRandRNG_f32n(rand__wyrand__WyRandRNG* rng, f32 max) {
	if (max <= 0) {
		eprintln(tos_lit("max has to be positive."));
		v_exit(1);
	}
	return rand__wyrand__WyRandRNG_f32(rng) * max;
}

// Attr: [inline]
inline f64 rand__wyrand__WyRandRNG_f64n(rand__wyrand__WyRandRNG* rng, f64 max) {
	if (max <= 0) {
		eprintln(tos_lit("max has to be positive."));
		v_exit(1);
	}
	return rand__wyrand__WyRandRNG_f64(rng) * max;
}

// Attr: [inline]
inline f32 rand__wyrand__WyRandRNG_f32_in_range(rand__wyrand__WyRandRNG* rng, f32 min, f32 max) {
	if (max <= min) {
		eprintln(tos_lit("max must be greater than min"));
		v_exit(1);
	}
	return min + rand__wyrand__WyRandRNG_f32n(rng, max - min);
}

// Attr: [inline]
inline f64 rand__wyrand__WyRandRNG_f64_in_range(rand__wyrand__WyRandRNG* rng, f64 min, f64 max) {
	if (max <= min) {
		eprintln(tos_lit("max must be greater than min"));
		v_exit(1);
	}
	return min + rand__wyrand__WyRandRNG_f64n(rng, max - min);
}

static bool vweb__Context_send_response_to_client(vweb__Context* ctx, string mimetype, string res) {
	if (ctx->done) {
		return false;
	}
	ctx->done = true;
	strings__Builder sb = strings__new_builder(1024);
	strings__Builder_write(&sb, tos_lit("HTTP/1.1 200 OK\r\nContent-Type: "));
	strings__Builder_write(&sb, mimetype);
	strings__Builder_write(&sb, tos_lit("\r\nContent-Length: "));
	strings__Builder_write(&sb, int_str(res.len));
	strings__Builder_write(&sb, ctx->headers);
	strings__Builder_write(&sb, tos_lit("\r\n"));
	strings__Builder_write(&sb, _const_vweb__headers_close);
	strings__Builder_write(&sb, res);
	string s = strings__Builder_str(&sb);
	Option_int _t491 = net__Socket_send_string(ctx->conn, s);
	if (!_t491.ok) {
		string err = _t491.v_error;
		int errcode = _t491.ecode;
		// Defer begin
		strings__Builder_free(&sb);
		// Defer end
		// Defer begin
		string_free(&s);
		// Defer end
		return false;
	};
	// Defer begin
	strings__Builder_free(&sb);
	// Defer end
	// Defer begin
	string_free(&s);
	// Defer end
	return true;
}

void vweb__Context_html(vweb__Context* ctx, string s) {
	vweb__Context_send_response_to_client(ctx, tos_lit("text/html"), s);
}

vweb__Result vweb__Context_text(vweb__Context* ctx, string s) {
	vweb__Context_send_response_to_client(ctx, tos_lit("text/plain"), s);
	return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
}

vweb__Result vweb__Context_json(vweb__Context* ctx, string s) {
	vweb__Context_send_response_to_client(ctx, tos_lit("application/json"), s);
	return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
}

vweb__Result vweb__Context_ok(vweb__Context* ctx, string s) {
	vweb__Context_send_response_to_client(ctx, ctx->content_type, s);
	return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
}

vweb__Result vweb__Context_redirect(vweb__Context* ctx, string url) {
	if (ctx->done) {
		return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
	}
	ctx->done = true;
	Option_int _t492 = net__Socket_send_string(ctx->conn, _STR("HTTP/1.1 302 Found\r\nLocation: %.*s\000%.*s\000\r\n%.*s", 3, url, ctx->headers, _const_vweb__headers_close));
	if (!_t492.ok) {
		string err = _t492.v_error;
		int errcode = _t492.ecode;
		return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
	};
	return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
}

vweb__Result vweb__Context_not_found(vweb__Context* ctx) {
	if (ctx->done) {
		return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
	}
	ctx->done = true;
	Option_int _t493 = net__Socket_send_string(ctx->conn, _const_vweb__http_404);
	if (!_t493.ok) {
		string err = _t493.v_error;
		int errcode = _t493.ecode;
	};
	return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
}

void vweb__Context_set_cookie(vweb__Context* ctx, vweb__Cookie cookie) {
	array_string cookie_data = __new_array_with_default(0, 0, sizeof(string), 0);
	string secure = (cookie.secure ? (tos_lit("Secure;")) : (tos_lit("")));
	secure = /*f*/string_add(secure, (cookie.http_only ? (tos_lit(" HttpOnly")) : (tos_lit(" "))));
	array_push(&cookie_data, _MOV((string[]){ secure }));
	if (cookie.expires.v_unix > 0) {
		array_push(&cookie_data, _MOV((string[]){ _STR("expires=%.*s", 1, time__Time_utc_string(cookie.expires)) }));
	}
	string data = array_string_join(cookie_data, tos_lit(" "));
	vweb__Context_add_header(ctx, tos_lit("Set-Cookie"), _STR("%.*s\000=%.*s\000; %.*s", 3, cookie.name, cookie.value, data));
}

void vweb__Context_set_cookie_old(vweb__Context* ctx, string key, string val) {
	vweb__Context_add_header(ctx, tos_lit("Set-Cookie"), _STR("%.*s\000=%.*s\000; HttpOnly", 3, key, val));
}

void vweb__Context_set_content_type(vweb__Context* ctx, string typ) {
	ctx->content_type = typ;
}

void vweb__Context_set_cookie_with_expire_date(vweb__Context* ctx, string key, string val, time__Time expire_date) {
	vweb__Context_add_header(ctx, tos_lit("Set-Cookie"), _STR("%.*s\000=%.*s\000;  Secure; HttpOnly; expires=%.*s", 3, key, val, time__Time_utc_string(expire_date)));
}

Option_string vweb__Context_get_cookie(vweb__Context* ctx, string key) {
	string cookie_header = vweb__Context_get_header(ctx, tos_lit("cookie"));
	if (string_eq(cookie_header, tos_lit(""))) {
		cookie_header = vweb__Context_get_header(ctx, tos_lit("Cookie"));
	}
	cookie_header = string_add(tos_lit(" "), cookie_header);
	string cookie = (string_contains(cookie_header, tos_lit(";")) ? (string_find_between(cookie_header, _STR(" %.*s\000=", 2, key), tos_lit(";"))) : (string_find_between(cookie_header, _STR(" %.*s\000=", 2, key), tos_lit("\r"))));
	if (string_ne(cookie, tos_lit(""))) {
		Option_string _t496;
		opt_ok2(&(string[]) { string_trim_space(cookie) }, (OptionBase*)(&_t496), sizeof(string));
		return _t496;
	}
	Option _t497 = v_error(tos_lit("Cookie not found"));
	return *(Option_string*)&_t497;
}

void vweb__Context_add_header(vweb__Context* ctx, string key, string val) {
	ctx->headers = string_add(ctx->headers, _STR("\r\n%.*s\000: %.*s", 2, key, val));
}

string vweb__Context_get_header(vweb__Context* ctx, string key) {
	return (*(string*)map_get(ctx->req.headers, key, &(string[]){ (string){.str=(byteptr)""} }));
}

void vweb__run_main__App(int port) {
	main__App app = (main__App){
#ifndef __cplusplus
0
#endif
};
	vweb__run_app_main__App((voidptr)&/*qq*/app, port);
}

void vweb__run_app_main__App(main__App* app, int port) {
	println(_STR("Running a Vweb app on http://localhost:%"PRId32"", 1, port));
	Option_net__Socket _t498 = net__listen(port);
	if (!_t498.ok) {
		string err = _t498.v_error;
		int errcode = _t498.ecode;
		v_panic(tos_lit("failed to listen"));
	}
	net__Socket l = *(net__Socket*)_t498.data;
	app->vweb = (vweb__Context){.static_files = new_map_1(sizeof(string)),.static_mime_types = new_map_1(sizeof(string)),.content_type = tos_lit("text/plain"),.req = {0},.conn = {0},.form = new_map_1(sizeof(string)),.query = new_map_1(sizeof(string)),.headers = (string){.str=(byteptr)""},.done = 0,.page_gen_start = 0,.form_error = (string){.str=(byteptr)""},};
	main__App_init_once(app);
	while (1) {
		Option_net__Socket _t499 = net__Socket_accept(l);
		if (!_t499.ok) {
			string err = _t499.v_error;
			int errcode = _t499.ecode;
			v_panic(tos_lit("accept() failed"));
		}
		net__Socket conn = *(net__Socket*)_t499.data;
		vweb__handle_conn_main__App(conn, app);
	}
}

static void vweb__handle_conn_main__App(net__Socket conn, main__App* app) {
	i64 page_gen_start = time__ticks();
	string first_line = net__Socket_read_line(conn);
// $if  debug {
#ifdef _VDEBUG
	println(_STR("firstline=\"%.*s\000\"", 2, first_line));
#endif
// } debug
	array_string vals = string_split(first_line, tos_lit(" "));
	if (vals.len < 2) {
		println(tos_lit("no vals for http"));
		Option_int _t500 = net__Socket_send_string(conn, _const_vweb__http_500);
		if (!_t500.ok) {
			string err = _t500.v_error;
			int errcode = _t500.ecode;
		};
		// Defer begin
		Option_int _t501 = net__Socket_close(conn);
		if (!_t501.ok) {
			string err = _t501.v_error;
			int errcode = _t501.ecode;
		};
		// Defer end
		return;
	}
	array_string headers = __new_array_with_default(0, 0, sizeof(string), 0);
	string body = tos_lit("");
	bool in_headers = true;
	int len = 0;
	int body_len = 0;
	for (int _t502 = 0; _t502 < 100; ++_t502) {
		string line = net__Socket_read_line(conn);
		string sline = vweb__strip(line);
		if (string_eq(sline, tos_lit(""))) {
			if (len == 0) {
				break;
			}
			in_headers = false;
		}
		if (in_headers) {
			array_push(&headers, _MOV((string[]){ sline }));
			if (string_starts_with(sline, tos_lit("Content-Length"))) {
				len = string_int(string_all_after(sline, tos_lit(": ")));
			}
		} else {
			body = /*f*/string_add(body, string_add(sline, tos_lit("\r\n")));
			body_len += body.len;
			if (body_len >= len) {
				break;
			}
		}
	}
	net__http__Request req = (net__http__Request){
		.method = (*(string*)array_get(vals, 0)),
		.headers = net__http__parse_headers(headers),
		.cookies = new_map_1(sizeof(string)),
		.data = vweb__strip(body),
		.url = (*(string*)array_get(vals, 1)),
		.user_agent = tos_lit("v.http"),
		.verbose = 0,
		.user_ptr = 0,
		.ws_func = 0,
	};
// $if  debug {
#ifdef _VDEBUG
	println(tos_lit("req.headers = "));
	println(map_string_string_str(req.headers));
	println(_STR("req.data=\"%.*s\000\"", 2, req.data));
#endif
// } debug
	app->vweb = (vweb__Context){
		.static_files = app->vweb.static_files,
		.static_mime_types = app->vweb.static_mime_types,
		.content_type = tos_lit("text/plain"),
		.req = req,
		.conn = conn,
		.form = new_map_1(sizeof(string)),
		.query = new_map_1(sizeof(string)),
		.headers = (string){.str=(byteptr)""},
		.done = 0,
		.page_gen_start = page_gen_start,
		.form_error = (string){.str=(byteptr)""},
	};
	if (_IN(string, req.method, _const_vweb__methods_with_form)) {
		vweb__Context_parse_form(&app->vweb, req.data);
	}
	if (vals.len < 2) {
// $if  debug {
#ifdef _VDEBUG
		println(tos_lit("no vals for http"));
#endif
// } debug
		// Defer begin
		Option_int _t504 = net__Socket_close(conn);
		if (!_t504.ok) {
			string err = _t504.v_error;
			int errcode = _t504.ecode;
		};
		// Defer end
		return;
	}
	string static_file_name = app->vweb.req.url;
	if (string_contains(static_file_name, tos_lit("?"))) {
		static_file_name = string_all_before(static_file_name, tos_lit("?"));
	}
	string static_file = (*(string*)map_get(app->vweb.static_files, static_file_name, &(string[]){ (string){.str=(byteptr)""} }));
	string mime_type = (*(string*)map_get(app->vweb.static_mime_types, static_file_name, &(string[]){ (string){.str=(byteptr)""} }));
	if (string_ne(static_file, tos_lit("")) && string_ne(mime_type, tos_lit(""))) {
		Option_string _t505 = os__read_file(static_file);
		if (!_t505.ok) {
			string err = _t505.v_error;
			int errcode = _t505.ecode;
						Option_int _t506 = net__Socket_send_string(conn, _const_vweb__http_404);
			if (!_t506.ok) {
				string err = _t506.v_error;
				int errcode = _t506.ecode;
			}
_t506;
			// Defer begin
						Option_int _t507 = net__Socket_close(conn);
			if (!_t507.ok) {
				string err = _t507.v_error;
				int errcode = _t507.ecode;
			}
_t507;
			// Defer end
			return;
		}
		string data = *(string*)_t505.data;
		vweb__Context_send_response_to_client(&app->vweb, mime_type, data);
		string_free(&data);
		// Defer begin
		Option_int _t508 = net__Socket_close(conn);
		if (!_t508.ok) {
			string err = _t508.v_error;
			int errcode = _t508.ecode;
		};
		// Defer end
		return;
	}
	main__App_init(app);
	println(tos_lit("route matching..."));
	array_array_string route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);

int _t509_len = string_split(string_substr((*(string*)array_get(vals, 1)), 1, (*(string*)array_get(vals, 1)).len), tos_lit("/")).len;
	array_string _t509 = __new_array(0, _t509_len, sizeof(string));
	for (int i = 0; i < _t509_len; ++i) {
	  string it = ((string*) string_split(string_substr((*(string*)array_get(vals, 1)), 1, (*(string*)array_get(vals, 1)).len), tos_lit("/")).data)[i];
	if (string_ne(it, tos_lit(""))) array_push(&_t509, &it); 
 }
		array_string url_words =  _t509;
	if (url_words.len == 0) {
		main__App_index(app);
		// Defer begin
		Option_int _t510 = net__Socket_close(conn);
		if (!_t510.ok) {
			string err = _t510.v_error;
			int errcode = _t510.ecode;
		};
		// Defer end
		return;
	} else {
		if (string_contains(*(string*)array_last(url_words), tos_lit("?"))) {

			int _t511_len = string_split(string_all_after(*(string*)array_last(url_words), tos_lit("?")), tos_lit("&")).len;
			array_array_string _t511 = __new_array(0, _t511_len, sizeof(array_string));
			for (int _t512 = 0; _t512 < _t511_len; ++_t512) {
				string it = ((string*) string_split(string_all_after(*(string*)array_last(url_words), tos_lit("?")), tos_lit("&")).data)[_t512];
				array_string ti = string_split(it, tos_lit("="));
				array_push(&_t511, &ti);
			}
						array_array_string tmp_query = _t511;
			array_set(&url_words, url_words.len - 1, &(string[]) { string_all_before(*(string*)array_last(url_words), tos_lit("?")) });
			// FOR IN array
			array _t513 = tmp_query;
			for (int _t514 = 0; _t514 < _t513.len; ++_t514) {
				array_string data = ((array_string*)_t513.data)[_t514];
				if (data.len == 2) {
					map_set(&app->vweb.query, (*(string*)array_get(data, 0)), &(string[]) { (*(string*)array_get(data, 1)) });
				}
			}
		}
	}
	array_string vars = __new_array_with_default(0, route_words_a.len, sizeof(string), 0);
	string action = tos_lit("");
	// 2comptime $for {
		// method 0
		string method = tos_lit("admin");
		array_string attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_admin(app ); // vweb action call with args;
				// Defer begin
				Option_int _t515 = net__Socket_close(conn);
				if (!_t515.ok) {
					string err = _t515.v_error;
					int errcode = _t515.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t519_len = attrs.len;
					array_string _t519 = __new_array(0, _t519_len, sizeof(string));
					for (int i = 0; i < _t519_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t519, &it); 
 }
					
int _t517_len = attrs.len;
					array_string _t517 = __new_array(0, _t517_len, sizeof(string));
					for (int i = 0; i < _t517_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t517, &it); 
 }
					
					int _t516_len =  _t517.len;
					array_array_string _t516 = __new_array(0, _t516_len, sizeof(array_string));
					for (int _t518 = 0; _t518 < _t516_len; ++_t518) {
						string it = ((string*)  _t519.data)[_t518];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t516, &ti);
					}
										route_words_a = _t516;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t523_len = attrs.len;
					array_string _t523 = __new_array(0, _t523_len, sizeof(string));
					for (int i = 0; i < _t523_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t523, &it); 
 }
					
int _t521_len = attrs.len;
					array_string _t521 = __new_array(0, _t521_len, sizeof(string));
					for (int i = 0; i < _t521_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t521, &it); 
 }
					
					int _t520_len =  _t521.len;
					array_array_string _t520 = __new_array(0, _t520_len, sizeof(array_string));
					for (int _t522 = 0; _t522 < _t520_len; ++_t522) {
						string it = ((string*)  _t523.data)[_t522];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t520, &ti);
					}
										route_words_a = _t520;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t527_len = attrs.len;
					array_string _t527 = __new_array(0, _t527_len, sizeof(string));
					for (int i = 0; i < _t527_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t527, &it); 
 }
					
int _t525_len = attrs.len;
					array_string _t525 = __new_array(0, _t525_len, sizeof(string));
					for (int i = 0; i < _t525_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t525, &it); 
 }
					
					int _t524_len =  _t525.len;
					array_array_string _t524 = __new_array(0, _t524_len, sizeof(array_string));
					for (int _t526 = 0; _t526 < _t524_len; ++_t526) {
						string it = ((string*)  _t527.data)[_t526];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t524, &ti);
					}
										route_words_a = _t524;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t531_len = attrs.len;
					array_string _t531 = __new_array(0, _t531_len, sizeof(string));
					for (int i = 0; i < _t531_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t531, &it); 
 }
					
int _t529_len = attrs.len;
					array_string _t529 = __new_array(0, _t529_len, sizeof(string));
					for (int i = 0; i < _t529_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t529, &it); 
 }
					
					int _t528_len =  _t529.len;
					array_array_string _t528 = __new_array(0, _t528_len, sizeof(array_string));
					for (int _t530 = 0; _t530 < _t528_len; ++_t530) {
						string it = ((string*)  _t531.data)[_t530];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t528, &ti);
					}
										route_words_a = _t528;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t535_len = attrs.len;
					array_string _t535 = __new_array(0, _t535_len, sizeof(string));
					for (int i = 0; i < _t535_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t535, &it); 
 }
					
int _t533_len = attrs.len;
					array_string _t533 = __new_array(0, _t533_len, sizeof(string));
					for (int i = 0; i < _t533_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t533, &it); 
 }
					
					int _t532_len =  _t533.len;
					array_array_string _t532 = __new_array(0, _t532_len, sizeof(array_string));
					for (int _t534 = 0; _t534 < _t532_len; ++_t534) {
						string it = ((string*)  _t535.data)[_t534];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t532, &ti);
					}
										route_words_a = _t532;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t539_len = attrs.len;
					array_string _t539 = __new_array(0, _t539_len, sizeof(string));
					for (int i = 0; i < _t539_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t539, &it); 
 }
					
int _t537_len = attrs.len;
					array_string _t537 = __new_array(0, _t537_len, sizeof(string));
					for (int i = 0; i < _t537_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t537, &it); 
 }
					
					int _t536_len =  _t537.len;
					array_array_string _t536 = __new_array(0, _t536_len, sizeof(array_string));
					for (int _t538 = 0; _t538 < _t536_len; ++_t538) {
						string it = ((string*)  _t539.data)[_t538];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t536, &ti);
					}
										route_words_a = _t536;
				}
			} else {

int _t543_len = attrs.len;
				array_string _t543 = __new_array(0, _t543_len, sizeof(string));
				for (int i = 0; i < _t543_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t543, &it); 
 }
				
int _t541_len = attrs.len;
				array_string _t541 = __new_array(0, _t541_len, sizeof(string));
				for (int i = 0; i < _t541_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t541, &it); 
 }
				
				int _t540_len =  _t541.len;
				array_array_string _t540 = __new_array(0, _t540_len, sizeof(array_string));
				for (int _t542 = 0; _t542 < _t540_len; ++_t542) {
					string it = ((string*)  _t543.data)[_t542];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t540, &ti);
				}
								route_words_a = _t540;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t544 = route_words_a;
				for (int _t545 = 0; _t545 < _t544.len; ++_t545) {
					array_string route_words = ((array_string*)_t544.data)[_t545];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_admin(app ); // vweb action call with args;
							// Defer begin
							Option_int _t549 = net__Socket_close(conn);
							if (!_t549.ok) {
								string err = _t549.v_error;
								int errcode = _t549.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 1
	method = tos_lit("git_info");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_git_info(app ); // vweb action call with args;
				// Defer begin
				Option_int _t550 = net__Socket_close(conn);
				if (!_t550.ok) {
					string err = _t550.v_error;
					int errcode = _t550.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t554_len = attrs.len;
					array_string _t554 = __new_array(0, _t554_len, sizeof(string));
					for (int i = 0; i < _t554_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t554, &it); 
 }
					
int _t552_len = attrs.len;
					array_string _t552 = __new_array(0, _t552_len, sizeof(string));
					for (int i = 0; i < _t552_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t552, &it); 
 }
					
					int _t551_len =  _t552.len;
					array_array_string _t551 = __new_array(0, _t551_len, sizeof(array_string));
					for (int _t553 = 0; _t553 < _t551_len; ++_t553) {
						string it = ((string*)  _t554.data)[_t553];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t551, &ti);
					}
										route_words_a = _t551;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t558_len = attrs.len;
					array_string _t558 = __new_array(0, _t558_len, sizeof(string));
					for (int i = 0; i < _t558_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t558, &it); 
 }
					
int _t556_len = attrs.len;
					array_string _t556 = __new_array(0, _t556_len, sizeof(string));
					for (int i = 0; i < _t556_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t556, &it); 
 }
					
					int _t555_len =  _t556.len;
					array_array_string _t555 = __new_array(0, _t555_len, sizeof(array_string));
					for (int _t557 = 0; _t557 < _t555_len; ++_t557) {
						string it = ((string*)  _t558.data)[_t557];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t555, &ti);
					}
										route_words_a = _t555;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t562_len = attrs.len;
					array_string _t562 = __new_array(0, _t562_len, sizeof(string));
					for (int i = 0; i < _t562_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t562, &it); 
 }
					
int _t560_len = attrs.len;
					array_string _t560 = __new_array(0, _t560_len, sizeof(string));
					for (int i = 0; i < _t560_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t560, &it); 
 }
					
					int _t559_len =  _t560.len;
					array_array_string _t559 = __new_array(0, _t559_len, sizeof(array_string));
					for (int _t561 = 0; _t561 < _t559_len; ++_t561) {
						string it = ((string*)  _t562.data)[_t561];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t559, &ti);
					}
										route_words_a = _t559;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t566_len = attrs.len;
					array_string _t566 = __new_array(0, _t566_len, sizeof(string));
					for (int i = 0; i < _t566_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t566, &it); 
 }
					
int _t564_len = attrs.len;
					array_string _t564 = __new_array(0, _t564_len, sizeof(string));
					for (int i = 0; i < _t564_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t564, &it); 
 }
					
					int _t563_len =  _t564.len;
					array_array_string _t563 = __new_array(0, _t563_len, sizeof(array_string));
					for (int _t565 = 0; _t565 < _t563_len; ++_t565) {
						string it = ((string*)  _t566.data)[_t565];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t563, &ti);
					}
										route_words_a = _t563;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t570_len = attrs.len;
					array_string _t570 = __new_array(0, _t570_len, sizeof(string));
					for (int i = 0; i < _t570_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t570, &it); 
 }
					
int _t568_len = attrs.len;
					array_string _t568 = __new_array(0, _t568_len, sizeof(string));
					for (int i = 0; i < _t568_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t568, &it); 
 }
					
					int _t567_len =  _t568.len;
					array_array_string _t567 = __new_array(0, _t567_len, sizeof(array_string));
					for (int _t569 = 0; _t569 < _t567_len; ++_t569) {
						string it = ((string*)  _t570.data)[_t569];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t567, &ti);
					}
										route_words_a = _t567;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t574_len = attrs.len;
					array_string _t574 = __new_array(0, _t574_len, sizeof(string));
					for (int i = 0; i < _t574_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t574, &it); 
 }
					
int _t572_len = attrs.len;
					array_string _t572 = __new_array(0, _t572_len, sizeof(string));
					for (int i = 0; i < _t572_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t572, &it); 
 }
					
					int _t571_len =  _t572.len;
					array_array_string _t571 = __new_array(0, _t571_len, sizeof(array_string));
					for (int _t573 = 0; _t573 < _t571_len; ++_t573) {
						string it = ((string*)  _t574.data)[_t573];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t571, &ti);
					}
										route_words_a = _t571;
				}
			} else {

int _t578_len = attrs.len;
				array_string _t578 = __new_array(0, _t578_len, sizeof(string));
				for (int i = 0; i < _t578_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t578, &it); 
 }
				
int _t576_len = attrs.len;
				array_string _t576 = __new_array(0, _t576_len, sizeof(string));
				for (int i = 0; i < _t576_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t576, &it); 
 }
				
				int _t575_len =  _t576.len;
				array_array_string _t575 = __new_array(0, _t575_len, sizeof(array_string));
				for (int _t577 = 0; _t577 < _t575_len; ++_t577) {
					string it = ((string*)  _t578.data)[_t577];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t575, &ti);
				}
								route_words_a = _t575;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t579 = route_words_a;
				for (int _t580 = 0; _t580 < _t579.len; ++_t580) {
					array_string route_words = ((array_string*)_t579.data)[_t580];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_git_info(app ); // vweb action call with args;
							// Defer begin
							Option_int _t584 = net__Socket_close(conn);
							if (!_t584.ok) {
								string err = _t584.v_error;
								int errcode = _t584.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 2
	method = tos_lit("r_home");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_r_home(app ); // vweb action call with args;
				// Defer begin
				Option_int _t585 = net__Socket_close(conn);
				if (!_t585.ok) {
					string err = _t585.v_error;
					int errcode = _t585.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t589_len = attrs.len;
					array_string _t589 = __new_array(0, _t589_len, sizeof(string));
					for (int i = 0; i < _t589_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t589, &it); 
 }
					
int _t587_len = attrs.len;
					array_string _t587 = __new_array(0, _t587_len, sizeof(string));
					for (int i = 0; i < _t587_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t587, &it); 
 }
					
					int _t586_len =  _t587.len;
					array_array_string _t586 = __new_array(0, _t586_len, sizeof(array_string));
					for (int _t588 = 0; _t588 < _t586_len; ++_t588) {
						string it = ((string*)  _t589.data)[_t588];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t586, &ti);
					}
										route_words_a = _t586;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t593_len = attrs.len;
					array_string _t593 = __new_array(0, _t593_len, sizeof(string));
					for (int i = 0; i < _t593_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t593, &it); 
 }
					
int _t591_len = attrs.len;
					array_string _t591 = __new_array(0, _t591_len, sizeof(string));
					for (int i = 0; i < _t591_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t591, &it); 
 }
					
					int _t590_len =  _t591.len;
					array_array_string _t590 = __new_array(0, _t590_len, sizeof(array_string));
					for (int _t592 = 0; _t592 < _t590_len; ++_t592) {
						string it = ((string*)  _t593.data)[_t592];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t590, &ti);
					}
										route_words_a = _t590;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t597_len = attrs.len;
					array_string _t597 = __new_array(0, _t597_len, sizeof(string));
					for (int i = 0; i < _t597_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t597, &it); 
 }
					
int _t595_len = attrs.len;
					array_string _t595 = __new_array(0, _t595_len, sizeof(string));
					for (int i = 0; i < _t595_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t595, &it); 
 }
					
					int _t594_len =  _t595.len;
					array_array_string _t594 = __new_array(0, _t594_len, sizeof(array_string));
					for (int _t596 = 0; _t596 < _t594_len; ++_t596) {
						string it = ((string*)  _t597.data)[_t596];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t594, &ti);
					}
										route_words_a = _t594;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t601_len = attrs.len;
					array_string _t601 = __new_array(0, _t601_len, sizeof(string));
					for (int i = 0; i < _t601_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t601, &it); 
 }
					
int _t599_len = attrs.len;
					array_string _t599 = __new_array(0, _t599_len, sizeof(string));
					for (int i = 0; i < _t599_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t599, &it); 
 }
					
					int _t598_len =  _t599.len;
					array_array_string _t598 = __new_array(0, _t598_len, sizeof(array_string));
					for (int _t600 = 0; _t600 < _t598_len; ++_t600) {
						string it = ((string*)  _t601.data)[_t600];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t598, &ti);
					}
										route_words_a = _t598;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t605_len = attrs.len;
					array_string _t605 = __new_array(0, _t605_len, sizeof(string));
					for (int i = 0; i < _t605_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t605, &it); 
 }
					
int _t603_len = attrs.len;
					array_string _t603 = __new_array(0, _t603_len, sizeof(string));
					for (int i = 0; i < _t603_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t603, &it); 
 }
					
					int _t602_len =  _t603.len;
					array_array_string _t602 = __new_array(0, _t602_len, sizeof(array_string));
					for (int _t604 = 0; _t604 < _t602_len; ++_t604) {
						string it = ((string*)  _t605.data)[_t604];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t602, &ti);
					}
										route_words_a = _t602;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t609_len = attrs.len;
					array_string _t609 = __new_array(0, _t609_len, sizeof(string));
					for (int i = 0; i < _t609_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t609, &it); 
 }
					
int _t607_len = attrs.len;
					array_string _t607 = __new_array(0, _t607_len, sizeof(string));
					for (int i = 0; i < _t607_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t607, &it); 
 }
					
					int _t606_len =  _t607.len;
					array_array_string _t606 = __new_array(0, _t606_len, sizeof(array_string));
					for (int _t608 = 0; _t608 < _t606_len; ++_t608) {
						string it = ((string*)  _t609.data)[_t608];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t606, &ti);
					}
										route_words_a = _t606;
				}
			} else {

int _t613_len = attrs.len;
				array_string _t613 = __new_array(0, _t613_len, sizeof(string));
				for (int i = 0; i < _t613_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t613, &it); 
 }
				
int _t611_len = attrs.len;
				array_string _t611 = __new_array(0, _t611_len, sizeof(string));
				for (int i = 0; i < _t611_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t611, &it); 
 }
				
				int _t610_len =  _t611.len;
				array_array_string _t610 = __new_array(0, _t610_len, sizeof(array_string));
				for (int _t612 = 0; _t612 < _t610_len; ++_t612) {
					string it = ((string*)  _t613.data)[_t612];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t610, &ti);
				}
								route_words_a = _t610;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t614 = route_words_a;
				for (int _t615 = 0; _t615 < _t614.len; ++_t615) {
					array_string route_words = ((array_string*)_t614.data)[_t615];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_r_home(app ); // vweb action call with args;
							// Defer begin
							Option_int _t619 = net__Socket_close(conn);
							if (!_t619.ok) {
								string err = _t619.v_error;
								int errcode = _t619.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 3
	method = tos_lit("r_repo");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_r_repo(app ); // vweb action call with args;
				// Defer begin
				Option_int _t620 = net__Socket_close(conn);
				if (!_t620.ok) {
					string err = _t620.v_error;
					int errcode = _t620.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t624_len = attrs.len;
					array_string _t624 = __new_array(0, _t624_len, sizeof(string));
					for (int i = 0; i < _t624_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t624, &it); 
 }
					
int _t622_len = attrs.len;
					array_string _t622 = __new_array(0, _t622_len, sizeof(string));
					for (int i = 0; i < _t622_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t622, &it); 
 }
					
					int _t621_len =  _t622.len;
					array_array_string _t621 = __new_array(0, _t621_len, sizeof(array_string));
					for (int _t623 = 0; _t623 < _t621_len; ++_t623) {
						string it = ((string*)  _t624.data)[_t623];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t621, &ti);
					}
										route_words_a = _t621;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t628_len = attrs.len;
					array_string _t628 = __new_array(0, _t628_len, sizeof(string));
					for (int i = 0; i < _t628_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t628, &it); 
 }
					
int _t626_len = attrs.len;
					array_string _t626 = __new_array(0, _t626_len, sizeof(string));
					for (int i = 0; i < _t626_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t626, &it); 
 }
					
					int _t625_len =  _t626.len;
					array_array_string _t625 = __new_array(0, _t625_len, sizeof(array_string));
					for (int _t627 = 0; _t627 < _t625_len; ++_t627) {
						string it = ((string*)  _t628.data)[_t627];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t625, &ti);
					}
										route_words_a = _t625;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t632_len = attrs.len;
					array_string _t632 = __new_array(0, _t632_len, sizeof(string));
					for (int i = 0; i < _t632_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t632, &it); 
 }
					
int _t630_len = attrs.len;
					array_string _t630 = __new_array(0, _t630_len, sizeof(string));
					for (int i = 0; i < _t630_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t630, &it); 
 }
					
					int _t629_len =  _t630.len;
					array_array_string _t629 = __new_array(0, _t629_len, sizeof(array_string));
					for (int _t631 = 0; _t631 < _t629_len; ++_t631) {
						string it = ((string*)  _t632.data)[_t631];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t629, &ti);
					}
										route_words_a = _t629;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t636_len = attrs.len;
					array_string _t636 = __new_array(0, _t636_len, sizeof(string));
					for (int i = 0; i < _t636_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t636, &it); 
 }
					
int _t634_len = attrs.len;
					array_string _t634 = __new_array(0, _t634_len, sizeof(string));
					for (int i = 0; i < _t634_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t634, &it); 
 }
					
					int _t633_len =  _t634.len;
					array_array_string _t633 = __new_array(0, _t633_len, sizeof(array_string));
					for (int _t635 = 0; _t635 < _t633_len; ++_t635) {
						string it = ((string*)  _t636.data)[_t635];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t633, &ti);
					}
										route_words_a = _t633;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t640_len = attrs.len;
					array_string _t640 = __new_array(0, _t640_len, sizeof(string));
					for (int i = 0; i < _t640_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t640, &it); 
 }
					
int _t638_len = attrs.len;
					array_string _t638 = __new_array(0, _t638_len, sizeof(string));
					for (int i = 0; i < _t638_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t638, &it); 
 }
					
					int _t637_len =  _t638.len;
					array_array_string _t637 = __new_array(0, _t637_len, sizeof(array_string));
					for (int _t639 = 0; _t639 < _t637_len; ++_t639) {
						string it = ((string*)  _t640.data)[_t639];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t637, &ti);
					}
										route_words_a = _t637;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t644_len = attrs.len;
					array_string _t644 = __new_array(0, _t644_len, sizeof(string));
					for (int i = 0; i < _t644_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t644, &it); 
 }
					
int _t642_len = attrs.len;
					array_string _t642 = __new_array(0, _t642_len, sizeof(string));
					for (int i = 0; i < _t642_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t642, &it); 
 }
					
					int _t641_len =  _t642.len;
					array_array_string _t641 = __new_array(0, _t641_len, sizeof(array_string));
					for (int _t643 = 0; _t643 < _t641_len; ++_t643) {
						string it = ((string*)  _t644.data)[_t643];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t641, &ti);
					}
										route_words_a = _t641;
				}
			} else {

int _t648_len = attrs.len;
				array_string _t648 = __new_array(0, _t648_len, sizeof(string));
				for (int i = 0; i < _t648_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t648, &it); 
 }
				
int _t646_len = attrs.len;
				array_string _t646 = __new_array(0, _t646_len, sizeof(string));
				for (int i = 0; i < _t646_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t646, &it); 
 }
				
				int _t645_len =  _t646.len;
				array_array_string _t645 = __new_array(0, _t645_len, sizeof(array_string));
				for (int _t647 = 0; _t647 < _t645_len; ++_t647) {
					string it = ((string*)  _t648.data)[_t647];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t645, &ti);
				}
								route_words_a = _t645;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t649 = route_words_a;
				for (int _t650 = 0; _t650 < _t649.len; ++_t650) {
					array_string route_words = ((array_string*)_t649.data)[_t650];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_r_repo(app ); // vweb action call with args;
							// Defer begin
							Option_int _t654 = net__Socket_close(conn);
							if (!_t654.ok) {
								string err = _t654.v_error;
								int errcode = _t654.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 4
	method = tos_lit("index");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_index(app ); // vweb action call with args;
				// Defer begin
				Option_int _t655 = net__Socket_close(conn);
				if (!_t655.ok) {
					string err = _t655.v_error;
					int errcode = _t655.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t659_len = attrs.len;
					array_string _t659 = __new_array(0, _t659_len, sizeof(string));
					for (int i = 0; i < _t659_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t659, &it); 
 }
					
int _t657_len = attrs.len;
					array_string _t657 = __new_array(0, _t657_len, sizeof(string));
					for (int i = 0; i < _t657_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t657, &it); 
 }
					
					int _t656_len =  _t657.len;
					array_array_string _t656 = __new_array(0, _t656_len, sizeof(array_string));
					for (int _t658 = 0; _t658 < _t656_len; ++_t658) {
						string it = ((string*)  _t659.data)[_t658];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t656, &ti);
					}
										route_words_a = _t656;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t663_len = attrs.len;
					array_string _t663 = __new_array(0, _t663_len, sizeof(string));
					for (int i = 0; i < _t663_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t663, &it); 
 }
					
int _t661_len = attrs.len;
					array_string _t661 = __new_array(0, _t661_len, sizeof(string));
					for (int i = 0; i < _t661_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t661, &it); 
 }
					
					int _t660_len =  _t661.len;
					array_array_string _t660 = __new_array(0, _t660_len, sizeof(array_string));
					for (int _t662 = 0; _t662 < _t660_len; ++_t662) {
						string it = ((string*)  _t663.data)[_t662];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t660, &ti);
					}
										route_words_a = _t660;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t667_len = attrs.len;
					array_string _t667 = __new_array(0, _t667_len, sizeof(string));
					for (int i = 0; i < _t667_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t667, &it); 
 }
					
int _t665_len = attrs.len;
					array_string _t665 = __new_array(0, _t665_len, sizeof(string));
					for (int i = 0; i < _t665_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t665, &it); 
 }
					
					int _t664_len =  _t665.len;
					array_array_string _t664 = __new_array(0, _t664_len, sizeof(array_string));
					for (int _t666 = 0; _t666 < _t664_len; ++_t666) {
						string it = ((string*)  _t667.data)[_t666];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t664, &ti);
					}
										route_words_a = _t664;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t671_len = attrs.len;
					array_string _t671 = __new_array(0, _t671_len, sizeof(string));
					for (int i = 0; i < _t671_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t671, &it); 
 }
					
int _t669_len = attrs.len;
					array_string _t669 = __new_array(0, _t669_len, sizeof(string));
					for (int i = 0; i < _t669_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t669, &it); 
 }
					
					int _t668_len =  _t669.len;
					array_array_string _t668 = __new_array(0, _t668_len, sizeof(array_string));
					for (int _t670 = 0; _t670 < _t668_len; ++_t670) {
						string it = ((string*)  _t671.data)[_t670];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t668, &ti);
					}
										route_words_a = _t668;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t675_len = attrs.len;
					array_string _t675 = __new_array(0, _t675_len, sizeof(string));
					for (int i = 0; i < _t675_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t675, &it); 
 }
					
int _t673_len = attrs.len;
					array_string _t673 = __new_array(0, _t673_len, sizeof(string));
					for (int i = 0; i < _t673_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t673, &it); 
 }
					
					int _t672_len =  _t673.len;
					array_array_string _t672 = __new_array(0, _t672_len, sizeof(array_string));
					for (int _t674 = 0; _t674 < _t672_len; ++_t674) {
						string it = ((string*)  _t675.data)[_t674];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t672, &ti);
					}
										route_words_a = _t672;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t679_len = attrs.len;
					array_string _t679 = __new_array(0, _t679_len, sizeof(string));
					for (int i = 0; i < _t679_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t679, &it); 
 }
					
int _t677_len = attrs.len;
					array_string _t677 = __new_array(0, _t677_len, sizeof(string));
					for (int i = 0; i < _t677_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t677, &it); 
 }
					
					int _t676_len =  _t677.len;
					array_array_string _t676 = __new_array(0, _t676_len, sizeof(array_string));
					for (int _t678 = 0; _t678 < _t676_len; ++_t678) {
						string it = ((string*)  _t679.data)[_t678];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t676, &ti);
					}
										route_words_a = _t676;
				}
			} else {

int _t683_len = attrs.len;
				array_string _t683 = __new_array(0, _t683_len, sizeof(string));
				for (int i = 0; i < _t683_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t683, &it); 
 }
				
int _t681_len = attrs.len;
				array_string _t681 = __new_array(0, _t681_len, sizeof(string));
				for (int i = 0; i < _t681_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t681, &it); 
 }
				
				int _t680_len =  _t681.len;
				array_array_string _t680 = __new_array(0, _t680_len, sizeof(array_string));
				for (int _t682 = 0; _t682 < _t680_len; ++_t682) {
					string it = ((string*)  _t683.data)[_t682];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t680, &ti);
				}
								route_words_a = _t680;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t684 = route_words_a;
				for (int _t685 = 0; _t685 < _t684.len; ++_t685) {
					array_string route_words = ((array_string*)_t684.data)[_t685];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_index(app ); // vweb action call with args;
							// Defer begin
							Option_int _t689 = net__Socket_close(conn);
							if (!_t689.ok) {
								string err = _t689.v_error;
								int errcode = _t689.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 5
	method = tos_lit("pulls");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_pulls(app ); // vweb action call with args;
				// Defer begin
				Option_int _t690 = net__Socket_close(conn);
				if (!_t690.ok) {
					string err = _t690.v_error;
					int errcode = _t690.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t694_len = attrs.len;
					array_string _t694 = __new_array(0, _t694_len, sizeof(string));
					for (int i = 0; i < _t694_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t694, &it); 
 }
					
int _t692_len = attrs.len;
					array_string _t692 = __new_array(0, _t692_len, sizeof(string));
					for (int i = 0; i < _t692_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t692, &it); 
 }
					
					int _t691_len =  _t692.len;
					array_array_string _t691 = __new_array(0, _t691_len, sizeof(array_string));
					for (int _t693 = 0; _t693 < _t691_len; ++_t693) {
						string it = ((string*)  _t694.data)[_t693];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t691, &ti);
					}
										route_words_a = _t691;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t698_len = attrs.len;
					array_string _t698 = __new_array(0, _t698_len, sizeof(string));
					for (int i = 0; i < _t698_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t698, &it); 
 }
					
int _t696_len = attrs.len;
					array_string _t696 = __new_array(0, _t696_len, sizeof(string));
					for (int i = 0; i < _t696_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t696, &it); 
 }
					
					int _t695_len =  _t696.len;
					array_array_string _t695 = __new_array(0, _t695_len, sizeof(array_string));
					for (int _t697 = 0; _t697 < _t695_len; ++_t697) {
						string it = ((string*)  _t698.data)[_t697];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t695, &ti);
					}
										route_words_a = _t695;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t702_len = attrs.len;
					array_string _t702 = __new_array(0, _t702_len, sizeof(string));
					for (int i = 0; i < _t702_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t702, &it); 
 }
					
int _t700_len = attrs.len;
					array_string _t700 = __new_array(0, _t700_len, sizeof(string));
					for (int i = 0; i < _t700_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t700, &it); 
 }
					
					int _t699_len =  _t700.len;
					array_array_string _t699 = __new_array(0, _t699_len, sizeof(array_string));
					for (int _t701 = 0; _t701 < _t699_len; ++_t701) {
						string it = ((string*)  _t702.data)[_t701];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t699, &ti);
					}
										route_words_a = _t699;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t706_len = attrs.len;
					array_string _t706 = __new_array(0, _t706_len, sizeof(string));
					for (int i = 0; i < _t706_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t706, &it); 
 }
					
int _t704_len = attrs.len;
					array_string _t704 = __new_array(0, _t704_len, sizeof(string));
					for (int i = 0; i < _t704_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t704, &it); 
 }
					
					int _t703_len =  _t704.len;
					array_array_string _t703 = __new_array(0, _t703_len, sizeof(array_string));
					for (int _t705 = 0; _t705 < _t703_len; ++_t705) {
						string it = ((string*)  _t706.data)[_t705];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t703, &ti);
					}
										route_words_a = _t703;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t710_len = attrs.len;
					array_string _t710 = __new_array(0, _t710_len, sizeof(string));
					for (int i = 0; i < _t710_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t710, &it); 
 }
					
int _t708_len = attrs.len;
					array_string _t708 = __new_array(0, _t708_len, sizeof(string));
					for (int i = 0; i < _t708_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t708, &it); 
 }
					
					int _t707_len =  _t708.len;
					array_array_string _t707 = __new_array(0, _t707_len, sizeof(array_string));
					for (int _t709 = 0; _t709 < _t707_len; ++_t709) {
						string it = ((string*)  _t710.data)[_t709];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t707, &ti);
					}
										route_words_a = _t707;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t714_len = attrs.len;
					array_string _t714 = __new_array(0, _t714_len, sizeof(string));
					for (int i = 0; i < _t714_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t714, &it); 
 }
					
int _t712_len = attrs.len;
					array_string _t712 = __new_array(0, _t712_len, sizeof(string));
					for (int i = 0; i < _t712_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t712, &it); 
 }
					
					int _t711_len =  _t712.len;
					array_array_string _t711 = __new_array(0, _t711_len, sizeof(array_string));
					for (int _t713 = 0; _t713 < _t711_len; ++_t713) {
						string it = ((string*)  _t714.data)[_t713];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t711, &ti);
					}
										route_words_a = _t711;
				}
			} else {

int _t718_len = attrs.len;
				array_string _t718 = __new_array(0, _t718_len, sizeof(string));
				for (int i = 0; i < _t718_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t718, &it); 
 }
				
int _t716_len = attrs.len;
				array_string _t716 = __new_array(0, _t716_len, sizeof(string));
				for (int i = 0; i < _t716_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t716, &it); 
 }
				
				int _t715_len =  _t716.len;
				array_array_string _t715 = __new_array(0, _t715_len, sizeof(array_string));
				for (int _t717 = 0; _t717 < _t715_len; ++_t717) {
					string it = ((string*)  _t718.data)[_t717];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t715, &ti);
				}
								route_words_a = _t715;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t719 = route_words_a;
				for (int _t720 = 0; _t720 < _t719.len; ++_t720) {
					array_string route_words = ((array_string*)_t719.data)[_t720];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_pulls(app ); // vweb action call with args;
							// Defer begin
							Option_int _t724 = net__Socket_close(conn);
							if (!_t724.ok) {
								string err = _t724.v_error;
								int errcode = _t724.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 6
	method = tos_lit("logout");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_logout(app ); // vweb action call with args;
				// Defer begin
				Option_int _t725 = net__Socket_close(conn);
				if (!_t725.ok) {
					string err = _t725.v_error;
					int errcode = _t725.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t729_len = attrs.len;
					array_string _t729 = __new_array(0, _t729_len, sizeof(string));
					for (int i = 0; i < _t729_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t729, &it); 
 }
					
int _t727_len = attrs.len;
					array_string _t727 = __new_array(0, _t727_len, sizeof(string));
					for (int i = 0; i < _t727_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t727, &it); 
 }
					
					int _t726_len =  _t727.len;
					array_array_string _t726 = __new_array(0, _t726_len, sizeof(array_string));
					for (int _t728 = 0; _t728 < _t726_len; ++_t728) {
						string it = ((string*)  _t729.data)[_t728];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t726, &ti);
					}
										route_words_a = _t726;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t733_len = attrs.len;
					array_string _t733 = __new_array(0, _t733_len, sizeof(string));
					for (int i = 0; i < _t733_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t733, &it); 
 }
					
int _t731_len = attrs.len;
					array_string _t731 = __new_array(0, _t731_len, sizeof(string));
					for (int i = 0; i < _t731_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t731, &it); 
 }
					
					int _t730_len =  _t731.len;
					array_array_string _t730 = __new_array(0, _t730_len, sizeof(array_string));
					for (int _t732 = 0; _t732 < _t730_len; ++_t732) {
						string it = ((string*)  _t733.data)[_t732];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t730, &ti);
					}
										route_words_a = _t730;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t737_len = attrs.len;
					array_string _t737 = __new_array(0, _t737_len, sizeof(string));
					for (int i = 0; i < _t737_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t737, &it); 
 }
					
int _t735_len = attrs.len;
					array_string _t735 = __new_array(0, _t735_len, sizeof(string));
					for (int i = 0; i < _t735_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t735, &it); 
 }
					
					int _t734_len =  _t735.len;
					array_array_string _t734 = __new_array(0, _t734_len, sizeof(array_string));
					for (int _t736 = 0; _t736 < _t734_len; ++_t736) {
						string it = ((string*)  _t737.data)[_t736];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t734, &ti);
					}
										route_words_a = _t734;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t741_len = attrs.len;
					array_string _t741 = __new_array(0, _t741_len, sizeof(string));
					for (int i = 0; i < _t741_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t741, &it); 
 }
					
int _t739_len = attrs.len;
					array_string _t739 = __new_array(0, _t739_len, sizeof(string));
					for (int i = 0; i < _t739_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t739, &it); 
 }
					
					int _t738_len =  _t739.len;
					array_array_string _t738 = __new_array(0, _t738_len, sizeof(array_string));
					for (int _t740 = 0; _t740 < _t738_len; ++_t740) {
						string it = ((string*)  _t741.data)[_t740];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t738, &ti);
					}
										route_words_a = _t738;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t745_len = attrs.len;
					array_string _t745 = __new_array(0, _t745_len, sizeof(string));
					for (int i = 0; i < _t745_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t745, &it); 
 }
					
int _t743_len = attrs.len;
					array_string _t743 = __new_array(0, _t743_len, sizeof(string));
					for (int i = 0; i < _t743_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t743, &it); 
 }
					
					int _t742_len =  _t743.len;
					array_array_string _t742 = __new_array(0, _t742_len, sizeof(array_string));
					for (int _t744 = 0; _t744 < _t742_len; ++_t744) {
						string it = ((string*)  _t745.data)[_t744];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t742, &ti);
					}
										route_words_a = _t742;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t749_len = attrs.len;
					array_string _t749 = __new_array(0, _t749_len, sizeof(string));
					for (int i = 0; i < _t749_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t749, &it); 
 }
					
int _t747_len = attrs.len;
					array_string _t747 = __new_array(0, _t747_len, sizeof(string));
					for (int i = 0; i < _t747_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t747, &it); 
 }
					
					int _t746_len =  _t747.len;
					array_array_string _t746 = __new_array(0, _t746_len, sizeof(array_string));
					for (int _t748 = 0; _t748 < _t746_len; ++_t748) {
						string it = ((string*)  _t749.data)[_t748];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t746, &ti);
					}
										route_words_a = _t746;
				}
			} else {

int _t753_len = attrs.len;
				array_string _t753 = __new_array(0, _t753_len, sizeof(string));
				for (int i = 0; i < _t753_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t753, &it); 
 }
				
int _t751_len = attrs.len;
				array_string _t751 = __new_array(0, _t751_len, sizeof(string));
				for (int i = 0; i < _t751_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t751, &it); 
 }
				
				int _t750_len =  _t751.len;
				array_array_string _t750 = __new_array(0, _t750_len, sizeof(array_string));
				for (int _t752 = 0; _t752 < _t750_len; ++_t752) {
					string it = ((string*)  _t753.data)[_t752];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t750, &ti);
				}
								route_words_a = _t750;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t754 = route_words_a;
				for (int _t755 = 0; _t755 < _t754.len; ++_t755) {
					array_string route_words = ((array_string*)_t754.data)[_t755];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_logout(app ); // vweb action call with args;
							// Defer begin
							Option_int _t759 = net__Socket_close(conn);
							if (!_t759.ok) {
								string err = _t759.v_error;
								int errcode = _t759.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 7
	method = tos_lit("oauth");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_oauth(app ); // vweb action call with args;
				// Defer begin
				Option_int _t760 = net__Socket_close(conn);
				if (!_t760.ok) {
					string err = _t760.v_error;
					int errcode = _t760.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t764_len = attrs.len;
					array_string _t764 = __new_array(0, _t764_len, sizeof(string));
					for (int i = 0; i < _t764_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t764, &it); 
 }
					
int _t762_len = attrs.len;
					array_string _t762 = __new_array(0, _t762_len, sizeof(string));
					for (int i = 0; i < _t762_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t762, &it); 
 }
					
					int _t761_len =  _t762.len;
					array_array_string _t761 = __new_array(0, _t761_len, sizeof(array_string));
					for (int _t763 = 0; _t763 < _t761_len; ++_t763) {
						string it = ((string*)  _t764.data)[_t763];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t761, &ti);
					}
										route_words_a = _t761;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t768_len = attrs.len;
					array_string _t768 = __new_array(0, _t768_len, sizeof(string));
					for (int i = 0; i < _t768_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t768, &it); 
 }
					
int _t766_len = attrs.len;
					array_string _t766 = __new_array(0, _t766_len, sizeof(string));
					for (int i = 0; i < _t766_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t766, &it); 
 }
					
					int _t765_len =  _t766.len;
					array_array_string _t765 = __new_array(0, _t765_len, sizeof(array_string));
					for (int _t767 = 0; _t767 < _t765_len; ++_t767) {
						string it = ((string*)  _t768.data)[_t767];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t765, &ti);
					}
										route_words_a = _t765;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t772_len = attrs.len;
					array_string _t772 = __new_array(0, _t772_len, sizeof(string));
					for (int i = 0; i < _t772_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t772, &it); 
 }
					
int _t770_len = attrs.len;
					array_string _t770 = __new_array(0, _t770_len, sizeof(string));
					for (int i = 0; i < _t770_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t770, &it); 
 }
					
					int _t769_len =  _t770.len;
					array_array_string _t769 = __new_array(0, _t769_len, sizeof(array_string));
					for (int _t771 = 0; _t771 < _t769_len; ++_t771) {
						string it = ((string*)  _t772.data)[_t771];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t769, &ti);
					}
										route_words_a = _t769;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t776_len = attrs.len;
					array_string _t776 = __new_array(0, _t776_len, sizeof(string));
					for (int i = 0; i < _t776_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t776, &it); 
 }
					
int _t774_len = attrs.len;
					array_string _t774 = __new_array(0, _t774_len, sizeof(string));
					for (int i = 0; i < _t774_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t774, &it); 
 }
					
					int _t773_len =  _t774.len;
					array_array_string _t773 = __new_array(0, _t773_len, sizeof(array_string));
					for (int _t775 = 0; _t775 < _t773_len; ++_t775) {
						string it = ((string*)  _t776.data)[_t775];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t773, &ti);
					}
										route_words_a = _t773;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t780_len = attrs.len;
					array_string _t780 = __new_array(0, _t780_len, sizeof(string));
					for (int i = 0; i < _t780_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t780, &it); 
 }
					
int _t778_len = attrs.len;
					array_string _t778 = __new_array(0, _t778_len, sizeof(string));
					for (int i = 0; i < _t778_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t778, &it); 
 }
					
					int _t777_len =  _t778.len;
					array_array_string _t777 = __new_array(0, _t777_len, sizeof(array_string));
					for (int _t779 = 0; _t779 < _t777_len; ++_t779) {
						string it = ((string*)  _t780.data)[_t779];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t777, &ti);
					}
										route_words_a = _t777;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t784_len = attrs.len;
					array_string _t784 = __new_array(0, _t784_len, sizeof(string));
					for (int i = 0; i < _t784_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t784, &it); 
 }
					
int _t782_len = attrs.len;
					array_string _t782 = __new_array(0, _t782_len, sizeof(string));
					for (int i = 0; i < _t782_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t782, &it); 
 }
					
					int _t781_len =  _t782.len;
					array_array_string _t781 = __new_array(0, _t781_len, sizeof(array_string));
					for (int _t783 = 0; _t783 < _t781_len; ++_t783) {
						string it = ((string*)  _t784.data)[_t783];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t781, &ti);
					}
										route_words_a = _t781;
				}
			} else {

int _t788_len = attrs.len;
				array_string _t788 = __new_array(0, _t788_len, sizeof(string));
				for (int i = 0; i < _t788_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t788, &it); 
 }
				
int _t786_len = attrs.len;
				array_string _t786 = __new_array(0, _t786_len, sizeof(string));
				for (int i = 0; i < _t786_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t786, &it); 
 }
				
				int _t785_len =  _t786.len;
				array_array_string _t785 = __new_array(0, _t785_len, sizeof(array_string));
				for (int _t787 = 0; _t787 < _t785_len; ++_t787) {
					string it = ((string*)  _t788.data)[_t787];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t785, &ti);
				}
								route_words_a = _t785;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t789 = route_words_a;
				for (int _t790 = 0; _t790 < _t789.len; ++_t790) {
					array_string route_words = ((array_string*)_t789.data)[_t790];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_oauth(app ); // vweb action call with args;
							// Defer begin
							Option_int _t794 = net__Socket_close(conn);
							if (!_t794.ok) {
								string err = _t794.v_error;
								int errcode = _t794.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 8
	method = tos_lit("admin_settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/admin/settings")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_admin_settings(app ); // vweb action call with args;
				// Defer begin
				Option_int _t795 = net__Socket_close(conn);
				if (!_t795.ok) {
					string err = _t795.v_error;
					int errcode = _t795.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t799_len = attrs.len;
					array_string _t799 = __new_array(0, _t799_len, sizeof(string));
					for (int i = 0; i < _t799_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t799, &it); 
 }
					
int _t797_len = attrs.len;
					array_string _t797 = __new_array(0, _t797_len, sizeof(string));
					for (int i = 0; i < _t797_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t797, &it); 
 }
					
					int _t796_len =  _t797.len;
					array_array_string _t796 = __new_array(0, _t796_len, sizeof(array_string));
					for (int _t798 = 0; _t798 < _t796_len; ++_t798) {
						string it = ((string*)  _t799.data)[_t798];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t796, &ti);
					}
										route_words_a = _t796;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t803_len = attrs.len;
					array_string _t803 = __new_array(0, _t803_len, sizeof(string));
					for (int i = 0; i < _t803_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t803, &it); 
 }
					
int _t801_len = attrs.len;
					array_string _t801 = __new_array(0, _t801_len, sizeof(string));
					for (int i = 0; i < _t801_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t801, &it); 
 }
					
					int _t800_len =  _t801.len;
					array_array_string _t800 = __new_array(0, _t800_len, sizeof(array_string));
					for (int _t802 = 0; _t802 < _t800_len; ++_t802) {
						string it = ((string*)  _t803.data)[_t802];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t800, &ti);
					}
										route_words_a = _t800;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t807_len = attrs.len;
					array_string _t807 = __new_array(0, _t807_len, sizeof(string));
					for (int i = 0; i < _t807_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t807, &it); 
 }
					
int _t805_len = attrs.len;
					array_string _t805 = __new_array(0, _t805_len, sizeof(string));
					for (int i = 0; i < _t805_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t805, &it); 
 }
					
					int _t804_len =  _t805.len;
					array_array_string _t804 = __new_array(0, _t804_len, sizeof(array_string));
					for (int _t806 = 0; _t806 < _t804_len; ++_t806) {
						string it = ((string*)  _t807.data)[_t806];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t804, &ti);
					}
										route_words_a = _t804;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t811_len = attrs.len;
					array_string _t811 = __new_array(0, _t811_len, sizeof(string));
					for (int i = 0; i < _t811_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t811, &it); 
 }
					
int _t809_len = attrs.len;
					array_string _t809 = __new_array(0, _t809_len, sizeof(string));
					for (int i = 0; i < _t809_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t809, &it); 
 }
					
					int _t808_len =  _t809.len;
					array_array_string _t808 = __new_array(0, _t808_len, sizeof(array_string));
					for (int _t810 = 0; _t810 < _t808_len; ++_t810) {
						string it = ((string*)  _t811.data)[_t810];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t808, &ti);
					}
										route_words_a = _t808;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t815_len = attrs.len;
					array_string _t815 = __new_array(0, _t815_len, sizeof(string));
					for (int i = 0; i < _t815_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t815, &it); 
 }
					
int _t813_len = attrs.len;
					array_string _t813 = __new_array(0, _t813_len, sizeof(string));
					for (int i = 0; i < _t813_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t813, &it); 
 }
					
					int _t812_len =  _t813.len;
					array_array_string _t812 = __new_array(0, _t812_len, sizeof(array_string));
					for (int _t814 = 0; _t814 < _t812_len; ++_t814) {
						string it = ((string*)  _t815.data)[_t814];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t812, &ti);
					}
										route_words_a = _t812;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t819_len = attrs.len;
					array_string _t819 = __new_array(0, _t819_len, sizeof(string));
					for (int i = 0; i < _t819_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t819, &it); 
 }
					
int _t817_len = attrs.len;
					array_string _t817 = __new_array(0, _t817_len, sizeof(string));
					for (int i = 0; i < _t817_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t817, &it); 
 }
					
					int _t816_len =  _t817.len;
					array_array_string _t816 = __new_array(0, _t816_len, sizeof(array_string));
					for (int _t818 = 0; _t818 < _t816_len; ++_t818) {
						string it = ((string*)  _t819.data)[_t818];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t816, &ti);
					}
										route_words_a = _t816;
				}
			} else {

int _t823_len = attrs.len;
				array_string _t823 = __new_array(0, _t823_len, sizeof(string));
				for (int i = 0; i < _t823_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t823, &it); 
 }
				
int _t821_len = attrs.len;
				array_string _t821 = __new_array(0, _t821_len, sizeof(string));
				for (int i = 0; i < _t821_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t821, &it); 
 }
				
				int _t820_len =  _t821.len;
				array_array_string _t820 = __new_array(0, _t820_len, sizeof(array_string));
				for (int _t822 = 0; _t822 < _t820_len; ++_t822) {
					string it = ((string*)  _t823.data)[_t822];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t820, &ti);
				}
								route_words_a = _t820;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t824 = route_words_a;
				for (int _t825 = 0; _t825 < _t824.len; ++_t825) {
					array_string route_words = ((array_string*)_t824.data)[_t825];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_admin_settings(app ); // vweb action call with args;
							// Defer begin
							Option_int _t829 = net__Socket_close(conn);
							if (!_t829.ok) {
								string err = _t829.v_error;
								int errcode = _t829.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 9
	method = tos_lit("update_admin_settings");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/admin/settings")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_update_admin_settings(app ); // vweb action call with args;
				// Defer begin
				Option_int _t830 = net__Socket_close(conn);
				if (!_t830.ok) {
					string err = _t830.v_error;
					int errcode = _t830.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t834_len = attrs.len;
					array_string _t834 = __new_array(0, _t834_len, sizeof(string));
					for (int i = 0; i < _t834_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t834, &it); 
 }
					
int _t832_len = attrs.len;
					array_string _t832 = __new_array(0, _t832_len, sizeof(string));
					for (int i = 0; i < _t832_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t832, &it); 
 }
					
					int _t831_len =  _t832.len;
					array_array_string _t831 = __new_array(0, _t831_len, sizeof(array_string));
					for (int _t833 = 0; _t833 < _t831_len; ++_t833) {
						string it = ((string*)  _t834.data)[_t833];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t831, &ti);
					}
										route_words_a = _t831;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t838_len = attrs.len;
					array_string _t838 = __new_array(0, _t838_len, sizeof(string));
					for (int i = 0; i < _t838_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t838, &it); 
 }
					
int _t836_len = attrs.len;
					array_string _t836 = __new_array(0, _t836_len, sizeof(string));
					for (int i = 0; i < _t836_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t836, &it); 
 }
					
					int _t835_len =  _t836.len;
					array_array_string _t835 = __new_array(0, _t835_len, sizeof(array_string));
					for (int _t837 = 0; _t837 < _t835_len; ++_t837) {
						string it = ((string*)  _t838.data)[_t837];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t835, &ti);
					}
										route_words_a = _t835;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t842_len = attrs.len;
					array_string _t842 = __new_array(0, _t842_len, sizeof(string));
					for (int i = 0; i < _t842_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t842, &it); 
 }
					
int _t840_len = attrs.len;
					array_string _t840 = __new_array(0, _t840_len, sizeof(string));
					for (int i = 0; i < _t840_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t840, &it); 
 }
					
					int _t839_len =  _t840.len;
					array_array_string _t839 = __new_array(0, _t839_len, sizeof(array_string));
					for (int _t841 = 0; _t841 < _t839_len; ++_t841) {
						string it = ((string*)  _t842.data)[_t841];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t839, &ti);
					}
										route_words_a = _t839;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t846_len = attrs.len;
					array_string _t846 = __new_array(0, _t846_len, sizeof(string));
					for (int i = 0; i < _t846_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t846, &it); 
 }
					
int _t844_len = attrs.len;
					array_string _t844 = __new_array(0, _t844_len, sizeof(string));
					for (int i = 0; i < _t844_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t844, &it); 
 }
					
					int _t843_len =  _t844.len;
					array_array_string _t843 = __new_array(0, _t843_len, sizeof(array_string));
					for (int _t845 = 0; _t845 < _t843_len; ++_t845) {
						string it = ((string*)  _t846.data)[_t845];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t843, &ti);
					}
										route_words_a = _t843;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t850_len = attrs.len;
					array_string _t850 = __new_array(0, _t850_len, sizeof(string));
					for (int i = 0; i < _t850_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t850, &it); 
 }
					
int _t848_len = attrs.len;
					array_string _t848 = __new_array(0, _t848_len, sizeof(string));
					for (int i = 0; i < _t848_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t848, &it); 
 }
					
					int _t847_len =  _t848.len;
					array_array_string _t847 = __new_array(0, _t847_len, sizeof(array_string));
					for (int _t849 = 0; _t849 < _t847_len; ++_t849) {
						string it = ((string*)  _t850.data)[_t849];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t847, &ti);
					}
										route_words_a = _t847;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t854_len = attrs.len;
					array_string _t854 = __new_array(0, _t854_len, sizeof(string));
					for (int i = 0; i < _t854_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t854, &it); 
 }
					
int _t852_len = attrs.len;
					array_string _t852 = __new_array(0, _t852_len, sizeof(string));
					for (int i = 0; i < _t852_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t852, &it); 
 }
					
					int _t851_len =  _t852.len;
					array_array_string _t851 = __new_array(0, _t851_len, sizeof(array_string));
					for (int _t853 = 0; _t853 < _t851_len; ++_t853) {
						string it = ((string*)  _t854.data)[_t853];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t851, &ti);
					}
										route_words_a = _t851;
				}
			} else {

int _t858_len = attrs.len;
				array_string _t858 = __new_array(0, _t858_len, sizeof(string));
				for (int i = 0; i < _t858_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t858, &it); 
 }
				
int _t856_len = attrs.len;
				array_string _t856 = __new_array(0, _t856_len, sizeof(string));
				for (int i = 0; i < _t856_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t856, &it); 
 }
				
				int _t855_len =  _t856.len;
				array_array_string _t855 = __new_array(0, _t855_len, sizeof(array_string));
				for (int _t857 = 0; _t857 < _t855_len; ++_t857) {
					string it = ((string*)  _t858.data)[_t857];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t855, &ti);
				}
								route_words_a = _t855;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t859 = route_words_a;
				for (int _t860 = 0; _t860 < _t859.len; ++_t860) {
					array_string route_words = ((array_string*)_t859.data)[_t860];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_update_admin_settings(app ); // vweb action call with args;
							// Defer begin
							Option_int _t864 = net__Socket_close(conn);
							if (!_t864.ok) {
								string err = _t864.v_error;
								int errcode = _t864.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 10
	method = tos_lit("admin_userlist");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/admin/userlist")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_admin_userlist(app ); // vweb action call with args;
				// Defer begin
				Option_int _t865 = net__Socket_close(conn);
				if (!_t865.ok) {
					string err = _t865.v_error;
					int errcode = _t865.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t869_len = attrs.len;
					array_string _t869 = __new_array(0, _t869_len, sizeof(string));
					for (int i = 0; i < _t869_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t869, &it); 
 }
					
int _t867_len = attrs.len;
					array_string _t867 = __new_array(0, _t867_len, sizeof(string));
					for (int i = 0; i < _t867_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t867, &it); 
 }
					
					int _t866_len =  _t867.len;
					array_array_string _t866 = __new_array(0, _t866_len, sizeof(array_string));
					for (int _t868 = 0; _t868 < _t866_len; ++_t868) {
						string it = ((string*)  _t869.data)[_t868];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t866, &ti);
					}
										route_words_a = _t866;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t873_len = attrs.len;
					array_string _t873 = __new_array(0, _t873_len, sizeof(string));
					for (int i = 0; i < _t873_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t873, &it); 
 }
					
int _t871_len = attrs.len;
					array_string _t871 = __new_array(0, _t871_len, sizeof(string));
					for (int i = 0; i < _t871_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t871, &it); 
 }
					
					int _t870_len =  _t871.len;
					array_array_string _t870 = __new_array(0, _t870_len, sizeof(array_string));
					for (int _t872 = 0; _t872 < _t870_len; ++_t872) {
						string it = ((string*)  _t873.data)[_t872];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t870, &ti);
					}
										route_words_a = _t870;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t877_len = attrs.len;
					array_string _t877 = __new_array(0, _t877_len, sizeof(string));
					for (int i = 0; i < _t877_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t877, &it); 
 }
					
int _t875_len = attrs.len;
					array_string _t875 = __new_array(0, _t875_len, sizeof(string));
					for (int i = 0; i < _t875_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t875, &it); 
 }
					
					int _t874_len =  _t875.len;
					array_array_string _t874 = __new_array(0, _t874_len, sizeof(array_string));
					for (int _t876 = 0; _t876 < _t874_len; ++_t876) {
						string it = ((string*)  _t877.data)[_t876];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t874, &ti);
					}
										route_words_a = _t874;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t881_len = attrs.len;
					array_string _t881 = __new_array(0, _t881_len, sizeof(string));
					for (int i = 0; i < _t881_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t881, &it); 
 }
					
int _t879_len = attrs.len;
					array_string _t879 = __new_array(0, _t879_len, sizeof(string));
					for (int i = 0; i < _t879_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t879, &it); 
 }
					
					int _t878_len =  _t879.len;
					array_array_string _t878 = __new_array(0, _t878_len, sizeof(array_string));
					for (int _t880 = 0; _t880 < _t878_len; ++_t880) {
						string it = ((string*)  _t881.data)[_t880];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t878, &ti);
					}
										route_words_a = _t878;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t885_len = attrs.len;
					array_string _t885 = __new_array(0, _t885_len, sizeof(string));
					for (int i = 0; i < _t885_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t885, &it); 
 }
					
int _t883_len = attrs.len;
					array_string _t883 = __new_array(0, _t883_len, sizeof(string));
					for (int i = 0; i < _t883_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t883, &it); 
 }
					
					int _t882_len =  _t883.len;
					array_array_string _t882 = __new_array(0, _t882_len, sizeof(array_string));
					for (int _t884 = 0; _t884 < _t882_len; ++_t884) {
						string it = ((string*)  _t885.data)[_t884];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t882, &ti);
					}
										route_words_a = _t882;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t889_len = attrs.len;
					array_string _t889 = __new_array(0, _t889_len, sizeof(string));
					for (int i = 0; i < _t889_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t889, &it); 
 }
					
int _t887_len = attrs.len;
					array_string _t887 = __new_array(0, _t887_len, sizeof(string));
					for (int i = 0; i < _t887_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t887, &it); 
 }
					
					int _t886_len =  _t887.len;
					array_array_string _t886 = __new_array(0, _t886_len, sizeof(array_string));
					for (int _t888 = 0; _t888 < _t886_len; ++_t888) {
						string it = ((string*)  _t889.data)[_t888];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t886, &ti);
					}
										route_words_a = _t886;
				}
			} else {

int _t893_len = attrs.len;
				array_string _t893 = __new_array(0, _t893_len, sizeof(string));
				for (int i = 0; i < _t893_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t893, &it); 
 }
				
int _t891_len = attrs.len;
				array_string _t891 = __new_array(0, _t891_len, sizeof(string));
				for (int i = 0; i < _t891_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t891, &it); 
 }
				
				int _t890_len =  _t891.len;
				array_array_string _t890 = __new_array(0, _t890_len, sizeof(array_string));
				for (int _t892 = 0; _t892 < _t890_len; ++_t892) {
					string it = ((string*)  _t893.data)[_t892];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t890, &ti);
				}
								route_words_a = _t890;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t894 = route_words_a;
				for (int _t895 = 0; _t895 < _t894.len; ++_t895) {
					array_string route_words = ((array_string*)_t894.data)[_t895];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_admin_userlist(app ); // vweb action call with args;
							// Defer begin
							Option_int _t899 = net__Socket_close(conn);
							if (!_t899.ok) {
								string err = _t899.v_error;
								int errcode = _t899.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 11
	method = tos_lit("admin_edituser");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/admin/edituser/:user")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_admin_edituser(app,  ); // vweb action call with args;
				// Defer begin
				Option_int _t900 = net__Socket_close(conn);
				if (!_t900.ok) {
					string err = _t900.v_error;
					int errcode = _t900.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t904_len = attrs.len;
					array_string _t904 = __new_array(0, _t904_len, sizeof(string));
					for (int i = 0; i < _t904_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t904, &it); 
 }
					
int _t902_len = attrs.len;
					array_string _t902 = __new_array(0, _t902_len, sizeof(string));
					for (int i = 0; i < _t902_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t902, &it); 
 }
					
					int _t901_len =  _t902.len;
					array_array_string _t901 = __new_array(0, _t901_len, sizeof(array_string));
					for (int _t903 = 0; _t903 < _t901_len; ++_t903) {
						string it = ((string*)  _t904.data)[_t903];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t901, &ti);
					}
										route_words_a = _t901;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t908_len = attrs.len;
					array_string _t908 = __new_array(0, _t908_len, sizeof(string));
					for (int i = 0; i < _t908_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t908, &it); 
 }
					
int _t906_len = attrs.len;
					array_string _t906 = __new_array(0, _t906_len, sizeof(string));
					for (int i = 0; i < _t906_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t906, &it); 
 }
					
					int _t905_len =  _t906.len;
					array_array_string _t905 = __new_array(0, _t905_len, sizeof(array_string));
					for (int _t907 = 0; _t907 < _t905_len; ++_t907) {
						string it = ((string*)  _t908.data)[_t907];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t905, &ti);
					}
										route_words_a = _t905;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t912_len = attrs.len;
					array_string _t912 = __new_array(0, _t912_len, sizeof(string));
					for (int i = 0; i < _t912_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t912, &it); 
 }
					
int _t910_len = attrs.len;
					array_string _t910 = __new_array(0, _t910_len, sizeof(string));
					for (int i = 0; i < _t910_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t910, &it); 
 }
					
					int _t909_len =  _t910.len;
					array_array_string _t909 = __new_array(0, _t909_len, sizeof(array_string));
					for (int _t911 = 0; _t911 < _t909_len; ++_t911) {
						string it = ((string*)  _t912.data)[_t911];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t909, &ti);
					}
										route_words_a = _t909;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t916_len = attrs.len;
					array_string _t916 = __new_array(0, _t916_len, sizeof(string));
					for (int i = 0; i < _t916_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t916, &it); 
 }
					
int _t914_len = attrs.len;
					array_string _t914 = __new_array(0, _t914_len, sizeof(string));
					for (int i = 0; i < _t914_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t914, &it); 
 }
					
					int _t913_len =  _t914.len;
					array_array_string _t913 = __new_array(0, _t913_len, sizeof(array_string));
					for (int _t915 = 0; _t915 < _t913_len; ++_t915) {
						string it = ((string*)  _t916.data)[_t915];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t913, &ti);
					}
										route_words_a = _t913;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t920_len = attrs.len;
					array_string _t920 = __new_array(0, _t920_len, sizeof(string));
					for (int i = 0; i < _t920_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t920, &it); 
 }
					
int _t918_len = attrs.len;
					array_string _t918 = __new_array(0, _t918_len, sizeof(string));
					for (int i = 0; i < _t918_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t918, &it); 
 }
					
					int _t917_len =  _t918.len;
					array_array_string _t917 = __new_array(0, _t917_len, sizeof(array_string));
					for (int _t919 = 0; _t919 < _t917_len; ++_t919) {
						string it = ((string*)  _t920.data)[_t919];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t917, &ti);
					}
										route_words_a = _t917;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t924_len = attrs.len;
					array_string _t924 = __new_array(0, _t924_len, sizeof(string));
					for (int i = 0; i < _t924_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t924, &it); 
 }
					
int _t922_len = attrs.len;
					array_string _t922 = __new_array(0, _t922_len, sizeof(string));
					for (int i = 0; i < _t922_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t922, &it); 
 }
					
					int _t921_len =  _t922.len;
					array_array_string _t921 = __new_array(0, _t921_len, sizeof(array_string));
					for (int _t923 = 0; _t923 < _t921_len; ++_t923) {
						string it = ((string*)  _t924.data)[_t923];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t921, &ti);
					}
										route_words_a = _t921;
				}
			} else {

int _t928_len = attrs.len;
				array_string _t928 = __new_array(0, _t928_len, sizeof(string));
				for (int i = 0; i < _t928_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t928, &it); 
 }
				
int _t926_len = attrs.len;
				array_string _t926 = __new_array(0, _t926_len, sizeof(string));
				for (int i = 0; i < _t926_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t926, &it); 
 }
				
				int _t925_len =  _t926.len;
				array_array_string _t925 = __new_array(0, _t925_len, sizeof(array_string));
				for (int _t927 = 0; _t927 < _t925_len; ++_t927) {
					string it = ((string*)  _t928.data)[_t927];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t925, &ti);
				}
								route_words_a = _t925;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t929 = route_words_a;
				for (int _t930 = 0; _t930 < _t929.len; ++_t930) {
					array_string route_words = ((array_string*)_t929.data)[_t930];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_admin_edituser(app,  ); // vweb action call with args;
							// Defer begin
							Option_int _t934 = net__Socket_close(conn);
							if (!_t934.ok) {
								string err = _t934.v_error;
								int errcode = _t934.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 12
	method = tos_lit("api_issues");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/api/:user/:repo/issues")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_api_issues(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t935 = net__Socket_close(conn);
				if (!_t935.ok) {
					string err = _t935.v_error;
					int errcode = _t935.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t939_len = attrs.len;
					array_string _t939 = __new_array(0, _t939_len, sizeof(string));
					for (int i = 0; i < _t939_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t939, &it); 
 }
					
int _t937_len = attrs.len;
					array_string _t937 = __new_array(0, _t937_len, sizeof(string));
					for (int i = 0; i < _t937_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t937, &it); 
 }
					
					int _t936_len =  _t937.len;
					array_array_string _t936 = __new_array(0, _t936_len, sizeof(array_string));
					for (int _t938 = 0; _t938 < _t936_len; ++_t938) {
						string it = ((string*)  _t939.data)[_t938];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t936, &ti);
					}
										route_words_a = _t936;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t943_len = attrs.len;
					array_string _t943 = __new_array(0, _t943_len, sizeof(string));
					for (int i = 0; i < _t943_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t943, &it); 
 }
					
int _t941_len = attrs.len;
					array_string _t941 = __new_array(0, _t941_len, sizeof(string));
					for (int i = 0; i < _t941_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t941, &it); 
 }
					
					int _t940_len =  _t941.len;
					array_array_string _t940 = __new_array(0, _t940_len, sizeof(array_string));
					for (int _t942 = 0; _t942 < _t940_len; ++_t942) {
						string it = ((string*)  _t943.data)[_t942];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t940, &ti);
					}
										route_words_a = _t940;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t947_len = attrs.len;
					array_string _t947 = __new_array(0, _t947_len, sizeof(string));
					for (int i = 0; i < _t947_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t947, &it); 
 }
					
int _t945_len = attrs.len;
					array_string _t945 = __new_array(0, _t945_len, sizeof(string));
					for (int i = 0; i < _t945_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t945, &it); 
 }
					
					int _t944_len =  _t945.len;
					array_array_string _t944 = __new_array(0, _t944_len, sizeof(array_string));
					for (int _t946 = 0; _t946 < _t944_len; ++_t946) {
						string it = ((string*)  _t947.data)[_t946];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t944, &ti);
					}
										route_words_a = _t944;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t951_len = attrs.len;
					array_string _t951 = __new_array(0, _t951_len, sizeof(string));
					for (int i = 0; i < _t951_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t951, &it); 
 }
					
int _t949_len = attrs.len;
					array_string _t949 = __new_array(0, _t949_len, sizeof(string));
					for (int i = 0; i < _t949_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t949, &it); 
 }
					
					int _t948_len =  _t949.len;
					array_array_string _t948 = __new_array(0, _t948_len, sizeof(array_string));
					for (int _t950 = 0; _t950 < _t948_len; ++_t950) {
						string it = ((string*)  _t951.data)[_t950];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t948, &ti);
					}
										route_words_a = _t948;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t955_len = attrs.len;
					array_string _t955 = __new_array(0, _t955_len, sizeof(string));
					for (int i = 0; i < _t955_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t955, &it); 
 }
					
int _t953_len = attrs.len;
					array_string _t953 = __new_array(0, _t953_len, sizeof(string));
					for (int i = 0; i < _t953_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t953, &it); 
 }
					
					int _t952_len =  _t953.len;
					array_array_string _t952 = __new_array(0, _t952_len, sizeof(array_string));
					for (int _t954 = 0; _t954 < _t952_len; ++_t954) {
						string it = ((string*)  _t955.data)[_t954];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t952, &ti);
					}
										route_words_a = _t952;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t959_len = attrs.len;
					array_string _t959 = __new_array(0, _t959_len, sizeof(string));
					for (int i = 0; i < _t959_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t959, &it); 
 }
					
int _t957_len = attrs.len;
					array_string _t957 = __new_array(0, _t957_len, sizeof(string));
					for (int i = 0; i < _t957_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t957, &it); 
 }
					
					int _t956_len =  _t957.len;
					array_array_string _t956 = __new_array(0, _t956_len, sizeof(array_string));
					for (int _t958 = 0; _t958 < _t956_len; ++_t958) {
						string it = ((string*)  _t959.data)[_t958];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t956, &ti);
					}
										route_words_a = _t956;
				}
			} else {

int _t963_len = attrs.len;
				array_string _t963 = __new_array(0, _t963_len, sizeof(string));
				for (int i = 0; i < _t963_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t963, &it); 
 }
				
int _t961_len = attrs.len;
				array_string _t961 = __new_array(0, _t961_len, sizeof(string));
				for (int i = 0; i < _t961_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t961, &it); 
 }
				
				int _t960_len =  _t961.len;
				array_array_string _t960 = __new_array(0, _t960_len, sizeof(array_string));
				for (int _t962 = 0; _t962 < _t960_len; ++_t962) {
					string it = ((string*)  _t963.data)[_t962];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t960, &ti);
				}
								route_words_a = _t960;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t964 = route_words_a;
				for (int _t965 = 0; _t965 < _t964.len; ++_t965) {
					array_string route_words = ((array_string*)_t964.data)[_t965];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_api_issues(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t969 = net__Socket_close(conn);
							if (!_t969.ok) {
								string err = _t969.v_error;
								int errcode = _t969.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 13
	method = tos_lit("api_commits");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/api/:user/:repo/commits")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_api_commits(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t970 = net__Socket_close(conn);
				if (!_t970.ok) {
					string err = _t970.v_error;
					int errcode = _t970.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t974_len = attrs.len;
					array_string _t974 = __new_array(0, _t974_len, sizeof(string));
					for (int i = 0; i < _t974_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t974, &it); 
 }
					
int _t972_len = attrs.len;
					array_string _t972 = __new_array(0, _t972_len, sizeof(string));
					for (int i = 0; i < _t972_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t972, &it); 
 }
					
					int _t971_len =  _t972.len;
					array_array_string _t971 = __new_array(0, _t971_len, sizeof(array_string));
					for (int _t973 = 0; _t973 < _t971_len; ++_t973) {
						string it = ((string*)  _t974.data)[_t973];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t971, &ti);
					}
										route_words_a = _t971;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t978_len = attrs.len;
					array_string _t978 = __new_array(0, _t978_len, sizeof(string));
					for (int i = 0; i < _t978_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t978, &it); 
 }
					
int _t976_len = attrs.len;
					array_string _t976 = __new_array(0, _t976_len, sizeof(string));
					for (int i = 0; i < _t976_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t976, &it); 
 }
					
					int _t975_len =  _t976.len;
					array_array_string _t975 = __new_array(0, _t975_len, sizeof(array_string));
					for (int _t977 = 0; _t977 < _t975_len; ++_t977) {
						string it = ((string*)  _t978.data)[_t977];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t975, &ti);
					}
										route_words_a = _t975;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t982_len = attrs.len;
					array_string _t982 = __new_array(0, _t982_len, sizeof(string));
					for (int i = 0; i < _t982_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t982, &it); 
 }
					
int _t980_len = attrs.len;
					array_string _t980 = __new_array(0, _t980_len, sizeof(string));
					for (int i = 0; i < _t980_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t980, &it); 
 }
					
					int _t979_len =  _t980.len;
					array_array_string _t979 = __new_array(0, _t979_len, sizeof(array_string));
					for (int _t981 = 0; _t981 < _t979_len; ++_t981) {
						string it = ((string*)  _t982.data)[_t981];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t979, &ti);
					}
										route_words_a = _t979;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t986_len = attrs.len;
					array_string _t986 = __new_array(0, _t986_len, sizeof(string));
					for (int i = 0; i < _t986_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t986, &it); 
 }
					
int _t984_len = attrs.len;
					array_string _t984 = __new_array(0, _t984_len, sizeof(string));
					for (int i = 0; i < _t984_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t984, &it); 
 }
					
					int _t983_len =  _t984.len;
					array_array_string _t983 = __new_array(0, _t983_len, sizeof(array_string));
					for (int _t985 = 0; _t985 < _t983_len; ++_t985) {
						string it = ((string*)  _t986.data)[_t985];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t983, &ti);
					}
										route_words_a = _t983;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t990_len = attrs.len;
					array_string _t990 = __new_array(0, _t990_len, sizeof(string));
					for (int i = 0; i < _t990_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t990, &it); 
 }
					
int _t988_len = attrs.len;
					array_string _t988 = __new_array(0, _t988_len, sizeof(string));
					for (int i = 0; i < _t988_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t988, &it); 
 }
					
					int _t987_len =  _t988.len;
					array_array_string _t987 = __new_array(0, _t987_len, sizeof(array_string));
					for (int _t989 = 0; _t989 < _t987_len; ++_t989) {
						string it = ((string*)  _t990.data)[_t989];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t987, &ti);
					}
										route_words_a = _t987;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t994_len = attrs.len;
					array_string _t994 = __new_array(0, _t994_len, sizeof(string));
					for (int i = 0; i < _t994_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t994, &it); 
 }
					
int _t992_len = attrs.len;
					array_string _t992 = __new_array(0, _t992_len, sizeof(string));
					for (int i = 0; i < _t992_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t992, &it); 
 }
					
					int _t991_len =  _t992.len;
					array_array_string _t991 = __new_array(0, _t991_len, sizeof(array_string));
					for (int _t993 = 0; _t993 < _t991_len; ++_t993) {
						string it = ((string*)  _t994.data)[_t993];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t991, &ti);
					}
										route_words_a = _t991;
				}
			} else {

int _t998_len = attrs.len;
				array_string _t998 = __new_array(0, _t998_len, sizeof(string));
				for (int i = 0; i < _t998_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t998, &it); 
 }
				
int _t996_len = attrs.len;
				array_string _t996 = __new_array(0, _t996_len, sizeof(string));
				for (int i = 0; i < _t996_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t996, &it); 
 }
				
				int _t995_len =  _t996.len;
				array_array_string _t995 = __new_array(0, _t995_len, sizeof(array_string));
				for (int _t997 = 0; _t997 < _t995_len; ++_t997) {
					string it = ((string*)  _t998.data)[_t997];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t995, &ti);
				}
								route_words_a = _t995;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t999 = route_words_a;
				for (int _t1000 = 0; _t1000 < _t999.len; ++_t1000) {
					array_string route_words = ((array_string*)_t999.data)[_t1000];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_api_commits(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1004 = net__Socket_close(conn);
							if (!_t1004.ok) {
								string err = _t1004.v_error;
								int errcode = _t1004.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 14
	method = tos_lit("settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/settings")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_settings(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1005 = net__Socket_close(conn);
				if (!_t1005.ok) {
					string err = _t1005.v_error;
					int errcode = _t1005.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1009_len = attrs.len;
					array_string _t1009 = __new_array(0, _t1009_len, sizeof(string));
					for (int i = 0; i < _t1009_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1009, &it); 
 }
					
int _t1007_len = attrs.len;
					array_string _t1007 = __new_array(0, _t1007_len, sizeof(string));
					for (int i = 0; i < _t1007_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1007, &it); 
 }
					
					int _t1006_len =  _t1007.len;
					array_array_string _t1006 = __new_array(0, _t1006_len, sizeof(array_string));
					for (int _t1008 = 0; _t1008 < _t1006_len; ++_t1008) {
						string it = ((string*)  _t1009.data)[_t1008];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1006, &ti);
					}
										route_words_a = _t1006;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1013_len = attrs.len;
					array_string _t1013 = __new_array(0, _t1013_len, sizeof(string));
					for (int i = 0; i < _t1013_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1013, &it); 
 }
					
int _t1011_len = attrs.len;
					array_string _t1011 = __new_array(0, _t1011_len, sizeof(string));
					for (int i = 0; i < _t1011_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1011, &it); 
 }
					
					int _t1010_len =  _t1011.len;
					array_array_string _t1010 = __new_array(0, _t1010_len, sizeof(array_string));
					for (int _t1012 = 0; _t1012 < _t1010_len; ++_t1012) {
						string it = ((string*)  _t1013.data)[_t1012];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1010, &ti);
					}
										route_words_a = _t1010;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1017_len = attrs.len;
					array_string _t1017 = __new_array(0, _t1017_len, sizeof(string));
					for (int i = 0; i < _t1017_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1017, &it); 
 }
					
int _t1015_len = attrs.len;
					array_string _t1015 = __new_array(0, _t1015_len, sizeof(string));
					for (int i = 0; i < _t1015_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1015, &it); 
 }
					
					int _t1014_len =  _t1015.len;
					array_array_string _t1014 = __new_array(0, _t1014_len, sizeof(array_string));
					for (int _t1016 = 0; _t1016 < _t1014_len; ++_t1016) {
						string it = ((string*)  _t1017.data)[_t1016];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1014, &ti);
					}
										route_words_a = _t1014;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1021_len = attrs.len;
					array_string _t1021 = __new_array(0, _t1021_len, sizeof(string));
					for (int i = 0; i < _t1021_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1021, &it); 
 }
					
int _t1019_len = attrs.len;
					array_string _t1019 = __new_array(0, _t1019_len, sizeof(string));
					for (int i = 0; i < _t1019_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1019, &it); 
 }
					
					int _t1018_len =  _t1019.len;
					array_array_string _t1018 = __new_array(0, _t1018_len, sizeof(array_string));
					for (int _t1020 = 0; _t1020 < _t1018_len; ++_t1020) {
						string it = ((string*)  _t1021.data)[_t1020];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1018, &ti);
					}
										route_words_a = _t1018;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1025_len = attrs.len;
					array_string _t1025 = __new_array(0, _t1025_len, sizeof(string));
					for (int i = 0; i < _t1025_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1025, &it); 
 }
					
int _t1023_len = attrs.len;
					array_string _t1023 = __new_array(0, _t1023_len, sizeof(string));
					for (int i = 0; i < _t1023_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1023, &it); 
 }
					
					int _t1022_len =  _t1023.len;
					array_array_string _t1022 = __new_array(0, _t1022_len, sizeof(array_string));
					for (int _t1024 = 0; _t1024 < _t1022_len; ++_t1024) {
						string it = ((string*)  _t1025.data)[_t1024];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1022, &ti);
					}
										route_words_a = _t1022;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1029_len = attrs.len;
					array_string _t1029 = __new_array(0, _t1029_len, sizeof(string));
					for (int i = 0; i < _t1029_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1029, &it); 
 }
					
int _t1027_len = attrs.len;
					array_string _t1027 = __new_array(0, _t1027_len, sizeof(string));
					for (int i = 0; i < _t1027_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1027, &it); 
 }
					
					int _t1026_len =  _t1027.len;
					array_array_string _t1026 = __new_array(0, _t1026_len, sizeof(array_string));
					for (int _t1028 = 0; _t1028 < _t1026_len; ++_t1028) {
						string it = ((string*)  _t1029.data)[_t1028];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1026, &ti);
					}
										route_words_a = _t1026;
				}
			} else {

int _t1033_len = attrs.len;
				array_string _t1033 = __new_array(0, _t1033_len, sizeof(string));
				for (int i = 0; i < _t1033_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1033, &it); 
 }
				
int _t1031_len = attrs.len;
				array_string _t1031 = __new_array(0, _t1031_len, sizeof(string));
				for (int i = 0; i < _t1031_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1031, &it); 
 }
				
				int _t1030_len =  _t1031.len;
				array_array_string _t1030 = __new_array(0, _t1030_len, sizeof(array_string));
				for (int _t1032 = 0; _t1032 < _t1030_len; ++_t1032) {
					string it = ((string*)  _t1033.data)[_t1032];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1030, &ti);
				}
								route_words_a = _t1030;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1034 = route_words_a;
				for (int _t1035 = 0; _t1035 < _t1034.len; ++_t1035) {
					array_string route_words = ((array_string*)_t1034.data)[_t1035];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_settings(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1039 = net__Socket_close(conn);
							if (!_t1039.ok) {
								string err = _t1039.v_error;
								int errcode = _t1039.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 15
	method = tos_lit("repo_settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/settings")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_repo_settings(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1040 = net__Socket_close(conn);
				if (!_t1040.ok) {
					string err = _t1040.v_error;
					int errcode = _t1040.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1044_len = attrs.len;
					array_string _t1044 = __new_array(0, _t1044_len, sizeof(string));
					for (int i = 0; i < _t1044_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1044, &it); 
 }
					
int _t1042_len = attrs.len;
					array_string _t1042 = __new_array(0, _t1042_len, sizeof(string));
					for (int i = 0; i < _t1042_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1042, &it); 
 }
					
					int _t1041_len =  _t1042.len;
					array_array_string _t1041 = __new_array(0, _t1041_len, sizeof(array_string));
					for (int _t1043 = 0; _t1043 < _t1041_len; ++_t1043) {
						string it = ((string*)  _t1044.data)[_t1043];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1041, &ti);
					}
										route_words_a = _t1041;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1048_len = attrs.len;
					array_string _t1048 = __new_array(0, _t1048_len, sizeof(string));
					for (int i = 0; i < _t1048_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1048, &it); 
 }
					
int _t1046_len = attrs.len;
					array_string _t1046 = __new_array(0, _t1046_len, sizeof(string));
					for (int i = 0; i < _t1046_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1046, &it); 
 }
					
					int _t1045_len =  _t1046.len;
					array_array_string _t1045 = __new_array(0, _t1045_len, sizeof(array_string));
					for (int _t1047 = 0; _t1047 < _t1045_len; ++_t1047) {
						string it = ((string*)  _t1048.data)[_t1047];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1045, &ti);
					}
										route_words_a = _t1045;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1052_len = attrs.len;
					array_string _t1052 = __new_array(0, _t1052_len, sizeof(string));
					for (int i = 0; i < _t1052_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1052, &it); 
 }
					
int _t1050_len = attrs.len;
					array_string _t1050 = __new_array(0, _t1050_len, sizeof(string));
					for (int i = 0; i < _t1050_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1050, &it); 
 }
					
					int _t1049_len =  _t1050.len;
					array_array_string _t1049 = __new_array(0, _t1049_len, sizeof(array_string));
					for (int _t1051 = 0; _t1051 < _t1049_len; ++_t1051) {
						string it = ((string*)  _t1052.data)[_t1051];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1049, &ti);
					}
										route_words_a = _t1049;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1056_len = attrs.len;
					array_string _t1056 = __new_array(0, _t1056_len, sizeof(string));
					for (int i = 0; i < _t1056_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1056, &it); 
 }
					
int _t1054_len = attrs.len;
					array_string _t1054 = __new_array(0, _t1054_len, sizeof(string));
					for (int i = 0; i < _t1054_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1054, &it); 
 }
					
					int _t1053_len =  _t1054.len;
					array_array_string _t1053 = __new_array(0, _t1053_len, sizeof(array_string));
					for (int _t1055 = 0; _t1055 < _t1053_len; ++_t1055) {
						string it = ((string*)  _t1056.data)[_t1055];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1053, &ti);
					}
										route_words_a = _t1053;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1060_len = attrs.len;
					array_string _t1060 = __new_array(0, _t1060_len, sizeof(string));
					for (int i = 0; i < _t1060_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1060, &it); 
 }
					
int _t1058_len = attrs.len;
					array_string _t1058 = __new_array(0, _t1058_len, sizeof(string));
					for (int i = 0; i < _t1058_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1058, &it); 
 }
					
					int _t1057_len =  _t1058.len;
					array_array_string _t1057 = __new_array(0, _t1057_len, sizeof(array_string));
					for (int _t1059 = 0; _t1059 < _t1057_len; ++_t1059) {
						string it = ((string*)  _t1060.data)[_t1059];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1057, &ti);
					}
										route_words_a = _t1057;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1064_len = attrs.len;
					array_string _t1064 = __new_array(0, _t1064_len, sizeof(string));
					for (int i = 0; i < _t1064_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1064, &it); 
 }
					
int _t1062_len = attrs.len;
					array_string _t1062 = __new_array(0, _t1062_len, sizeof(string));
					for (int i = 0; i < _t1062_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1062, &it); 
 }
					
					int _t1061_len =  _t1062.len;
					array_array_string _t1061 = __new_array(0, _t1061_len, sizeof(array_string));
					for (int _t1063 = 0; _t1063 < _t1061_len; ++_t1063) {
						string it = ((string*)  _t1064.data)[_t1063];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1061, &ti);
					}
										route_words_a = _t1061;
				}
			} else {

int _t1068_len = attrs.len;
				array_string _t1068 = __new_array(0, _t1068_len, sizeof(string));
				for (int i = 0; i < _t1068_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1068, &it); 
 }
				
int _t1066_len = attrs.len;
				array_string _t1066 = __new_array(0, _t1066_len, sizeof(string));
				for (int i = 0; i < _t1066_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1066, &it); 
 }
				
				int _t1065_len =  _t1066.len;
				array_array_string _t1065 = __new_array(0, _t1065_len, sizeof(array_string));
				for (int _t1067 = 0; _t1067 < _t1065_len; ++_t1067) {
					string it = ((string*)  _t1068.data)[_t1067];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1065, &ti);
				}
								route_words_a = _t1065;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1069 = route_words_a;
				for (int _t1070 = 0; _t1070 < _t1069.len; ++_t1070) {
					array_string route_words = ((array_string*)_t1069.data)[_t1070];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_repo_settings(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1074 = net__Socket_close(conn);
							if (!_t1074.ok) {
								string err = _t1074.v_error;
								int errcode = _t1074.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 16
	method = tos_lit("update_repo_settings");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/settings")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_update_repo_settings(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1075 = net__Socket_close(conn);
				if (!_t1075.ok) {
					string err = _t1075.v_error;
					int errcode = _t1075.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1079_len = attrs.len;
					array_string _t1079 = __new_array(0, _t1079_len, sizeof(string));
					for (int i = 0; i < _t1079_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1079, &it); 
 }
					
int _t1077_len = attrs.len;
					array_string _t1077 = __new_array(0, _t1077_len, sizeof(string));
					for (int i = 0; i < _t1077_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1077, &it); 
 }
					
					int _t1076_len =  _t1077.len;
					array_array_string _t1076 = __new_array(0, _t1076_len, sizeof(array_string));
					for (int _t1078 = 0; _t1078 < _t1076_len; ++_t1078) {
						string it = ((string*)  _t1079.data)[_t1078];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1076, &ti);
					}
										route_words_a = _t1076;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1083_len = attrs.len;
					array_string _t1083 = __new_array(0, _t1083_len, sizeof(string));
					for (int i = 0; i < _t1083_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1083, &it); 
 }
					
int _t1081_len = attrs.len;
					array_string _t1081 = __new_array(0, _t1081_len, sizeof(string));
					for (int i = 0; i < _t1081_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1081, &it); 
 }
					
					int _t1080_len =  _t1081.len;
					array_array_string _t1080 = __new_array(0, _t1080_len, sizeof(array_string));
					for (int _t1082 = 0; _t1082 < _t1080_len; ++_t1082) {
						string it = ((string*)  _t1083.data)[_t1082];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1080, &ti);
					}
										route_words_a = _t1080;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1087_len = attrs.len;
					array_string _t1087 = __new_array(0, _t1087_len, sizeof(string));
					for (int i = 0; i < _t1087_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1087, &it); 
 }
					
int _t1085_len = attrs.len;
					array_string _t1085 = __new_array(0, _t1085_len, sizeof(string));
					for (int i = 0; i < _t1085_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1085, &it); 
 }
					
					int _t1084_len =  _t1085.len;
					array_array_string _t1084 = __new_array(0, _t1084_len, sizeof(array_string));
					for (int _t1086 = 0; _t1086 < _t1084_len; ++_t1086) {
						string it = ((string*)  _t1087.data)[_t1086];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1084, &ti);
					}
										route_words_a = _t1084;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1091_len = attrs.len;
					array_string _t1091 = __new_array(0, _t1091_len, sizeof(string));
					for (int i = 0; i < _t1091_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1091, &it); 
 }
					
int _t1089_len = attrs.len;
					array_string _t1089 = __new_array(0, _t1089_len, sizeof(string));
					for (int i = 0; i < _t1089_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1089, &it); 
 }
					
					int _t1088_len =  _t1089.len;
					array_array_string _t1088 = __new_array(0, _t1088_len, sizeof(array_string));
					for (int _t1090 = 0; _t1090 < _t1088_len; ++_t1090) {
						string it = ((string*)  _t1091.data)[_t1090];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1088, &ti);
					}
										route_words_a = _t1088;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1095_len = attrs.len;
					array_string _t1095 = __new_array(0, _t1095_len, sizeof(string));
					for (int i = 0; i < _t1095_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1095, &it); 
 }
					
int _t1093_len = attrs.len;
					array_string _t1093 = __new_array(0, _t1093_len, sizeof(string));
					for (int i = 0; i < _t1093_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1093, &it); 
 }
					
					int _t1092_len =  _t1093.len;
					array_array_string _t1092 = __new_array(0, _t1092_len, sizeof(array_string));
					for (int _t1094 = 0; _t1094 < _t1092_len; ++_t1094) {
						string it = ((string*)  _t1095.data)[_t1094];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1092, &ti);
					}
										route_words_a = _t1092;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1099_len = attrs.len;
					array_string _t1099 = __new_array(0, _t1099_len, sizeof(string));
					for (int i = 0; i < _t1099_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1099, &it); 
 }
					
int _t1097_len = attrs.len;
					array_string _t1097 = __new_array(0, _t1097_len, sizeof(string));
					for (int i = 0; i < _t1097_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1097, &it); 
 }
					
					int _t1096_len =  _t1097.len;
					array_array_string _t1096 = __new_array(0, _t1096_len, sizeof(array_string));
					for (int _t1098 = 0; _t1098 < _t1096_len; ++_t1098) {
						string it = ((string*)  _t1099.data)[_t1098];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1096, &ti);
					}
										route_words_a = _t1096;
				}
			} else {

int _t1103_len = attrs.len;
				array_string _t1103 = __new_array(0, _t1103_len, sizeof(string));
				for (int i = 0; i < _t1103_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1103, &it); 
 }
				
int _t1101_len = attrs.len;
				array_string _t1101 = __new_array(0, _t1101_len, sizeof(string));
				for (int i = 0; i < _t1101_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1101, &it); 
 }
				
				int _t1100_len =  _t1101.len;
				array_array_string _t1100 = __new_array(0, _t1100_len, sizeof(array_string));
				for (int _t1102 = 0; _t1102 < _t1100_len; ++_t1102) {
					string it = ((string*)  _t1103.data)[_t1102];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1100, &ti);
				}
								route_words_a = _t1100;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1104 = route_words_a;
				for (int _t1105 = 0; _t1105 < _t1104.len; ++_t1105) {
					array_string route_words = ((array_string*)_t1104.data)[_t1105];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_update_repo_settings(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1109 = net__Socket_close(conn);
							if (!_t1109.ok) {
								string err = _t1109.v_error;
								int errcode = _t1109.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 17
	method = tos_lit("repo_delete");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/delete_repo")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_repo_delete(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1110 = net__Socket_close(conn);
				if (!_t1110.ok) {
					string err = _t1110.v_error;
					int errcode = _t1110.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1114_len = attrs.len;
					array_string _t1114 = __new_array(0, _t1114_len, sizeof(string));
					for (int i = 0; i < _t1114_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1114, &it); 
 }
					
int _t1112_len = attrs.len;
					array_string _t1112 = __new_array(0, _t1112_len, sizeof(string));
					for (int i = 0; i < _t1112_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1112, &it); 
 }
					
					int _t1111_len =  _t1112.len;
					array_array_string _t1111 = __new_array(0, _t1111_len, sizeof(array_string));
					for (int _t1113 = 0; _t1113 < _t1111_len; ++_t1113) {
						string it = ((string*)  _t1114.data)[_t1113];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1111, &ti);
					}
										route_words_a = _t1111;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1118_len = attrs.len;
					array_string _t1118 = __new_array(0, _t1118_len, sizeof(string));
					for (int i = 0; i < _t1118_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1118, &it); 
 }
					
int _t1116_len = attrs.len;
					array_string _t1116 = __new_array(0, _t1116_len, sizeof(string));
					for (int i = 0; i < _t1116_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1116, &it); 
 }
					
					int _t1115_len =  _t1116.len;
					array_array_string _t1115 = __new_array(0, _t1115_len, sizeof(array_string));
					for (int _t1117 = 0; _t1117 < _t1115_len; ++_t1117) {
						string it = ((string*)  _t1118.data)[_t1117];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1115, &ti);
					}
										route_words_a = _t1115;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1122_len = attrs.len;
					array_string _t1122 = __new_array(0, _t1122_len, sizeof(string));
					for (int i = 0; i < _t1122_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1122, &it); 
 }
					
int _t1120_len = attrs.len;
					array_string _t1120 = __new_array(0, _t1120_len, sizeof(string));
					for (int i = 0; i < _t1120_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1120, &it); 
 }
					
					int _t1119_len =  _t1120.len;
					array_array_string _t1119 = __new_array(0, _t1119_len, sizeof(array_string));
					for (int _t1121 = 0; _t1121 < _t1119_len; ++_t1121) {
						string it = ((string*)  _t1122.data)[_t1121];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1119, &ti);
					}
										route_words_a = _t1119;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1126_len = attrs.len;
					array_string _t1126 = __new_array(0, _t1126_len, sizeof(string));
					for (int i = 0; i < _t1126_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1126, &it); 
 }
					
int _t1124_len = attrs.len;
					array_string _t1124 = __new_array(0, _t1124_len, sizeof(string));
					for (int i = 0; i < _t1124_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1124, &it); 
 }
					
					int _t1123_len =  _t1124.len;
					array_array_string _t1123 = __new_array(0, _t1123_len, sizeof(array_string));
					for (int _t1125 = 0; _t1125 < _t1123_len; ++_t1125) {
						string it = ((string*)  _t1126.data)[_t1125];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1123, &ti);
					}
										route_words_a = _t1123;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1130_len = attrs.len;
					array_string _t1130 = __new_array(0, _t1130_len, sizeof(string));
					for (int i = 0; i < _t1130_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1130, &it); 
 }
					
int _t1128_len = attrs.len;
					array_string _t1128 = __new_array(0, _t1128_len, sizeof(string));
					for (int i = 0; i < _t1128_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1128, &it); 
 }
					
					int _t1127_len =  _t1128.len;
					array_array_string _t1127 = __new_array(0, _t1127_len, sizeof(array_string));
					for (int _t1129 = 0; _t1129 < _t1127_len; ++_t1129) {
						string it = ((string*)  _t1130.data)[_t1129];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1127, &ti);
					}
										route_words_a = _t1127;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1134_len = attrs.len;
					array_string _t1134 = __new_array(0, _t1134_len, sizeof(string));
					for (int i = 0; i < _t1134_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1134, &it); 
 }
					
int _t1132_len = attrs.len;
					array_string _t1132 = __new_array(0, _t1132_len, sizeof(string));
					for (int i = 0; i < _t1132_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1132, &it); 
 }
					
					int _t1131_len =  _t1132.len;
					array_array_string _t1131 = __new_array(0, _t1131_len, sizeof(array_string));
					for (int _t1133 = 0; _t1133 < _t1131_len; ++_t1133) {
						string it = ((string*)  _t1134.data)[_t1133];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1131, &ti);
					}
										route_words_a = _t1131;
				}
			} else {

int _t1138_len = attrs.len;
				array_string _t1138 = __new_array(0, _t1138_len, sizeof(string));
				for (int i = 0; i < _t1138_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1138, &it); 
 }
				
int _t1136_len = attrs.len;
				array_string _t1136 = __new_array(0, _t1136_len, sizeof(string));
				for (int i = 0; i < _t1136_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1136, &it); 
 }
				
				int _t1135_len =  _t1136.len;
				array_array_string _t1135 = __new_array(0, _t1135_len, sizeof(array_string));
				for (int _t1137 = 0; _t1137 < _t1135_len; ++_t1137) {
					string it = ((string*)  _t1138.data)[_t1137];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1135, &ti);
				}
								route_words_a = _t1135;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1139 = route_words_a;
				for (int _t1140 = 0; _t1140 < _t1139.len; ++_t1140) {
					array_string route_words = ((array_string*)_t1139.data)[_t1140];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_repo_delete(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1144 = net__Socket_close(conn);
							if (!_t1144.ok) {
								string err = _t1144.v_error;
								int errcode = _t1144.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 18
	method = tos_lit("repo_move");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/move_repo")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_repo_move(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1145 = net__Socket_close(conn);
				if (!_t1145.ok) {
					string err = _t1145.v_error;
					int errcode = _t1145.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1149_len = attrs.len;
					array_string _t1149 = __new_array(0, _t1149_len, sizeof(string));
					for (int i = 0; i < _t1149_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1149, &it); 
 }
					
int _t1147_len = attrs.len;
					array_string _t1147 = __new_array(0, _t1147_len, sizeof(string));
					for (int i = 0; i < _t1147_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1147, &it); 
 }
					
					int _t1146_len =  _t1147.len;
					array_array_string _t1146 = __new_array(0, _t1146_len, sizeof(array_string));
					for (int _t1148 = 0; _t1148 < _t1146_len; ++_t1148) {
						string it = ((string*)  _t1149.data)[_t1148];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1146, &ti);
					}
										route_words_a = _t1146;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1153_len = attrs.len;
					array_string _t1153 = __new_array(0, _t1153_len, sizeof(string));
					for (int i = 0; i < _t1153_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1153, &it); 
 }
					
int _t1151_len = attrs.len;
					array_string _t1151 = __new_array(0, _t1151_len, sizeof(string));
					for (int i = 0; i < _t1151_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1151, &it); 
 }
					
					int _t1150_len =  _t1151.len;
					array_array_string _t1150 = __new_array(0, _t1150_len, sizeof(array_string));
					for (int _t1152 = 0; _t1152 < _t1150_len; ++_t1152) {
						string it = ((string*)  _t1153.data)[_t1152];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1150, &ti);
					}
										route_words_a = _t1150;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1157_len = attrs.len;
					array_string _t1157 = __new_array(0, _t1157_len, sizeof(string));
					for (int i = 0; i < _t1157_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1157, &it); 
 }
					
int _t1155_len = attrs.len;
					array_string _t1155 = __new_array(0, _t1155_len, sizeof(string));
					for (int i = 0; i < _t1155_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1155, &it); 
 }
					
					int _t1154_len =  _t1155.len;
					array_array_string _t1154 = __new_array(0, _t1154_len, sizeof(array_string));
					for (int _t1156 = 0; _t1156 < _t1154_len; ++_t1156) {
						string it = ((string*)  _t1157.data)[_t1156];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1154, &ti);
					}
										route_words_a = _t1154;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1161_len = attrs.len;
					array_string _t1161 = __new_array(0, _t1161_len, sizeof(string));
					for (int i = 0; i < _t1161_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1161, &it); 
 }
					
int _t1159_len = attrs.len;
					array_string _t1159 = __new_array(0, _t1159_len, sizeof(string));
					for (int i = 0; i < _t1159_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1159, &it); 
 }
					
					int _t1158_len =  _t1159.len;
					array_array_string _t1158 = __new_array(0, _t1158_len, sizeof(array_string));
					for (int _t1160 = 0; _t1160 < _t1158_len; ++_t1160) {
						string it = ((string*)  _t1161.data)[_t1160];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1158, &ti);
					}
										route_words_a = _t1158;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1165_len = attrs.len;
					array_string _t1165 = __new_array(0, _t1165_len, sizeof(string));
					for (int i = 0; i < _t1165_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1165, &it); 
 }
					
int _t1163_len = attrs.len;
					array_string _t1163 = __new_array(0, _t1163_len, sizeof(string));
					for (int i = 0; i < _t1163_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1163, &it); 
 }
					
					int _t1162_len =  _t1163.len;
					array_array_string _t1162 = __new_array(0, _t1162_len, sizeof(array_string));
					for (int _t1164 = 0; _t1164 < _t1162_len; ++_t1164) {
						string it = ((string*)  _t1165.data)[_t1164];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1162, &ti);
					}
										route_words_a = _t1162;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1169_len = attrs.len;
					array_string _t1169 = __new_array(0, _t1169_len, sizeof(string));
					for (int i = 0; i < _t1169_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1169, &it); 
 }
					
int _t1167_len = attrs.len;
					array_string _t1167 = __new_array(0, _t1167_len, sizeof(string));
					for (int i = 0; i < _t1167_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1167, &it); 
 }
					
					int _t1166_len =  _t1167.len;
					array_array_string _t1166 = __new_array(0, _t1166_len, sizeof(array_string));
					for (int _t1168 = 0; _t1168 < _t1166_len; ++_t1168) {
						string it = ((string*)  _t1169.data)[_t1168];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1166, &ti);
					}
										route_words_a = _t1166;
				}
			} else {

int _t1173_len = attrs.len;
				array_string _t1173 = __new_array(0, _t1173_len, sizeof(string));
				for (int i = 0; i < _t1173_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1173, &it); 
 }
				
int _t1171_len = attrs.len;
				array_string _t1171 = __new_array(0, _t1171_len, sizeof(string));
				for (int i = 0; i < _t1171_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1171, &it); 
 }
				
				int _t1170_len =  _t1171.len;
				array_array_string _t1170 = __new_array(0, _t1170_len, sizeof(array_string));
				for (int _t1172 = 0; _t1172 < _t1170_len; ++_t1172) {
					string it = ((string*)  _t1173.data)[_t1172];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1170, &ti);
				}
								route_words_a = _t1170;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1174 = route_words_a;
				for (int _t1175 = 0; _t1175 < _t1174.len; ++_t1175) {
					array_string route_words = ((array_string*)_t1174.data)[_t1175];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_repo_move(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1179 = net__Socket_close(conn);
							if (!_t1179.ok) {
								string err = _t1179.v_error;
								int errcode = _t1179.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 19
	method = tos_lit("tree2");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_tree2(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1180 = net__Socket_close(conn);
				if (!_t1180.ok) {
					string err = _t1180.v_error;
					int errcode = _t1180.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1184_len = attrs.len;
					array_string _t1184 = __new_array(0, _t1184_len, sizeof(string));
					for (int i = 0; i < _t1184_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1184, &it); 
 }
					
int _t1182_len = attrs.len;
					array_string _t1182 = __new_array(0, _t1182_len, sizeof(string));
					for (int i = 0; i < _t1182_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1182, &it); 
 }
					
					int _t1181_len =  _t1182.len;
					array_array_string _t1181 = __new_array(0, _t1181_len, sizeof(array_string));
					for (int _t1183 = 0; _t1183 < _t1181_len; ++_t1183) {
						string it = ((string*)  _t1184.data)[_t1183];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1181, &ti);
					}
										route_words_a = _t1181;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1188_len = attrs.len;
					array_string _t1188 = __new_array(0, _t1188_len, sizeof(string));
					for (int i = 0; i < _t1188_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1188, &it); 
 }
					
int _t1186_len = attrs.len;
					array_string _t1186 = __new_array(0, _t1186_len, sizeof(string));
					for (int i = 0; i < _t1186_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1186, &it); 
 }
					
					int _t1185_len =  _t1186.len;
					array_array_string _t1185 = __new_array(0, _t1185_len, sizeof(array_string));
					for (int _t1187 = 0; _t1187 < _t1185_len; ++_t1187) {
						string it = ((string*)  _t1188.data)[_t1187];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1185, &ti);
					}
										route_words_a = _t1185;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1192_len = attrs.len;
					array_string _t1192 = __new_array(0, _t1192_len, sizeof(string));
					for (int i = 0; i < _t1192_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1192, &it); 
 }
					
int _t1190_len = attrs.len;
					array_string _t1190 = __new_array(0, _t1190_len, sizeof(string));
					for (int i = 0; i < _t1190_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1190, &it); 
 }
					
					int _t1189_len =  _t1190.len;
					array_array_string _t1189 = __new_array(0, _t1189_len, sizeof(array_string));
					for (int _t1191 = 0; _t1191 < _t1189_len; ++_t1191) {
						string it = ((string*)  _t1192.data)[_t1191];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1189, &ti);
					}
										route_words_a = _t1189;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1196_len = attrs.len;
					array_string _t1196 = __new_array(0, _t1196_len, sizeof(string));
					for (int i = 0; i < _t1196_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1196, &it); 
 }
					
int _t1194_len = attrs.len;
					array_string _t1194 = __new_array(0, _t1194_len, sizeof(string));
					for (int i = 0; i < _t1194_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1194, &it); 
 }
					
					int _t1193_len =  _t1194.len;
					array_array_string _t1193 = __new_array(0, _t1193_len, sizeof(array_string));
					for (int _t1195 = 0; _t1195 < _t1193_len; ++_t1195) {
						string it = ((string*)  _t1196.data)[_t1195];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1193, &ti);
					}
										route_words_a = _t1193;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1200_len = attrs.len;
					array_string _t1200 = __new_array(0, _t1200_len, sizeof(string));
					for (int i = 0; i < _t1200_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1200, &it); 
 }
					
int _t1198_len = attrs.len;
					array_string _t1198 = __new_array(0, _t1198_len, sizeof(string));
					for (int i = 0; i < _t1198_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1198, &it); 
 }
					
					int _t1197_len =  _t1198.len;
					array_array_string _t1197 = __new_array(0, _t1197_len, sizeof(array_string));
					for (int _t1199 = 0; _t1199 < _t1197_len; ++_t1199) {
						string it = ((string*)  _t1200.data)[_t1199];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1197, &ti);
					}
										route_words_a = _t1197;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1204_len = attrs.len;
					array_string _t1204 = __new_array(0, _t1204_len, sizeof(string));
					for (int i = 0; i < _t1204_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1204, &it); 
 }
					
int _t1202_len = attrs.len;
					array_string _t1202 = __new_array(0, _t1202_len, sizeof(string));
					for (int i = 0; i < _t1202_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1202, &it); 
 }
					
					int _t1201_len =  _t1202.len;
					array_array_string _t1201 = __new_array(0, _t1201_len, sizeof(array_string));
					for (int _t1203 = 0; _t1203 < _t1201_len; ++_t1203) {
						string it = ((string*)  _t1204.data)[_t1203];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1201, &ti);
					}
										route_words_a = _t1201;
				}
			} else {

int _t1208_len = attrs.len;
				array_string _t1208 = __new_array(0, _t1208_len, sizeof(string));
				for (int i = 0; i < _t1208_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1208, &it); 
 }
				
int _t1206_len = attrs.len;
				array_string _t1206 = __new_array(0, _t1206_len, sizeof(string));
				for (int i = 0; i < _t1206_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1206, &it); 
 }
				
				int _t1205_len =  _t1206.len;
				array_array_string _t1205 = __new_array(0, _t1205_len, sizeof(array_string));
				for (int _t1207 = 0; _t1207 < _t1205_len; ++_t1207) {
					string it = ((string*)  _t1208.data)[_t1207];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1205, &ti);
				}
								route_words_a = _t1205;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1209 = route_words_a;
				for (int _t1210 = 0; _t1210 < _t1209.len; ++_t1210) {
					array_string route_words = ((array_string*)_t1209.data)[_t1210];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_tree2(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1214 = net__Socket_close(conn);
							if (!_t1214.ok) {
								string err = _t1214.v_error;
								int errcode = _t1214.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 20
	method = tos_lit("tree");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/tree/:branch/:path...")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_tree(app, , , ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1215 = net__Socket_close(conn);
				if (!_t1215.ok) {
					string err = _t1215.v_error;
					int errcode = _t1215.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1219_len = attrs.len;
					array_string _t1219 = __new_array(0, _t1219_len, sizeof(string));
					for (int i = 0; i < _t1219_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1219, &it); 
 }
					
int _t1217_len = attrs.len;
					array_string _t1217 = __new_array(0, _t1217_len, sizeof(string));
					for (int i = 0; i < _t1217_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1217, &it); 
 }
					
					int _t1216_len =  _t1217.len;
					array_array_string _t1216 = __new_array(0, _t1216_len, sizeof(array_string));
					for (int _t1218 = 0; _t1218 < _t1216_len; ++_t1218) {
						string it = ((string*)  _t1219.data)[_t1218];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1216, &ti);
					}
										route_words_a = _t1216;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1223_len = attrs.len;
					array_string _t1223 = __new_array(0, _t1223_len, sizeof(string));
					for (int i = 0; i < _t1223_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1223, &it); 
 }
					
int _t1221_len = attrs.len;
					array_string _t1221 = __new_array(0, _t1221_len, sizeof(string));
					for (int i = 0; i < _t1221_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1221, &it); 
 }
					
					int _t1220_len =  _t1221.len;
					array_array_string _t1220 = __new_array(0, _t1220_len, sizeof(array_string));
					for (int _t1222 = 0; _t1222 < _t1220_len; ++_t1222) {
						string it = ((string*)  _t1223.data)[_t1222];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1220, &ti);
					}
										route_words_a = _t1220;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1227_len = attrs.len;
					array_string _t1227 = __new_array(0, _t1227_len, sizeof(string));
					for (int i = 0; i < _t1227_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1227, &it); 
 }
					
int _t1225_len = attrs.len;
					array_string _t1225 = __new_array(0, _t1225_len, sizeof(string));
					for (int i = 0; i < _t1225_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1225, &it); 
 }
					
					int _t1224_len =  _t1225.len;
					array_array_string _t1224 = __new_array(0, _t1224_len, sizeof(array_string));
					for (int _t1226 = 0; _t1226 < _t1224_len; ++_t1226) {
						string it = ((string*)  _t1227.data)[_t1226];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1224, &ti);
					}
										route_words_a = _t1224;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1231_len = attrs.len;
					array_string _t1231 = __new_array(0, _t1231_len, sizeof(string));
					for (int i = 0; i < _t1231_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1231, &it); 
 }
					
int _t1229_len = attrs.len;
					array_string _t1229 = __new_array(0, _t1229_len, sizeof(string));
					for (int i = 0; i < _t1229_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1229, &it); 
 }
					
					int _t1228_len =  _t1229.len;
					array_array_string _t1228 = __new_array(0, _t1228_len, sizeof(array_string));
					for (int _t1230 = 0; _t1230 < _t1228_len; ++_t1230) {
						string it = ((string*)  _t1231.data)[_t1230];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1228, &ti);
					}
										route_words_a = _t1228;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1235_len = attrs.len;
					array_string _t1235 = __new_array(0, _t1235_len, sizeof(string));
					for (int i = 0; i < _t1235_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1235, &it); 
 }
					
int _t1233_len = attrs.len;
					array_string _t1233 = __new_array(0, _t1233_len, sizeof(string));
					for (int i = 0; i < _t1233_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1233, &it); 
 }
					
					int _t1232_len =  _t1233.len;
					array_array_string _t1232 = __new_array(0, _t1232_len, sizeof(array_string));
					for (int _t1234 = 0; _t1234 < _t1232_len; ++_t1234) {
						string it = ((string*)  _t1235.data)[_t1234];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1232, &ti);
					}
										route_words_a = _t1232;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1239_len = attrs.len;
					array_string _t1239 = __new_array(0, _t1239_len, sizeof(string));
					for (int i = 0; i < _t1239_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1239, &it); 
 }
					
int _t1237_len = attrs.len;
					array_string _t1237 = __new_array(0, _t1237_len, sizeof(string));
					for (int i = 0; i < _t1237_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1237, &it); 
 }
					
					int _t1236_len =  _t1237.len;
					array_array_string _t1236 = __new_array(0, _t1236_len, sizeof(array_string));
					for (int _t1238 = 0; _t1238 < _t1236_len; ++_t1238) {
						string it = ((string*)  _t1239.data)[_t1238];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1236, &ti);
					}
										route_words_a = _t1236;
				}
			} else {

int _t1243_len = attrs.len;
				array_string _t1243 = __new_array(0, _t1243_len, sizeof(string));
				for (int i = 0; i < _t1243_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1243, &it); 
 }
				
int _t1241_len = attrs.len;
				array_string _t1241 = __new_array(0, _t1241_len, sizeof(string));
				for (int i = 0; i < _t1241_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1241, &it); 
 }
				
				int _t1240_len =  _t1241.len;
				array_array_string _t1240 = __new_array(0, _t1240_len, sizeof(array_string));
				for (int _t1242 = 0; _t1242 < _t1240_len; ++_t1242) {
					string it = ((string*)  _t1243.data)[_t1242];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1240, &ti);
				}
								route_words_a = _t1240;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1244 = route_words_a;
				for (int _t1245 = 0; _t1245 < _t1244.len; ++_t1245) {
					array_string route_words = ((array_string*)_t1244.data)[_t1245];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_tree(app, , , ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1249 = net__Socket_close(conn);
							if (!_t1249.ok) {
								string err = _t1249.v_error;
								int errcode = _t1249.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 21
	method = tos_lit("update");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/update")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_update(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1250 = net__Socket_close(conn);
				if (!_t1250.ok) {
					string err = _t1250.v_error;
					int errcode = _t1250.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1254_len = attrs.len;
					array_string _t1254 = __new_array(0, _t1254_len, sizeof(string));
					for (int i = 0; i < _t1254_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1254, &it); 
 }
					
int _t1252_len = attrs.len;
					array_string _t1252 = __new_array(0, _t1252_len, sizeof(string));
					for (int i = 0; i < _t1252_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1252, &it); 
 }
					
					int _t1251_len =  _t1252.len;
					array_array_string _t1251 = __new_array(0, _t1251_len, sizeof(array_string));
					for (int _t1253 = 0; _t1253 < _t1251_len; ++_t1253) {
						string it = ((string*)  _t1254.data)[_t1253];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1251, &ti);
					}
										route_words_a = _t1251;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1258_len = attrs.len;
					array_string _t1258 = __new_array(0, _t1258_len, sizeof(string));
					for (int i = 0; i < _t1258_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1258, &it); 
 }
					
int _t1256_len = attrs.len;
					array_string _t1256 = __new_array(0, _t1256_len, sizeof(string));
					for (int i = 0; i < _t1256_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1256, &it); 
 }
					
					int _t1255_len =  _t1256.len;
					array_array_string _t1255 = __new_array(0, _t1255_len, sizeof(array_string));
					for (int _t1257 = 0; _t1257 < _t1255_len; ++_t1257) {
						string it = ((string*)  _t1258.data)[_t1257];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1255, &ti);
					}
										route_words_a = _t1255;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1262_len = attrs.len;
					array_string _t1262 = __new_array(0, _t1262_len, sizeof(string));
					for (int i = 0; i < _t1262_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1262, &it); 
 }
					
int _t1260_len = attrs.len;
					array_string _t1260 = __new_array(0, _t1260_len, sizeof(string));
					for (int i = 0; i < _t1260_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1260, &it); 
 }
					
					int _t1259_len =  _t1260.len;
					array_array_string _t1259 = __new_array(0, _t1259_len, sizeof(array_string));
					for (int _t1261 = 0; _t1261 < _t1259_len; ++_t1261) {
						string it = ((string*)  _t1262.data)[_t1261];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1259, &ti);
					}
										route_words_a = _t1259;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1266_len = attrs.len;
					array_string _t1266 = __new_array(0, _t1266_len, sizeof(string));
					for (int i = 0; i < _t1266_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1266, &it); 
 }
					
int _t1264_len = attrs.len;
					array_string _t1264 = __new_array(0, _t1264_len, sizeof(string));
					for (int i = 0; i < _t1264_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1264, &it); 
 }
					
					int _t1263_len =  _t1264.len;
					array_array_string _t1263 = __new_array(0, _t1263_len, sizeof(array_string));
					for (int _t1265 = 0; _t1265 < _t1263_len; ++_t1265) {
						string it = ((string*)  _t1266.data)[_t1265];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1263, &ti);
					}
										route_words_a = _t1263;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1270_len = attrs.len;
					array_string _t1270 = __new_array(0, _t1270_len, sizeof(string));
					for (int i = 0; i < _t1270_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1270, &it); 
 }
					
int _t1268_len = attrs.len;
					array_string _t1268 = __new_array(0, _t1268_len, sizeof(string));
					for (int i = 0; i < _t1268_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1268, &it); 
 }
					
					int _t1267_len =  _t1268.len;
					array_array_string _t1267 = __new_array(0, _t1267_len, sizeof(array_string));
					for (int _t1269 = 0; _t1269 < _t1267_len; ++_t1269) {
						string it = ((string*)  _t1270.data)[_t1269];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1267, &ti);
					}
										route_words_a = _t1267;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1274_len = attrs.len;
					array_string _t1274 = __new_array(0, _t1274_len, sizeof(string));
					for (int i = 0; i < _t1274_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1274, &it); 
 }
					
int _t1272_len = attrs.len;
					array_string _t1272 = __new_array(0, _t1272_len, sizeof(string));
					for (int i = 0; i < _t1272_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1272, &it); 
 }
					
					int _t1271_len =  _t1272.len;
					array_array_string _t1271 = __new_array(0, _t1271_len, sizeof(array_string));
					for (int _t1273 = 0; _t1273 < _t1271_len; ++_t1273) {
						string it = ((string*)  _t1274.data)[_t1273];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1271, &ti);
					}
										route_words_a = _t1271;
				}
			} else {

int _t1278_len = attrs.len;
				array_string _t1278 = __new_array(0, _t1278_len, sizeof(string));
				for (int i = 0; i < _t1278_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1278, &it); 
 }
				
int _t1276_len = attrs.len;
				array_string _t1276 = __new_array(0, _t1276_len, sizeof(string));
				for (int i = 0; i < _t1276_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1276, &it); 
 }
				
				int _t1275_len =  _t1276.len;
				array_array_string _t1275 = __new_array(0, _t1275_len, sizeof(array_string));
				for (int _t1277 = 0; _t1277 < _t1275_len; ++_t1277) {
					string it = ((string*)  _t1278.data)[_t1277];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1275, &ti);
				}
								route_words_a = _t1275;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1279 = route_words_a;
				for (int _t1280 = 0; _t1280 < _t1279.len; ++_t1280) {
					array_string route_words = ((array_string*)_t1279.data)[_t1280];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_update(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1284 = net__Socket_close(conn);
							if (!_t1284.ok) {
								string err = _t1284.v_error;
								int errcode = _t1284.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 22
	method = tos_lit("new");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/new")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_new(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1285 = net__Socket_close(conn);
				if (!_t1285.ok) {
					string err = _t1285.v_error;
					int errcode = _t1285.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1289_len = attrs.len;
					array_string _t1289 = __new_array(0, _t1289_len, sizeof(string));
					for (int i = 0; i < _t1289_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1289, &it); 
 }
					
int _t1287_len = attrs.len;
					array_string _t1287 = __new_array(0, _t1287_len, sizeof(string));
					for (int i = 0; i < _t1287_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1287, &it); 
 }
					
					int _t1286_len =  _t1287.len;
					array_array_string _t1286 = __new_array(0, _t1286_len, sizeof(array_string));
					for (int _t1288 = 0; _t1288 < _t1286_len; ++_t1288) {
						string it = ((string*)  _t1289.data)[_t1288];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1286, &ti);
					}
										route_words_a = _t1286;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1293_len = attrs.len;
					array_string _t1293 = __new_array(0, _t1293_len, sizeof(string));
					for (int i = 0; i < _t1293_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1293, &it); 
 }
					
int _t1291_len = attrs.len;
					array_string _t1291 = __new_array(0, _t1291_len, sizeof(string));
					for (int i = 0; i < _t1291_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1291, &it); 
 }
					
					int _t1290_len =  _t1291.len;
					array_array_string _t1290 = __new_array(0, _t1290_len, sizeof(array_string));
					for (int _t1292 = 0; _t1292 < _t1290_len; ++_t1292) {
						string it = ((string*)  _t1293.data)[_t1292];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1290, &ti);
					}
										route_words_a = _t1290;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1297_len = attrs.len;
					array_string _t1297 = __new_array(0, _t1297_len, sizeof(string));
					for (int i = 0; i < _t1297_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1297, &it); 
 }
					
int _t1295_len = attrs.len;
					array_string _t1295 = __new_array(0, _t1295_len, sizeof(string));
					for (int i = 0; i < _t1295_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1295, &it); 
 }
					
					int _t1294_len =  _t1295.len;
					array_array_string _t1294 = __new_array(0, _t1294_len, sizeof(array_string));
					for (int _t1296 = 0; _t1296 < _t1294_len; ++_t1296) {
						string it = ((string*)  _t1297.data)[_t1296];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1294, &ti);
					}
										route_words_a = _t1294;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1301_len = attrs.len;
					array_string _t1301 = __new_array(0, _t1301_len, sizeof(string));
					for (int i = 0; i < _t1301_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1301, &it); 
 }
					
int _t1299_len = attrs.len;
					array_string _t1299 = __new_array(0, _t1299_len, sizeof(string));
					for (int i = 0; i < _t1299_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1299, &it); 
 }
					
					int _t1298_len =  _t1299.len;
					array_array_string _t1298 = __new_array(0, _t1298_len, sizeof(array_string));
					for (int _t1300 = 0; _t1300 < _t1298_len; ++_t1300) {
						string it = ((string*)  _t1301.data)[_t1300];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1298, &ti);
					}
										route_words_a = _t1298;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1305_len = attrs.len;
					array_string _t1305 = __new_array(0, _t1305_len, sizeof(string));
					for (int i = 0; i < _t1305_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1305, &it); 
 }
					
int _t1303_len = attrs.len;
					array_string _t1303 = __new_array(0, _t1303_len, sizeof(string));
					for (int i = 0; i < _t1303_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1303, &it); 
 }
					
					int _t1302_len =  _t1303.len;
					array_array_string _t1302 = __new_array(0, _t1302_len, sizeof(array_string));
					for (int _t1304 = 0; _t1304 < _t1302_len; ++_t1304) {
						string it = ((string*)  _t1305.data)[_t1304];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1302, &ti);
					}
										route_words_a = _t1302;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1309_len = attrs.len;
					array_string _t1309 = __new_array(0, _t1309_len, sizeof(string));
					for (int i = 0; i < _t1309_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1309, &it); 
 }
					
int _t1307_len = attrs.len;
					array_string _t1307 = __new_array(0, _t1307_len, sizeof(string));
					for (int i = 0; i < _t1307_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1307, &it); 
 }
					
					int _t1306_len =  _t1307.len;
					array_array_string _t1306 = __new_array(0, _t1306_len, sizeof(array_string));
					for (int _t1308 = 0; _t1308 < _t1306_len; ++_t1308) {
						string it = ((string*)  _t1309.data)[_t1308];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1306, &ti);
					}
										route_words_a = _t1306;
				}
			} else {

int _t1313_len = attrs.len;
				array_string _t1313 = __new_array(0, _t1313_len, sizeof(string));
				for (int i = 0; i < _t1313_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1313, &it); 
 }
				
int _t1311_len = attrs.len;
				array_string _t1311 = __new_array(0, _t1311_len, sizeof(string));
				for (int i = 0; i < _t1311_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1311, &it); 
 }
				
				int _t1310_len =  _t1311.len;
				array_array_string _t1310 = __new_array(0, _t1310_len, sizeof(array_string));
				for (int _t1312 = 0; _t1312 < _t1310_len; ++_t1312) {
					string it = ((string*)  _t1313.data)[_t1312];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1310, &ti);
				}
								route_words_a = _t1310;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1314 = route_words_a;
				for (int _t1315 = 0; _t1315 < _t1314.len; ++_t1315) {
					array_string route_words = ((array_string*)_t1314.data)[_t1315];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_new(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1319 = net__Socket_close(conn);
							if (!_t1319.ok) {
								string err = _t1319.v_error;
								int errcode = _t1319.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 23
	method = tos_lit("new_repo");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/new")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_new_repo(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1320 = net__Socket_close(conn);
				if (!_t1320.ok) {
					string err = _t1320.v_error;
					int errcode = _t1320.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1324_len = attrs.len;
					array_string _t1324 = __new_array(0, _t1324_len, sizeof(string));
					for (int i = 0; i < _t1324_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1324, &it); 
 }
					
int _t1322_len = attrs.len;
					array_string _t1322 = __new_array(0, _t1322_len, sizeof(string));
					for (int i = 0; i < _t1322_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1322, &it); 
 }
					
					int _t1321_len =  _t1322.len;
					array_array_string _t1321 = __new_array(0, _t1321_len, sizeof(array_string));
					for (int _t1323 = 0; _t1323 < _t1321_len; ++_t1323) {
						string it = ((string*)  _t1324.data)[_t1323];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1321, &ti);
					}
										route_words_a = _t1321;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1328_len = attrs.len;
					array_string _t1328 = __new_array(0, _t1328_len, sizeof(string));
					for (int i = 0; i < _t1328_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1328, &it); 
 }
					
int _t1326_len = attrs.len;
					array_string _t1326 = __new_array(0, _t1326_len, sizeof(string));
					for (int i = 0; i < _t1326_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1326, &it); 
 }
					
					int _t1325_len =  _t1326.len;
					array_array_string _t1325 = __new_array(0, _t1325_len, sizeof(array_string));
					for (int _t1327 = 0; _t1327 < _t1325_len; ++_t1327) {
						string it = ((string*)  _t1328.data)[_t1327];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1325, &ti);
					}
										route_words_a = _t1325;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1332_len = attrs.len;
					array_string _t1332 = __new_array(0, _t1332_len, sizeof(string));
					for (int i = 0; i < _t1332_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1332, &it); 
 }
					
int _t1330_len = attrs.len;
					array_string _t1330 = __new_array(0, _t1330_len, sizeof(string));
					for (int i = 0; i < _t1330_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1330, &it); 
 }
					
					int _t1329_len =  _t1330.len;
					array_array_string _t1329 = __new_array(0, _t1329_len, sizeof(array_string));
					for (int _t1331 = 0; _t1331 < _t1329_len; ++_t1331) {
						string it = ((string*)  _t1332.data)[_t1331];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1329, &ti);
					}
										route_words_a = _t1329;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1336_len = attrs.len;
					array_string _t1336 = __new_array(0, _t1336_len, sizeof(string));
					for (int i = 0; i < _t1336_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1336, &it); 
 }
					
int _t1334_len = attrs.len;
					array_string _t1334 = __new_array(0, _t1334_len, sizeof(string));
					for (int i = 0; i < _t1334_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1334, &it); 
 }
					
					int _t1333_len =  _t1334.len;
					array_array_string _t1333 = __new_array(0, _t1333_len, sizeof(array_string));
					for (int _t1335 = 0; _t1335 < _t1333_len; ++_t1335) {
						string it = ((string*)  _t1336.data)[_t1335];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1333, &ti);
					}
										route_words_a = _t1333;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1340_len = attrs.len;
					array_string _t1340 = __new_array(0, _t1340_len, sizeof(string));
					for (int i = 0; i < _t1340_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1340, &it); 
 }
					
int _t1338_len = attrs.len;
					array_string _t1338 = __new_array(0, _t1338_len, sizeof(string));
					for (int i = 0; i < _t1338_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1338, &it); 
 }
					
					int _t1337_len =  _t1338.len;
					array_array_string _t1337 = __new_array(0, _t1337_len, sizeof(array_string));
					for (int _t1339 = 0; _t1339 < _t1337_len; ++_t1339) {
						string it = ((string*)  _t1340.data)[_t1339];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1337, &ti);
					}
										route_words_a = _t1337;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1344_len = attrs.len;
					array_string _t1344 = __new_array(0, _t1344_len, sizeof(string));
					for (int i = 0; i < _t1344_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1344, &it); 
 }
					
int _t1342_len = attrs.len;
					array_string _t1342 = __new_array(0, _t1342_len, sizeof(string));
					for (int i = 0; i < _t1342_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1342, &it); 
 }
					
					int _t1341_len =  _t1342.len;
					array_array_string _t1341 = __new_array(0, _t1341_len, sizeof(array_string));
					for (int _t1343 = 0; _t1343 < _t1341_len; ++_t1343) {
						string it = ((string*)  _t1344.data)[_t1343];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1341, &ti);
					}
										route_words_a = _t1341;
				}
			} else {

int _t1348_len = attrs.len;
				array_string _t1348 = __new_array(0, _t1348_len, sizeof(string));
				for (int i = 0; i < _t1348_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1348, &it); 
 }
				
int _t1346_len = attrs.len;
				array_string _t1346 = __new_array(0, _t1346_len, sizeof(string));
				for (int i = 0; i < _t1346_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1346, &it); 
 }
				
				int _t1345_len =  _t1346.len;
				array_array_string _t1345 = __new_array(0, _t1345_len, sizeof(array_string));
				for (int _t1347 = 0; _t1347 < _t1345_len; ++_t1347) {
					string it = ((string*)  _t1348.data)[_t1347];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1345, &ti);
				}
								route_words_a = _t1345;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1349 = route_words_a;
				for (int _t1350 = 0; _t1350 < _t1349.len; ++_t1350) {
					array_string route_words = ((array_string*)_t1349.data)[_t1350];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_new_repo(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1354 = net__Socket_close(conn);
							if (!_t1354.ok) {
								string err = _t1354.v_error;
								int errcode = _t1354.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 24
	method = tos_lit("commits");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/:user/:repo/commits"), tos_lit("/:user/:repo/commits/:page_str")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_commits(app, , , string_int(((string*)vars.data) [3])  ); // vweb action call with args;
				// Defer begin
				Option_int _t1355 = net__Socket_close(conn);
				if (!_t1355.ok) {
					string err = _t1355.v_error;
					int errcode = _t1355.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1359_len = attrs.len;
					array_string _t1359 = __new_array(0, _t1359_len, sizeof(string));
					for (int i = 0; i < _t1359_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1359, &it); 
 }
					
int _t1357_len = attrs.len;
					array_string _t1357 = __new_array(0, _t1357_len, sizeof(string));
					for (int i = 0; i < _t1357_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1357, &it); 
 }
					
					int _t1356_len =  _t1357.len;
					array_array_string _t1356 = __new_array(0, _t1356_len, sizeof(array_string));
					for (int _t1358 = 0; _t1358 < _t1356_len; ++_t1358) {
						string it = ((string*)  _t1359.data)[_t1358];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1356, &ti);
					}
										route_words_a = _t1356;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1363_len = attrs.len;
					array_string _t1363 = __new_array(0, _t1363_len, sizeof(string));
					for (int i = 0; i < _t1363_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1363, &it); 
 }
					
int _t1361_len = attrs.len;
					array_string _t1361 = __new_array(0, _t1361_len, sizeof(string));
					for (int i = 0; i < _t1361_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1361, &it); 
 }
					
					int _t1360_len =  _t1361.len;
					array_array_string _t1360 = __new_array(0, _t1360_len, sizeof(array_string));
					for (int _t1362 = 0; _t1362 < _t1360_len; ++_t1362) {
						string it = ((string*)  _t1363.data)[_t1362];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1360, &ti);
					}
										route_words_a = _t1360;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1367_len = attrs.len;
					array_string _t1367 = __new_array(0, _t1367_len, sizeof(string));
					for (int i = 0; i < _t1367_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1367, &it); 
 }
					
int _t1365_len = attrs.len;
					array_string _t1365 = __new_array(0, _t1365_len, sizeof(string));
					for (int i = 0; i < _t1365_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1365, &it); 
 }
					
					int _t1364_len =  _t1365.len;
					array_array_string _t1364 = __new_array(0, _t1364_len, sizeof(array_string));
					for (int _t1366 = 0; _t1366 < _t1364_len; ++_t1366) {
						string it = ((string*)  _t1367.data)[_t1366];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1364, &ti);
					}
										route_words_a = _t1364;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1371_len = attrs.len;
					array_string _t1371 = __new_array(0, _t1371_len, sizeof(string));
					for (int i = 0; i < _t1371_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1371, &it); 
 }
					
int _t1369_len = attrs.len;
					array_string _t1369 = __new_array(0, _t1369_len, sizeof(string));
					for (int i = 0; i < _t1369_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1369, &it); 
 }
					
					int _t1368_len =  _t1369.len;
					array_array_string _t1368 = __new_array(0, _t1368_len, sizeof(array_string));
					for (int _t1370 = 0; _t1370 < _t1368_len; ++_t1370) {
						string it = ((string*)  _t1371.data)[_t1370];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1368, &ti);
					}
										route_words_a = _t1368;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1375_len = attrs.len;
					array_string _t1375 = __new_array(0, _t1375_len, sizeof(string));
					for (int i = 0; i < _t1375_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1375, &it); 
 }
					
int _t1373_len = attrs.len;
					array_string _t1373 = __new_array(0, _t1373_len, sizeof(string));
					for (int i = 0; i < _t1373_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1373, &it); 
 }
					
					int _t1372_len =  _t1373.len;
					array_array_string _t1372 = __new_array(0, _t1372_len, sizeof(array_string));
					for (int _t1374 = 0; _t1374 < _t1372_len; ++_t1374) {
						string it = ((string*)  _t1375.data)[_t1374];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1372, &ti);
					}
										route_words_a = _t1372;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1379_len = attrs.len;
					array_string _t1379 = __new_array(0, _t1379_len, sizeof(string));
					for (int i = 0; i < _t1379_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1379, &it); 
 }
					
int _t1377_len = attrs.len;
					array_string _t1377 = __new_array(0, _t1377_len, sizeof(string));
					for (int i = 0; i < _t1377_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1377, &it); 
 }
					
					int _t1376_len =  _t1377.len;
					array_array_string _t1376 = __new_array(0, _t1376_len, sizeof(array_string));
					for (int _t1378 = 0; _t1378 < _t1376_len; ++_t1378) {
						string it = ((string*)  _t1379.data)[_t1378];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1376, &ti);
					}
										route_words_a = _t1376;
				}
			} else {

int _t1383_len = attrs.len;
				array_string _t1383 = __new_array(0, _t1383_len, sizeof(string));
				for (int i = 0; i < _t1383_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1383, &it); 
 }
				
int _t1381_len = attrs.len;
				array_string _t1381 = __new_array(0, _t1381_len, sizeof(string));
				for (int i = 0; i < _t1381_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1381, &it); 
 }
				
				int _t1380_len =  _t1381.len;
				array_array_string _t1380 = __new_array(0, _t1380_len, sizeof(array_string));
				for (int _t1382 = 0; _t1382 < _t1380_len; ++_t1382) {
					string it = ((string*)  _t1383.data)[_t1382];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1380, &ti);
				}
								route_words_a = _t1380;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1384 = route_words_a;
				for (int _t1385 = 0; _t1385 < _t1384.len; ++_t1385) {
					array_string route_words = ((array_string*)_t1384.data)[_t1385];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_commits(app, , , string_int(((string*)vars.data) [3])  ); // vweb action call with args;
							// Defer begin
							Option_int _t1389 = net__Socket_close(conn);
							if (!_t1389.ok) {
								string err = _t1389.v_error;
								int errcode = _t1389.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 25
	method = tos_lit("commit");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/commit/:hash")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_commit(app, , ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1390 = net__Socket_close(conn);
				if (!_t1390.ok) {
					string err = _t1390.v_error;
					int errcode = _t1390.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1394_len = attrs.len;
					array_string _t1394 = __new_array(0, _t1394_len, sizeof(string));
					for (int i = 0; i < _t1394_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1394, &it); 
 }
					
int _t1392_len = attrs.len;
					array_string _t1392 = __new_array(0, _t1392_len, sizeof(string));
					for (int i = 0; i < _t1392_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1392, &it); 
 }
					
					int _t1391_len =  _t1392.len;
					array_array_string _t1391 = __new_array(0, _t1391_len, sizeof(array_string));
					for (int _t1393 = 0; _t1393 < _t1391_len; ++_t1393) {
						string it = ((string*)  _t1394.data)[_t1393];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1391, &ti);
					}
										route_words_a = _t1391;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1398_len = attrs.len;
					array_string _t1398 = __new_array(0, _t1398_len, sizeof(string));
					for (int i = 0; i < _t1398_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1398, &it); 
 }
					
int _t1396_len = attrs.len;
					array_string _t1396 = __new_array(0, _t1396_len, sizeof(string));
					for (int i = 0; i < _t1396_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1396, &it); 
 }
					
					int _t1395_len =  _t1396.len;
					array_array_string _t1395 = __new_array(0, _t1395_len, sizeof(array_string));
					for (int _t1397 = 0; _t1397 < _t1395_len; ++_t1397) {
						string it = ((string*)  _t1398.data)[_t1397];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1395, &ti);
					}
										route_words_a = _t1395;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1402_len = attrs.len;
					array_string _t1402 = __new_array(0, _t1402_len, sizeof(string));
					for (int i = 0; i < _t1402_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1402, &it); 
 }
					
int _t1400_len = attrs.len;
					array_string _t1400 = __new_array(0, _t1400_len, sizeof(string));
					for (int i = 0; i < _t1400_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1400, &it); 
 }
					
					int _t1399_len =  _t1400.len;
					array_array_string _t1399 = __new_array(0, _t1399_len, sizeof(array_string));
					for (int _t1401 = 0; _t1401 < _t1399_len; ++_t1401) {
						string it = ((string*)  _t1402.data)[_t1401];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1399, &ti);
					}
										route_words_a = _t1399;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1406_len = attrs.len;
					array_string _t1406 = __new_array(0, _t1406_len, sizeof(string));
					for (int i = 0; i < _t1406_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1406, &it); 
 }
					
int _t1404_len = attrs.len;
					array_string _t1404 = __new_array(0, _t1404_len, sizeof(string));
					for (int i = 0; i < _t1404_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1404, &it); 
 }
					
					int _t1403_len =  _t1404.len;
					array_array_string _t1403 = __new_array(0, _t1403_len, sizeof(array_string));
					for (int _t1405 = 0; _t1405 < _t1403_len; ++_t1405) {
						string it = ((string*)  _t1406.data)[_t1405];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1403, &ti);
					}
										route_words_a = _t1403;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1410_len = attrs.len;
					array_string _t1410 = __new_array(0, _t1410_len, sizeof(string));
					for (int i = 0; i < _t1410_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1410, &it); 
 }
					
int _t1408_len = attrs.len;
					array_string _t1408 = __new_array(0, _t1408_len, sizeof(string));
					for (int i = 0; i < _t1408_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1408, &it); 
 }
					
					int _t1407_len =  _t1408.len;
					array_array_string _t1407 = __new_array(0, _t1407_len, sizeof(array_string));
					for (int _t1409 = 0; _t1409 < _t1407_len; ++_t1409) {
						string it = ((string*)  _t1410.data)[_t1409];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1407, &ti);
					}
										route_words_a = _t1407;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1414_len = attrs.len;
					array_string _t1414 = __new_array(0, _t1414_len, sizeof(string));
					for (int i = 0; i < _t1414_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1414, &it); 
 }
					
int _t1412_len = attrs.len;
					array_string _t1412 = __new_array(0, _t1412_len, sizeof(string));
					for (int i = 0; i < _t1412_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1412, &it); 
 }
					
					int _t1411_len =  _t1412.len;
					array_array_string _t1411 = __new_array(0, _t1411_len, sizeof(array_string));
					for (int _t1413 = 0; _t1413 < _t1411_len; ++_t1413) {
						string it = ((string*)  _t1414.data)[_t1413];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1411, &ti);
					}
										route_words_a = _t1411;
				}
			} else {

int _t1418_len = attrs.len;
				array_string _t1418 = __new_array(0, _t1418_len, sizeof(string));
				for (int i = 0; i < _t1418_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1418, &it); 
 }
				
int _t1416_len = attrs.len;
				array_string _t1416 = __new_array(0, _t1416_len, sizeof(string));
				for (int i = 0; i < _t1416_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1416, &it); 
 }
				
				int _t1415_len =  _t1416.len;
				array_array_string _t1415 = __new_array(0, _t1415_len, sizeof(array_string));
				for (int _t1417 = 0; _t1417 < _t1415_len; ++_t1417) {
					string it = ((string*)  _t1418.data)[_t1417];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1415, &ti);
				}
								route_words_a = _t1415;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1419 = route_words_a;
				for (int _t1420 = 0; _t1420 < _t1419.len; ++_t1420) {
					array_string route_words = ((array_string*)_t1419.data)[_t1420];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_commit(app, , ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1424 = net__Socket_close(conn);
							if (!_t1424.ok) {
								string err = _t1424.v_error;
								int errcode = _t1424.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 26
	method = tos_lit("issues");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/:user/:repo/issues"), tos_lit("/:user/:repo/issues/:page_str")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_issues(app, , ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1425 = net__Socket_close(conn);
				if (!_t1425.ok) {
					string err = _t1425.v_error;
					int errcode = _t1425.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1429_len = attrs.len;
					array_string _t1429 = __new_array(0, _t1429_len, sizeof(string));
					for (int i = 0; i < _t1429_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1429, &it); 
 }
					
int _t1427_len = attrs.len;
					array_string _t1427 = __new_array(0, _t1427_len, sizeof(string));
					for (int i = 0; i < _t1427_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1427, &it); 
 }
					
					int _t1426_len =  _t1427.len;
					array_array_string _t1426 = __new_array(0, _t1426_len, sizeof(array_string));
					for (int _t1428 = 0; _t1428 < _t1426_len; ++_t1428) {
						string it = ((string*)  _t1429.data)[_t1428];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1426, &ti);
					}
										route_words_a = _t1426;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1433_len = attrs.len;
					array_string _t1433 = __new_array(0, _t1433_len, sizeof(string));
					for (int i = 0; i < _t1433_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1433, &it); 
 }
					
int _t1431_len = attrs.len;
					array_string _t1431 = __new_array(0, _t1431_len, sizeof(string));
					for (int i = 0; i < _t1431_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1431, &it); 
 }
					
					int _t1430_len =  _t1431.len;
					array_array_string _t1430 = __new_array(0, _t1430_len, sizeof(array_string));
					for (int _t1432 = 0; _t1432 < _t1430_len; ++_t1432) {
						string it = ((string*)  _t1433.data)[_t1432];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1430, &ti);
					}
										route_words_a = _t1430;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1437_len = attrs.len;
					array_string _t1437 = __new_array(0, _t1437_len, sizeof(string));
					for (int i = 0; i < _t1437_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1437, &it); 
 }
					
int _t1435_len = attrs.len;
					array_string _t1435 = __new_array(0, _t1435_len, sizeof(string));
					for (int i = 0; i < _t1435_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1435, &it); 
 }
					
					int _t1434_len =  _t1435.len;
					array_array_string _t1434 = __new_array(0, _t1434_len, sizeof(array_string));
					for (int _t1436 = 0; _t1436 < _t1434_len; ++_t1436) {
						string it = ((string*)  _t1437.data)[_t1436];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1434, &ti);
					}
										route_words_a = _t1434;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1441_len = attrs.len;
					array_string _t1441 = __new_array(0, _t1441_len, sizeof(string));
					for (int i = 0; i < _t1441_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1441, &it); 
 }
					
int _t1439_len = attrs.len;
					array_string _t1439 = __new_array(0, _t1439_len, sizeof(string));
					for (int i = 0; i < _t1439_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1439, &it); 
 }
					
					int _t1438_len =  _t1439.len;
					array_array_string _t1438 = __new_array(0, _t1438_len, sizeof(array_string));
					for (int _t1440 = 0; _t1440 < _t1438_len; ++_t1440) {
						string it = ((string*)  _t1441.data)[_t1440];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1438, &ti);
					}
										route_words_a = _t1438;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1445_len = attrs.len;
					array_string _t1445 = __new_array(0, _t1445_len, sizeof(string));
					for (int i = 0; i < _t1445_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1445, &it); 
 }
					
int _t1443_len = attrs.len;
					array_string _t1443 = __new_array(0, _t1443_len, sizeof(string));
					for (int i = 0; i < _t1443_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1443, &it); 
 }
					
					int _t1442_len =  _t1443.len;
					array_array_string _t1442 = __new_array(0, _t1442_len, sizeof(array_string));
					for (int _t1444 = 0; _t1444 < _t1442_len; ++_t1444) {
						string it = ((string*)  _t1445.data)[_t1444];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1442, &ti);
					}
										route_words_a = _t1442;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1449_len = attrs.len;
					array_string _t1449 = __new_array(0, _t1449_len, sizeof(string));
					for (int i = 0; i < _t1449_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1449, &it); 
 }
					
int _t1447_len = attrs.len;
					array_string _t1447 = __new_array(0, _t1447_len, sizeof(string));
					for (int i = 0; i < _t1447_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1447, &it); 
 }
					
					int _t1446_len =  _t1447.len;
					array_array_string _t1446 = __new_array(0, _t1446_len, sizeof(array_string));
					for (int _t1448 = 0; _t1448 < _t1446_len; ++_t1448) {
						string it = ((string*)  _t1449.data)[_t1448];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1446, &ti);
					}
										route_words_a = _t1446;
				}
			} else {

int _t1453_len = attrs.len;
				array_string _t1453 = __new_array(0, _t1453_len, sizeof(string));
				for (int i = 0; i < _t1453_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1453, &it); 
 }
				
int _t1451_len = attrs.len;
				array_string _t1451 = __new_array(0, _t1451_len, sizeof(string));
				for (int i = 0; i < _t1451_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1451, &it); 
 }
				
				int _t1450_len =  _t1451.len;
				array_array_string _t1450 = __new_array(0, _t1450_len, sizeof(array_string));
				for (int _t1452 = 0; _t1452 < _t1450_len; ++_t1452) {
					string it = ((string*)  _t1453.data)[_t1452];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1450, &ti);
				}
								route_words_a = _t1450;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1454 = route_words_a;
				for (int _t1455 = 0; _t1455 < _t1454.len; ++_t1455) {
					array_string route_words = ((array_string*)_t1454.data)[_t1455];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_issues(app, , ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1459 = net__Socket_close(conn);
							if (!_t1459.ok) {
								string err = _t1459.v_error;
								int errcode = _t1459.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 27
	method = tos_lit("issue");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/issue/:id")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_issue(app, , ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1460 = net__Socket_close(conn);
				if (!_t1460.ok) {
					string err = _t1460.v_error;
					int errcode = _t1460.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1464_len = attrs.len;
					array_string _t1464 = __new_array(0, _t1464_len, sizeof(string));
					for (int i = 0; i < _t1464_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1464, &it); 
 }
					
int _t1462_len = attrs.len;
					array_string _t1462 = __new_array(0, _t1462_len, sizeof(string));
					for (int i = 0; i < _t1462_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1462, &it); 
 }
					
					int _t1461_len =  _t1462.len;
					array_array_string _t1461 = __new_array(0, _t1461_len, sizeof(array_string));
					for (int _t1463 = 0; _t1463 < _t1461_len; ++_t1463) {
						string it = ((string*)  _t1464.data)[_t1463];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1461, &ti);
					}
										route_words_a = _t1461;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1468_len = attrs.len;
					array_string _t1468 = __new_array(0, _t1468_len, sizeof(string));
					for (int i = 0; i < _t1468_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1468, &it); 
 }
					
int _t1466_len = attrs.len;
					array_string _t1466 = __new_array(0, _t1466_len, sizeof(string));
					for (int i = 0; i < _t1466_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1466, &it); 
 }
					
					int _t1465_len =  _t1466.len;
					array_array_string _t1465 = __new_array(0, _t1465_len, sizeof(array_string));
					for (int _t1467 = 0; _t1467 < _t1465_len; ++_t1467) {
						string it = ((string*)  _t1468.data)[_t1467];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1465, &ti);
					}
										route_words_a = _t1465;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1472_len = attrs.len;
					array_string _t1472 = __new_array(0, _t1472_len, sizeof(string));
					for (int i = 0; i < _t1472_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1472, &it); 
 }
					
int _t1470_len = attrs.len;
					array_string _t1470 = __new_array(0, _t1470_len, sizeof(string));
					for (int i = 0; i < _t1470_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1470, &it); 
 }
					
					int _t1469_len =  _t1470.len;
					array_array_string _t1469 = __new_array(0, _t1469_len, sizeof(array_string));
					for (int _t1471 = 0; _t1471 < _t1469_len; ++_t1471) {
						string it = ((string*)  _t1472.data)[_t1471];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1469, &ti);
					}
										route_words_a = _t1469;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1476_len = attrs.len;
					array_string _t1476 = __new_array(0, _t1476_len, sizeof(string));
					for (int i = 0; i < _t1476_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1476, &it); 
 }
					
int _t1474_len = attrs.len;
					array_string _t1474 = __new_array(0, _t1474_len, sizeof(string));
					for (int i = 0; i < _t1474_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1474, &it); 
 }
					
					int _t1473_len =  _t1474.len;
					array_array_string _t1473 = __new_array(0, _t1473_len, sizeof(array_string));
					for (int _t1475 = 0; _t1475 < _t1473_len; ++_t1475) {
						string it = ((string*)  _t1476.data)[_t1475];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1473, &ti);
					}
										route_words_a = _t1473;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1480_len = attrs.len;
					array_string _t1480 = __new_array(0, _t1480_len, sizeof(string));
					for (int i = 0; i < _t1480_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1480, &it); 
 }
					
int _t1478_len = attrs.len;
					array_string _t1478 = __new_array(0, _t1478_len, sizeof(string));
					for (int i = 0; i < _t1478_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1478, &it); 
 }
					
					int _t1477_len =  _t1478.len;
					array_array_string _t1477 = __new_array(0, _t1477_len, sizeof(array_string));
					for (int _t1479 = 0; _t1479 < _t1477_len; ++_t1479) {
						string it = ((string*)  _t1480.data)[_t1479];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1477, &ti);
					}
										route_words_a = _t1477;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1484_len = attrs.len;
					array_string _t1484 = __new_array(0, _t1484_len, sizeof(string));
					for (int i = 0; i < _t1484_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1484, &it); 
 }
					
int _t1482_len = attrs.len;
					array_string _t1482 = __new_array(0, _t1482_len, sizeof(string));
					for (int i = 0; i < _t1482_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1482, &it); 
 }
					
					int _t1481_len =  _t1482.len;
					array_array_string _t1481 = __new_array(0, _t1481_len, sizeof(array_string));
					for (int _t1483 = 0; _t1483 < _t1481_len; ++_t1483) {
						string it = ((string*)  _t1484.data)[_t1483];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1481, &ti);
					}
										route_words_a = _t1481;
				}
			} else {

int _t1488_len = attrs.len;
				array_string _t1488 = __new_array(0, _t1488_len, sizeof(string));
				for (int i = 0; i < _t1488_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1488, &it); 
 }
				
int _t1486_len = attrs.len;
				array_string _t1486 = __new_array(0, _t1486_len, sizeof(string));
				for (int i = 0; i < _t1486_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1486, &it); 
 }
				
				int _t1485_len =  _t1486.len;
				array_array_string _t1485 = __new_array(0, _t1485_len, sizeof(array_string));
				for (int _t1487 = 0; _t1487 < _t1485_len; ++_t1487) {
					string it = ((string*)  _t1488.data)[_t1487];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1485, &ti);
				}
								route_words_a = _t1485;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1489 = route_words_a;
				for (int _t1490 = 0; _t1490 < _t1489.len; ++_t1490) {
					array_string route_words = ((array_string*)_t1489.data)[_t1490];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_issue(app, , ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1494 = net__Socket_close(conn);
							if (!_t1494.ok) {
								string err = _t1494.v_error;
								int errcode = _t1494.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 28
	method = tos_lit("pull");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/pull/:id")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_pull(app, , ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1495 = net__Socket_close(conn);
				if (!_t1495.ok) {
					string err = _t1495.v_error;
					int errcode = _t1495.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1499_len = attrs.len;
					array_string _t1499 = __new_array(0, _t1499_len, sizeof(string));
					for (int i = 0; i < _t1499_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1499, &it); 
 }
					
int _t1497_len = attrs.len;
					array_string _t1497 = __new_array(0, _t1497_len, sizeof(string));
					for (int i = 0; i < _t1497_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1497, &it); 
 }
					
					int _t1496_len =  _t1497.len;
					array_array_string _t1496 = __new_array(0, _t1496_len, sizeof(array_string));
					for (int _t1498 = 0; _t1498 < _t1496_len; ++_t1498) {
						string it = ((string*)  _t1499.data)[_t1498];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1496, &ti);
					}
										route_words_a = _t1496;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1503_len = attrs.len;
					array_string _t1503 = __new_array(0, _t1503_len, sizeof(string));
					for (int i = 0; i < _t1503_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1503, &it); 
 }
					
int _t1501_len = attrs.len;
					array_string _t1501 = __new_array(0, _t1501_len, sizeof(string));
					for (int i = 0; i < _t1501_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1501, &it); 
 }
					
					int _t1500_len =  _t1501.len;
					array_array_string _t1500 = __new_array(0, _t1500_len, sizeof(array_string));
					for (int _t1502 = 0; _t1502 < _t1500_len; ++_t1502) {
						string it = ((string*)  _t1503.data)[_t1502];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1500, &ti);
					}
										route_words_a = _t1500;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1507_len = attrs.len;
					array_string _t1507 = __new_array(0, _t1507_len, sizeof(string));
					for (int i = 0; i < _t1507_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1507, &it); 
 }
					
int _t1505_len = attrs.len;
					array_string _t1505 = __new_array(0, _t1505_len, sizeof(string));
					for (int i = 0; i < _t1505_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1505, &it); 
 }
					
					int _t1504_len =  _t1505.len;
					array_array_string _t1504 = __new_array(0, _t1504_len, sizeof(array_string));
					for (int _t1506 = 0; _t1506 < _t1504_len; ++_t1506) {
						string it = ((string*)  _t1507.data)[_t1506];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1504, &ti);
					}
										route_words_a = _t1504;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1511_len = attrs.len;
					array_string _t1511 = __new_array(0, _t1511_len, sizeof(string));
					for (int i = 0; i < _t1511_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1511, &it); 
 }
					
int _t1509_len = attrs.len;
					array_string _t1509 = __new_array(0, _t1509_len, sizeof(string));
					for (int i = 0; i < _t1509_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1509, &it); 
 }
					
					int _t1508_len =  _t1509.len;
					array_array_string _t1508 = __new_array(0, _t1508_len, sizeof(array_string));
					for (int _t1510 = 0; _t1510 < _t1508_len; ++_t1510) {
						string it = ((string*)  _t1511.data)[_t1510];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1508, &ti);
					}
										route_words_a = _t1508;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1515_len = attrs.len;
					array_string _t1515 = __new_array(0, _t1515_len, sizeof(string));
					for (int i = 0; i < _t1515_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1515, &it); 
 }
					
int _t1513_len = attrs.len;
					array_string _t1513 = __new_array(0, _t1513_len, sizeof(string));
					for (int i = 0; i < _t1513_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1513, &it); 
 }
					
					int _t1512_len =  _t1513.len;
					array_array_string _t1512 = __new_array(0, _t1512_len, sizeof(array_string));
					for (int _t1514 = 0; _t1514 < _t1512_len; ++_t1514) {
						string it = ((string*)  _t1515.data)[_t1514];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1512, &ti);
					}
										route_words_a = _t1512;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1519_len = attrs.len;
					array_string _t1519 = __new_array(0, _t1519_len, sizeof(string));
					for (int i = 0; i < _t1519_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1519, &it); 
 }
					
int _t1517_len = attrs.len;
					array_string _t1517 = __new_array(0, _t1517_len, sizeof(string));
					for (int i = 0; i < _t1517_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1517, &it); 
 }
					
					int _t1516_len =  _t1517.len;
					array_array_string _t1516 = __new_array(0, _t1516_len, sizeof(array_string));
					for (int _t1518 = 0; _t1518 < _t1516_len; ++_t1518) {
						string it = ((string*)  _t1519.data)[_t1518];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1516, &ti);
					}
										route_words_a = _t1516;
				}
			} else {

int _t1523_len = attrs.len;
				array_string _t1523 = __new_array(0, _t1523_len, sizeof(string));
				for (int i = 0; i < _t1523_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1523, &it); 
 }
				
int _t1521_len = attrs.len;
				array_string _t1521 = __new_array(0, _t1521_len, sizeof(string));
				for (int i = 0; i < _t1521_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1521, &it); 
 }
				
				int _t1520_len =  _t1521.len;
				array_array_string _t1520 = __new_array(0, _t1520_len, sizeof(array_string));
				for (int _t1522 = 0; _t1522 < _t1520_len; ++_t1522) {
					string it = ((string*)  _t1523.data)[_t1522];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1520, &ti);
				}
								route_words_a = _t1520;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1524 = route_words_a;
				for (int _t1525 = 0; _t1525 < _t1524.len; ++_t1525) {
					array_string route_words = ((array_string*)_t1524.data)[_t1525];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_pull(app, , ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1529 = net__Socket_close(conn);
							if (!_t1529.ok) {
								string err = _t1529.v_error;
								int errcode = _t1529.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 29
	method = tos_lit("contributors");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/contributors")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_contributors(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1530 = net__Socket_close(conn);
				if (!_t1530.ok) {
					string err = _t1530.v_error;
					int errcode = _t1530.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1534_len = attrs.len;
					array_string _t1534 = __new_array(0, _t1534_len, sizeof(string));
					for (int i = 0; i < _t1534_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1534, &it); 
 }
					
int _t1532_len = attrs.len;
					array_string _t1532 = __new_array(0, _t1532_len, sizeof(string));
					for (int i = 0; i < _t1532_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1532, &it); 
 }
					
					int _t1531_len =  _t1532.len;
					array_array_string _t1531 = __new_array(0, _t1531_len, sizeof(array_string));
					for (int _t1533 = 0; _t1533 < _t1531_len; ++_t1533) {
						string it = ((string*)  _t1534.data)[_t1533];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1531, &ti);
					}
										route_words_a = _t1531;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1538_len = attrs.len;
					array_string _t1538 = __new_array(0, _t1538_len, sizeof(string));
					for (int i = 0; i < _t1538_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1538, &it); 
 }
					
int _t1536_len = attrs.len;
					array_string _t1536 = __new_array(0, _t1536_len, sizeof(string));
					for (int i = 0; i < _t1536_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1536, &it); 
 }
					
					int _t1535_len =  _t1536.len;
					array_array_string _t1535 = __new_array(0, _t1535_len, sizeof(array_string));
					for (int _t1537 = 0; _t1537 < _t1535_len; ++_t1537) {
						string it = ((string*)  _t1538.data)[_t1537];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1535, &ti);
					}
										route_words_a = _t1535;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1542_len = attrs.len;
					array_string _t1542 = __new_array(0, _t1542_len, sizeof(string));
					for (int i = 0; i < _t1542_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1542, &it); 
 }
					
int _t1540_len = attrs.len;
					array_string _t1540 = __new_array(0, _t1540_len, sizeof(string));
					for (int i = 0; i < _t1540_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1540, &it); 
 }
					
					int _t1539_len =  _t1540.len;
					array_array_string _t1539 = __new_array(0, _t1539_len, sizeof(array_string));
					for (int _t1541 = 0; _t1541 < _t1539_len; ++_t1541) {
						string it = ((string*)  _t1542.data)[_t1541];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1539, &ti);
					}
										route_words_a = _t1539;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1546_len = attrs.len;
					array_string _t1546 = __new_array(0, _t1546_len, sizeof(string));
					for (int i = 0; i < _t1546_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1546, &it); 
 }
					
int _t1544_len = attrs.len;
					array_string _t1544 = __new_array(0, _t1544_len, sizeof(string));
					for (int i = 0; i < _t1544_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1544, &it); 
 }
					
					int _t1543_len =  _t1544.len;
					array_array_string _t1543 = __new_array(0, _t1543_len, sizeof(array_string));
					for (int _t1545 = 0; _t1545 < _t1543_len; ++_t1545) {
						string it = ((string*)  _t1546.data)[_t1545];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1543, &ti);
					}
										route_words_a = _t1543;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1550_len = attrs.len;
					array_string _t1550 = __new_array(0, _t1550_len, sizeof(string));
					for (int i = 0; i < _t1550_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1550, &it); 
 }
					
int _t1548_len = attrs.len;
					array_string _t1548 = __new_array(0, _t1548_len, sizeof(string));
					for (int i = 0; i < _t1548_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1548, &it); 
 }
					
					int _t1547_len =  _t1548.len;
					array_array_string _t1547 = __new_array(0, _t1547_len, sizeof(array_string));
					for (int _t1549 = 0; _t1549 < _t1547_len; ++_t1549) {
						string it = ((string*)  _t1550.data)[_t1549];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1547, &ti);
					}
										route_words_a = _t1547;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1554_len = attrs.len;
					array_string _t1554 = __new_array(0, _t1554_len, sizeof(string));
					for (int i = 0; i < _t1554_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1554, &it); 
 }
					
int _t1552_len = attrs.len;
					array_string _t1552 = __new_array(0, _t1552_len, sizeof(string));
					for (int i = 0; i < _t1552_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1552, &it); 
 }
					
					int _t1551_len =  _t1552.len;
					array_array_string _t1551 = __new_array(0, _t1551_len, sizeof(array_string));
					for (int _t1553 = 0; _t1553 < _t1551_len; ++_t1553) {
						string it = ((string*)  _t1554.data)[_t1553];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1551, &ti);
					}
										route_words_a = _t1551;
				}
			} else {

int _t1558_len = attrs.len;
				array_string _t1558 = __new_array(0, _t1558_len, sizeof(string));
				for (int i = 0; i < _t1558_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1558, &it); 
 }
				
int _t1556_len = attrs.len;
				array_string _t1556 = __new_array(0, _t1556_len, sizeof(string));
				for (int i = 0; i < _t1556_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1556, &it); 
 }
				
				int _t1555_len =  _t1556.len;
				array_array_string _t1555 = __new_array(0, _t1555_len, sizeof(array_string));
				for (int _t1557 = 0; _t1557 < _t1555_len; ++_t1557) {
					string it = ((string*)  _t1558.data)[_t1557];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1555, &ti);
				}
								route_words_a = _t1555;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1559 = route_words_a;
				for (int _t1560 = 0; _t1560 < _t1559.len; ++_t1560) {
					array_string route_words = ((array_string*)_t1559.data)[_t1560];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_contributors(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1564 = net__Socket_close(conn);
							if (!_t1564.ok) {
								string err = _t1564.v_error;
								int errcode = _t1564.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 30
	method = tos_lit("branches");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/branches")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_branches(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1565 = net__Socket_close(conn);
				if (!_t1565.ok) {
					string err = _t1565.v_error;
					int errcode = _t1565.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1569_len = attrs.len;
					array_string _t1569 = __new_array(0, _t1569_len, sizeof(string));
					for (int i = 0; i < _t1569_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1569, &it); 
 }
					
int _t1567_len = attrs.len;
					array_string _t1567 = __new_array(0, _t1567_len, sizeof(string));
					for (int i = 0; i < _t1567_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1567, &it); 
 }
					
					int _t1566_len =  _t1567.len;
					array_array_string _t1566 = __new_array(0, _t1566_len, sizeof(array_string));
					for (int _t1568 = 0; _t1568 < _t1566_len; ++_t1568) {
						string it = ((string*)  _t1569.data)[_t1568];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1566, &ti);
					}
										route_words_a = _t1566;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1573_len = attrs.len;
					array_string _t1573 = __new_array(0, _t1573_len, sizeof(string));
					for (int i = 0; i < _t1573_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1573, &it); 
 }
					
int _t1571_len = attrs.len;
					array_string _t1571 = __new_array(0, _t1571_len, sizeof(string));
					for (int i = 0; i < _t1571_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1571, &it); 
 }
					
					int _t1570_len =  _t1571.len;
					array_array_string _t1570 = __new_array(0, _t1570_len, sizeof(array_string));
					for (int _t1572 = 0; _t1572 < _t1570_len; ++_t1572) {
						string it = ((string*)  _t1573.data)[_t1572];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1570, &ti);
					}
										route_words_a = _t1570;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1577_len = attrs.len;
					array_string _t1577 = __new_array(0, _t1577_len, sizeof(string));
					for (int i = 0; i < _t1577_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1577, &it); 
 }
					
int _t1575_len = attrs.len;
					array_string _t1575 = __new_array(0, _t1575_len, sizeof(string));
					for (int i = 0; i < _t1575_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1575, &it); 
 }
					
					int _t1574_len =  _t1575.len;
					array_array_string _t1574 = __new_array(0, _t1574_len, sizeof(array_string));
					for (int _t1576 = 0; _t1576 < _t1574_len; ++_t1576) {
						string it = ((string*)  _t1577.data)[_t1576];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1574, &ti);
					}
										route_words_a = _t1574;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1581_len = attrs.len;
					array_string _t1581 = __new_array(0, _t1581_len, sizeof(string));
					for (int i = 0; i < _t1581_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1581, &it); 
 }
					
int _t1579_len = attrs.len;
					array_string _t1579 = __new_array(0, _t1579_len, sizeof(string));
					for (int i = 0; i < _t1579_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1579, &it); 
 }
					
					int _t1578_len =  _t1579.len;
					array_array_string _t1578 = __new_array(0, _t1578_len, sizeof(array_string));
					for (int _t1580 = 0; _t1580 < _t1578_len; ++_t1580) {
						string it = ((string*)  _t1581.data)[_t1580];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1578, &ti);
					}
										route_words_a = _t1578;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1585_len = attrs.len;
					array_string _t1585 = __new_array(0, _t1585_len, sizeof(string));
					for (int i = 0; i < _t1585_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1585, &it); 
 }
					
int _t1583_len = attrs.len;
					array_string _t1583 = __new_array(0, _t1583_len, sizeof(string));
					for (int i = 0; i < _t1583_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1583, &it); 
 }
					
					int _t1582_len =  _t1583.len;
					array_array_string _t1582 = __new_array(0, _t1582_len, sizeof(array_string));
					for (int _t1584 = 0; _t1584 < _t1582_len; ++_t1584) {
						string it = ((string*)  _t1585.data)[_t1584];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1582, &ti);
					}
										route_words_a = _t1582;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1589_len = attrs.len;
					array_string _t1589 = __new_array(0, _t1589_len, sizeof(string));
					for (int i = 0; i < _t1589_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1589, &it); 
 }
					
int _t1587_len = attrs.len;
					array_string _t1587 = __new_array(0, _t1587_len, sizeof(string));
					for (int i = 0; i < _t1587_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1587, &it); 
 }
					
					int _t1586_len =  _t1587.len;
					array_array_string _t1586 = __new_array(0, _t1586_len, sizeof(array_string));
					for (int _t1588 = 0; _t1588 < _t1586_len; ++_t1588) {
						string it = ((string*)  _t1589.data)[_t1588];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1586, &ti);
					}
										route_words_a = _t1586;
				}
			} else {

int _t1593_len = attrs.len;
				array_string _t1593 = __new_array(0, _t1593_len, sizeof(string));
				for (int i = 0; i < _t1593_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1593, &it); 
 }
				
int _t1591_len = attrs.len;
				array_string _t1591 = __new_array(0, _t1591_len, sizeof(string));
				for (int i = 0; i < _t1591_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1591, &it); 
 }
				
				int _t1590_len =  _t1591.len;
				array_array_string _t1590 = __new_array(0, _t1590_len, sizeof(array_string));
				for (int _t1592 = 0; _t1592 < _t1590_len; ++_t1592) {
					string it = ((string*)  _t1593.data)[_t1592];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1590, &ti);
				}
								route_words_a = _t1590;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1594 = route_words_a;
				for (int _t1595 = 0; _t1595 < _t1594.len; ++_t1595) {
					array_string route_words = ((array_string*)_t1594.data)[_t1595];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_branches(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1599 = net__Socket_close(conn);
							if (!_t1599.ok) {
								string err = _t1599.v_error;
								int errcode = _t1599.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 31
	method = tos_lit("releases");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/releases")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_releases(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1600 = net__Socket_close(conn);
				if (!_t1600.ok) {
					string err = _t1600.v_error;
					int errcode = _t1600.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1604_len = attrs.len;
					array_string _t1604 = __new_array(0, _t1604_len, sizeof(string));
					for (int i = 0; i < _t1604_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1604, &it); 
 }
					
int _t1602_len = attrs.len;
					array_string _t1602 = __new_array(0, _t1602_len, sizeof(string));
					for (int i = 0; i < _t1602_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1602, &it); 
 }
					
					int _t1601_len =  _t1602.len;
					array_array_string _t1601 = __new_array(0, _t1601_len, sizeof(array_string));
					for (int _t1603 = 0; _t1603 < _t1601_len; ++_t1603) {
						string it = ((string*)  _t1604.data)[_t1603];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1601, &ti);
					}
										route_words_a = _t1601;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1608_len = attrs.len;
					array_string _t1608 = __new_array(0, _t1608_len, sizeof(string));
					for (int i = 0; i < _t1608_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1608, &it); 
 }
					
int _t1606_len = attrs.len;
					array_string _t1606 = __new_array(0, _t1606_len, sizeof(string));
					for (int i = 0; i < _t1606_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1606, &it); 
 }
					
					int _t1605_len =  _t1606.len;
					array_array_string _t1605 = __new_array(0, _t1605_len, sizeof(array_string));
					for (int _t1607 = 0; _t1607 < _t1605_len; ++_t1607) {
						string it = ((string*)  _t1608.data)[_t1607];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1605, &ti);
					}
										route_words_a = _t1605;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1612_len = attrs.len;
					array_string _t1612 = __new_array(0, _t1612_len, sizeof(string));
					for (int i = 0; i < _t1612_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1612, &it); 
 }
					
int _t1610_len = attrs.len;
					array_string _t1610 = __new_array(0, _t1610_len, sizeof(string));
					for (int i = 0; i < _t1610_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1610, &it); 
 }
					
					int _t1609_len =  _t1610.len;
					array_array_string _t1609 = __new_array(0, _t1609_len, sizeof(array_string));
					for (int _t1611 = 0; _t1611 < _t1609_len; ++_t1611) {
						string it = ((string*)  _t1612.data)[_t1611];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1609, &ti);
					}
										route_words_a = _t1609;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1616_len = attrs.len;
					array_string _t1616 = __new_array(0, _t1616_len, sizeof(string));
					for (int i = 0; i < _t1616_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1616, &it); 
 }
					
int _t1614_len = attrs.len;
					array_string _t1614 = __new_array(0, _t1614_len, sizeof(string));
					for (int i = 0; i < _t1614_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1614, &it); 
 }
					
					int _t1613_len =  _t1614.len;
					array_array_string _t1613 = __new_array(0, _t1613_len, sizeof(array_string));
					for (int _t1615 = 0; _t1615 < _t1613_len; ++_t1615) {
						string it = ((string*)  _t1616.data)[_t1615];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1613, &ti);
					}
										route_words_a = _t1613;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1620_len = attrs.len;
					array_string _t1620 = __new_array(0, _t1620_len, sizeof(string));
					for (int i = 0; i < _t1620_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1620, &it); 
 }
					
int _t1618_len = attrs.len;
					array_string _t1618 = __new_array(0, _t1618_len, sizeof(string));
					for (int i = 0; i < _t1618_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1618, &it); 
 }
					
					int _t1617_len =  _t1618.len;
					array_array_string _t1617 = __new_array(0, _t1617_len, sizeof(array_string));
					for (int _t1619 = 0; _t1619 < _t1617_len; ++_t1619) {
						string it = ((string*)  _t1620.data)[_t1619];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1617, &ti);
					}
										route_words_a = _t1617;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1624_len = attrs.len;
					array_string _t1624 = __new_array(0, _t1624_len, sizeof(string));
					for (int i = 0; i < _t1624_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1624, &it); 
 }
					
int _t1622_len = attrs.len;
					array_string _t1622 = __new_array(0, _t1622_len, sizeof(string));
					for (int i = 0; i < _t1622_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1622, &it); 
 }
					
					int _t1621_len =  _t1622.len;
					array_array_string _t1621 = __new_array(0, _t1621_len, sizeof(array_string));
					for (int _t1623 = 0; _t1623 < _t1621_len; ++_t1623) {
						string it = ((string*)  _t1624.data)[_t1623];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1621, &ti);
					}
										route_words_a = _t1621;
				}
			} else {

int _t1628_len = attrs.len;
				array_string _t1628 = __new_array(0, _t1628_len, sizeof(string));
				for (int i = 0; i < _t1628_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1628, &it); 
 }
				
int _t1626_len = attrs.len;
				array_string _t1626 = __new_array(0, _t1626_len, sizeof(string));
				for (int i = 0; i < _t1626_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1626, &it); 
 }
				
				int _t1625_len =  _t1626.len;
				array_array_string _t1625 = __new_array(0, _t1625_len, sizeof(array_string));
				for (int _t1627 = 0; _t1627 < _t1625_len; ++_t1627) {
					string it = ((string*)  _t1628.data)[_t1627];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1625, &ti);
				}
								route_words_a = _t1625;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1629 = route_words_a;
				for (int _t1630 = 0; _t1630 < _t1629.len; ++_t1630) {
					array_string route_words = ((array_string*)_t1629.data)[_t1630];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_releases(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1634 = net__Socket_close(conn);
							if (!_t1634.ok) {
								string err = _t1634.v_error;
								int errcode = _t1634.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 32
	method = tos_lit("blob");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/blob/:branch/:path...")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_blob(app, , , ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1635 = net__Socket_close(conn);
				if (!_t1635.ok) {
					string err = _t1635.v_error;
					int errcode = _t1635.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1639_len = attrs.len;
					array_string _t1639 = __new_array(0, _t1639_len, sizeof(string));
					for (int i = 0; i < _t1639_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1639, &it); 
 }
					
int _t1637_len = attrs.len;
					array_string _t1637 = __new_array(0, _t1637_len, sizeof(string));
					for (int i = 0; i < _t1637_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1637, &it); 
 }
					
					int _t1636_len =  _t1637.len;
					array_array_string _t1636 = __new_array(0, _t1636_len, sizeof(array_string));
					for (int _t1638 = 0; _t1638 < _t1636_len; ++_t1638) {
						string it = ((string*)  _t1639.data)[_t1638];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1636, &ti);
					}
										route_words_a = _t1636;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1643_len = attrs.len;
					array_string _t1643 = __new_array(0, _t1643_len, sizeof(string));
					for (int i = 0; i < _t1643_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1643, &it); 
 }
					
int _t1641_len = attrs.len;
					array_string _t1641 = __new_array(0, _t1641_len, sizeof(string));
					for (int i = 0; i < _t1641_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1641, &it); 
 }
					
					int _t1640_len =  _t1641.len;
					array_array_string _t1640 = __new_array(0, _t1640_len, sizeof(array_string));
					for (int _t1642 = 0; _t1642 < _t1640_len; ++_t1642) {
						string it = ((string*)  _t1643.data)[_t1642];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1640, &ti);
					}
										route_words_a = _t1640;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1647_len = attrs.len;
					array_string _t1647 = __new_array(0, _t1647_len, sizeof(string));
					for (int i = 0; i < _t1647_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1647, &it); 
 }
					
int _t1645_len = attrs.len;
					array_string _t1645 = __new_array(0, _t1645_len, sizeof(string));
					for (int i = 0; i < _t1645_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1645, &it); 
 }
					
					int _t1644_len =  _t1645.len;
					array_array_string _t1644 = __new_array(0, _t1644_len, sizeof(array_string));
					for (int _t1646 = 0; _t1646 < _t1644_len; ++_t1646) {
						string it = ((string*)  _t1647.data)[_t1646];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1644, &ti);
					}
										route_words_a = _t1644;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1651_len = attrs.len;
					array_string _t1651 = __new_array(0, _t1651_len, sizeof(string));
					for (int i = 0; i < _t1651_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1651, &it); 
 }
					
int _t1649_len = attrs.len;
					array_string _t1649 = __new_array(0, _t1649_len, sizeof(string));
					for (int i = 0; i < _t1649_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1649, &it); 
 }
					
					int _t1648_len =  _t1649.len;
					array_array_string _t1648 = __new_array(0, _t1648_len, sizeof(array_string));
					for (int _t1650 = 0; _t1650 < _t1648_len; ++_t1650) {
						string it = ((string*)  _t1651.data)[_t1650];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1648, &ti);
					}
										route_words_a = _t1648;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1655_len = attrs.len;
					array_string _t1655 = __new_array(0, _t1655_len, sizeof(string));
					for (int i = 0; i < _t1655_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1655, &it); 
 }
					
int _t1653_len = attrs.len;
					array_string _t1653 = __new_array(0, _t1653_len, sizeof(string));
					for (int i = 0; i < _t1653_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1653, &it); 
 }
					
					int _t1652_len =  _t1653.len;
					array_array_string _t1652 = __new_array(0, _t1652_len, sizeof(array_string));
					for (int _t1654 = 0; _t1654 < _t1652_len; ++_t1654) {
						string it = ((string*)  _t1655.data)[_t1654];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1652, &ti);
					}
										route_words_a = _t1652;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1659_len = attrs.len;
					array_string _t1659 = __new_array(0, _t1659_len, sizeof(string));
					for (int i = 0; i < _t1659_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1659, &it); 
 }
					
int _t1657_len = attrs.len;
					array_string _t1657 = __new_array(0, _t1657_len, sizeof(string));
					for (int i = 0; i < _t1657_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1657, &it); 
 }
					
					int _t1656_len =  _t1657.len;
					array_array_string _t1656 = __new_array(0, _t1656_len, sizeof(array_string));
					for (int _t1658 = 0; _t1658 < _t1656_len; ++_t1658) {
						string it = ((string*)  _t1659.data)[_t1658];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1656, &ti);
					}
										route_words_a = _t1656;
				}
			} else {

int _t1663_len = attrs.len;
				array_string _t1663 = __new_array(0, _t1663_len, sizeof(string));
				for (int i = 0; i < _t1663_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1663, &it); 
 }
				
int _t1661_len = attrs.len;
				array_string _t1661 = __new_array(0, _t1661_len, sizeof(string));
				for (int i = 0; i < _t1661_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1661, &it); 
 }
				
				int _t1660_len =  _t1661.len;
				array_array_string _t1660 = __new_array(0, _t1660_len, sizeof(array_string));
				for (int _t1662 = 0; _t1662 < _t1660_len; ++_t1662) {
					string it = ((string*)  _t1663.data)[_t1662];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1660, &ti);
				}
								route_words_a = _t1660;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1664 = route_words_a;
				for (int _t1665 = 0; _t1665 < _t1664.len; ++_t1665) {
					array_string route_words = ((array_string*)_t1664.data)[_t1665];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_blob(app, , , ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1669 = net__Socket_close(conn);
							if (!_t1669.ok) {
								string err = _t1669.v_error;
								int errcode = _t1669.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 33
	method = tos_lit("new_issue");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/issues/new")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_new_issue(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1670 = net__Socket_close(conn);
				if (!_t1670.ok) {
					string err = _t1670.v_error;
					int errcode = _t1670.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1674_len = attrs.len;
					array_string _t1674 = __new_array(0, _t1674_len, sizeof(string));
					for (int i = 0; i < _t1674_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1674, &it); 
 }
					
int _t1672_len = attrs.len;
					array_string _t1672 = __new_array(0, _t1672_len, sizeof(string));
					for (int i = 0; i < _t1672_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1672, &it); 
 }
					
					int _t1671_len =  _t1672.len;
					array_array_string _t1671 = __new_array(0, _t1671_len, sizeof(array_string));
					for (int _t1673 = 0; _t1673 < _t1671_len; ++_t1673) {
						string it = ((string*)  _t1674.data)[_t1673];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1671, &ti);
					}
										route_words_a = _t1671;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1678_len = attrs.len;
					array_string _t1678 = __new_array(0, _t1678_len, sizeof(string));
					for (int i = 0; i < _t1678_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1678, &it); 
 }
					
int _t1676_len = attrs.len;
					array_string _t1676 = __new_array(0, _t1676_len, sizeof(string));
					for (int i = 0; i < _t1676_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1676, &it); 
 }
					
					int _t1675_len =  _t1676.len;
					array_array_string _t1675 = __new_array(0, _t1675_len, sizeof(array_string));
					for (int _t1677 = 0; _t1677 < _t1675_len; ++_t1677) {
						string it = ((string*)  _t1678.data)[_t1677];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1675, &ti);
					}
										route_words_a = _t1675;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1682_len = attrs.len;
					array_string _t1682 = __new_array(0, _t1682_len, sizeof(string));
					for (int i = 0; i < _t1682_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1682, &it); 
 }
					
int _t1680_len = attrs.len;
					array_string _t1680 = __new_array(0, _t1680_len, sizeof(string));
					for (int i = 0; i < _t1680_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1680, &it); 
 }
					
					int _t1679_len =  _t1680.len;
					array_array_string _t1679 = __new_array(0, _t1679_len, sizeof(array_string));
					for (int _t1681 = 0; _t1681 < _t1679_len; ++_t1681) {
						string it = ((string*)  _t1682.data)[_t1681];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1679, &ti);
					}
										route_words_a = _t1679;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1686_len = attrs.len;
					array_string _t1686 = __new_array(0, _t1686_len, sizeof(string));
					for (int i = 0; i < _t1686_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1686, &it); 
 }
					
int _t1684_len = attrs.len;
					array_string _t1684 = __new_array(0, _t1684_len, sizeof(string));
					for (int i = 0; i < _t1684_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1684, &it); 
 }
					
					int _t1683_len =  _t1684.len;
					array_array_string _t1683 = __new_array(0, _t1683_len, sizeof(array_string));
					for (int _t1685 = 0; _t1685 < _t1683_len; ++_t1685) {
						string it = ((string*)  _t1686.data)[_t1685];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1683, &ti);
					}
										route_words_a = _t1683;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1690_len = attrs.len;
					array_string _t1690 = __new_array(0, _t1690_len, sizeof(string));
					for (int i = 0; i < _t1690_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1690, &it); 
 }
					
int _t1688_len = attrs.len;
					array_string _t1688 = __new_array(0, _t1688_len, sizeof(string));
					for (int i = 0; i < _t1688_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1688, &it); 
 }
					
					int _t1687_len =  _t1688.len;
					array_array_string _t1687 = __new_array(0, _t1687_len, sizeof(array_string));
					for (int _t1689 = 0; _t1689 < _t1687_len; ++_t1689) {
						string it = ((string*)  _t1690.data)[_t1689];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1687, &ti);
					}
										route_words_a = _t1687;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1694_len = attrs.len;
					array_string _t1694 = __new_array(0, _t1694_len, sizeof(string));
					for (int i = 0; i < _t1694_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1694, &it); 
 }
					
int _t1692_len = attrs.len;
					array_string _t1692 = __new_array(0, _t1692_len, sizeof(string));
					for (int i = 0; i < _t1692_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1692, &it); 
 }
					
					int _t1691_len =  _t1692.len;
					array_array_string _t1691 = __new_array(0, _t1691_len, sizeof(array_string));
					for (int _t1693 = 0; _t1693 < _t1691_len; ++_t1693) {
						string it = ((string*)  _t1694.data)[_t1693];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1691, &ti);
					}
										route_words_a = _t1691;
				}
			} else {

int _t1698_len = attrs.len;
				array_string _t1698 = __new_array(0, _t1698_len, sizeof(string));
				for (int i = 0; i < _t1698_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1698, &it); 
 }
				
int _t1696_len = attrs.len;
				array_string _t1696 = __new_array(0, _t1696_len, sizeof(string));
				for (int i = 0; i < _t1696_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1696, &it); 
 }
				
				int _t1695_len =  _t1696.len;
				array_array_string _t1695 = __new_array(0, _t1695_len, sizeof(array_string));
				for (int _t1697 = 0; _t1697 < _t1695_len; ++_t1697) {
					string it = ((string*)  _t1698.data)[_t1697];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1695, &ti);
				}
								route_words_a = _t1695;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1699 = route_words_a;
				for (int _t1700 = 0; _t1700 < _t1699.len; ++_t1700) {
					array_string route_words = ((array_string*)_t1699.data)[_t1700];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_new_issue(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1704 = net__Socket_close(conn);
							if (!_t1704.ok) {
								string err = _t1704.v_error;
								int errcode = _t1704.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 34
	method = tos_lit("add_issue");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/issues/new")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_add_issue(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1705 = net__Socket_close(conn);
				if (!_t1705.ok) {
					string err = _t1705.v_error;
					int errcode = _t1705.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1709_len = attrs.len;
					array_string _t1709 = __new_array(0, _t1709_len, sizeof(string));
					for (int i = 0; i < _t1709_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1709, &it); 
 }
					
int _t1707_len = attrs.len;
					array_string _t1707 = __new_array(0, _t1707_len, sizeof(string));
					for (int i = 0; i < _t1707_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1707, &it); 
 }
					
					int _t1706_len =  _t1707.len;
					array_array_string _t1706 = __new_array(0, _t1706_len, sizeof(array_string));
					for (int _t1708 = 0; _t1708 < _t1706_len; ++_t1708) {
						string it = ((string*)  _t1709.data)[_t1708];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1706, &ti);
					}
										route_words_a = _t1706;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1713_len = attrs.len;
					array_string _t1713 = __new_array(0, _t1713_len, sizeof(string));
					for (int i = 0; i < _t1713_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1713, &it); 
 }
					
int _t1711_len = attrs.len;
					array_string _t1711 = __new_array(0, _t1711_len, sizeof(string));
					for (int i = 0; i < _t1711_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1711, &it); 
 }
					
					int _t1710_len =  _t1711.len;
					array_array_string _t1710 = __new_array(0, _t1710_len, sizeof(array_string));
					for (int _t1712 = 0; _t1712 < _t1710_len; ++_t1712) {
						string it = ((string*)  _t1713.data)[_t1712];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1710, &ti);
					}
										route_words_a = _t1710;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1717_len = attrs.len;
					array_string _t1717 = __new_array(0, _t1717_len, sizeof(string));
					for (int i = 0; i < _t1717_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1717, &it); 
 }
					
int _t1715_len = attrs.len;
					array_string _t1715 = __new_array(0, _t1715_len, sizeof(string));
					for (int i = 0; i < _t1715_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1715, &it); 
 }
					
					int _t1714_len =  _t1715.len;
					array_array_string _t1714 = __new_array(0, _t1714_len, sizeof(array_string));
					for (int _t1716 = 0; _t1716 < _t1714_len; ++_t1716) {
						string it = ((string*)  _t1717.data)[_t1716];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1714, &ti);
					}
										route_words_a = _t1714;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1721_len = attrs.len;
					array_string _t1721 = __new_array(0, _t1721_len, sizeof(string));
					for (int i = 0; i < _t1721_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1721, &it); 
 }
					
int _t1719_len = attrs.len;
					array_string _t1719 = __new_array(0, _t1719_len, sizeof(string));
					for (int i = 0; i < _t1719_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1719, &it); 
 }
					
					int _t1718_len =  _t1719.len;
					array_array_string _t1718 = __new_array(0, _t1718_len, sizeof(array_string));
					for (int _t1720 = 0; _t1720 < _t1718_len; ++_t1720) {
						string it = ((string*)  _t1721.data)[_t1720];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1718, &ti);
					}
										route_words_a = _t1718;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1725_len = attrs.len;
					array_string _t1725 = __new_array(0, _t1725_len, sizeof(string));
					for (int i = 0; i < _t1725_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1725, &it); 
 }
					
int _t1723_len = attrs.len;
					array_string _t1723 = __new_array(0, _t1723_len, sizeof(string));
					for (int i = 0; i < _t1723_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1723, &it); 
 }
					
					int _t1722_len =  _t1723.len;
					array_array_string _t1722 = __new_array(0, _t1722_len, sizeof(array_string));
					for (int _t1724 = 0; _t1724 < _t1722_len; ++_t1724) {
						string it = ((string*)  _t1725.data)[_t1724];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1722, &ti);
					}
										route_words_a = _t1722;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1729_len = attrs.len;
					array_string _t1729 = __new_array(0, _t1729_len, sizeof(string));
					for (int i = 0; i < _t1729_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1729, &it); 
 }
					
int _t1727_len = attrs.len;
					array_string _t1727 = __new_array(0, _t1727_len, sizeof(string));
					for (int i = 0; i < _t1727_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1727, &it); 
 }
					
					int _t1726_len =  _t1727.len;
					array_array_string _t1726 = __new_array(0, _t1726_len, sizeof(array_string));
					for (int _t1728 = 0; _t1728 < _t1726_len; ++_t1728) {
						string it = ((string*)  _t1729.data)[_t1728];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1726, &ti);
					}
										route_words_a = _t1726;
				}
			} else {

int _t1733_len = attrs.len;
				array_string _t1733 = __new_array(0, _t1733_len, sizeof(string));
				for (int i = 0; i < _t1733_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1733, &it); 
 }
				
int _t1731_len = attrs.len;
				array_string _t1731 = __new_array(0, _t1731_len, sizeof(string));
				for (int i = 0; i < _t1731_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1731, &it); 
 }
				
				int _t1730_len =  _t1731.len;
				array_array_string _t1730 = __new_array(0, _t1730_len, sizeof(array_string));
				for (int _t1732 = 0; _t1732 < _t1730_len; ++_t1732) {
					string it = ((string*)  _t1733.data)[_t1732];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1730, &ti);
				}
								route_words_a = _t1730;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1734 = route_words_a;
				for (int _t1735 = 0; _t1735 < _t1734.len; ++_t1735) {
					array_string route_words = ((array_string*)_t1734.data)[_t1735];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_add_issue(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1739 = net__Socket_close(conn);
							if (!_t1739.ok) {
								string err = _t1739.v_error;
								int errcode = _t1739.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 35
	method = tos_lit("add_comment");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/comment")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_add_comment(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1740 = net__Socket_close(conn);
				if (!_t1740.ok) {
					string err = _t1740.v_error;
					int errcode = _t1740.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1744_len = attrs.len;
					array_string _t1744 = __new_array(0, _t1744_len, sizeof(string));
					for (int i = 0; i < _t1744_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1744, &it); 
 }
					
int _t1742_len = attrs.len;
					array_string _t1742 = __new_array(0, _t1742_len, sizeof(string));
					for (int i = 0; i < _t1742_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1742, &it); 
 }
					
					int _t1741_len =  _t1742.len;
					array_array_string _t1741 = __new_array(0, _t1741_len, sizeof(array_string));
					for (int _t1743 = 0; _t1743 < _t1741_len; ++_t1743) {
						string it = ((string*)  _t1744.data)[_t1743];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1741, &ti);
					}
										route_words_a = _t1741;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1748_len = attrs.len;
					array_string _t1748 = __new_array(0, _t1748_len, sizeof(string));
					for (int i = 0; i < _t1748_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1748, &it); 
 }
					
int _t1746_len = attrs.len;
					array_string _t1746 = __new_array(0, _t1746_len, sizeof(string));
					for (int i = 0; i < _t1746_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1746, &it); 
 }
					
					int _t1745_len =  _t1746.len;
					array_array_string _t1745 = __new_array(0, _t1745_len, sizeof(array_string));
					for (int _t1747 = 0; _t1747 < _t1745_len; ++_t1747) {
						string it = ((string*)  _t1748.data)[_t1747];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1745, &ti);
					}
										route_words_a = _t1745;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1752_len = attrs.len;
					array_string _t1752 = __new_array(0, _t1752_len, sizeof(string));
					for (int i = 0; i < _t1752_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1752, &it); 
 }
					
int _t1750_len = attrs.len;
					array_string _t1750 = __new_array(0, _t1750_len, sizeof(string));
					for (int i = 0; i < _t1750_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1750, &it); 
 }
					
					int _t1749_len =  _t1750.len;
					array_array_string _t1749 = __new_array(0, _t1749_len, sizeof(array_string));
					for (int _t1751 = 0; _t1751 < _t1749_len; ++_t1751) {
						string it = ((string*)  _t1752.data)[_t1751];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1749, &ti);
					}
										route_words_a = _t1749;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1756_len = attrs.len;
					array_string _t1756 = __new_array(0, _t1756_len, sizeof(string));
					for (int i = 0; i < _t1756_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1756, &it); 
 }
					
int _t1754_len = attrs.len;
					array_string _t1754 = __new_array(0, _t1754_len, sizeof(string));
					for (int i = 0; i < _t1754_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1754, &it); 
 }
					
					int _t1753_len =  _t1754.len;
					array_array_string _t1753 = __new_array(0, _t1753_len, sizeof(array_string));
					for (int _t1755 = 0; _t1755 < _t1753_len; ++_t1755) {
						string it = ((string*)  _t1756.data)[_t1755];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1753, &ti);
					}
										route_words_a = _t1753;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1760_len = attrs.len;
					array_string _t1760 = __new_array(0, _t1760_len, sizeof(string));
					for (int i = 0; i < _t1760_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1760, &it); 
 }
					
int _t1758_len = attrs.len;
					array_string _t1758 = __new_array(0, _t1758_len, sizeof(string));
					for (int i = 0; i < _t1758_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1758, &it); 
 }
					
					int _t1757_len =  _t1758.len;
					array_array_string _t1757 = __new_array(0, _t1757_len, sizeof(array_string));
					for (int _t1759 = 0; _t1759 < _t1757_len; ++_t1759) {
						string it = ((string*)  _t1760.data)[_t1759];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1757, &ti);
					}
										route_words_a = _t1757;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1764_len = attrs.len;
					array_string _t1764 = __new_array(0, _t1764_len, sizeof(string));
					for (int i = 0; i < _t1764_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1764, &it); 
 }
					
int _t1762_len = attrs.len;
					array_string _t1762 = __new_array(0, _t1762_len, sizeof(string));
					for (int i = 0; i < _t1762_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1762, &it); 
 }
					
					int _t1761_len =  _t1762.len;
					array_array_string _t1761 = __new_array(0, _t1761_len, sizeof(array_string));
					for (int _t1763 = 0; _t1763 < _t1761_len; ++_t1763) {
						string it = ((string*)  _t1764.data)[_t1763];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1761, &ti);
					}
										route_words_a = _t1761;
				}
			} else {

int _t1768_len = attrs.len;
				array_string _t1768 = __new_array(0, _t1768_len, sizeof(string));
				for (int i = 0; i < _t1768_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1768, &it); 
 }
				
int _t1766_len = attrs.len;
				array_string _t1766 = __new_array(0, _t1766_len, sizeof(string));
				for (int i = 0; i < _t1766_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1766, &it); 
 }
				
				int _t1765_len =  _t1766.len;
				array_array_string _t1765 = __new_array(0, _t1765_len, sizeof(array_string));
				for (int _t1767 = 0; _t1767 < _t1765_len; ++_t1767) {
					string it = ((string*)  _t1768.data)[_t1767];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1765, &ti);
				}
								route_words_a = _t1765;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1769 = route_words_a;
				for (int _t1770 = 0; _t1770 < _t1769.len; ++_t1770) {
					array_string route_words = ((array_string*)_t1769.data)[_t1770];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_add_comment(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1774 = net__Socket_close(conn);
							if (!_t1774.ok) {
								string err = _t1774.v_error;
								int errcode = _t1774.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 36
	method = tos_lit("login");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/login")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_login(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1775 = net__Socket_close(conn);
				if (!_t1775.ok) {
					string err = _t1775.v_error;
					int errcode = _t1775.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1779_len = attrs.len;
					array_string _t1779 = __new_array(0, _t1779_len, sizeof(string));
					for (int i = 0; i < _t1779_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1779, &it); 
 }
					
int _t1777_len = attrs.len;
					array_string _t1777 = __new_array(0, _t1777_len, sizeof(string));
					for (int i = 0; i < _t1777_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1777, &it); 
 }
					
					int _t1776_len =  _t1777.len;
					array_array_string _t1776 = __new_array(0, _t1776_len, sizeof(array_string));
					for (int _t1778 = 0; _t1778 < _t1776_len; ++_t1778) {
						string it = ((string*)  _t1779.data)[_t1778];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1776, &ti);
					}
										route_words_a = _t1776;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1783_len = attrs.len;
					array_string _t1783 = __new_array(0, _t1783_len, sizeof(string));
					for (int i = 0; i < _t1783_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1783, &it); 
 }
					
int _t1781_len = attrs.len;
					array_string _t1781 = __new_array(0, _t1781_len, sizeof(string));
					for (int i = 0; i < _t1781_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1781, &it); 
 }
					
					int _t1780_len =  _t1781.len;
					array_array_string _t1780 = __new_array(0, _t1780_len, sizeof(array_string));
					for (int _t1782 = 0; _t1782 < _t1780_len; ++_t1782) {
						string it = ((string*)  _t1783.data)[_t1782];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1780, &ti);
					}
										route_words_a = _t1780;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1787_len = attrs.len;
					array_string _t1787 = __new_array(0, _t1787_len, sizeof(string));
					for (int i = 0; i < _t1787_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1787, &it); 
 }
					
int _t1785_len = attrs.len;
					array_string _t1785 = __new_array(0, _t1785_len, sizeof(string));
					for (int i = 0; i < _t1785_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1785, &it); 
 }
					
					int _t1784_len =  _t1785.len;
					array_array_string _t1784 = __new_array(0, _t1784_len, sizeof(array_string));
					for (int _t1786 = 0; _t1786 < _t1784_len; ++_t1786) {
						string it = ((string*)  _t1787.data)[_t1786];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1784, &ti);
					}
										route_words_a = _t1784;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1791_len = attrs.len;
					array_string _t1791 = __new_array(0, _t1791_len, sizeof(string));
					for (int i = 0; i < _t1791_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1791, &it); 
 }
					
int _t1789_len = attrs.len;
					array_string _t1789 = __new_array(0, _t1789_len, sizeof(string));
					for (int i = 0; i < _t1789_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1789, &it); 
 }
					
					int _t1788_len =  _t1789.len;
					array_array_string _t1788 = __new_array(0, _t1788_len, sizeof(array_string));
					for (int _t1790 = 0; _t1790 < _t1788_len; ++_t1790) {
						string it = ((string*)  _t1791.data)[_t1790];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1788, &ti);
					}
										route_words_a = _t1788;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1795_len = attrs.len;
					array_string _t1795 = __new_array(0, _t1795_len, sizeof(string));
					for (int i = 0; i < _t1795_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1795, &it); 
 }
					
int _t1793_len = attrs.len;
					array_string _t1793 = __new_array(0, _t1793_len, sizeof(string));
					for (int i = 0; i < _t1793_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1793, &it); 
 }
					
					int _t1792_len =  _t1793.len;
					array_array_string _t1792 = __new_array(0, _t1792_len, sizeof(array_string));
					for (int _t1794 = 0; _t1794 < _t1792_len; ++_t1794) {
						string it = ((string*)  _t1795.data)[_t1794];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1792, &ti);
					}
										route_words_a = _t1792;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1799_len = attrs.len;
					array_string _t1799 = __new_array(0, _t1799_len, sizeof(string));
					for (int i = 0; i < _t1799_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1799, &it); 
 }
					
int _t1797_len = attrs.len;
					array_string _t1797 = __new_array(0, _t1797_len, sizeof(string));
					for (int i = 0; i < _t1797_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1797, &it); 
 }
					
					int _t1796_len =  _t1797.len;
					array_array_string _t1796 = __new_array(0, _t1796_len, sizeof(array_string));
					for (int _t1798 = 0; _t1798 < _t1796_len; ++_t1798) {
						string it = ((string*)  _t1799.data)[_t1798];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1796, &ti);
					}
										route_words_a = _t1796;
				}
			} else {

int _t1803_len = attrs.len;
				array_string _t1803 = __new_array(0, _t1803_len, sizeof(string));
				for (int i = 0; i < _t1803_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1803, &it); 
 }
				
int _t1801_len = attrs.len;
				array_string _t1801 = __new_array(0, _t1801_len, sizeof(string));
				for (int i = 0; i < _t1801_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1801, &it); 
 }
				
				int _t1800_len =  _t1801.len;
				array_array_string _t1800 = __new_array(0, _t1800_len, sizeof(array_string));
				for (int _t1802 = 0; _t1802 < _t1800_len; ++_t1802) {
					string it = ((string*)  _t1803.data)[_t1802];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1800, &ti);
				}
								route_words_a = _t1800;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1804 = route_words_a;
				for (int _t1805 = 0; _t1805 < _t1804.len; ++_t1805) {
					array_string route_words = ((array_string*)_t1804.data)[_t1805];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_login(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1809 = net__Socket_close(conn);
							if (!_t1809.ok) {
								string err = _t1809.v_error;
								int errcode = _t1809.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 37
	method = tos_lit("handle_login");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/login")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_handle_login(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1810 = net__Socket_close(conn);
				if (!_t1810.ok) {
					string err = _t1810.v_error;
					int errcode = _t1810.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1814_len = attrs.len;
					array_string _t1814 = __new_array(0, _t1814_len, sizeof(string));
					for (int i = 0; i < _t1814_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1814, &it); 
 }
					
int _t1812_len = attrs.len;
					array_string _t1812 = __new_array(0, _t1812_len, sizeof(string));
					for (int i = 0; i < _t1812_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1812, &it); 
 }
					
					int _t1811_len =  _t1812.len;
					array_array_string _t1811 = __new_array(0, _t1811_len, sizeof(array_string));
					for (int _t1813 = 0; _t1813 < _t1811_len; ++_t1813) {
						string it = ((string*)  _t1814.data)[_t1813];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1811, &ti);
					}
										route_words_a = _t1811;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1818_len = attrs.len;
					array_string _t1818 = __new_array(0, _t1818_len, sizeof(string));
					for (int i = 0; i < _t1818_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1818, &it); 
 }
					
int _t1816_len = attrs.len;
					array_string _t1816 = __new_array(0, _t1816_len, sizeof(string));
					for (int i = 0; i < _t1816_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1816, &it); 
 }
					
					int _t1815_len =  _t1816.len;
					array_array_string _t1815 = __new_array(0, _t1815_len, sizeof(array_string));
					for (int _t1817 = 0; _t1817 < _t1815_len; ++_t1817) {
						string it = ((string*)  _t1818.data)[_t1817];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1815, &ti);
					}
										route_words_a = _t1815;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1822_len = attrs.len;
					array_string _t1822 = __new_array(0, _t1822_len, sizeof(string));
					for (int i = 0; i < _t1822_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1822, &it); 
 }
					
int _t1820_len = attrs.len;
					array_string _t1820 = __new_array(0, _t1820_len, sizeof(string));
					for (int i = 0; i < _t1820_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1820, &it); 
 }
					
					int _t1819_len =  _t1820.len;
					array_array_string _t1819 = __new_array(0, _t1819_len, sizeof(array_string));
					for (int _t1821 = 0; _t1821 < _t1819_len; ++_t1821) {
						string it = ((string*)  _t1822.data)[_t1821];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1819, &ti);
					}
										route_words_a = _t1819;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1826_len = attrs.len;
					array_string _t1826 = __new_array(0, _t1826_len, sizeof(string));
					for (int i = 0; i < _t1826_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1826, &it); 
 }
					
int _t1824_len = attrs.len;
					array_string _t1824 = __new_array(0, _t1824_len, sizeof(string));
					for (int i = 0; i < _t1824_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1824, &it); 
 }
					
					int _t1823_len =  _t1824.len;
					array_array_string _t1823 = __new_array(0, _t1823_len, sizeof(array_string));
					for (int _t1825 = 0; _t1825 < _t1823_len; ++_t1825) {
						string it = ((string*)  _t1826.data)[_t1825];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1823, &ti);
					}
										route_words_a = _t1823;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1830_len = attrs.len;
					array_string _t1830 = __new_array(0, _t1830_len, sizeof(string));
					for (int i = 0; i < _t1830_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1830, &it); 
 }
					
int _t1828_len = attrs.len;
					array_string _t1828 = __new_array(0, _t1828_len, sizeof(string));
					for (int i = 0; i < _t1828_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1828, &it); 
 }
					
					int _t1827_len =  _t1828.len;
					array_array_string _t1827 = __new_array(0, _t1827_len, sizeof(array_string));
					for (int _t1829 = 0; _t1829 < _t1827_len; ++_t1829) {
						string it = ((string*)  _t1830.data)[_t1829];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1827, &ti);
					}
										route_words_a = _t1827;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1834_len = attrs.len;
					array_string _t1834 = __new_array(0, _t1834_len, sizeof(string));
					for (int i = 0; i < _t1834_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1834, &it); 
 }
					
int _t1832_len = attrs.len;
					array_string _t1832 = __new_array(0, _t1832_len, sizeof(string));
					for (int i = 0; i < _t1832_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1832, &it); 
 }
					
					int _t1831_len =  _t1832.len;
					array_array_string _t1831 = __new_array(0, _t1831_len, sizeof(array_string));
					for (int _t1833 = 0; _t1833 < _t1831_len; ++_t1833) {
						string it = ((string*)  _t1834.data)[_t1833];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1831, &ti);
					}
										route_words_a = _t1831;
				}
			} else {

int _t1838_len = attrs.len;
				array_string _t1838 = __new_array(0, _t1838_len, sizeof(string));
				for (int i = 0; i < _t1838_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1838, &it); 
 }
				
int _t1836_len = attrs.len;
				array_string _t1836 = __new_array(0, _t1836_len, sizeof(string));
				for (int i = 0; i < _t1836_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1836, &it); 
 }
				
				int _t1835_len =  _t1836.len;
				array_array_string _t1835 = __new_array(0, _t1835_len, sizeof(array_string));
				for (int _t1837 = 0; _t1837 < _t1835_len; ++_t1837) {
					string it = ((string*)  _t1838.data)[_t1837];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1835, &ti);
				}
								route_words_a = _t1835;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1839 = route_words_a;
				for (int _t1840 = 0; _t1840 < _t1839.len; ++_t1840) {
					array_string route_words = ((array_string*)_t1839.data)[_t1840];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_handle_login(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1844 = net__Socket_close(conn);
							if (!_t1844.ok) {
								string err = _t1844.v_error;
								int errcode = _t1844.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 38
	method = tos_lit("register");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/register")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_register(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1845 = net__Socket_close(conn);
				if (!_t1845.ok) {
					string err = _t1845.v_error;
					int errcode = _t1845.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1849_len = attrs.len;
					array_string _t1849 = __new_array(0, _t1849_len, sizeof(string));
					for (int i = 0; i < _t1849_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1849, &it); 
 }
					
int _t1847_len = attrs.len;
					array_string _t1847 = __new_array(0, _t1847_len, sizeof(string));
					for (int i = 0; i < _t1847_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1847, &it); 
 }
					
					int _t1846_len =  _t1847.len;
					array_array_string _t1846 = __new_array(0, _t1846_len, sizeof(array_string));
					for (int _t1848 = 0; _t1848 < _t1846_len; ++_t1848) {
						string it = ((string*)  _t1849.data)[_t1848];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1846, &ti);
					}
										route_words_a = _t1846;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1853_len = attrs.len;
					array_string _t1853 = __new_array(0, _t1853_len, sizeof(string));
					for (int i = 0; i < _t1853_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1853, &it); 
 }
					
int _t1851_len = attrs.len;
					array_string _t1851 = __new_array(0, _t1851_len, sizeof(string));
					for (int i = 0; i < _t1851_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1851, &it); 
 }
					
					int _t1850_len =  _t1851.len;
					array_array_string _t1850 = __new_array(0, _t1850_len, sizeof(array_string));
					for (int _t1852 = 0; _t1852 < _t1850_len; ++_t1852) {
						string it = ((string*)  _t1853.data)[_t1852];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1850, &ti);
					}
										route_words_a = _t1850;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1857_len = attrs.len;
					array_string _t1857 = __new_array(0, _t1857_len, sizeof(string));
					for (int i = 0; i < _t1857_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1857, &it); 
 }
					
int _t1855_len = attrs.len;
					array_string _t1855 = __new_array(0, _t1855_len, sizeof(string));
					for (int i = 0; i < _t1855_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1855, &it); 
 }
					
					int _t1854_len =  _t1855.len;
					array_array_string _t1854 = __new_array(0, _t1854_len, sizeof(array_string));
					for (int _t1856 = 0; _t1856 < _t1854_len; ++_t1856) {
						string it = ((string*)  _t1857.data)[_t1856];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1854, &ti);
					}
										route_words_a = _t1854;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1861_len = attrs.len;
					array_string _t1861 = __new_array(0, _t1861_len, sizeof(string));
					for (int i = 0; i < _t1861_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1861, &it); 
 }
					
int _t1859_len = attrs.len;
					array_string _t1859 = __new_array(0, _t1859_len, sizeof(string));
					for (int i = 0; i < _t1859_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1859, &it); 
 }
					
					int _t1858_len =  _t1859.len;
					array_array_string _t1858 = __new_array(0, _t1858_len, sizeof(array_string));
					for (int _t1860 = 0; _t1860 < _t1858_len; ++_t1860) {
						string it = ((string*)  _t1861.data)[_t1860];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1858, &ti);
					}
										route_words_a = _t1858;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1865_len = attrs.len;
					array_string _t1865 = __new_array(0, _t1865_len, sizeof(string));
					for (int i = 0; i < _t1865_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1865, &it); 
 }
					
int _t1863_len = attrs.len;
					array_string _t1863 = __new_array(0, _t1863_len, sizeof(string));
					for (int i = 0; i < _t1863_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1863, &it); 
 }
					
					int _t1862_len =  _t1863.len;
					array_array_string _t1862 = __new_array(0, _t1862_len, sizeof(array_string));
					for (int _t1864 = 0; _t1864 < _t1862_len; ++_t1864) {
						string it = ((string*)  _t1865.data)[_t1864];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1862, &ti);
					}
										route_words_a = _t1862;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1869_len = attrs.len;
					array_string _t1869 = __new_array(0, _t1869_len, sizeof(string));
					for (int i = 0; i < _t1869_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1869, &it); 
 }
					
int _t1867_len = attrs.len;
					array_string _t1867 = __new_array(0, _t1867_len, sizeof(string));
					for (int i = 0; i < _t1867_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1867, &it); 
 }
					
					int _t1866_len =  _t1867.len;
					array_array_string _t1866 = __new_array(0, _t1866_len, sizeof(array_string));
					for (int _t1868 = 0; _t1868 < _t1866_len; ++_t1868) {
						string it = ((string*)  _t1869.data)[_t1868];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1866, &ti);
					}
										route_words_a = _t1866;
				}
			} else {

int _t1873_len = attrs.len;
				array_string _t1873 = __new_array(0, _t1873_len, sizeof(string));
				for (int i = 0; i < _t1873_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1873, &it); 
 }
				
int _t1871_len = attrs.len;
				array_string _t1871 = __new_array(0, _t1871_len, sizeof(string));
				for (int i = 0; i < _t1871_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1871, &it); 
 }
				
				int _t1870_len =  _t1871.len;
				array_array_string _t1870 = __new_array(0, _t1870_len, sizeof(array_string));
				for (int _t1872 = 0; _t1872 < _t1870_len; ++_t1872) {
					string it = ((string*)  _t1873.data)[_t1872];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1870, &ti);
				}
								route_words_a = _t1870;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1874 = route_words_a;
				for (int _t1875 = 0; _t1875 < _t1874.len; ++_t1875) {
					array_string route_words = ((array_string*)_t1874.data)[_t1875];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_register(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1879 = net__Socket_close(conn);
							if (!_t1879.ok) {
								string err = _t1879.v_error;
								int errcode = _t1879.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 39
	method = tos_lit("handle_register");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/register")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_handle_register(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1880 = net__Socket_close(conn);
				if (!_t1880.ok) {
					string err = _t1880.v_error;
					int errcode = _t1880.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1884_len = attrs.len;
					array_string _t1884 = __new_array(0, _t1884_len, sizeof(string));
					for (int i = 0; i < _t1884_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1884, &it); 
 }
					
int _t1882_len = attrs.len;
					array_string _t1882 = __new_array(0, _t1882_len, sizeof(string));
					for (int i = 0; i < _t1882_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1882, &it); 
 }
					
					int _t1881_len =  _t1882.len;
					array_array_string _t1881 = __new_array(0, _t1881_len, sizeof(array_string));
					for (int _t1883 = 0; _t1883 < _t1881_len; ++_t1883) {
						string it = ((string*)  _t1884.data)[_t1883];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1881, &ti);
					}
										route_words_a = _t1881;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1888_len = attrs.len;
					array_string _t1888 = __new_array(0, _t1888_len, sizeof(string));
					for (int i = 0; i < _t1888_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1888, &it); 
 }
					
int _t1886_len = attrs.len;
					array_string _t1886 = __new_array(0, _t1886_len, sizeof(string));
					for (int i = 0; i < _t1886_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1886, &it); 
 }
					
					int _t1885_len =  _t1886.len;
					array_array_string _t1885 = __new_array(0, _t1885_len, sizeof(array_string));
					for (int _t1887 = 0; _t1887 < _t1885_len; ++_t1887) {
						string it = ((string*)  _t1888.data)[_t1887];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1885, &ti);
					}
										route_words_a = _t1885;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1892_len = attrs.len;
					array_string _t1892 = __new_array(0, _t1892_len, sizeof(string));
					for (int i = 0; i < _t1892_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1892, &it); 
 }
					
int _t1890_len = attrs.len;
					array_string _t1890 = __new_array(0, _t1890_len, sizeof(string));
					for (int i = 0; i < _t1890_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1890, &it); 
 }
					
					int _t1889_len =  _t1890.len;
					array_array_string _t1889 = __new_array(0, _t1889_len, sizeof(array_string));
					for (int _t1891 = 0; _t1891 < _t1889_len; ++_t1891) {
						string it = ((string*)  _t1892.data)[_t1891];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1889, &ti);
					}
										route_words_a = _t1889;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1896_len = attrs.len;
					array_string _t1896 = __new_array(0, _t1896_len, sizeof(string));
					for (int i = 0; i < _t1896_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1896, &it); 
 }
					
int _t1894_len = attrs.len;
					array_string _t1894 = __new_array(0, _t1894_len, sizeof(string));
					for (int i = 0; i < _t1894_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1894, &it); 
 }
					
					int _t1893_len =  _t1894.len;
					array_array_string _t1893 = __new_array(0, _t1893_len, sizeof(array_string));
					for (int _t1895 = 0; _t1895 < _t1893_len; ++_t1895) {
						string it = ((string*)  _t1896.data)[_t1895];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1893, &ti);
					}
										route_words_a = _t1893;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1900_len = attrs.len;
					array_string _t1900 = __new_array(0, _t1900_len, sizeof(string));
					for (int i = 0; i < _t1900_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1900, &it); 
 }
					
int _t1898_len = attrs.len;
					array_string _t1898 = __new_array(0, _t1898_len, sizeof(string));
					for (int i = 0; i < _t1898_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1898, &it); 
 }
					
					int _t1897_len =  _t1898.len;
					array_array_string _t1897 = __new_array(0, _t1897_len, sizeof(array_string));
					for (int _t1899 = 0; _t1899 < _t1897_len; ++_t1899) {
						string it = ((string*)  _t1900.data)[_t1899];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1897, &ti);
					}
										route_words_a = _t1897;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1904_len = attrs.len;
					array_string _t1904 = __new_array(0, _t1904_len, sizeof(string));
					for (int i = 0; i < _t1904_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1904, &it); 
 }
					
int _t1902_len = attrs.len;
					array_string _t1902 = __new_array(0, _t1902_len, sizeof(string));
					for (int i = 0; i < _t1902_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1902, &it); 
 }
					
					int _t1901_len =  _t1902.len;
					array_array_string _t1901 = __new_array(0, _t1901_len, sizeof(array_string));
					for (int _t1903 = 0; _t1903 < _t1901_len; ++_t1903) {
						string it = ((string*)  _t1904.data)[_t1903];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1901, &ti);
					}
										route_words_a = _t1901;
				}
			} else {

int _t1908_len = attrs.len;
				array_string _t1908 = __new_array(0, _t1908_len, sizeof(string));
				for (int i = 0; i < _t1908_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1908, &it); 
 }
				
int _t1906_len = attrs.len;
				array_string _t1906 = __new_array(0, _t1906_len, sizeof(string));
				for (int i = 0; i < _t1906_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1906, &it); 
 }
				
				int _t1905_len =  _t1906.len;
				array_array_string _t1905 = __new_array(0, _t1905_len, sizeof(array_string));
				for (int _t1907 = 0; _t1907 < _t1905_len; ++_t1907) {
					string it = ((string*)  _t1908.data)[_t1907];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1905, &ti);
				}
								route_words_a = _t1905;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1909 = route_words_a;
				for (int _t1910 = 0; _t1910 < _t1909.len; ++_t1910) {
					array_string route_words = ((array_string*)_t1909.data)[_t1910];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_handle_register(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1914 = net__Socket_close(conn);
							if (!_t1914.ok) {
								string err = _t1914.v_error;
								int errcode = _t1914.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 40
	method = tos_lit("security");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/settings/security")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_security(app ); // vweb action call with args;
				// Defer begin
				Option_int _t1915 = net__Socket_close(conn);
				if (!_t1915.ok) {
					string err = _t1915.v_error;
					int errcode = _t1915.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1919_len = attrs.len;
					array_string _t1919 = __new_array(0, _t1919_len, sizeof(string));
					for (int i = 0; i < _t1919_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1919, &it); 
 }
					
int _t1917_len = attrs.len;
					array_string _t1917 = __new_array(0, _t1917_len, sizeof(string));
					for (int i = 0; i < _t1917_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1917, &it); 
 }
					
					int _t1916_len =  _t1917.len;
					array_array_string _t1916 = __new_array(0, _t1916_len, sizeof(array_string));
					for (int _t1918 = 0; _t1918 < _t1916_len; ++_t1918) {
						string it = ((string*)  _t1919.data)[_t1918];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1916, &ti);
					}
										route_words_a = _t1916;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1923_len = attrs.len;
					array_string _t1923 = __new_array(0, _t1923_len, sizeof(string));
					for (int i = 0; i < _t1923_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1923, &it); 
 }
					
int _t1921_len = attrs.len;
					array_string _t1921 = __new_array(0, _t1921_len, sizeof(string));
					for (int i = 0; i < _t1921_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1921, &it); 
 }
					
					int _t1920_len =  _t1921.len;
					array_array_string _t1920 = __new_array(0, _t1920_len, sizeof(array_string));
					for (int _t1922 = 0; _t1922 < _t1920_len; ++_t1922) {
						string it = ((string*)  _t1923.data)[_t1922];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1920, &ti);
					}
										route_words_a = _t1920;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1927_len = attrs.len;
					array_string _t1927 = __new_array(0, _t1927_len, sizeof(string));
					for (int i = 0; i < _t1927_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1927, &it); 
 }
					
int _t1925_len = attrs.len;
					array_string _t1925 = __new_array(0, _t1925_len, sizeof(string));
					for (int i = 0; i < _t1925_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1925, &it); 
 }
					
					int _t1924_len =  _t1925.len;
					array_array_string _t1924 = __new_array(0, _t1924_len, sizeof(array_string));
					for (int _t1926 = 0; _t1926 < _t1924_len; ++_t1926) {
						string it = ((string*)  _t1927.data)[_t1926];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1924, &ti);
					}
										route_words_a = _t1924;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1931_len = attrs.len;
					array_string _t1931 = __new_array(0, _t1931_len, sizeof(string));
					for (int i = 0; i < _t1931_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1931, &it); 
 }
					
int _t1929_len = attrs.len;
					array_string _t1929 = __new_array(0, _t1929_len, sizeof(string));
					for (int i = 0; i < _t1929_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1929, &it); 
 }
					
					int _t1928_len =  _t1929.len;
					array_array_string _t1928 = __new_array(0, _t1928_len, sizeof(array_string));
					for (int _t1930 = 0; _t1930 < _t1928_len; ++_t1930) {
						string it = ((string*)  _t1931.data)[_t1930];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1928, &ti);
					}
										route_words_a = _t1928;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1935_len = attrs.len;
					array_string _t1935 = __new_array(0, _t1935_len, sizeof(string));
					for (int i = 0; i < _t1935_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1935, &it); 
 }
					
int _t1933_len = attrs.len;
					array_string _t1933 = __new_array(0, _t1933_len, sizeof(string));
					for (int i = 0; i < _t1933_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1933, &it); 
 }
					
					int _t1932_len =  _t1933.len;
					array_array_string _t1932 = __new_array(0, _t1932_len, sizeof(array_string));
					for (int _t1934 = 0; _t1934 < _t1932_len; ++_t1934) {
						string it = ((string*)  _t1935.data)[_t1934];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1932, &ti);
					}
										route_words_a = _t1932;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1939_len = attrs.len;
					array_string _t1939 = __new_array(0, _t1939_len, sizeof(string));
					for (int i = 0; i < _t1939_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1939, &it); 
 }
					
int _t1937_len = attrs.len;
					array_string _t1937 = __new_array(0, _t1937_len, sizeof(string));
					for (int i = 0; i < _t1937_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1937, &it); 
 }
					
					int _t1936_len =  _t1937.len;
					array_array_string _t1936 = __new_array(0, _t1936_len, sizeof(array_string));
					for (int _t1938 = 0; _t1938 < _t1936_len; ++_t1938) {
						string it = ((string*)  _t1939.data)[_t1938];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1936, &ti);
					}
										route_words_a = _t1936;
				}
			} else {

int _t1943_len = attrs.len;
				array_string _t1943 = __new_array(0, _t1943_len, sizeof(string));
				for (int i = 0; i < _t1943_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1943, &it); 
 }
				
int _t1941_len = attrs.len;
				array_string _t1941 = __new_array(0, _t1941_len, sizeof(string));
				for (int i = 0; i < _t1941_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1941, &it); 
 }
				
				int _t1940_len =  _t1941.len;
				array_array_string _t1940 = __new_array(0, _t1940_len, sizeof(array_string));
				for (int _t1942 = 0; _t1942 < _t1940_len; ++_t1942) {
					string it = ((string*)  _t1943.data)[_t1942];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1940, &ti);
				}
								route_words_a = _t1940;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1944 = route_words_a;
				for (int _t1945 = 0; _t1945 < _t1944.len; ++_t1945) {
					array_string route_words = ((array_string*)_t1944.data)[_t1945];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_security(app ); // vweb action call with args;
							// Defer begin
							Option_int _t1949 = net__Socket_close(conn);
							if (!_t1949.ok) {
								string err = _t1949.v_error;
								int errcode = _t1949.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 41
	method = tos_lit("user");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:username")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_user(app,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1950 = net__Socket_close(conn);
				if (!_t1950.ok) {
					string err = _t1950.v_error;
					int errcode = _t1950.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1954_len = attrs.len;
					array_string _t1954 = __new_array(0, _t1954_len, sizeof(string));
					for (int i = 0; i < _t1954_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1954, &it); 
 }
					
int _t1952_len = attrs.len;
					array_string _t1952 = __new_array(0, _t1952_len, sizeof(string));
					for (int i = 0; i < _t1952_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1952, &it); 
 }
					
					int _t1951_len =  _t1952.len;
					array_array_string _t1951 = __new_array(0, _t1951_len, sizeof(array_string));
					for (int _t1953 = 0; _t1953 < _t1951_len; ++_t1953) {
						string it = ((string*)  _t1954.data)[_t1953];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1951, &ti);
					}
										route_words_a = _t1951;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1958_len = attrs.len;
					array_string _t1958 = __new_array(0, _t1958_len, sizeof(string));
					for (int i = 0; i < _t1958_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1958, &it); 
 }
					
int _t1956_len = attrs.len;
					array_string _t1956 = __new_array(0, _t1956_len, sizeof(string));
					for (int i = 0; i < _t1956_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1956, &it); 
 }
					
					int _t1955_len =  _t1956.len;
					array_array_string _t1955 = __new_array(0, _t1955_len, sizeof(array_string));
					for (int _t1957 = 0; _t1957 < _t1955_len; ++_t1957) {
						string it = ((string*)  _t1958.data)[_t1957];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1955, &ti);
					}
										route_words_a = _t1955;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1962_len = attrs.len;
					array_string _t1962 = __new_array(0, _t1962_len, sizeof(string));
					for (int i = 0; i < _t1962_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1962, &it); 
 }
					
int _t1960_len = attrs.len;
					array_string _t1960 = __new_array(0, _t1960_len, sizeof(string));
					for (int i = 0; i < _t1960_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1960, &it); 
 }
					
					int _t1959_len =  _t1960.len;
					array_array_string _t1959 = __new_array(0, _t1959_len, sizeof(array_string));
					for (int _t1961 = 0; _t1961 < _t1959_len; ++_t1961) {
						string it = ((string*)  _t1962.data)[_t1961];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1959, &ti);
					}
										route_words_a = _t1959;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t1966_len = attrs.len;
					array_string _t1966 = __new_array(0, _t1966_len, sizeof(string));
					for (int i = 0; i < _t1966_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1966, &it); 
 }
					
int _t1964_len = attrs.len;
					array_string _t1964 = __new_array(0, _t1964_len, sizeof(string));
					for (int i = 0; i < _t1964_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1964, &it); 
 }
					
					int _t1963_len =  _t1964.len;
					array_array_string _t1963 = __new_array(0, _t1963_len, sizeof(array_string));
					for (int _t1965 = 0; _t1965 < _t1963_len; ++_t1965) {
						string it = ((string*)  _t1966.data)[_t1965];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1963, &ti);
					}
										route_words_a = _t1963;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t1970_len = attrs.len;
					array_string _t1970 = __new_array(0, _t1970_len, sizeof(string));
					for (int i = 0; i < _t1970_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1970, &it); 
 }
					
int _t1968_len = attrs.len;
					array_string _t1968 = __new_array(0, _t1968_len, sizeof(string));
					for (int i = 0; i < _t1968_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t1968, &it); 
 }
					
					int _t1967_len =  _t1968.len;
					array_array_string _t1967 = __new_array(0, _t1967_len, sizeof(array_string));
					for (int _t1969 = 0; _t1969 < _t1967_len; ++_t1969) {
						string it = ((string*)  _t1970.data)[_t1969];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1967, &ti);
					}
										route_words_a = _t1967;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t1974_len = attrs.len;
					array_string _t1974 = __new_array(0, _t1974_len, sizeof(string));
					for (int i = 0; i < _t1974_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1974, &it); 
 }
					
int _t1972_len = attrs.len;
					array_string _t1972 = __new_array(0, _t1972_len, sizeof(string));
					for (int i = 0; i < _t1972_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t1972, &it); 
 }
					
					int _t1971_len =  _t1972.len;
					array_array_string _t1971 = __new_array(0, _t1971_len, sizeof(array_string));
					for (int _t1973 = 0; _t1973 < _t1971_len; ++_t1973) {
						string it = ((string*)  _t1974.data)[_t1973];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1971, &ti);
					}
										route_words_a = _t1971;
				}
			} else {

int _t1978_len = attrs.len;
				array_string _t1978 = __new_array(0, _t1978_len, sizeof(string));
				for (int i = 0; i < _t1978_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1978, &it); 
 }
				
int _t1976_len = attrs.len;
				array_string _t1976 = __new_array(0, _t1976_len, sizeof(string));
				for (int i = 0; i < _t1976_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t1976, &it); 
 }
				
				int _t1975_len =  _t1976.len;
				array_array_string _t1975 = __new_array(0, _t1975_len, sizeof(array_string));
				for (int _t1977 = 0; _t1977 < _t1975_len; ++_t1977) {
					string it = ((string*)  _t1978.data)[_t1977];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t1975, &ti);
				}
								route_words_a = _t1975;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t1979 = route_words_a;
				for (int _t1980 = 0; _t1980 < _t1979.len; ++_t1980) {
					array_string route_words = ((array_string*)_t1979.data)[_t1980];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_user(app,  ); // vweb action call with args;
							// Defer begin
							Option_int _t1984 = net__Socket_close(conn);
							if (!_t1984.ok) {
								string err = _t1984.v_error;
								int errcode = _t1984.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 42
	method = tos_lit("user_repos");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:username/repos")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_user_repos(app,  ); // vweb action call with args;
				// Defer begin
				Option_int _t1985 = net__Socket_close(conn);
				if (!_t1985.ok) {
					string err = _t1985.v_error;
					int errcode = _t1985.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t1989_len = attrs.len;
					array_string _t1989 = __new_array(0, _t1989_len, sizeof(string));
					for (int i = 0; i < _t1989_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1989, &it); 
 }
					
int _t1987_len = attrs.len;
					array_string _t1987 = __new_array(0, _t1987_len, sizeof(string));
					for (int i = 0; i < _t1987_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t1987, &it); 
 }
					
					int _t1986_len =  _t1987.len;
					array_array_string _t1986 = __new_array(0, _t1986_len, sizeof(array_string));
					for (int _t1988 = 0; _t1988 < _t1986_len; ++_t1988) {
						string it = ((string*)  _t1989.data)[_t1988];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1986, &ti);
					}
										route_words_a = _t1986;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t1993_len = attrs.len;
					array_string _t1993 = __new_array(0, _t1993_len, sizeof(string));
					for (int i = 0; i < _t1993_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1993, &it); 
 }
					
int _t1991_len = attrs.len;
					array_string _t1991 = __new_array(0, _t1991_len, sizeof(string));
					for (int i = 0; i < _t1991_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t1991, &it); 
 }
					
					int _t1990_len =  _t1991.len;
					array_array_string _t1990 = __new_array(0, _t1990_len, sizeof(array_string));
					for (int _t1992 = 0; _t1992 < _t1990_len; ++_t1992) {
						string it = ((string*)  _t1993.data)[_t1992];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1990, &ti);
					}
										route_words_a = _t1990;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t1997_len = attrs.len;
					array_string _t1997 = __new_array(0, _t1997_len, sizeof(string));
					for (int i = 0; i < _t1997_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1997, &it); 
 }
					
int _t1995_len = attrs.len;
					array_string _t1995 = __new_array(0, _t1995_len, sizeof(string));
					for (int i = 0; i < _t1995_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t1995, &it); 
 }
					
					int _t1994_len =  _t1995.len;
					array_array_string _t1994 = __new_array(0, _t1994_len, sizeof(array_string));
					for (int _t1996 = 0; _t1996 < _t1994_len; ++_t1996) {
						string it = ((string*)  _t1997.data)[_t1996];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1994, &ti);
					}
										route_words_a = _t1994;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t2001_len = attrs.len;
					array_string _t2001 = __new_array(0, _t2001_len, sizeof(string));
					for (int i = 0; i < _t2001_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t2001, &it); 
 }
					
int _t1999_len = attrs.len;
					array_string _t1999 = __new_array(0, _t1999_len, sizeof(string));
					for (int i = 0; i < _t1999_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t1999, &it); 
 }
					
					int _t1998_len =  _t1999.len;
					array_array_string _t1998 = __new_array(0, _t1998_len, sizeof(array_string));
					for (int _t2000 = 0; _t2000 < _t1998_len; ++_t2000) {
						string it = ((string*)  _t2001.data)[_t2000];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t1998, &ti);
					}
										route_words_a = _t1998;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t2005_len = attrs.len;
					array_string _t2005 = __new_array(0, _t2005_len, sizeof(string));
					for (int i = 0; i < _t2005_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2005, &it); 
 }
					
int _t2003_len = attrs.len;
					array_string _t2003 = __new_array(0, _t2003_len, sizeof(string));
					for (int i = 0; i < _t2003_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2003, &it); 
 }
					
					int _t2002_len =  _t2003.len;
					array_array_string _t2002 = __new_array(0, _t2002_len, sizeof(array_string));
					for (int _t2004 = 0; _t2004 < _t2002_len; ++_t2004) {
						string it = ((string*)  _t2005.data)[_t2004];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2002, &ti);
					}
										route_words_a = _t2002;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t2009_len = attrs.len;
					array_string _t2009 = __new_array(0, _t2009_len, sizeof(string));
					for (int i = 0; i < _t2009_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2009, &it); 
 }
					
int _t2007_len = attrs.len;
					array_string _t2007 = __new_array(0, _t2007_len, sizeof(string));
					for (int i = 0; i < _t2007_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2007, &it); 
 }
					
					int _t2006_len =  _t2007.len;
					array_array_string _t2006 = __new_array(0, _t2006_len, sizeof(array_string));
					for (int _t2008 = 0; _t2008 < _t2006_len; ++_t2008) {
						string it = ((string*)  _t2009.data)[_t2008];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2006, &ti);
					}
										route_words_a = _t2006;
				}
			} else {

int _t2013_len = attrs.len;
				array_string _t2013 = __new_array(0, _t2013_len, sizeof(string));
				for (int i = 0; i < _t2013_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2013, &it); 
 }
				
int _t2011_len = attrs.len;
				array_string _t2011 = __new_array(0, _t2011_len, sizeof(string));
				for (int i = 0; i < _t2011_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2011, &it); 
 }
				
				int _t2010_len =  _t2011.len;
				array_array_string _t2010 = __new_array(0, _t2010_len, sizeof(array_string));
				for (int _t2012 = 0; _t2012 < _t2010_len; ++_t2012) {
					string it = ((string*)  _t2013.data)[_t2012];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t2010, &ti);
				}
								route_words_a = _t2010;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t2014 = route_words_a;
				for (int _t2015 = 0; _t2015 < _t2014.len; ++_t2015) {
					array_string route_words = ((array_string*)_t2014.data)[_t2015];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_user_repos(app,  ); // vweb action call with args;
							// Defer begin
							Option_int _t2019 = net__Socket_close(conn);
							if (!_t2019.ok) {
								string err = _t2019.v_error;
								int errcode = _t2019.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 43
	method = tos_lit("user_issues");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/:username/issues"), tos_lit("/:username/issues/:page_str")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_user_issues(app, ,  ); // vweb action call with args;
				// Defer begin
				Option_int _t2020 = net__Socket_close(conn);
				if (!_t2020.ok) {
					string err = _t2020.v_error;
					int errcode = _t2020.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t2024_len = attrs.len;
					array_string _t2024 = __new_array(0, _t2024_len, sizeof(string));
					for (int i = 0; i < _t2024_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t2024, &it); 
 }
					
int _t2022_len = attrs.len;
					array_string _t2022 = __new_array(0, _t2022_len, sizeof(string));
					for (int i = 0; i < _t2022_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t2022, &it); 
 }
					
					int _t2021_len =  _t2022.len;
					array_array_string _t2021 = __new_array(0, _t2021_len, sizeof(array_string));
					for (int _t2023 = 0; _t2023 < _t2021_len; ++_t2023) {
						string it = ((string*)  _t2024.data)[_t2023];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2021, &ti);
					}
										route_words_a = _t2021;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t2028_len = attrs.len;
					array_string _t2028 = __new_array(0, _t2028_len, sizeof(string));
					for (int i = 0; i < _t2028_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t2028, &it); 
 }
					
int _t2026_len = attrs.len;
					array_string _t2026 = __new_array(0, _t2026_len, sizeof(string));
					for (int i = 0; i < _t2026_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t2026, &it); 
 }
					
					int _t2025_len =  _t2026.len;
					array_array_string _t2025 = __new_array(0, _t2025_len, sizeof(array_string));
					for (int _t2027 = 0; _t2027 < _t2025_len; ++_t2027) {
						string it = ((string*)  _t2028.data)[_t2027];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2025, &ti);
					}
										route_words_a = _t2025;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t2032_len = attrs.len;
					array_string _t2032 = __new_array(0, _t2032_len, sizeof(string));
					for (int i = 0; i < _t2032_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t2032, &it); 
 }
					
int _t2030_len = attrs.len;
					array_string _t2030 = __new_array(0, _t2030_len, sizeof(string));
					for (int i = 0; i < _t2030_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t2030, &it); 
 }
					
					int _t2029_len =  _t2030.len;
					array_array_string _t2029 = __new_array(0, _t2029_len, sizeof(array_string));
					for (int _t2031 = 0; _t2031 < _t2029_len; ++_t2031) {
						string it = ((string*)  _t2032.data)[_t2031];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2029, &ti);
					}
										route_words_a = _t2029;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t2036_len = attrs.len;
					array_string _t2036 = __new_array(0, _t2036_len, sizeof(string));
					for (int i = 0; i < _t2036_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t2036, &it); 
 }
					
int _t2034_len = attrs.len;
					array_string _t2034 = __new_array(0, _t2034_len, sizeof(string));
					for (int i = 0; i < _t2034_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t2034, &it); 
 }
					
					int _t2033_len =  _t2034.len;
					array_array_string _t2033 = __new_array(0, _t2033_len, sizeof(array_string));
					for (int _t2035 = 0; _t2035 < _t2033_len; ++_t2035) {
						string it = ((string*)  _t2036.data)[_t2035];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2033, &ti);
					}
										route_words_a = _t2033;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t2040_len = attrs.len;
					array_string _t2040 = __new_array(0, _t2040_len, sizeof(string));
					for (int i = 0; i < _t2040_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2040, &it); 
 }
					
int _t2038_len = attrs.len;
					array_string _t2038 = __new_array(0, _t2038_len, sizeof(string));
					for (int i = 0; i < _t2038_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2038, &it); 
 }
					
					int _t2037_len =  _t2038.len;
					array_array_string _t2037 = __new_array(0, _t2037_len, sizeof(array_string));
					for (int _t2039 = 0; _t2039 < _t2037_len; ++_t2039) {
						string it = ((string*)  _t2040.data)[_t2039];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2037, &ti);
					}
										route_words_a = _t2037;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t2044_len = attrs.len;
					array_string _t2044 = __new_array(0, _t2044_len, sizeof(string));
					for (int i = 0; i < _t2044_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2044, &it); 
 }
					
int _t2042_len = attrs.len;
					array_string _t2042 = __new_array(0, _t2042_len, sizeof(string));
					for (int i = 0; i < _t2042_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2042, &it); 
 }
					
					int _t2041_len =  _t2042.len;
					array_array_string _t2041 = __new_array(0, _t2041_len, sizeof(array_string));
					for (int _t2043 = 0; _t2043 < _t2041_len; ++_t2043) {
						string it = ((string*)  _t2044.data)[_t2043];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2041, &ti);
					}
										route_words_a = _t2041;
				}
			} else {

int _t2048_len = attrs.len;
				array_string _t2048 = __new_array(0, _t2048_len, sizeof(string));
				for (int i = 0; i < _t2048_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2048, &it); 
 }
				
int _t2046_len = attrs.len;
				array_string _t2046 = __new_array(0, _t2046_len, sizeof(string));
				for (int i = 0; i < _t2046_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2046, &it); 
 }
				
				int _t2045_len =  _t2046.len;
				array_array_string _t2045 = __new_array(0, _t2045_len, sizeof(array_string));
				for (int _t2047 = 0; _t2047 < _t2045_len; ++_t2047) {
					string it = ((string*)  _t2048.data)[_t2047];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t2045, &ti);
				}
								route_words_a = _t2045;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t2049 = route_words_a;
				for (int _t2050 = 0; _t2050 < _t2049.len; ++_t2050) {
					array_string route_words = ((array_string*)_t2049.data)[_t2050];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_user_issues(app, ,  ); // vweb action call with args;
							// Defer begin
							Option_int _t2054 = net__Socket_close(conn);
							if (!_t2054.ok) {
								string err = _t2054.v_error;
								int errcode = _t2054.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 44
	method = tos_lit("user_settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/settings")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_user_settings(app,  ); // vweb action call with args;
				// Defer begin
				Option_int _t2055 = net__Socket_close(conn);
				if (!_t2055.ok) {
					string err = _t2055.v_error;
					int errcode = _t2055.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t2059_len = attrs.len;
					array_string _t2059 = __new_array(0, _t2059_len, sizeof(string));
					for (int i = 0; i < _t2059_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t2059, &it); 
 }
					
int _t2057_len = attrs.len;
					array_string _t2057 = __new_array(0, _t2057_len, sizeof(string));
					for (int i = 0; i < _t2057_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t2057, &it); 
 }
					
					int _t2056_len =  _t2057.len;
					array_array_string _t2056 = __new_array(0, _t2056_len, sizeof(array_string));
					for (int _t2058 = 0; _t2058 < _t2056_len; ++_t2058) {
						string it = ((string*)  _t2059.data)[_t2058];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2056, &ti);
					}
										route_words_a = _t2056;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t2063_len = attrs.len;
					array_string _t2063 = __new_array(0, _t2063_len, sizeof(string));
					for (int i = 0; i < _t2063_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t2063, &it); 
 }
					
int _t2061_len = attrs.len;
					array_string _t2061 = __new_array(0, _t2061_len, sizeof(string));
					for (int i = 0; i < _t2061_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t2061, &it); 
 }
					
					int _t2060_len =  _t2061.len;
					array_array_string _t2060 = __new_array(0, _t2060_len, sizeof(array_string));
					for (int _t2062 = 0; _t2062 < _t2060_len; ++_t2062) {
						string it = ((string*)  _t2063.data)[_t2062];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2060, &ti);
					}
										route_words_a = _t2060;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t2067_len = attrs.len;
					array_string _t2067 = __new_array(0, _t2067_len, sizeof(string));
					for (int i = 0; i < _t2067_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t2067, &it); 
 }
					
int _t2065_len = attrs.len;
					array_string _t2065 = __new_array(0, _t2065_len, sizeof(string));
					for (int i = 0; i < _t2065_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t2065, &it); 
 }
					
					int _t2064_len =  _t2065.len;
					array_array_string _t2064 = __new_array(0, _t2064_len, sizeof(array_string));
					for (int _t2066 = 0; _t2066 < _t2064_len; ++_t2066) {
						string it = ((string*)  _t2067.data)[_t2066];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2064, &ti);
					}
										route_words_a = _t2064;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t2071_len = attrs.len;
					array_string _t2071 = __new_array(0, _t2071_len, sizeof(string));
					for (int i = 0; i < _t2071_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t2071, &it); 
 }
					
int _t2069_len = attrs.len;
					array_string _t2069 = __new_array(0, _t2069_len, sizeof(string));
					for (int i = 0; i < _t2069_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t2069, &it); 
 }
					
					int _t2068_len =  _t2069.len;
					array_array_string _t2068 = __new_array(0, _t2068_len, sizeof(array_string));
					for (int _t2070 = 0; _t2070 < _t2068_len; ++_t2070) {
						string it = ((string*)  _t2071.data)[_t2070];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2068, &ti);
					}
										route_words_a = _t2068;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t2075_len = attrs.len;
					array_string _t2075 = __new_array(0, _t2075_len, sizeof(string));
					for (int i = 0; i < _t2075_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2075, &it); 
 }
					
int _t2073_len = attrs.len;
					array_string _t2073 = __new_array(0, _t2073_len, sizeof(string));
					for (int i = 0; i < _t2073_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2073, &it); 
 }
					
					int _t2072_len =  _t2073.len;
					array_array_string _t2072 = __new_array(0, _t2072_len, sizeof(array_string));
					for (int _t2074 = 0; _t2074 < _t2072_len; ++_t2074) {
						string it = ((string*)  _t2075.data)[_t2074];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2072, &ti);
					}
										route_words_a = _t2072;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t2079_len = attrs.len;
					array_string _t2079 = __new_array(0, _t2079_len, sizeof(string));
					for (int i = 0; i < _t2079_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2079, &it); 
 }
					
int _t2077_len = attrs.len;
					array_string _t2077 = __new_array(0, _t2077_len, sizeof(string));
					for (int i = 0; i < _t2077_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2077, &it); 
 }
					
					int _t2076_len =  _t2077.len;
					array_array_string _t2076 = __new_array(0, _t2076_len, sizeof(array_string));
					for (int _t2078 = 0; _t2078 < _t2076_len; ++_t2078) {
						string it = ((string*)  _t2079.data)[_t2078];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2076, &ti);
					}
										route_words_a = _t2076;
				}
			} else {

int _t2083_len = attrs.len;
				array_string _t2083 = __new_array(0, _t2083_len, sizeof(string));
				for (int i = 0; i < _t2083_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2083, &it); 
 }
				
int _t2081_len = attrs.len;
				array_string _t2081 = __new_array(0, _t2081_len, sizeof(string));
				for (int i = 0; i < _t2081_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2081, &it); 
 }
				
				int _t2080_len =  _t2081.len;
				array_array_string _t2080 = __new_array(0, _t2080_len, sizeof(array_string));
				for (int _t2082 = 0; _t2082 < _t2080_len; ++_t2082) {
					string it = ((string*)  _t2083.data)[_t2082];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t2080, &ti);
				}
								route_words_a = _t2080;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t2084 = route_words_a;
				for (int _t2085 = 0; _t2085 < _t2084.len; ++_t2085) {
					array_string route_words = ((array_string*)_t2084.data)[_t2085];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_user_settings(app,  ); // vweb action call with args;
							// Defer begin
							Option_int _t2089 = net__Socket_close(conn);
							if (!_t2089.ok) {
								string err = _t2089.v_error;
								int errcode = _t2089.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
		// method 45
	method = tos_lit("update_user_settings");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/settings")}));
		route_words_a = __new_array_with_default(0, 0, sizeof(array_string), 0);
		if (attrs.len == 0) {
			if ((string_eq(req.method, tos_lit("GET")) && string_eq((*(string*)array_get(url_words, 0)), method) && url_words.len == 1) || (string_eq(req.method, tos_lit("POST")) && string_eq(string_add((*(string*)array_get(url_words, 0)), tos_lit("_post")), method))) {
				println(_STR("easy match method=%.*s", 1, method));
				// $method call. sym="main.App"
				main__App_update_user_settings(app,  ); // vweb action call with args;
				// Defer begin
				Option_int _t2090 = net__Socket_close(conn);
				if (!_t2090.ok) {
					string err = _t2090.v_error;
					int errcode = _t2090.ecode;
				};
				// Defer end
				return;
			}
		} else {
			if (_IN(string, tos_lit("post"), attrs)) {
				if (string_eq(req.method, tos_lit("POST"))) {

int _t2094_len = attrs.len;
					array_string _t2094 = __new_array(0, _t2094_len, sizeof(string));
					for (int i = 0; i < _t2094_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t2094, &it); 
 }
					
int _t2092_len = attrs.len;
					array_string _t2092 = __new_array(0, _t2092_len, sizeof(string));
					for (int i = 0; i < _t2092_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("post"))) array_push(&_t2092, &it); 
 }
					
					int _t2091_len =  _t2092.len;
					array_array_string _t2091 = __new_array(0, _t2091_len, sizeof(array_string));
					for (int _t2093 = 0; _t2093 < _t2091_len; ++_t2093) {
						string it = ((string*)  _t2094.data)[_t2093];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2091, &ti);
					}
										route_words_a = _t2091;
				}
			} else if (_IN(string, tos_lit("put"), attrs)) {
				if (string_eq(req.method, tos_lit("PUT"))) {

int _t2098_len = attrs.len;
					array_string _t2098 = __new_array(0, _t2098_len, sizeof(string));
					for (int i = 0; i < _t2098_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t2098, &it); 
 }
					
int _t2096_len = attrs.len;
					array_string _t2096 = __new_array(0, _t2096_len, sizeof(string));
					for (int i = 0; i < _t2096_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("put"))) array_push(&_t2096, &it); 
 }
					
					int _t2095_len =  _t2096.len;
					array_array_string _t2095 = __new_array(0, _t2095_len, sizeof(array_string));
					for (int _t2097 = 0; _t2097 < _t2095_len; ++_t2097) {
						string it = ((string*)  _t2098.data)[_t2097];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2095, &ti);
					}
										route_words_a = _t2095;
				}
			} else if (_IN(string, tos_lit("patch"), attrs)) {
				if (string_eq(req.method, tos_lit("PATCH"))) {

int _t2102_len = attrs.len;
					array_string _t2102 = __new_array(0, _t2102_len, sizeof(string));
					for (int i = 0; i < _t2102_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t2102, &it); 
 }
					
int _t2100_len = attrs.len;
					array_string _t2100 = __new_array(0, _t2100_len, sizeof(string));
					for (int i = 0; i < _t2100_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("patch"))) array_push(&_t2100, &it); 
 }
					
					int _t2099_len =  _t2100.len;
					array_array_string _t2099 = __new_array(0, _t2099_len, sizeof(array_string));
					for (int _t2101 = 0; _t2101 < _t2099_len; ++_t2101) {
						string it = ((string*)  _t2102.data)[_t2101];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2099, &ti);
					}
										route_words_a = _t2099;
				}
			} else if (_IN(string, tos_lit("delete"), attrs)) {
				if (string_eq(req.method, tos_lit("DELETE"))) {

int _t2106_len = attrs.len;
					array_string _t2106 = __new_array(0, _t2106_len, sizeof(string));
					for (int i = 0; i < _t2106_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t2106, &it); 
 }
					
int _t2104_len = attrs.len;
					array_string _t2104 = __new_array(0, _t2104_len, sizeof(string));
					for (int i = 0; i < _t2104_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("delete"))) array_push(&_t2104, &it); 
 }
					
					int _t2103_len =  _t2104.len;
					array_array_string _t2103 = __new_array(0, _t2103_len, sizeof(array_string));
					for (int _t2105 = 0; _t2105 < _t2103_len; ++_t2105) {
						string it = ((string*)  _t2106.data)[_t2105];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2103, &ti);
					}
										route_words_a = _t2103;
				}
			} else if (_IN(string, tos_lit("head"), attrs)) {
				if (string_eq(req.method, tos_lit("HEAD"))) {

int _t2110_len = attrs.len;
					array_string _t2110 = __new_array(0, _t2110_len, sizeof(string));
					for (int i = 0; i < _t2110_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2110, &it); 
 }
					
int _t2108_len = attrs.len;
					array_string _t2108 = __new_array(0, _t2108_len, sizeof(string));
					for (int i = 0; i < _t2108_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("head"))) array_push(&_t2108, &it); 
 }
					
					int _t2107_len =  _t2108.len;
					array_array_string _t2107 = __new_array(0, _t2107_len, sizeof(array_string));
					for (int _t2109 = 0; _t2109 < _t2107_len; ++_t2109) {
						string it = ((string*)  _t2110.data)[_t2109];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2107, &ti);
					}
										route_words_a = _t2107;
				}
			} else if (_IN(string, tos_lit("options"), attrs)) {
				if (string_eq(req.method, tos_lit("OPTIONS"))) {

int _t2114_len = attrs.len;
					array_string _t2114 = __new_array(0, _t2114_len, sizeof(string));
					for (int i = 0; i < _t2114_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2114, &it); 
 }
					
int _t2112_len = attrs.len;
					array_string _t2112 = __new_array(0, _t2112_len, sizeof(string));
					for (int i = 0; i < _t2112_len; ++i) {
					  string it = ((string*) attrs.data)[i];
					if (string_ne(string_to_lower(it), tos_lit("options"))) array_push(&_t2112, &it); 
 }
					
					int _t2111_len =  _t2112.len;
					array_array_string _t2111 = __new_array(0, _t2111_len, sizeof(array_string));
					for (int _t2113 = 0; _t2113 < _t2111_len; ++_t2113) {
						string it = ((string*)  _t2114.data)[_t2113];
						array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
						array_push(&_t2111, &ti);
					}
										route_words_a = _t2111;
				}
			} else {

int _t2118_len = attrs.len;
				array_string _t2118 = __new_array(0, _t2118_len, sizeof(string));
				for (int i = 0; i < _t2118_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2118, &it); 
 }
				
int _t2116_len = attrs.len;
				array_string _t2116 = __new_array(0, _t2116_len, sizeof(string));
				for (int i = 0; i < _t2116_len; ++i) {
				  string it = ((string*) attrs.data)[i];
				if (string_ne(string_to_lower(it), tos_lit("get"))) array_push(&_t2116, &it); 
 }
				
				int _t2115_len =  _t2116.len;
				array_array_string _t2115 = __new_array(0, _t2115_len, sizeof(array_string));
				for (int _t2117 = 0; _t2117 < _t2115_len; ++_t2117) {
					string it = ((string*)  _t2118.data)[_t2117];
					array_string ti = string_split(string_substr(it, 1, it.len), tos_lit("/"));
					array_push(&_t2115, &ti);
				}
								route_words_a = _t2115;
			}
			if (route_words_a.len > 0) {
				// FOR IN array
				array _t2119 = route_words_a;
				for (int _t2120 = 0; _t2120 < _t2119.len; ++_t2120) {
					array_string route_words = ((array_string*)_t2119.data)[_t2120];
					if (url_words.len == route_words.len || (url_words.len >= route_words.len - 1 && string_ends_with(*(string*)array_last(route_words), tos_lit("...")))) {
						bool matching = false;
						bool unknown = false;
						array_string variables = __new_array_with_default(0, route_words.len, sizeof(string), 0);
						for (int i = 0; i < route_words.len; ++i) {
							if (url_words.len == i) {
								array_push(&variables, _MOV((string[]){ tos_lit("") }));
								matching = true;
								unknown = true;
								break;
							}
							if (string_eq((*(string*)array_get(url_words, i)), (*(string*)array_get(route_words, i)))) {
								matching = true;
								continue;
							} else if (string_starts_with((*(string*)array_get(route_words, i)), tos_lit(":"))) {
								if (i < route_words.len && !string_ends_with((*(string*)array_get(route_words, i)), tos_lit("..."))) {
									array_push(&variables, _MOV((string[]){ (*(string*)array_get(url_words, i)) }));
								} else {
									array_push(&variables, _MOV((string[]){ array_string_join(array_slice(url_words, i, url_words.len), tos_lit("/")) }));
								}
								matching = true;
								unknown = true;
								continue;
							} else {
								matching = false;
								break;
							}
						}
						if (matching && !unknown) {
							// $method call. sym="main.App"
							main__App_update_user_settings(app,  ); // vweb action call with args;
							// Defer begin
							Option_int _t2124 = net__Socket_close(conn);
							if (!_t2124.ok) {
								string err = _t2124.v_error;
								int errcode = _t2124.ecode;
							};
							// Defer end
							return;
						} else if (matching && unknown) {
							action = method;
							vars = variables;
						}
					}
				}
			}
		}
	
	// } comptime for
	if (string_eq(action, tos_lit(""))) {
		Option_int _t2125 = net__Socket_send_string(conn, _const_vweb__http_404);
		if (!_t2125.ok) {
			string err = _t2125.v_error;
			int errcode = _t2125.ecode;
		};
		// Defer begin
		Option_int _t2126 = net__Socket_close(conn);
		if (!_t2126.ok) {
			string err = _t2126.v_error;
			int errcode = _t2126.ecode;
		};
		// Defer end
		return;
	}
	vweb__send_action_main__App(action, vars, app);
// Defer begin
Option_int _t2127 = net__Socket_close(conn);
if (!_t2127.ok) {
	string err = _t2127.v_error;
	int errcode = _t2127.ecode;
};
// Defer end
}

static void vweb__send_action_main__App(string action, array_string vars, main__App* app) {
	// 2comptime $for {
		// method 0
		string method = tos_lit("admin");
		array_string attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_admin(app ); // vweb action call with args;
		}
	
		// method 1
	method = tos_lit("git_info");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_git_info(app ); // vweb action call with args;
		}
	
		// method 2
	method = tos_lit("r_home");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_r_home(app ); // vweb action call with args;
		}
	
		// method 3
	method = tos_lit("r_repo");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_r_repo(app ); // vweb action call with args;
		}
	
		// method 4
	method = tos_lit("index");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_index(app ); // vweb action call with args;
		}
	
		// method 5
	method = tos_lit("pulls");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_pulls(app ); // vweb action call with args;
		}
	
		// method 6
	method = tos_lit("logout");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_logout(app ); // vweb action call with args;
		}
	
		// method 7
	method = tos_lit("oauth");
	attrs = new_array_from_c_array(0, 0, sizeof(string), _MOV((string[0]){}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_oauth(app ); // vweb action call with args;
		}
	
		// method 8
	method = tos_lit("admin_settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/admin/settings")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_admin_settings(app ); // vweb action call with args;
		}
	
		// method 9
	method = tos_lit("update_admin_settings");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/admin/settings")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_update_admin_settings(app ); // vweb action call with args;
		}
	
		// method 10
	method = tos_lit("admin_userlist");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/admin/userlist")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_admin_userlist(app ); // vweb action call with args;
		}
	
		// method 11
	method = tos_lit("admin_edituser");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/admin/edituser/:user")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_admin_edituser(app,  ); // vweb action call with args;
		}
	
		// method 12
	method = tos_lit("api_issues");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/api/:user/:repo/issues")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_api_issues(app, ,  ); // vweb action call with args;
		}
	
		// method 13
	method = tos_lit("api_commits");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/api/:user/:repo/commits")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_api_commits(app, ,  ); // vweb action call with args;
		}
	
		// method 14
	method = tos_lit("settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/settings")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_settings(app ); // vweb action call with args;
		}
	
		// method 15
	method = tos_lit("repo_settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/settings")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_repo_settings(app, ,  ); // vweb action call with args;
		}
	
		// method 16
	method = tos_lit("update_repo_settings");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/settings")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_update_repo_settings(app, ,  ); // vweb action call with args;
		}
	
		// method 17
	method = tos_lit("repo_delete");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/delete_repo")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_repo_delete(app, ,  ); // vweb action call with args;
		}
	
		// method 18
	method = tos_lit("repo_move");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/move_repo")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_repo_move(app, ,  ); // vweb action call with args;
		}
	
		// method 19
	method = tos_lit("tree2");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_tree2(app, ,  ); // vweb action call with args;
		}
	
		// method 20
	method = tos_lit("tree");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/tree/:branch/:path...")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_tree(app, , , ,  ); // vweb action call with args;
		}
	
		// method 21
	method = tos_lit("update");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/update")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_update(app, ,  ); // vweb action call with args;
		}
	
		// method 22
	method = tos_lit("new");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/new")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_new(app ); // vweb action call with args;
		}
	
		// method 23
	method = tos_lit("new_repo");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/new")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_new_repo(app ); // vweb action call with args;
		}
	
		// method 24
	method = tos_lit("commits");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/:user/:repo/commits"), tos_lit("/:user/:repo/commits/:page_str")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_commits(app, , , string_int(((string*)vars.data) [3])  ); // vweb action call with args;
		}
	
		// method 25
	method = tos_lit("commit");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/commit/:hash")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_commit(app, , ,  ); // vweb action call with args;
		}
	
		// method 26
	method = tos_lit("issues");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/:user/:repo/issues"), tos_lit("/:user/:repo/issues/:page_str")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_issues(app, , ,  ); // vweb action call with args;
		}
	
		// method 27
	method = tos_lit("issue");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/issue/:id")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_issue(app, , ,  ); // vweb action call with args;
		}
	
		// method 28
	method = tos_lit("pull");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/pull/:id")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_pull(app, , ,  ); // vweb action call with args;
		}
	
		// method 29
	method = tos_lit("contributors");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/contributors")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_contributors(app, ,  ); // vweb action call with args;
		}
	
		// method 30
	method = tos_lit("branches");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/branches")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_branches(app, ,  ); // vweb action call with args;
		}
	
		// method 31
	method = tos_lit("releases");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/releases")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_releases(app, ,  ); // vweb action call with args;
		}
	
		// method 32
	method = tos_lit("blob");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/blob/:branch/:path...")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_blob(app, , , ,  ); // vweb action call with args;
		}
	
		// method 33
	method = tos_lit("new_issue");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/:repo/issues/new")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_new_issue(app, ,  ); // vweb action call with args;
		}
	
		// method 34
	method = tos_lit("add_issue");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/issues/new")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_add_issue(app, ,  ); // vweb action call with args;
		}
	
		// method 35
	method = tos_lit("add_comment");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/:repo/comment")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_add_comment(app, ,  ); // vweb action call with args;
		}
	
		// method 36
	method = tos_lit("login");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/login")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_login(app ); // vweb action call with args;
		}
	
		// method 37
	method = tos_lit("handle_login");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/login")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_handle_login(app ); // vweb action call with args;
		}
	
		// method 38
	method = tos_lit("register");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/register")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_register(app ); // vweb action call with args;
		}
	
		// method 39
	method = tos_lit("handle_register");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/register")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_handle_register(app ); // vweb action call with args;
		}
	
		// method 40
	method = tos_lit("security");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/settings/security")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_security(app ); // vweb action call with args;
		}
	
		// method 41
	method = tos_lit("user");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:username")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_user(app,  ); // vweb action call with args;
		}
	
		// method 42
	method = tos_lit("user_repos");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:username/repos")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_user_repos(app,  ); // vweb action call with args;
		}
	
		// method 43
	method = tos_lit("user_issues");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("/:username/issues"), tos_lit("/:username/issues/:page_str")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_user_issues(app, ,  ); // vweb action call with args;
		}
	
		// method 44
	method = tos_lit("user_settings");
	attrs = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("/:user/settings")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_user_settings(app,  ); // vweb action call with args;
		}
	
		// method 45
	method = tos_lit("update_user_settings");
	attrs = new_array_from_c_array(2, 2, sizeof(string), _MOV((string[2]){tos_lit("post"), tos_lit("/:user/settings")}));
		if (string_eq(action, method) && attrs.len > 0) {
			// $method call. sym="main.App"
			main__App_update_user_settings(app,  ); // vweb action call with args;
		}
	
	// } comptime for
}

static void vweb__Context_parse_form(vweb__Context* ctx, string s) {
	if (!_IN(string, ctx->req.method, _const_vweb__methods_with_form)) {
		return;
	}
	string str_form = s;
	str_form = string_replace(str_form, tos_lit("+"), tos_lit(" "));
	array_string words = string_split(str_form, tos_lit("&"));
	// FOR IN array
	array _t2128 = words;
	for (int _t2129 = 0; _t2129 < _t2128.len; ++_t2129) {
		string word = ((string*)_t2128.data)[_t2129];
// $if  debug {
#ifdef _VDEBUG
		println(_STR("parse form keyval=\"%.*s\000\"", 2, word));
#endif
// } debug
		array_string keyval = string_split(string_trim_space(word), tos_lit("="));
		if (keyval.len != 2) {
			continue;
		}
		string key = (*(string*)array_get(keyval, 0));
		Option_string _t2130 = net__urllib__query_unescape((*(string*)array_get(keyval, 1)));
		if (!_t2130.ok) {
			string err = _t2130.v_error;
			int errcode = _t2130.ecode;
			continue;
		}
		string val = *(string*)_t2130.data;
// $if  debug {
#ifdef _VDEBUG
		println(_STR("http form \"%.*s\000\" => \"%.*s\000\"", 3, key, val));
#endif
// } debug
		map_set(&ctx->form, key, &(string[]) { val });
	}
}

static void vweb__Context_scan_static_directory(vweb__Context* ctx, string directory_path, string mount_path) {
	Option_array_string _t2131 = os__ls(directory_path);
	if (!_t2131.ok) {
		string err = _t2131.v_error;
		int errcode = _t2131.ecode;
		v_panic(err);
	}
	array_string files = *(array_string*)_t2131.data;
	if (files.len > 0) {
		// FOR IN array
		array _t2132 = files;
		for (int _t2133 = 0; _t2133 < _t2132.len; ++_t2133) {
			string file = ((string*)_t2132.data)[_t2133];
			if (os__is_dir(file)) {
				vweb__Context_scan_static_directory(ctx, string_add(string_add(directory_path, tos_lit("/")), file), string_add(string_add(mount_path, tos_lit("/")), file));
			} else if (string_contains(file, tos_lit(".")) && !string_starts_with(file, tos_lit(".")) && !string_ends_with(file, tos_lit("."))) {
				string ext = os__file_ext(file);
				if (_IN_MAP(ext, _const_vweb__mime_types)) {
					vweb__Context_serve_static(ctx, string_add(string_add(mount_path, tos_lit("/")), file), string_add(string_add(directory_path, tos_lit("/")), file), (*(string*)map_get(_const_vweb__mime_types, ext, &(string[]){ (string){.str=(byteptr)""} })));
				}
			}
		}
	}
}

bool vweb__Context_handle_static(vweb__Context* ctx, string directory_path) {
	if (ctx->done || !os__exists(directory_path)) {
		return false;
	}
	string dir_path = string_trim_right(string_trim_space(directory_path), tos_lit("/"));
	string mount_path = tos_lit("");
	if (string_ne(dir_path, tos_lit(".")) && os__is_dir(dir_path)) {
		mount_path = string_add(tos_lit("/"), string_trim(string_trim_left(dir_path, tos_lit(".")), tos_lit("/")));
	}
	vweb__Context_scan_static_directory(ctx, dir_path, mount_path);
	return true;
}

void vweb__Context_serve_static(vweb__Context* ctx, string url, string file_path, string mime_type) {
	map_set(&ctx->static_files, url, &(string[]) { file_path });
	map_set(&ctx->static_mime_types, url, &(string[]) { mime_type });
}

string vweb__Context_ip(vweb__Context* ctx) {
	string ip = (*(string*)map_get(ctx->req.headers, tos_lit("X-Forwarded-For"), &(string[]){ (string){.str=(byteptr)""} }));
	if (string_eq(ip, tos_lit(""))) {
		ip = (*(string*)map_get(ctx->req.headers, tos_lit("X-Real-IP"), &(string[]){ (string){.str=(byteptr)""} }));
	}
	if (string_contains(ip, tos_lit(","))) {
		ip = string_all_before(ip, tos_lit(","));
	}
	return ip;
}

void vweb__Context_error(vweb__Context* ctx, string s) {
	ctx->form_error = s;
}

static string vweb__strip(string s) {
	return string_trim(s, tos_lit("\r\n"));
}

vweb__Result vweb__not_found() {
	return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
}

static string vweb__filter(string s) {
	return string_replace_each(s, new_array_from_c_array(6, 6, sizeof(string), _MOV((string[6]){tos_lit("<"), tos_lit("&lt;"), tos_lit("\""), tos_lit("&quot;"), tos_lit("&"), tos_lit("&amp;")})));
}

// TypeDecl
static void rand__init() {
	default_rng = rand__new_default((rand__PRNGConfigStruct){.seed = rand__util__time_seed_array(2),});
}

rand__wyrand__WyRandRNG* rand__new_default(rand__PRNGConfigStruct config) {
	rand__wyrand__WyRandRNG* rng = (rand__wyrand__WyRandRNG*)memdup(&(rand__wyrand__WyRandRNG){.state = rand__util__time_seed_64(),.has_extra = false,.extra = 0,}, sizeof(rand__wyrand__WyRandRNG));
	rand__wyrand__WyRandRNG_seed(rng, config.seed);
	return rng;
}

void rand__seed(array_u32 seed) {
	rand__wyrand__WyRandRNG_seed(default_rng, seed);
}

u32 rand__u32() {
	return rand__wyrand__WyRandRNG_u32(default_rng);
}

u64 rand__u64() {
	return rand__wyrand__WyRandRNG_u64(default_rng);
}

u32 rand__u32n(u32 max) {
	return rand__wyrand__WyRandRNG_u32n(default_rng, max);
}

u64 rand__u64n(u64 max) {
	return rand__wyrand__WyRandRNG_u64n(default_rng, max);
}

u32 rand__u32_in_range(u32 min, u32 max) {
	return rand__wyrand__WyRandRNG_u32_in_range(default_rng, min, max);
}

u64 rand__u64_in_range(u64 min, u64 max) {
	return rand__wyrand__WyRandRNG_u64_in_range(default_rng, min, max);
}

int rand__int() {
	return rand__wyrand__WyRandRNG_int(default_rng);
}

int rand__intn(int max) {
	return rand__wyrand__WyRandRNG_intn(default_rng, max);
}

int rand__int_in_range(int min, int max) {
	return rand__wyrand__WyRandRNG_int_in_range(default_rng, min, max);
}

int rand__int31() {
	return rand__wyrand__WyRandRNG_int31(default_rng);
}

i64 rand__i64() {
	return rand__wyrand__WyRandRNG_i64(default_rng);
}

i64 rand__i64n(i64 max) {
	return rand__wyrand__WyRandRNG_i64n(default_rng, max);
}

i64 rand__i64_in_range(i64 min, i64 max) {
	return rand__wyrand__WyRandRNG_i64_in_range(default_rng, min, max);
}

i64 rand__int63() {
	return rand__wyrand__WyRandRNG_int63(default_rng);
}

f32 rand__f32() {
	return rand__wyrand__WyRandRNG_f32(default_rng);
}

f64 rand__f64() {
	return rand__wyrand__WyRandRNG_f64(default_rng);
}

f32 rand__f32n(f32 max) {
	return rand__wyrand__WyRandRNG_f32n(default_rng, max);
}

f64 rand__f64n(f64 max) {
	return rand__wyrand__WyRandRNG_f64n(default_rng, max);
}

f32 rand__f32_in_range(f32 min, f32 max) {
	return rand__wyrand__WyRandRNG_f32_in_range(default_rng, min, max);
}

f64 rand__f64_in_range(f64 min, f64 max) {
	return rand__wyrand__WyRandRNG_f64_in_range(default_rng, min, max);
}

string rand__string(int len) {
	byteptr buf = v_malloc(len);
	for (int i = 0; i < len; ++i) {
		buf[i] = string_at(_const_rand__chars, rand__intn(_const_rand__chars.len));
	}
	return tos((byteptr)buf, len);
}

vweb__Result main__App_admin(main__App* app) {
	if (!main__App_is_admin(app)) {
		return main__App_r_home(app);
	}
		strings__Builder sb = strings__new_builder(6000);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h1>Admin panel</h1>\n\n<a href=\"/admin/settings\"><h3>Gitly settings</h3></a>\n<a href=\"/admin/userlist\"><h3>Gitly userlist</h3></a>\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		string _tmpl_res_admin = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_admin); strings__Builder_free(&sb); string_free(&_tmpl_res_admin);
	;
}

// Attr: [/admin/settings]
vweb__Result main__App_admin_settings(main__App* app) {
	if (!main__App_is_admin(app)) {
		return main__App_r_home(app);
	}
		strings__Builder sb = strings__new_builder(6390);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 15, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_admin_settings = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_admin_settings); strings__Builder_free(&sb); string_free(&_tmpl_res_admin_settings);
	;
}

// Attr: [post]
// Attr: [/admin/settings]
vweb__Result main__App_update_admin_settings(main__App* app) {
	if (!main__App_is_admin(app)) {
		return main__App_r_home(app);
	}
	return vweb__Context_text(&app->vweb, tos_lit("TODO"));
}

// Attr: [/admin/userlist]
vweb__Result main__App_admin_userlist(main__App* app) {
	if (!main__App_is_admin(app)) {
		return main__App_r_home(app);
	}
	array_main__User userlist = main__App_find_registered_user(app);
		strings__Builder sb = strings__new_builder(7350);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<a href=\"/admin\"><h1>Admin panel</h1></a>\n\n<div class=\"users\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2134 = userlist;
		for (int _t2135 = 0; _t2135 < _t2134.len; ++_t2135) {
			main__User user = ((main__User*)_t2134.data)[_t2135];
			strings__Builder_write(&sb, _STR("\n<div class=\"user_item\">\n<form action=\"/admin/edituser/%"PRId32"\000\" method=\"post\">\n<label>%.*s\000</label><br>\n<ul>\n", 3, user.id, vweb__filter(user.username)));
			// FOR IN array
			array _t2136 = user.emails;
			for (int _t2137 = 0; _t2137 < _t2136.len; ++_t2137) {
				main__Email email = ((main__Email*)_t2136.data)[_t2137];
				strings__Builder_write(&sb, _STR("\n<li>%.*s\000</li>\n", 2, vweb__filter(email.email)));
			}
			strings__Builder_write(&sb, tos_lit("\n</ul>\n<input name=\"stop-session\" type=\"checkbox\">\n<label>Clear user sessions</label><br>\n<input name=\"is-blocked\" type=\"checkbox\"\n"));
			if (user.is_blocked) {
				strings__Builder_write(&sb, tos_lit("\nchecked\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n>\n<label>Blocked status</label><br>\n<input name=\"is-admin\" type=\"checkbox\"\n"));
			if (user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\nchecked\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n>\n<label>Admin user</label><br>\n<input type=\"submit\" value=\"Edit user\">\n</form>\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 3, vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_admin_userlist = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_admin_userlist); strings__Builder_free(&sb); string_free(&_tmpl_res_admin_userlist);
	;
}

// Attr: [post]
// Attr: [/admin/edituser/:user]
vweb__Result main__App_admin_edituser(main__App* app, string user) {
	if (!main__App_is_admin(app)) {
		return main__App_r_home(app);
	}
	bool clear_session = _IN_MAP(tos_lit("stop-session"), app->vweb.form);
	bool is_blocked = _IN_MAP(tos_lit("is-blocked"), app->vweb.form);
	bool is_admin = _IN_MAP(tos_lit("is-admin"), app->vweb.form);
	if (is_admin) {
		main__App_user_set_admin(app, string_int(user));
	} else {
		main__App_user_unset_admin(app, string_int(user));
	}
	if (is_blocked) {
		main__App_block_user(app, string_int(user));
	} else {
		main__App_unblock_user(app, string_int(user));
	}
	if (clear_session) {
		main__App_clear_sessions(app, string_int(user));
	}
	return vweb__Context_redirect(&app->vweb, tos_lit("/admin"));
}

static bool main__App_is_admin(main__App* app) {
	return app->logged_in && app->user.is_admin;
}

// Attr: [/api/:user/:repo/issues]
vweb__Result main__App_api_issues(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_json(&app->vweb, tos_lit("{}"));
	}
	array_main__Issue issues = main__App_find_repo_issues(app, app->repo.id);
	return vweb__Context_json(&app->vweb, json__json_print(json__encode_array_main__Issue(issues)));
}

// Attr: [/api/:user/:repo/commits]
vweb__Result main__App_api_commits(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_json(&app->vweb, tos_lit("{}"));
	}
	array_main__Commit commits = main__App_find_repo_commits(app, app->repo.id);
	return vweb__Context_json(&app->vweb, json__json_print(json__encode_array_main__Commit(commits)));
}

static void main__App_fetch_branches(main__App* app, main__Repo r) {
	main__Branch branch = (main__Branch){.id = 0,.repo_id = 0,.name = (string){.str=(byteptr)""},.author = (string){.str=(byteptr)""},.hash = (string){.str=(byteptr)""},.date = 0,};
	string data = main__Repo_git(&r, tos_lit("branch -a"));
	// FOR IN array
	array _t2138 = string_split_into_lines(data);
	for (int _t2139 = 0; _t2139 < _t2138.len; ++_t2139) {
		string remote_branch = ((string*)_t2138.data)[_t2139];
		if (string_contains(remote_branch, tos_lit("remotes/")) && !string_contains(remote_branch, tos_lit("HEAD"))) {
			string temp_branch = string_after(string_trim_space(remote_branch), tos_lit("remotes/"));
			main__Repo_git(&r, _STR("checkout -t %.*s", 1, temp_branch));
			branch.repo_id = r.id;
			branch.name = string_after(temp_branch, tos_lit("origin/"));
			Option_array_string _t2140 = os__read_lines(_STR("%.*s\000/.git/refs/heads/%.*s", 2, r.git_dir, branch.name));
			if (!_t2140.ok) {
				string err = _t2140.v_error;
				int errcode = _t2140.ecode;
				main__App_info(app, err);
				return;
			}
			array_string hash_data = *(array_string*)_t2140.data;
			branch.hash = string_substr((*(string*)array_get(hash_data, 0)), 0, 7);
			string branch_data = main__Repo_git(&r, _STR("log -1 --pretty=\"%%aE%.*s\000%%cD\" %.*s", 2, _const_main__log_field_separator, branch.hash));
			array_string args = string_split(branch_data, _const_main__log_field_separator);
			string email = (*(string*)array_get(args, 0));
			Option_main__User _t2141 = main__App_find_user_by_email(app, email);
			if (!_t2141.ok) {
				string err = _t2141.v_error;
				int errcode = _t2141.ecode;
				*(main__User*) _t2141.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = email,.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
			}
			main__User u = *(main__User*)_t2141.data;
			branch.author = u.username;
			Option_time__Time _t2142 = time__parse_rfc2822((*(string*)array_get(args, 1)));
			if (!_t2142.ok) {
				string err = _t2142.v_error;
				int errcode = _t2142.ecode;
				main__App_info(app, _STR("Error: %.*s", 1, err));
				return;
			}
			time__Time date = *(time__Time*)_t2142.data;
			branch.date = ((int)(date.v_unix));
			main__App_insert_branch(app, branch);
		}
	}
	main__Repo_git(&r, tos_lit("checkout master"));
}

static void main__App_update_branches(main__App* app, main__Repo* r) {
	main__Branch branch = (main__Branch){.id = 0,.repo_id = 0,.name = (string){.str=(byteptr)""},.author = (string){.str=(byteptr)""},.hash = (string){.str=(byteptr)""},.date = 0,};
	string data = main__Repo_git(r, tos_lit("branch -a"));
	// FOR IN array
	array _t2143 = string_split_into_lines(data);
	for (int _t2144 = 0; _t2144 < _t2143.len; ++_t2144) {
		string remote_branch = ((string*)_t2143.data)[_t2144];
		if (string_contains(remote_branch, tos_lit("remotes/")) && !string_contains(remote_branch, tos_lit("HEAD"))) {
			string temp_branch = string_after(string_trim_space(remote_branch), tos_lit("remotes/"));
			main__Repo_git(r, _STR("checkout -t %.*s", 1, temp_branch));
			branch.repo_id = r->id;
			branch.name = string_after(temp_branch, tos_lit("origin/"));
			Option_array_string _t2145 = os__read_lines(_STR("%.*s\000/.git/refs/heads/%.*s", 2, r->git_dir, branch.name));
			if (!_t2145.ok) {
				string err = _t2145.v_error;
				int errcode = _t2145.ecode;
				main__App_info(app, _STR("Error: %.*s", 1, err));
				return;
			}
			array_string hash_data = *(array_string*)_t2145.data;
			branch.hash = string_substr((*(string*)array_get(hash_data, 0)), 0, 7);
			string branch_data = main__Repo_git(r, _STR("log -1 --pretty=\"%%aE%.*s\000%%cD\" %.*s", 2, _const_main__log_field_separator, branch.hash));
			array_string args = string_split(branch_data, _const_main__log_field_separator);
			string email = (*(string*)array_get(args, 0));
			Option_main__User _t2146 = main__App_find_user_by_email(app, email);
			if (!_t2146.ok) {
				string err = _t2146.v_error;
				int errcode = _t2146.ecode;
				*(main__User*) _t2146.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = email,.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
			}
			main__User u = *(main__User*)_t2146.data;
			branch.author = u.username;
			Option_time__Time _t2147 = time__parse_rfc2822((*(string*)array_get(args, 1)));
			if (!_t2147.ok) {
				string err = _t2147.v_error;
				int errcode = _t2147.ecode;
				main__App_info(app, _STR("Error: %.*s", 1, err));
				return;
			}
			time__Time date = *(time__Time*)_t2147.data;
			branch.date = ((int)(date.v_unix));
			if (!main__App_contains_repo_branch(app, branch.name, r->id)) {
				main__App_insert_branch(app, branch);
			} else {
				main__App_update_branch(app, branch);
			}
		}
	}
	main__Repo_git(r, tos_lit("checkout master"));
}

static string main__Branch_relative(main__Branch branch) {
	return time__Time_relative(time__unix(branch.date));
}

static void main__App_update_branch(main__App* app, main__Branch branch) {
	main__Branch b = main__App_find_repo_branch_by_name(app, branch.name, branch.repo_id);
	string author = branch.author;
	string hash = branch.hash;
	int date = branch.date;
	
	// sql insert
	sqlite__DB _t2148 = app->db;
	sqlite3_stmt* _t2149 = sqlite__DB_init_stmt(_t2148, tos_lit("UPDATE `Branch` SET  author = author,  hash = hash,  date = date WHERE id = ?1"));
	sqlite3_bind_int(_t2149, 1, b.id);

		int _t2150 = sqlite3_step(_t2149);
		if( (_t2150 != SQLITE_OK) && (_t2150 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2148.conn)); }
		sqlite3_finalize(_t2149);
}

static void main__App_insert_branch(main__App* app, main__Branch branch) {
	
	// sql insert
	sqlite__DB _t2151 = app->db;
	sqlite3_stmt* _t2152 = sqlite__DB_init_stmt(_t2151, tos_lit("INSERT INTO `Branch` (`repo_id`, `name`, `author`, `hash`, `date`) values (?1, ?2, ?3, ?4, ?5)"));
	sqlite3_bind_int(_t2152, 1, branch.repo_id); // stmt
	sqlite3_bind_text(_t2152, 2, branch.name.str, branch.name.len, 0);
	sqlite3_bind_text(_t2152, 3, branch.author.str, branch.author.len, 0);
	sqlite3_bind_text(_t2152, 4, branch.hash.str, branch.hash.len, 0);
	sqlite3_bind_int(_t2152, 5, branch.date); // stmt
	
		int _t2153 = sqlite3_step(_t2152);
		if( (_t2153 != SQLITE_OK) && (_t2153 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2151.conn)); }
		sqlite3_finalize(_t2152);
}

static main__Branch main__App_find_repo_branch_by_name(main__App* app, string name, int repo_id) {

	// sql select
	sqlite__DB _t2155 = app->db;
	sqlite3_stmt* _t2154 = sqlite__DB_init_stmt(_t2155, tos_lit("SELECT `id`, `repo_id`, `name`, `author`, `hash`, `date` FROM `Branch` WHERE name = ?1 and repo_id = ?2 ORDER BY id  LIMIT ?3"));
	sqlite3_bind_text(_t2154, 1, name.str, name.len, 0);
sqlite3_bind_int(_t2154, 2, repo_id);
sqlite3_bind_int(_t2154, 3, 1);

	int _t2156 = sqlite3_extended_errcode(_t2155.conn);
	if (_t2156 != SQLITE_OK) { puts(sqlite3_errmsg(_t2155.conn)); }
	main__Branch _t2157 = (main__Branch){
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .date = 0};
	int _step_res_t2157 = sqlite3_step(_t2154);
		if (_step_res_t2157 == SQLITE_OK || _step_res_t2157 == SQLITE_ROW) {
	_t2157.id = sqlite3_column_int(_t2154, 0);
	_t2157.repo_id = sqlite3_column_int(_t2154, 1);
	_t2157.name = tos_clone(sqlite3_column_text(_t2154, 2));
	_t2157.author = tos_clone(sqlite3_column_text(_t2154, 3));
	_t2157.hash = tos_clone(sqlite3_column_text(_t2154, 4));
	_t2157.date = sqlite3_column_int(_t2154, 5);
	}
	sqlite3_finalize(_t2154);
		return  _t2157; 
	;
}

static array_main__Branch main__App_find_repo_branches(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2159 = app->db;
	sqlite3_stmt* _t2158 = sqlite__DB_init_stmt(_t2159, tos_lit("SELECT `id`, `repo_id`, `name`, `author`, `hash`, `date` FROM `Branch` WHERE repo_id = ?1 ORDER BY date DESC "));
	sqlite3_bind_int(_t2158, 1, repo_id);

	int _t2160 = sqlite3_extended_errcode(_t2159.conn);
	if (_t2160 != SQLITE_OK) { puts(sqlite3_errmsg(_t2159.conn)); }
	array_main__Branch _t2161_array = __new_array(0, 10, sizeof(main__Branch));
	while (1) {
		main__Branch _t2161 = (main__Branch) {
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .date = 0};
	int _step_res_t2161 = sqlite3_step(_t2158);
		if (_step_res_t2161 == SQLITE_DONE) break;
		if (_step_res_t2161 == SQLITE_ROW) ;
		else if (_step_res_t2161 != SQLITE_OK) break;
	_t2161.id = sqlite3_column_int(_t2158, 0);
	_t2161.repo_id = sqlite3_column_int(_t2158, 1);
	_t2161.name = tos_clone(sqlite3_column_text(_t2158, 2));
	_t2161.author = tos_clone(sqlite3_column_text(_t2158, 3));
	_t2161.hash = tos_clone(sqlite3_column_text(_t2158, 4));
	_t2161.date = sqlite3_column_int(_t2158, 5);
		 array_push(&_t2161_array, _MOV((main__Branch[]){ _t2161 }));
	}
	sqlite3_finalize(_t2158);
		return  _t2161_array; 
	;
}

static int main__App_nr_repo_branches(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2163 = app->db;
	sqlite3_stmt* _t2162 = sqlite__DB_init_stmt(_t2163, tos_lit("SELECT COUNT(*) FROM `Branch`  WHERE repo_id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2162, 1, repo_id);

	int _t2164 = sqlite3_extended_errcode(_t2163.conn);
	if (_t2164 != SQLITE_OK) { puts(sqlite3_errmsg(_t2163.conn)); }
		return  sqlite__get_int_from_stmt(_t2162);
	;
}

static bool main__App_contains_repo_branch(main__App* app, string name, int repo_id) {

	// sql select
	sqlite__DB _t2166 = app->db;
	sqlite3_stmt* _t2165 = sqlite__DB_init_stmt(_t2166, tos_lit("SELECT COUNT(*) FROM `Branch`  WHERE repo_id = ?1 and name = ?2 ORDER BY id "));
	sqlite3_bind_int(_t2165, 1, repo_id);
sqlite3_bind_text(_t2165, 2, name.str, name.len, 0);

	int _t2167 = sqlite3_extended_errcode(_t2166.conn);
	if (_t2167 != SQLITE_OK) { puts(sqlite3_errmsg(_t2166.conn)); }
		int nr =  sqlite__get_int_from_stmt(_t2165);
	;
	return nr == 1;
}

static void main__App_delete_repo_branches(main__App* app, int repo_id) {
	
	// sql insert
	sqlite__DB _t2168 = app->db;
	sqlite3_stmt* _t2169 = sqlite__DB_init_stmt(_t2168, tos_lit("DELETE FROM `Branch`  WHERE repo_id = ?1"));
	sqlite3_bind_int(_t2169, 1, repo_id);

		int _t2170 = sqlite3_step(_t2169);
		if( (_t2170 != SQLITE_OK) && (_t2170 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2168.conn)); }
		sqlite3_finalize(_t2169);
}

void main__App_command_fetcher(main__App* app) {
	while (1) {
		string line = os__get_line();
		if (string_starts_with(line, tos_lit("!"))) {
			array_string args = string_split(string_substr(line, 1, line.len), tos_lit(" "));
			if (args.len > 0) {
				if (string_eq((*(string*)array_get(args, 0)), tos_lit("updaterepo"))) {
					main__App_update_repo(app);
				} else if (string_eq((*(string*)array_get(args, 0)), tos_lit("adduser"))) {
					if (args.len > 4) {
						main__App_add_user(app, (*(string*)array_get(args, 1)), (*(string*)array_get(args, 2)), array_slice(args, 3, args.len), false);
						println(_STR("Added user %.*s", 1, (*(string*)array_get(args, 1))));
					} else {
						v_error(_STR("Not enough arguments (3 required but only %"PRId32"\000 given)", 2, args.len));
					}
				} else {
					println(tos_lit("Commands:"));
					println(tos_lit("	!updaterepo"));
					println(tos_lit("	!adduser <username> <password> <email1> <email2>..."));
				};
			} else {
				v_error(tos_lit("Unkown syntax. Use !<command>"));
			}
		} else {
			v_error(tos_lit("Unkown syntax. Use !<command>"));
		}
	}
}

static void main__App_insert_comment(main__App* app, main__Comment comment) {
	
	// sql insert
	sqlite__DB _t2172 = app->db;
	sqlite3_stmt* _t2173 = sqlite__DB_init_stmt(_t2172, tos_lit("INSERT INTO `Comment` (`author_id`, `issue_id`, `created_at`, `text`) values (?1, ?2, ?3, ?4)"));
	sqlite3_bind_int(_t2173, 1, comment.author_id); // stmt
	sqlite3_bind_int(_t2173, 2, comment.issue_id); // stmt
	sqlite3_bind_int(_t2173, 3, comment.created_at); // stmt
	sqlite3_bind_text(_t2173, 4, comment.text.str, comment.text.len, 0);
	
		int _t2174 = sqlite3_step(_t2173);
		if( (_t2174 != SQLITE_OK) && (_t2174 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2172.conn)); }
		sqlite3_finalize(_t2173);
}

static array_main__Comment main__App_find_issue_comments(main__App* app, int issue_id) {

	// sql select
	sqlite__DB _t2176 = app->db;
	sqlite3_stmt* _t2175 = sqlite__DB_init_stmt(_t2176, tos_lit("SELECT `id`, `author_id`, `issue_id`, `created_at`, `text` FROM `Comment` WHERE issue_id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2175, 1, issue_id);

	int _t2177 = sqlite3_extended_errcode(_t2176.conn);
	if (_t2177 != SQLITE_OK) { puts(sqlite3_errmsg(_t2176.conn)); }
	array_main__Comment _t2178_array = __new_array(0, 10, sizeof(main__Comment));
	while (1) {
		main__Comment _t2178 = (main__Comment) {
	.id = 0, .author_id = 0, .issue_id = 0, .created_at = 0, .text = (string){.str=(byteptr)""}, .author_name = (string){.str=(byteptr)""}};
	int _step_res_t2178 = sqlite3_step(_t2175);
		if (_step_res_t2178 == SQLITE_DONE) break;
		if (_step_res_t2178 == SQLITE_ROW) ;
		else if (_step_res_t2178 != SQLITE_OK) break;
	_t2178.id = sqlite3_column_int(_t2175, 0);
	_t2178.author_id = sqlite3_column_int(_t2175, 1);
	_t2178.issue_id = sqlite3_column_int(_t2175, 2);
	_t2178.created_at = sqlite3_column_int(_t2175, 3);
	_t2178.text = tos_clone(sqlite3_column_text(_t2175, 4));
		 array_push(&_t2178_array, _MOV((main__Comment[]){ _t2178 }));
	}
	sqlite3_finalize(_t2175);
		array_main__Comment comments =  _t2178_array; 
	;
	// FOR IN array
	array _t2179 = comments;
	for (int i = 0; i < _t2179.len; ++i) {
		main__Comment comment = ((main__Comment*)_t2179.data)[i];
		(*(main__Comment*)array_get(comments, i)).author_name = main__App_find_username_by_id(app, comment.author_id);
	}
	return comments;
}

static string main__Comment_relative(main__Comment comment) {
	return time__Time_relative(time__unix(comment.created_at));
}

static string main__Commit_relative(main__Commit commit) {
	return time__Time_relative(time__unix(commit.created_at));
}

static array_main__Change main__Commit_get_changes(main__Commit commit, main__Repo repo) {
	string changes_s = main__Repo_git(&repo, _STR("show %.*s", 1, commit.hash));
	main__Change tmp_change = (main__Change){.file = (string){.str=(byteptr)""},.additions = 0,.deletions = 0,.diff = (string){.str=(byteptr)""},.message = (string){.str=(byteptr)""},};
	array_main__Change changes = __new_array_with_default(0, 0, sizeof(main__Change), 0);
	bool started = false;
	// FOR IN array
	array _t2180 = string_split_into_lines(changes_s);
	for (int _t2181 = 0; _t2181 < _t2180.len; ++_t2181) {
		string line = ((string*)_t2180.data)[_t2181];
		array_string args = string_split(line, tos_lit(" "));
		if (args.len <= 0) {
			continue;
		}
		if (string_eq((*(string*)array_get(args, 0)), tos_lit("diff"))) {
			started = true;
			if (tmp_change.file.len > 0) {
				array_push(&changes, _MOV((main__Change[]){ tmp_change }));
				tmp_change = (main__Change){.file = (string){.str=(byteptr)""},.additions = 0,.deletions = 0,.diff = (string){.str=(byteptr)""},.message = (string){.str=(byteptr)""},};
			}
			tmp_change.file = string_substr((*(string*)array_get(args, 2)), 2, (*(string*)array_get(args, 2)).len);
		} else if (string_eq((*(string*)array_get(args, 0)), tos_lit("index"))) {
			continue;
		} else if (string_eq((*(string*)array_get(args, 0)), tos_lit("---"))) {
			continue;
		} else if (string_eq((*(string*)array_get(args, 0)), tos_lit("+++"))) {
			continue;
		} else if (string_eq((*(string*)array_get(args, 0)), tos_lit("@@"))) {
			tmp_change.diff = line;
		} else {
			if (started) {
				if ((*(byte*)array_get(string_bytes(line), 0)) == '+') {
					tmp_change.additions++;
				}
				if ((*(byte*)array_get(string_bytes(line), 0)) == '-') {
					tmp_change.deletions++;
				}
				tmp_change.message = /*f*/string_add(tmp_change.message, _STR("%.*s\000\n", 2, line));
			}
		};
	}
	array_push(&changes, _MOV((main__Change[]){ tmp_change }));
	return changes;
}

static void main__App_insert_commit(main__App* app, main__Commit commit) {
	
	// sql insert
	sqlite__DB _t2185 = app->db;
	sqlite3_stmt* _t2186 = sqlite__DB_init_stmt(_t2185, tos_lit("INSERT INTO `Commit` (`author_id`, `author`, `hash`, `created_at`, `repo_id`, `message`) values (?1, ?2, ?3, ?4, ?5, ?6)"));
	sqlite3_bind_int(_t2186, 1, commit.author_id); // stmt
	sqlite3_bind_text(_t2186, 2, commit.author.str, commit.author.len, 0);
	sqlite3_bind_text(_t2186, 3, commit.hash.str, commit.hash.len, 0);
	sqlite3_bind_int(_t2186, 4, commit.created_at); // stmt
	sqlite3_bind_int(_t2186, 5, commit.repo_id); // stmt
	sqlite3_bind_text(_t2186, 6, commit.message.str, commit.message.len, 0);
	
		int _t2187 = sqlite3_step(_t2186);
		if( (_t2187 != SQLITE_OK) && (_t2187 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2185.conn)); }
		sqlite3_finalize(_t2186);
}

static array_main__Commit main__App_find_repo_commits(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2189 = app->db;
	sqlite3_stmt* _t2188 = sqlite__DB_init_stmt(_t2189, tos_lit("SELECT `id`, `author_id`, `author`, `hash`, `created_at`, `repo_id`, `message` FROM `Commit` WHERE repo_id = ?1 ORDER BY id  LIMIT ?2"));
	sqlite3_bind_int(_t2188, 1, repo_id);
sqlite3_bind_int(_t2188, 2, 10);

	int _t2190 = sqlite3_extended_errcode(_t2189.conn);
	if (_t2190 != SQLITE_OK) { puts(sqlite3_errmsg(_t2189.conn)); }
	array_main__Commit _t2191_array = __new_array(0, 10, sizeof(main__Commit));
	while (1) {
		main__Commit _t2191 = (main__Commit) {
	.id = 0, .author_id = 0, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .created_at = 0, .repo_id = 0, .message = (string){.str=(byteptr)""}};
	int _step_res_t2191 = sqlite3_step(_t2188);
		if (_step_res_t2191 == SQLITE_DONE) break;
		if (_step_res_t2191 == SQLITE_ROW) ;
		else if (_step_res_t2191 != SQLITE_OK) break;
	_t2191.id = sqlite3_column_int(_t2188, 0);
	_t2191.author_id = sqlite3_column_int(_t2188, 1);
	_t2191.author = tos_clone(sqlite3_column_text(_t2188, 2));
	_t2191.hash = tos_clone(sqlite3_column_text(_t2188, 3));
	_t2191.created_at = sqlite3_column_int(_t2188, 4);
	_t2191.repo_id = sqlite3_column_int(_t2188, 5);
	_t2191.message = tos_clone(sqlite3_column_text(_t2188, 6));
		 array_push(&_t2191_array, _MOV((main__Commit[]){ _t2191 }));
	}
	sqlite3_finalize(_t2188);
		return  _t2191_array; 
	;
}

static array_main__Commit main__App_find_repo_commits_as_page(main__App* app, int repo_id, int page) {
	int offs = page * _const_main__commits_per_page;

	// sql select
	sqlite__DB _t2193 = app->db;
	sqlite3_stmt* _t2192 = sqlite__DB_init_stmt(_t2193, tos_lit("SELECT `id`, `author_id`, `author`, `hash`, `created_at`, `repo_id`, `message` FROM `Commit` WHERE repo_id = ?1 ORDER BY created_at DESC  LIMIT ?2 OFFSET ?3"));
	sqlite3_bind_int(_t2192, 1, repo_id);
sqlite3_bind_int(_t2192, 2, 35);
sqlite3_bind_int(_t2192, 3, offs);

	int _t2194 = sqlite3_extended_errcode(_t2193.conn);
	if (_t2194 != SQLITE_OK) { puts(sqlite3_errmsg(_t2193.conn)); }
	array_main__Commit _t2195_array = __new_array(0, 10, sizeof(main__Commit));
	while (1) {
		main__Commit _t2195 = (main__Commit) {
	.id = 0, .author_id = 0, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .created_at = 0, .repo_id = 0, .message = (string){.str=(byteptr)""}};
	int _step_res_t2195 = sqlite3_step(_t2192);
		if (_step_res_t2195 == SQLITE_DONE) break;
		if (_step_res_t2195 == SQLITE_ROW) ;
		else if (_step_res_t2195 != SQLITE_OK) break;
	_t2195.id = sqlite3_column_int(_t2192, 0);
	_t2195.author_id = sqlite3_column_int(_t2192, 1);
	_t2195.author = tos_clone(sqlite3_column_text(_t2192, 2));
	_t2195.hash = tos_clone(sqlite3_column_text(_t2192, 3));
	_t2195.created_at = sqlite3_column_int(_t2192, 4);
	_t2195.repo_id = sqlite3_column_int(_t2192, 5);
	_t2195.message = tos_clone(sqlite3_column_text(_t2192, 6));
		 array_push(&_t2195_array, _MOV((main__Commit[]){ _t2195 }));
	}
	sqlite3_finalize(_t2192);
		return  _t2195_array; 
	;
}

static int main__App_nr_repo_commits(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2197 = app->db;
	sqlite3_stmt* _t2196 = sqlite__DB_init_stmt(_t2197, tos_lit("SELECT COUNT(*) FROM `Commit`  WHERE repo_id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2196, 1, repo_id);

	int _t2198 = sqlite3_extended_errcode(_t2197.conn);
	if (_t2198 != SQLITE_OK) { puts(sqlite3_errmsg(_t2197.conn)); }
		return  sqlite__get_int_from_stmt(_t2196);
	;
}

static main__Commit main__App_find_repo_commit_by_hash(main__App* app, int repo_id, string hash) {

	// sql select
	sqlite__DB _t2200 = app->db;
	sqlite3_stmt* _t2199 = sqlite__DB_init_stmt(_t2200, tos_lit("SELECT `id`, `author_id`, `author`, `hash`, `created_at`, `repo_id`, `message` FROM `Commit` WHERE repo_id = ?1 and hash = ?2 ORDER BY id "));
	sqlite3_bind_int(_t2199, 1, repo_id);
sqlite3_bind_text(_t2199, 2, hash.str, hash.len, 0);

	int _t2201 = sqlite3_extended_errcode(_t2200.conn);
	if (_t2201 != SQLITE_OK) { puts(sqlite3_errmsg(_t2200.conn)); }
	array_main__Commit _t2202_array = __new_array(0, 10, sizeof(main__Commit));
	while (1) {
		main__Commit _t2202 = (main__Commit) {
	.id = 0, .author_id = 0, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .created_at = 0, .repo_id = 0, .message = (string){.str=(byteptr)""}};
	int _step_res_t2202 = sqlite3_step(_t2199);
		if (_step_res_t2202 == SQLITE_DONE) break;
		if (_step_res_t2202 == SQLITE_ROW) ;
		else if (_step_res_t2202 != SQLITE_OK) break;
	_t2202.id = sqlite3_column_int(_t2199, 0);
	_t2202.author_id = sqlite3_column_int(_t2199, 1);
	_t2202.author = tos_clone(sqlite3_column_text(_t2199, 2));
	_t2202.hash = tos_clone(sqlite3_column_text(_t2199, 3));
	_t2202.created_at = sqlite3_column_int(_t2199, 4);
	_t2202.repo_id = sqlite3_column_int(_t2199, 5);
	_t2202.message = tos_clone(sqlite3_column_text(_t2199, 6));
		 array_push(&_t2202_array, _MOV((main__Commit[]){ _t2202 }));
	}
	sqlite3_finalize(_t2199);
		array_main__Commit commits =  _t2202_array; 
	;
	if (commits.len == 1) {
		return (*(main__Commit*)array_get(commits, 0));
	}
	return (main__Commit){.id = 0,.author_id = 0,.author = (string){.str=(byteptr)""},.hash = (string){.str=(byteptr)""},.created_at = 0,.repo_id = 0,.message = (string){.str=(byteptr)""},};
}

static main__Commit main__App_find_repo_last_commit(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2204 = app->db;
	sqlite3_stmt* _t2203 = sqlite__DB_init_stmt(_t2204, tos_lit("SELECT `id`, `author_id`, `author`, `hash`, `created_at`, `repo_id`, `message` FROM `Commit` WHERE repo_id = ?1 ORDER BY created_at DESC  LIMIT ?2"));
	sqlite3_bind_int(_t2203, 1, repo_id);
sqlite3_bind_int(_t2203, 2, 1);

	int _t2205 = sqlite3_extended_errcode(_t2204.conn);
	if (_t2205 != SQLITE_OK) { puts(sqlite3_errmsg(_t2204.conn)); }
	main__Commit _t2206 = (main__Commit){
	.id = 0, .author_id = 0, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .created_at = 0, .repo_id = 0, .message = (string){.str=(byteptr)""}};
	int _step_res_t2206 = sqlite3_step(_t2203);
		if (_step_res_t2206 == SQLITE_OK || _step_res_t2206 == SQLITE_ROW) {
	_t2206.id = sqlite3_column_int(_t2203, 0);
	_t2206.author_id = sqlite3_column_int(_t2203, 1);
	_t2206.author = tos_clone(sqlite3_column_text(_t2203, 2));
	_t2206.hash = tos_clone(sqlite3_column_text(_t2203, 3));
	_t2206.created_at = sqlite3_column_int(_t2203, 4);
	_t2206.repo_id = sqlite3_column_int(_t2203, 5);
	_t2206.message = tos_clone(sqlite3_column_text(_t2203, 6));
	}
	sqlite3_finalize(_t2203);
		return  _t2206; 
	;
}

static main__Commit main__App_find_repo_first_commit(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2208 = app->db;
	sqlite3_stmt* _t2207 = sqlite__DB_init_stmt(_t2208, tos_lit("SELECT `id`, `author_id`, `author`, `hash`, `created_at`, `repo_id`, `message` FROM `Commit` WHERE repo_id = ?1 ORDER BY created_at LIMIT ?2"));
	sqlite3_bind_int(_t2207, 1, repo_id);
sqlite3_bind_int(_t2207, 2, 1);

	int _t2209 = sqlite3_extended_errcode(_t2208.conn);
	if (_t2209 != SQLITE_OK) { puts(sqlite3_errmsg(_t2208.conn)); }
	main__Commit _t2210 = (main__Commit){
	.id = 0, .author_id = 0, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .created_at = 0, .repo_id = 0, .message = (string){.str=(byteptr)""}};
	int _step_res_t2210 = sqlite3_step(_t2207);
		if (_step_res_t2210 == SQLITE_OK || _step_res_t2210 == SQLITE_ROW) {
	_t2210.id = sqlite3_column_int(_t2207, 0);
	_t2210.author_id = sqlite3_column_int(_t2207, 1);
	_t2210.author = tos_clone(sqlite3_column_text(_t2207, 2));
	_t2210.hash = tos_clone(sqlite3_column_text(_t2207, 3));
	_t2210.created_at = sqlite3_column_int(_t2207, 4);
	_t2210.repo_id = sqlite3_column_int(_t2207, 5);
	_t2210.message = tos_clone(sqlite3_column_text(_t2207, 6));
	}
	sqlite3_finalize(_t2207);
		return  _t2210; 
	;
}

static array_main__Commit main__App_find_repo_commits_by_author(main__App* app, int repo_id, string author) {

	// sql select
	sqlite__DB _t2212 = app->db;
	sqlite3_stmt* _t2211 = sqlite__DB_init_stmt(_t2212, tos_lit("SELECT `id`, `author_id`, `author`, `hash`, `created_at`, `repo_id`, `message` FROM `Commit` WHERE repo_id = ?1 and author = ?2 ORDER BY id  LIMIT ?3"));
	sqlite3_bind_int(_t2211, 1, repo_id);
sqlite3_bind_text(_t2211, 2, author.str, author.len, 0);
sqlite3_bind_int(_t2211, 3, 10);

	int _t2213 = sqlite3_extended_errcode(_t2212.conn);
	if (_t2213 != SQLITE_OK) { puts(sqlite3_errmsg(_t2212.conn)); }
	array_main__Commit _t2214_array = __new_array(0, 10, sizeof(main__Commit));
	while (1) {
		main__Commit _t2214 = (main__Commit) {
	.id = 0, .author_id = 0, .author = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .created_at = 0, .repo_id = 0, .message = (string){.str=(byteptr)""}};
	int _step_res_t2214 = sqlite3_step(_t2211);
		if (_step_res_t2214 == SQLITE_DONE) break;
		if (_step_res_t2214 == SQLITE_ROW) ;
		else if (_step_res_t2214 != SQLITE_OK) break;
	_t2214.id = sqlite3_column_int(_t2211, 0);
	_t2214.author_id = sqlite3_column_int(_t2211, 1);
	_t2214.author = tos_clone(sqlite3_column_text(_t2211, 2));
	_t2214.hash = tos_clone(sqlite3_column_text(_t2211, 3));
	_t2214.created_at = sqlite3_column_int(_t2211, 4);
	_t2214.repo_id = sqlite3_column_int(_t2211, 5);
	_t2214.message = tos_clone(sqlite3_column_text(_t2211, 6));
		 array_push(&_t2214_array, _MOV((main__Commit[]){ _t2214 }));
	}
	sqlite3_finalize(_t2211);
		return  _t2214_array; 
	;
}

static string main__File_url(main__File f) {
	string typ = (f.is_dir ? (tos_lit("tree")) : (tos_lit("blob")));
	if (string_eq(f.parent_path, tos_lit(""))) {
		return _STR("%.*s\000/%.*s\000/%.*s", 3, typ, f.branch, f.name);
	}
	return _STR("%.*s\000/%.*s\000/%.*s\000/%.*s", 4, typ, f.branch, f.parent_path, f.name);
}

static string main__File_full_path(main__File* f) {
	if (string_eq(f->parent_path, tos_lit(""))) {
		return f->name;
	}
	return string_add(string_add(f->parent_path, tos_lit("/")), f->name);
}

static string main__File_pretty_last_time(main__File f) {
	return time__Time_relative(time__unix(f.last_time));
}

static string main__File_pretty_size(main__File f) {
	return tos_lit("Today");
}

static void main__App_insert_file(main__App* app, main__File file) {
	
	// sql insert
	sqlite__DB _t2215 = app->db;
	sqlite3_stmt* _t2216 = sqlite__DB_init_stmt(_t2215, tos_lit("INSERT INTO `File` (`repo_id`, `name`, `parent_path`, `is_dir`, `branch`, `nr_contributors`, `last_hash`, `size`, `nr_views`, `last_msg`, `last_time`) values (?1, ?2, ?3, ?4, ?5, ?6, ?7, ?8, ?9, ?10, ?11)"));
	sqlite3_bind_int(_t2216, 1, file.repo_id); // stmt
	sqlite3_bind_text(_t2216, 2, file.name.str, file.name.len, 0);
	sqlite3_bind_text(_t2216, 3, file.parent_path.str, file.parent_path.len, 0);
	sqlite3_bind_int(_t2216, 4, file.is_dir); // stmt
	sqlite3_bind_text(_t2216, 5, file.branch.str, file.branch.len, 0);
	sqlite3_bind_int(_t2216, 6, file.nr_contributors); // stmt
	sqlite3_bind_text(_t2216, 7, file.last_hash.str, file.last_hash.len, 0);
	sqlite3_bind_int(_t2216, 8, file.size); // stmt
	sqlite3_bind_int(_t2216, 9, file.nr_views); // stmt
	sqlite3_bind_text(_t2216, 10, file.last_msg.str, file.last_msg.len, 0);
	sqlite3_bind_int(_t2216, 11, file.last_time); // stmt
	
		int _t2217 = sqlite3_step(_t2216);
		if( (_t2217 != SQLITE_OK) && (_t2217 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2215.conn)); }
		sqlite3_finalize(_t2216);
}

static array_main__File main__App_find_repo_files(main__App* app, int repo_id2, string branch, string parent_path) {
	main__App_info(app, _STR("find files by repo(repo_id=%"PRId32"\000, parent_path=\"%.*s\000\")", 3, repo_id2, parent_path));

	// sql select
	sqlite__DB _t2219 = app->db;
	sqlite3_stmt* _t2218 = sqlite__DB_init_stmt(_t2219, tos_lit("SELECT `id`, `repo_id`, `name`, `parent_path`, `is_dir`, `branch`, `nr_contributors`, `last_hash`, `size`, `nr_views`, `last_msg`, `last_time` FROM `File` WHERE repo_id = ?1 and parent_path = ?2 and branch = ?3 ORDER BY id "));
	sqlite3_bind_int(_t2218, 1, repo_id2);
sqlite3_bind_text(_t2218, 2, parent_path.str, parent_path.len, 0);
sqlite3_bind_text(_t2218, 3, branch.str, branch.len, 0);

	int _t2220 = sqlite3_extended_errcode(_t2219.conn);
	if (_t2220 != SQLITE_OK) { puts(sqlite3_errmsg(_t2219.conn)); }
	array_main__File _t2221_array = __new_array(0, 10, sizeof(main__File));
	while (1) {
		main__File _t2221 = (main__File) {
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .parent_path = (string){.str=(byteptr)""}, .is_dir = 0, .branch = (string){.str=(byteptr)""}, .nr_contributors = 0, .last_hash = (string){.str=(byteptr)""}, .size = 0, .nr_views = 0, .last_msg = (string){.str=(byteptr)""}, .last_time = 0, .commit = {0}};
	int _step_res_t2221 = sqlite3_step(_t2218);
		if (_step_res_t2221 == SQLITE_DONE) break;
		if (_step_res_t2221 == SQLITE_ROW) ;
		else if (_step_res_t2221 != SQLITE_OK) break;
	_t2221.id = sqlite3_column_int(_t2218, 0);
	_t2221.repo_id = sqlite3_column_int(_t2218, 1);
	_t2221.name = tos_clone(sqlite3_column_text(_t2218, 2));
	_t2221.parent_path = tos_clone(sqlite3_column_text(_t2218, 3));
	_t2221.is_dir = sqlite3_column_int(_t2218, 4);
	_t2221.branch = tos_clone(sqlite3_column_text(_t2218, 5));
	_t2221.nr_contributors = sqlite3_column_int(_t2218, 6);
	_t2221.last_hash = tos_clone(sqlite3_column_text(_t2218, 7));
	_t2221.size = sqlite3_column_int(_t2218, 8);
	_t2221.nr_views = sqlite3_column_int(_t2218, 9);
	_t2221.last_msg = tos_clone(sqlite3_column_text(_t2218, 10));
	_t2221.last_time = sqlite3_column_int(_t2218, 11);
		 array_push(&_t2221_array, _MOV((main__File[]){ _t2221 }));
	}
	sqlite3_finalize(_t2218);
		array_main__File files =  _t2221_array; 
	;
	return files;
}

static Option_main__File main__App_find_repo_file_by_path(main__App* app, int repo_id, string branch, string path) {
	string parent_path = os__base_dir(path);
	string name = string_after(path, tos_lit("/"));
	main__App_info(app, _STR("find file parent_path=%.*s\000 name=%.*s", 2, parent_path, name));

	// sql select
	sqlite__DB _t2223 = app->db;
	sqlite3_stmt* _t2222 = sqlite__DB_init_stmt(_t2223, tos_lit("SELECT `id`, `repo_id`, `name`, `parent_path`, `is_dir`, `branch`, `nr_contributors`, `last_hash`, `size`, `nr_views`, `last_msg`, `last_time` FROM `File` WHERE repo_id = ?1 and parent_path = ?2 and branch = ?3 and name = ?4 ORDER BY id  LIMIT ?5"));
	sqlite3_bind_int(_t2222, 1, repo_id);
sqlite3_bind_text(_t2222, 2, parent_path.str, parent_path.len, 0);
sqlite3_bind_text(_t2222, 3, branch.str, branch.len, 0);
sqlite3_bind_text(_t2222, 4, name.str, name.len, 0);
sqlite3_bind_int(_t2222, 5, 1);

	int _t2224 = sqlite3_extended_errcode(_t2223.conn);
	if (_t2224 != SQLITE_OK) { puts(sqlite3_errmsg(_t2223.conn)); }
	main__File _t2225 = (main__File){
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .parent_path = (string){.str=(byteptr)""}, .is_dir = 0, .branch = (string){.str=(byteptr)""}, .nr_contributors = 0, .last_hash = (string){.str=(byteptr)""}, .size = 0, .nr_views = 0, .last_msg = (string){.str=(byteptr)""}, .last_time = 0, .commit = {0}};
	int _step_res_t2225 = sqlite3_step(_t2222);
		if (_step_res_t2225 == SQLITE_OK || _step_res_t2225 == SQLITE_ROW) {
	_t2225.id = sqlite3_column_int(_t2222, 0);
	_t2225.repo_id = sqlite3_column_int(_t2222, 1);
	_t2225.name = tos_clone(sqlite3_column_text(_t2222, 2));
	_t2225.parent_path = tos_clone(sqlite3_column_text(_t2222, 3));
	_t2225.is_dir = sqlite3_column_int(_t2222, 4);
	_t2225.branch = tos_clone(sqlite3_column_text(_t2222, 5));
	_t2225.nr_contributors = sqlite3_column_int(_t2222, 6);
	_t2225.last_hash = tos_clone(sqlite3_column_text(_t2222, 7));
	_t2225.size = sqlite3_column_int(_t2222, 8);
	_t2225.nr_views = sqlite3_column_int(_t2222, 9);
	_t2225.last_msg = tos_clone(sqlite3_column_text(_t2222, 10));
	_t2225.last_time = sqlite3_column_int(_t2222, 11);
	}
	sqlite3_finalize(_t2222);
		main__File file =  _t2225; 
	;
	if (string_eq(file.name, tos_lit(""))) {
		Option _t2226 = opt_none();
		return *(Option_main__File*)&_t2226;
	}
	Option_main__File _t2227;
	opt_ok2(&(main__File[]) { file }, (OptionBase*)(&_t2227), sizeof(main__File));
	return _t2227;
}

static void main__App_delete_repo_files(main__App* app, int repo_id) {
	
	// sql insert
	sqlite__DB _t2228 = app->db;
	sqlite3_stmt* _t2229 = sqlite__DB_init_stmt(_t2228, tos_lit("DELETE FROM `File`  WHERE repo_id = ?1"));
	sqlite3_bind_int(_t2229, 1, repo_id);

		int _t2230 = sqlite3_step(_t2229);
		if( (_t2230 != SQLITE_OK) && (_t2230 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2228.conn)); }
		sqlite3_finalize(_t2229);
}

static void main__App_delete_repo_folder(main__App* app, string path) {
	os__rmdir_all(os__real_path(path));
}

static string main__GitService_to_str(main__GitService s) {
	return (s == main__GitService_receive) ? (tos_lit("receive-pack")) : (s == main__GitService_upload) ? (tos_lit("upload-pack")) : (tos_lit("unknown"));
}

static vweb__Result main__App_git_info(main__App* app) {
	main__App_info(app, tos_lit("/info/refs"));
	main__App_info(app, app->vweb.req.method);
	string url = app->vweb.req.url;
	main__GitService service = (string_contains(url, tos_lit("?service=git-upload-pack")) ? (main__GitService_upload) : string_contains(url, tos_lit("?service=git-receive-pack")) ? (main__GitService_receive) : (main__GitService_unknown));
	if (service == main__GitService_unknown) {
		main__App_info(app, _STR("git: unknown info/refs service: %.*s", 1, url));
		return (vweb__Result){
#ifndef __cplusplus
0
#endif
};
	}
	if (false && !app->repo.is_public) {
		return vweb__Context_not_found(&app->vweb);
	} else {
		if (service == main__GitService_receive) {
			string user = tos_lit("");
			main__App_info(app, _STR("info/refs user=\"%.*s\000\"", 2, user));
			if (string_eq(user, tos_lit(""))) {
				return vweb__Context_not_found(&app->vweb);
			}
		}
	}
	vweb__Context_set_content_type(&app->vweb, _STR("application/x-git-%.*s\000-advertisement", 2, main__GitService_str(service)));
	vweb__Context_add_header(&app->vweb, tos_lit("Cache-Control"), tos_lit("no-cache"));
	strings__Builder sb = strings__new_builder(100);
	strings__Builder_write(&sb, main__packet_write(_STR("# service=git-%.*s\000\n", 2, main__GitService_str(service))));
	strings__Builder_write(&sb, main__packet_flush());
	string refs = main__Repo_git_advertise(app->repo, main__GitService_to_str(service));
	main__App_info(app, tos_lit("refs = "));
	main__App_info(app, refs);
	strings__Builder_write(&sb, refs);
	return vweb__Context_ok(&app->vweb, strings__Builder_str(&sb));
}

static string main__packet_flush() {
	return tos_lit("0000");
}

static string main__packet_write(string str) {
	string s = int_hex((str.len + 4));
	if (s.len % 4 != 0) {
		s = string_add(strings__repeat('0', 4 - s.len % 4), s);
	}
	return string_add(s, str);
}

static void main__main() {
	vweb__run_main__App(_const_main__http_port);
}

void main__App_info(main__App* app, string msg) {
	log__Log_info(&app->file_log, msg);
	log__Log_info(&app->cli_log, msg);
}

void main__App_warn(main__App* app, string msg) {
	log__Log_warn(&app->file_log, msg);
	log__Log_warn(&app->cli_log, msg);
}

void main__App_init_once(main__App* app) {
	os__mkdir(tos_lit("logs"));
	app->file_log = (log__Log){.level = 0,.output_label = (string){.str=(byteptr)""},.ofile = {0},.output_to_file = 0,.output_file_name = (string){.str=(byteptr)""},};
	app->cli_log = (log__Log){.level = 0,.output_label = (string){.str=(byteptr)""},.ofile = {0},.output_to_file = 0,.output_file_name = (string){.str=(byteptr)""},};
	log__Log_set_level(&app->file_log, log__Level_info);
	log__Log_set_level(&app->cli_log, log__Level_info);
	time__Time date = time__now();
	string date_s = _STR("%.*s", 1, time__Time_ymmdd(date));
	log__Log_set_full_logpath(&app->file_log, _STR("./logs/log_%.*s\000.log", 2, date_s));
	main__App_info(app, tos_lit("init_once()"));
	Option_string _t2232 = os__read_file(tos_lit("static/assets/version"));
	if (!_t2232.ok) {
		string err = _t2232.v_error;
		int errcode = _t2232.ecode;
		*(string*) _t2232.data = tos_lit("unknown");
	}
	string version = *(string*)_t2232.data;
	Option_os__Result _t2233 = os__exec(tos_lit("git rev-parse --short HEAD"));
	if (!_t2233.ok) {
		string err = _t2233.v_error;
		int errcode = _t2233.ecode;
		*(os__Result*) _t2233.data = (os__Result){.exit_code = 0,.output = version,};
	}
	os__Result result = *(os__Result*)_t2233.data;
	if (!string_contains(result.output, tos_lit("fatal"))) {
		app->version = string_trim_space(result.output);
	}
	if (string_ne(version, app->version)) {
		os__write_file(tos_lit("static/assets/version"), app->version);
	}
	app->path = tos_lit("");
	vweb__Context_serve_static(&app->vweb, tos_lit("/gitly.css"), tos_lit("static/css/gitly.css"), tos_lit("text/css"));
	vweb__Context_serve_static(&app->vweb, tos_lit("/jquery.js"), tos_lit("static/js/jquery.js"), tos_lit("text/javascript"));
	vweb__Context_serve_static(&app->vweb, tos_lit("/favicon.svg"), tos_lit("static/assets/favicon.svg"), tos_lit("image/svg+xml"));
	Option_sqlite__DB _t2234 = sqlite__connect(tos_lit("gitly.sqlite"));
	if (!_t2234.ok) {
		string err = _t2234.v_error;
		int errcode = _t2234.ecode;
		println(tos_lit("failed to connect to db"));
		v_panic(err);
	}
	app->db = *(sqlite__DB*)_t2234.data;
	main__App_create_tables(app);
	app->oauth_client_id = os__getenv(tos_lit("GITLY_OAUTH_CLIENT_ID"));
	app->oauth_client_secret = os__getenv(tos_lit("GITLY_OAUTH_SECRET"));
	if (string_eq(app->oauth_client_id, tos_lit(""))) {
		main__App_get_oauth_tokens_from_db(app);
	}
	if (!os__exists(_const_main__repo_storage_path)) {
		Option_bool _t2235 = os__mkdir(_const_main__repo_storage_path);
		if (!_t2235.ok) {
			string err = _t2235.v_error;
			int errcode = _t2235.ecode;
			main__App_info(app, _STR("Failed to create %.*s", 1, _const_main__repo_storage_path));
			main__App_info(app, _STR("Error: %.*s", 1, err));
			v_exit(1);
		};
	}
	Option_main__User _t2236 = main__App_find_user_by_id(app, 1);
	if (!_t2236.ok) {
		string err = _t2236.v_error;
		int errcode = _t2236.ecode;
		app->only_gh_login = false;
	};
	if (_IN(string, tos_lit("-cmdapi"), _const_os__args)) {
		// go
		thread_arg_main__App_command_fetcher *arg__t2237 = malloc(sizeof(thread_arg_main__App_command_fetcher));
		arg__t2237->arg0 = app;
		pthread_t thread__t2237;
		pthread_create(&thread__t2237, NULL, (void*)main__App_command_fetcher_thread_wrapper, arg__t2237);
		// endgo

	}
}

void main__App_init(main__App* app) {
	string url = app->vweb.req.url;
	app->show_menu = false;
	app->page_gen_time = tos_lit("");
	main__App_info(app, _STR("\n\ninit() url=%.*s", 1, url));
	app->path = tos_lit("");
	main__App_info(app, _STR("path=%.*s", 1, app->path));
	app->logged_in = main__App_logged_in(app);
	app->repo = (main__Repo){.id = 0,.git_dir = (string){.str=(byteptr)""},.name = (string){.str=(byteptr)""},.user_id = 0,.user_name = (string){.str=(byteptr)""},.clone_url = (string){.str=(byteptr)""},.primary_branch = (string){.str=(byteptr)""},.description = (string){.str=(byteptr)""},.is_public = 0,.users_contributed = __new_array(0, 1, sizeof(string)),.users_authorized = __new_array(0, 1, sizeof(string)),.nr_topics = 0,.nr_views = 0,.latest_update_hash = (string){.str=(byteptr)""},.latest_activity = {0},.webhook_secret = (string){.str=(byteptr)""},.nr_tags = 0,.nr_open_issues = 0,.nr_open_prs = 0,.nr_releases = 0,.nr_branches = 0,.lang_stats = __new_array(0, 1, sizeof(main__LangStat)),.created_at = 0,.nr_contributors = 0,.nr_commits = 0,.labels = __new_array(0, 1, sizeof(main__Label)),.status = 0,.msg_cache = new_map_1(sizeof(string)),};
	app->user = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
	if (app->logged_in) {
		Option_main__User _t2238 = main__App_get_user_from_cookies(app);
		if (!_t2238.ok) {
			string err = _t2238.v_error;
			int errcode = _t2238.ecode;
			app->logged_in = false;
			*(main__User*) _t2238.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
		}
		app->user = *(main__User*)_t2238.data;
	}
	main__App_add_visit(app);
}

vweb__Result main__App_r_home(main__App* app) {
	return vweb__Context_redirect(&app->vweb, tos_lit("/"));
}

vweb__Result main__App_r_repo(main__App* app) {
	return vweb__Context_redirect(&app->vweb, _STR("/%.*s\000/%.*s", 2, app->user.username, app->repo.name));
}

// Attr: [/:user/settings]
vweb__Result main__App_settings(main__App* app) {
	println(tos_lit("user settings"));
	return vweb__Context_text(&app->vweb, tos_lit("settings"));
}

// Attr: [/:user/:repo/settings]
vweb__Result main__App_repo_settings(main__App* app, string user, string repo) {
	if (!main__App_repo_belongs_to(app, user, repo)) {
		return main__App_r_repo(app);
	}
	app->show_menu = true;
		strings__Builder sb = strings__new_builder(7020);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n<div class=\"div-center\">\n<div class=\"form-error\">\n%.*s\000\n</div>\n\n<form action=\"/%.*s\000/%.*s\000/settings\" method=\"post\">\n<input type=\"password\" name=\"webhook_secret\" value=\"%.*s\000\" placeholder=\"WebhookSecret\">\n<input type=\"submit\" value=\"Update repo\">\n</form>\n\n<form action=\"/%.*s\000/%.*s\000/delete_repo\" method=\"post\">\n<input type=\"text\" name=\"verify\" placeholder=\"Type your repo path username/reponame\" required>\n<input type=\"submit\" value=\"Delete repo\">\n</form>\n\n<form action=\"/%.*s\000/%.*s\000/move_repo\" method=\"post\">\n<input type=\"text\" name=\"dest\" placeholder=\"Destination username\" required>\n<input type=\"text\" name=\"verify\" placeholder=\"Type your repo path username/reponame\" required>\n<input type=\"submit\" value=\"Move repo\">\n</form>\n\n</div>\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 23, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(app->vweb.form_error), vweb__filter(app->user.username), vweb__filter(app->repo.name), vweb__filter(app->repo.webhook_secret), vweb__filter(app->user.username), vweb__filter(app->repo.name), vweb__filter(app->user.username), vweb__filter(app->repo.name), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_repo_settings = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_repo_settings); strings__Builder_free(&sb); string_free(&_tmpl_res_repo_settings);
	;
}

static bool main__App_repo_belongs_to(main__App* app, string user, string repo) {
	return app->logged_in && main__App_exists_user_repo(app, user, repo) && app->repo.user_id == app->user.id;
}

// Attr: [post]
// Attr: [/:user/:repo/settings]
vweb__Result main__App_update_repo_settings(main__App* app, string user, string repo) {
	if (!main__App_repo_belongs_to(app, user, repo)) {
		return main__App_r_repo(app);
	}
	if (_IN_MAP(tos_lit("webhook_secret"), app->vweb.form) && string_ne((*(string*)map_get(app->vweb.form, tos_lit("webhook_secret"), &(string[]){ (string){.str=(byteptr)""} })), app->repo.webhook_secret) && string_ne((*(string*)map_get(app->vweb.form, tos_lit("webhook_secret"), &(string[]){ (string){.str=(byteptr)""} })), tos_lit(""))) {
		string webhook = crypto__sha1__hexhash((*(string*)map_get(app->vweb.form, tos_lit("webhook_secret"), &(string[]){ (string){.str=(byteptr)""} })));
		main__App_update_repo_webhook(app, app->repo.id, webhook);
	}
	return main__App_r_repo(app);
}

// Attr: [post]
// Attr: [/:user/:repo/delete_repo]
vweb__Result main__App_repo_delete(main__App* app, string user, string repo) {
	if (!main__App_repo_belongs_to(app, user, repo)) {
		return main__App_r_repo(app);
	}
	if (_IN_MAP(tos_lit("verify"), app->vweb.form) && string_eq((*(string*)map_get(app->vweb.form, tos_lit("verify"), &(string[]){ (string){.str=(byteptr)""} })), _STR("%.*s\000/%.*s", 2, user, repo))) {
		// go
		thread_arg_main__App_delete_repo *arg__t2239 = malloc(sizeof(thread_arg_main__App_delete_repo));
		arg__t2239->arg0 = app;
		arg__t2239->arg1 = app->repo.id;
		arg__t2239->arg2 = app->repo.git_dir;
		arg__t2239->arg3 = app->repo.name;
		pthread_t thread__t2239;
		pthread_create(&thread__t2239, NULL, (void*)main__App_delete_repo_thread_wrapper, arg__t2239);
		// endgo

	} else {
		vweb__Context_error(&app->vweb, tos_lit("Verification failed"));
		return main__App_repo_settings(app, user, repo);
	}
	return main__App_r_home(app);
}

// Attr: [post]
// Attr: [/:user/:repo/move_repo]
vweb__Result main__App_repo_move(main__App* app, string user, string repo) {
	if (!main__App_repo_belongs_to(app, user, repo)) {
		return main__App_r_repo(app);
	}
	if (_IN_MAP(tos_lit("verify"), app->vweb.form) && _IN_MAP(tos_lit("dest"), app->vweb.form) && string_eq((*(string*)map_get(app->vweb.form, tos_lit("verify"), &(string[]){ (string){.str=(byteptr)""} })), _STR("%.*s\000/%.*s", 2, user, repo))) {
		string uname = (*(string*)map_get(app->vweb.form, tos_lit("dest"), &(string[]){ (string){.str=(byteptr)""} }));
		Option_main__User _t2240 = main__App_find_user_by_username(app, uname);
		if (!_t2240.ok) {
			string err = _t2240.v_error;
			int errcode = _t2240.ecode;
			vweb__Context_error(&app->vweb, _STR("Unknown user %.*s", 1, uname));
			return main__App_repo_settings(app, user, repo);
		}
		main__User dest_user = *(main__User*)_t2240.data;
		if (main__App_user_has_repo(app, dest_user.id, app->repo.name)) {
			vweb__Context_error(&app->vweb, _STR("User already owns repo %.*s", 1, app->repo.name));
			return main__App_repo_settings(app, user, repo);
		}
		if (main__App_nr_user_repos(app, dest_user.id) >= _const_main__max_user_repos) {
			vweb__Context_error(&app->vweb, tos_lit("User already reached the repo limit"));
			return main__App_repo_settings(app, user, repo);
		}
		main__App_move_repo_to_user(app, app->repo.id, dest_user.id, dest_user.username);
		return vweb__Context_redirect(&app->vweb, _STR("/%.*s\000/%.*s", 2, dest_user.username, app->repo.name));
	} else {
		vweb__Context_error(&app->vweb, tos_lit("Verification failed"));
		return main__App_repo_settings(app, user, repo);
	}
	return main__App_r_home(app);
}

// Attr: [/:user/:repo]
vweb__Result main__App_tree2(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	return main__App_tree(app, user, repo, app->repo.primary_branch, tos_lit(""));
}

// Attr: [/:user/:repo/tree/:branch/:path...]
vweb__Result main__App_tree(main__App* app, string user, string repo, string branch, string path) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	println(string_add(string_add(_STR("\n\n\ntree() user=\"%.*s\000\" repo=\"", 2, user), repo), tos_lit("\"")));
	app->path = _STR("/%.*s", 1, path);
	if (string_contains(app->path, tos_lit("/favicon.svg"))) {
		return vweb__not_found();
	}
	app->is_tree = true;
	app->show_menu = true;
	main__App_inc_repo_views(app, app->repo.id);
	string up = tos_lit("/");
	bool can_up = string_ne(path, tos_lit(""));
	if (can_up) {
		up = string_all_before_last(app->vweb.req.url, tos_lit("/"));
	}
	if (!string_ends_with(up, tos_lit("/"))) {
		up = /*f*/string_add(up, tos_lit("/"));
	}
	println(up);
	println(_STR("path=%.*s", 1, app->path));
	if (string_starts_with(app->path, tos_lit("/"))) {
		app->path = string_substr(app->path, 1, app->path.len);
	}
	array_main__File files = main__App_find_repo_files(app, app->repo.id, branch, app->path);
	main__App_info(app, _STR("tree() nr files found: %"PRId32"\000 in branch %.*s", 2, files.len, branch));
	if (files.len == 0) {
		main__App_info(app, _STR("caching files, repo_id=%"PRId32"", 1, app->repo.id));
		i64 t = time__ticks();
		files = main__App_cache_repo_files(app, (voidptr)&/*qq*/app->repo, branch, app->path);
		println(_STR("caching files took %"PRId64"\000ms", 2, time__ticks() - t));
		// go
		thread_arg_main__App_slow_fetch_files_info *arg__t2241 = malloc(sizeof(thread_arg_main__App_slow_fetch_files_info));
		arg__t2241->arg0 = app;
		arg__t2241->arg1 = branch;
		arg__t2241->arg2 = app->path;
		pthread_t thread__t2241;
		pthread_create(&thread__t2241, NULL, (void*)main__App_slow_fetch_files_info_thread_wrapper, arg__t2241);
		// endgo

	}
	vweb__RawHtml readme = ((vweb__RawHtml)(tos_lit("")));
	// FOR IN array
	array _t2242 = files;
	for (int _t2243 = 0; _t2243 < _t2242.len; ++_t2243) {
		main__File file = ((main__File*)_t2242.data)[_t2243];
		if (string_eq(string_to_lower(file.name), tos_lit("readme.md"))) {
			string blob_path = os__join_path(app->repo.git_dir, (varg_string){.len=1,.args={_STR("%.*s\000%.*s", 2, file.parent_path, file.name)}});
			Option_string _t2244 = os__read_file(blob_path);
			if (!_t2244.ok) {
				string err = _t2244.v_error;
				int errcode = _t2244.ecode;
				*(string*) _t2244.data = tos_lit("");
			}
			string plain_text = *(string*)_t2244.data;
			multi_return_string_int_int mr_8806 = hl__highlight_text(plain_text, blob_path, false);
			string src = mr_8806.arg0;
			readme = ((vweb__RawHtml)(src));
		}
	}
	main__Commit last_commit = (main__Commit){.id = 0,.author_id = 0,.author = (string){.str=(byteptr)""},.hash = (string){.str=(byteptr)""},.created_at = 0,.repo_id = 0,.message = (string){.str=(byteptr)""},};
	if (can_up) {
		string p = path;
		if (string_ends_with(p, tos_lit("/"))) {
			p = string_substr(p, 0, path.len - 1);
		}
		if (!string_contains(p, tos_lit("/"))) {
			p = _STR("/%.*s", 1, p);
		}
		{ /* if guard */ 
		Option_main__File _t2245;
		if (_t2245 = main__App_find_repo_file_by_path(app, app->repo.id, branch, p), _t2245.ok) {
			Option_main__File dir = _t2245;
			println(_STR("hash=%.*s", 1, /*opt*/(*(main__File*)dir.data).last_hash));
			last_commit = main__App_find_repo_commit_by_hash(app, app->repo.id, /*opt*/(*(main__File*)dir.data).last_hash);
		}}
	} else {
		last_commit = main__App_find_repo_last_commit(app, app->repo.id);
	}
	int diff = ((int)(time__ticks() - app->vweb.page_gen_start));
	if (diff == 0) {
		app->page_gen_time = tos_lit("<1ms");
	} else {
		app->page_gen_time = _STR("%"PRId32"\000ms", 2, diff);
	}
		strings__Builder sb = strings__new_builder(9090);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n\n\n<script>\n$(document).ready(function(){\n// So that the entire row is clickable\n$(\".file\").click(function(){\nwindow.location = $(this).find(\"a\").first().attr(\"href\");\n});\n});\n</script>\n\n\n<div class=\"lang-stats-header\">\n<div class=\"langs\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2246 = app->repo.lang_stats;
		for (int _t2247 = 0; _t2247 < _t2246.len; ++_t2247) {
			main__LangStat stat = ((main__LangStat*)_t2246.data)[_t2247];
			strings__Builder_write(&sb, _STR("\n<div class=\"lang-stat\">\n<span class=\"lang-stat-dot\" style=\"background-color:%.*s\000\">&nbsp;</span>\n<b>%.*s\000</b>\n%.*s\000\n</div>\n", 4, vweb__filter(stat.color), vweb__filter(stat.name), main__LangStat_pct_html(&stat)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n\n<div class=\"lang-stats-bar\">\n"));
		// FOR IN array
		array _t2248 = app->repo.lang_stats;
		for (int _t2249 = 0; _t2249 < _t2248.len; ++_t2249) {
			main__LangStat stat = ((main__LangStat*)_t2248.data)[_t2249];
			strings__Builder_write(&sb, _STR("\n<div style=\"flex:%"PRId32"\000; background-color:%.*s\000\">\n</div>\n", 3, stat.pct, vweb__filter(stat.color)));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n</div>\n\n<div class=\"files\">\n<div class=\"last_commit\">\n<span class=\"last_commit_author\">\n%.*s\000\n</span>\n<span class=\"last_commit_msg\">\ncommited <a href=\"/%.*s\000/%.*s\000/commit/%.*s\000\" class=\"hash_string\">%.*s\000</a>\n</span>\n<span class=\"time\">\n%.*s\000\n</span>\n</div>\n", 7, vweb__filter(last_commit.author), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(last_commit.hash), vweb__filter(last_commit.hash), vweb__filter(main__Commit_relative(last_commit))));
		if (can_up) {
			strings__Builder_write(&sb, _STR("\n<div class=\"file\">\n<span class=\"file-ico\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"folder\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z\"></path></svg>\n</span>\n<span class=\"file-name\">\n<a href=\"%.*s\000\">..</a>\n</span>\n</div>\n", 2, vweb__filter(up)));
		}
		strings__Builder_write(&sb, tos_lit("\n"));
		// FOR IN array
		array _t2250 = files;
		for (int _t2251 = 0; _t2251 < _t2250.len; ++_t2251) {
			main__File file = ((main__File*)_t2250.data)[_t2251];
			strings__Builder_write(&sb, tos_lit("\n<div class=\"file\">\n<span class=\"file-ico\">\n"));
			if (file.is_dir) {
				strings__Builder_write(&sb, tos_lit("\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"folder\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z\"></path></svg>\n"));
			} else {
				strings__Builder_write(&sb, tos_lit("\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"far\" data-icon=\"file-alt\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M288 248v28c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-28c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm-12 72H108c-6.6 0-12 5.4-12 12v28c0 6.6 5.4 12 12 12h168c6.6 0 12-5.4 12-12v-28c0-6.6-5.4-12-12-12zm108-188.1V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V48C0 21.5 21.5 0 48 0h204.1C264.8 0 277 5.1 286 14.1L369.9 98c9 8.9 14.1 21.2 14.1 33.9zm-128-80V128h76.1L256 51.9zM336 464V176H232c-13.3 0-24-10.7-24-24V48H48v416h288z\"></path></svg>\n"));
			}
			strings__Builder_write(&sb, _STR("\n</span>\n\n\n<span class=\"file-name\">\n<!--\n<a href=\"%.*s\000\">%.*s\000 (path=%.*s\000)</a>\n-->\n<a href=\"/%.*s\000/%.*s\000/%.*s\000\">%.*s\000</a>\n</span>\n<!--\n<span class=\"file-size\">\n%.*s\000\n</span>\n-->\n<span class=\"file-msg\">\n<a href=\"/%.*s\000/%.*s\000/commit/%.*s\000#%.*s\000\">%.*s\000</a>\n</span>\n<span class=\"file-time\">\n%.*s\000\n</span>\n\n</div>\n", 15, vweb__filter(main__File_url(file)), vweb__filter(file.name), vweb__filter(main__File_full_path(&file)), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(main__File_url(file)), vweb__filter(file.name), vweb__filter(main__File_pretty_size(file)), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(file.last_hash), vweb__filter(main__File_full_path(&file)), vweb__filter(file.last_msg), vweb__filter(main__File_pretty_last_time(file))));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n\n<div class=\"readme\">\n%.*s\000\n</div>\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 4, readme, vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_tree = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_tree); strings__Builder_free(&sb); string_free(&_tmpl_res_tree);
	;
}

vweb__Result main__App_index(main__App* app) {
	app->show_menu = false;
		strings__Builder sb = strings__new_builder(10560);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<style>\ntable, td {\nborder-collapse:collapse;\nborder:1px solid#dfdfdf;\n}\ntd {\npadding: 3px;\n}\n\n</style>\n\n<p>\nGitly is an upcoming open-source development platform that is going to have\n<li>Source code hosting <!--(git and Mercurial)-->\n<li>Project management\n<li>CI & CD\n\n<br><br>\n\n<p>\nMain features:\n\n<p>\n- Light and fast <br>\n- Minimal amount of RAM usage (works great on the cheapest $3.5 AWS Lightsail instance) <br>\n- Easy to deploy (a single <1 MB binary that includes compiled templates) <br>\n- Works without JavaScript <br>\n- Detailed language stats for each directory <br>\n- \"Top files\" feature to give an overview of the project <br>\n- Very fast CI with pre-cached dependencies <br>\n- Submitting a pull request without forking the repository\n</p>\n\n\n<br><br>\n\n<table>\n<tr>\n<td>\n<td>GitHub</td>\n<td>GitLab</td>\n<td>Gitly</td>\n</tr>\n<tr>\n<td>Open source</td>\n<td>No</td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td>All features are open source</td>\n<td>No</td>\n<td>No</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td>Minimum RAM</td>\n<td>32 GB <a target=_blank href=\"https://enterprise.github.com/faq\">[0]</a>\n<td>4 GB <a target=_blank href=\"https://docs.gitlab.com/ee/install/requirements.html#memory\">[1]</a>\n<td>128 MB</td>\n</tr>\n<tr>\n<td>Cheapest server\n<td>$160\n<td>$20\n<td>$3.50\n<a target=_blank href=\"https://aws.amazon.com/lightsail/pricing/\">[2]</a>\n</tr>\n<tr>\n<td>Works without JS\n<td>Partially\n<td>No\n<td>Yes\n</tr>\n<tr>\n<td>Detailed language stats\n<td>No\n<td>No\n<td>Yes\n</tr>\n<tr>\n<td>Installation size\n<td>?\n<td>3.9 GB\n<a target=_blank href=\"https://gist.github.com/medvednikov/a90fba85e5e2703a7a6270f1adc50dad\">[3]</a>\n<td><1 MB\n</tr>\n<tr>\n<td>CI features\n<td>\n<td>\n<td>\n<tr>\n<td># CPU cores\n<td>2\n<td>1\n<td>4 - 8\n</tr>\n<tr>\n<td>FreeBSD\n<td>No\n<td>No\n<td>Yes\n</tr>\n<tr>\n<td>macOS\n<td>Yes\n<td>No\n<td>Yes\n</tr>\n<tr>\n<td>Built-in dependency cache\n<td>No\n<td>No\n<td>Yes\n</tr>\n<tr>\n<td>CI minutes in a basic package\n<td>3000\n<a target=_blank href=\"https://docs.github.com/en/github/setting-up-and-managing-billing-and-payments-on-github/about-billing-for-github-actions\">[4]</a>\n<td>2000\n<a target=_blank href=\"https://about.gitlab.com/pricing/\">[5]</a>\n<td>43200\n</tr>\n</table>\n\n<br><br>\n\nCheck out Gitly in action by browsing the V language repo:\n\n<a href=\"/medvednikov/v\">gitly.org/vlang/v</a>\n\n<a href=\"/medvednikov/v\">\n<img width=600 src=\"https://user-images.githubusercontent.com/687996/85933714-b195fe80-b8da-11ea-9ddd-09cadc2103e4.png\">\n</a>\n\n\n\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 15, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_index = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_index); strings__Builder_free(&sb); string_free(&_tmpl_res_index);
	;
}

// Attr: [/:user/:repo/update]
vweb__Result main__App_update(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	if (app->user.is_admin) {
		// go
		thread_arg_main__App_update_repo_data *arg__t2252 = malloc(sizeof(thread_arg_main__App_update_repo_data));
		arg__t2252->arg0 = app;
		arg__t2252->arg1 = app->repo;
		pthread_t thread__t2252;
		pthread_create(&thread__t2252, NULL, (void*)main__App_update_repo_data_thread_wrapper, arg__t2252);
		// endgo

	}
	return main__App_r_repo(app);
}

// Attr: [/new]
vweb__Result main__App_new(main__App* app) {
	if (!app->logged_in) {
		return vweb__Context_redirect(&app->vweb, tos_lit("/login"));
	}
		strings__Builder sb = strings__new_builder(7680);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h3>New repository</h3>\n\n<div id=\"div-center\">\n<div class=\"form-error\">\n%.*s\000\n</div>\n\n<form method=\"post\" id=\"aj-form\">\n<div id=\"form-errors\">\n<!--\nif .clone_failed\nCloning failed. Most likely you provided an invalid git repo.\nend\n-->\n</div>\n\n<!--\n<div class=\"field\">New repository name</div>\n-->\nhttps://gitly.org/%.*s\000/\n<input type=\"text\" name=\"name\" required autofocus id=\"txt-name\" maxlength=%"PRId32"\000>\n\n<div class=\"field\">Clone URL <i>(only if you want to clone an existing repo)</i></div>\n<input type=\"text\" name=\"clone_url\" placeholder=\"https://github.com/user/repo\" maxlength=60 style=\"width:300px\">\n<!--\n<div class=\"field\">Webtoken-Secret <i>(if you want to auto update your repo)</i></div>\n<input type=\"text\" name=\"webtoken\" placeholder=\"Webtoken secret...\">\n-->\n\n<div class=\"field\">\n<label>\n<input type=\"checkbox\" name=\"isPrivate\" checked>\n<span class=\"icon-lock\" style=\"position:relative; top:3px;\"></span>\nMake this repository private\n</label>\n</div>\n\n<input type=\"submit\" class=\"btn-info\" value=\"Create\">\n</form>\n\n</div>\n\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 18, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(app->vweb.form_error), vweb__filter(app->user.username), _const_main__max_repo_name_len, vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_new = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_new); strings__Builder_free(&sb); string_free(&_tmpl_res_new);
	;
}

// Attr: [post]
// Attr: [/new]
vweb__Result main__App_new_repo(main__App* app) {
	if (!app->logged_in) {
		return vweb__Context_redirect(&app->vweb, tos_lit("/login"));
	}
	if (main__App_nr_user_repos(app, app->user.id) >= _const_main__max_user_repos) {
		vweb__Context_error(&app->vweb, tos_lit("You have reached the limit for the number of repositories"));
		return main__App_new(app);
	}
	string name = (*(string*)map_get(app->vweb.form, tos_lit("name"), &(string[]){ (string){.str=(byteptr)""} }));
	if (name.len > _const_main__max_repo_name_len) {
		vweb__Context_error(&app->vweb, _STR("Repository name is too long (should be fewer than %"PRId32"\000 characters)", 2, _const_main__max_repo_name_len));
		return main__App_new(app);
	}
	app->repo = (main__Repo){
		.id = 0,
		.git_dir = os__join_path(_const_main__repo_storage_path, (varg_string){.len=2,.args={app->user.username, name}}),
		.name = name,
		.user_id = app->user.id,
		.user_name = app->user.username,
		.clone_url = (*(string*)map_get(app->vweb.form, tos_lit("clone_url"), &(string[]){ (string){.str=(byteptr)""} })),
		.primary_branch = tos_lit("master"),
		.description = (string){.str=(byteptr)""},
		.is_public = 0,
		.users_contributed = __new_array(0, 1, sizeof(string)),
		.users_authorized = __new_array(0, 1, sizeof(string)),
		.nr_topics = 0,
		.nr_views = 0,
		.latest_update_hash = (string){.str=(byteptr)""},
		.latest_activity = {0},
		.webhook_secret = (string){.str=(byteptr)""},
		.nr_tags = 0,
		.nr_open_issues = 0,
		.nr_open_prs = 0,
		.nr_releases = 0,
		.nr_branches = 0,
		.lang_stats = __new_array(0, 1, sizeof(main__LangStat)),
		.created_at = 0,
		.nr_contributors = 0,
		.nr_commits = 0,
		.labels = __new_array(0, 1, sizeof(main__Label)),
		.status = 0,
		.msg_cache = new_map_1(sizeof(string)),
	};
	if (string_eq(app->repo.clone_url, tos_lit(""))) {
		os__mkdir(app->repo.git_dir);
		main__Repo_git(&app->repo, tos_lit("init"));
	} else {
		main__Repo_clone(&app->repo);
	}
	main__App_insert_repo(app, app->repo);
	Option_main__Repo _t2253 = main__App_find_repo_by_name(app, app->user.id, app->repo.name);
	if (!_t2253.ok) {
		string err = _t2253.v_error;
		int errcode = _t2253.ecode;
		main__App_info(app, tos_lit("Repo was not inserted"));
		return vweb__Context_redirect(&app->vweb, tos_lit("/new"));
	}
	app->repo = *(main__Repo*)_t2253.data;
	println(tos_lit("start go"));
	if (string_ne(app->repo.clone_url, tos_lit(""))) {
		main__Repo_clone(&app->repo);
	}
	// go
	thread_arg_main__App_update_repo *arg__t2254 = malloc(sizeof(thread_arg_main__App_update_repo));
	arg__t2254->arg0 = app;
	pthread_t thread__t2254;
	pthread_create(&thread__t2254, NULL, (void*)main__App_update_repo_thread_wrapper, arg__t2254);
	// endgo

	println(tos_lit("end go"));
	return vweb__Context_redirect(&app->vweb, _STR("/%.*s\000/repos", 2, app->user.username));
}

// Attr: [/:user/:repo/commits]
// Attr: [/:user/:repo/commits/:page_str]
vweb__Result main__App_commits(main__App* app, string user, string repo, int page) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	app->show_menu = true;
	array_main__Commit commits = main__App_find_repo_commits_as_page(app, app->repo.id, page);
	bool b_author = false;
	bool last = false;
	bool first = false;
	if (app->repo.nr_commits > _const_main__commits_per_page) {
		int offset = page * _const_main__commits_per_page;
		int delta = app->repo.nr_commits - offset;
		if (delta > 0) {
			if (delta == app->repo.nr_commits && page == 0) {
				first = true;
			} else {
				last = true;
			}
		}
	} else {
		last = true;
		first = true;
	}
	int last_site = 0;
	if (page > 0) {
		last_site = page - 1;
	}
	int next_site = page + 1;
	string msg = tos_lit("on");
	if (b_author) {
		msg = tos_lit("by");
	}
	map_string_array_main__Commit d_commits = new_map_1(sizeof(array_main__Commit));
	// FOR IN array
	array _t2255 = commits;
	for (int _t2256 = 0; _t2256 < _t2255.len; ++_t2256) {
		main__Commit commit = ((main__Commit*)_t2255.data)[_t2256];
		time__Time date = time__unix(commit.created_at);
		int day = date.day;
		int month = date.month;
		int year = date.year;
		string author = int_str(commit.author_id);
		string date_s = _STR("%"PRId32"\000.%"PRId32"\000.%"PRId32"", 3, day, month, year);
		if (!b_author) {
			if (!_IN_MAP(date_s, d_commits)) {
				map_set(&d_commits, date_s, &(array_main__Commit[]) { __new_array_with_default(0, 0, sizeof(main__Commit), 0) });
			}
			array_push(&(*(array_main__Commit*)map_get_and_set(&d_commits, date_s, &(array_main__Commit[]){ __new_array(0, 1, sizeof(main__Commit)) })), _MOV((main__Commit[]){ commit }));
		} else {
			if (!_IN_MAP(author, d_commits)) {
				map_set(&d_commits, author, &(array_main__Commit[]) { __new_array_with_default(0, 0, sizeof(main__Commit), 0) });
			}
			array_push(&(*(array_main__Commit*)map_get_and_set(&d_commits, author, &(array_main__Commit[]){ __new_array(0, 1, sizeof(main__Commit)) })), _MOV((main__Commit[]){ commit }));
		}
	}
		strings__Builder sb = strings__new_builder(7080);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN map
		map_string_array_main__Commit _t2261 = d_commits;
		array_string keys__t2259 = map_keys(&_t2261);
		for (int _t2260 = 0; _t2260 < keys__t2259.len; ++_t2260) {
			string day = /*kkkk*/ string_clone( ((string*)keys__t2259.data)[_t2260] );
			array_main__Commit commits = /*vvv*/ (*(array_main__Commit*)map_get(_t2261, day, &(array_main__Commit[]){ __new_array(0, 1, sizeof(main__Commit)) }));
			strings__Builder_write(&sb, _STR("\n<div class=\"commit-day\">\n<div class=\"commit-day-title\">\nCommits %.*s\000 %.*s\000\n</div>\n<div class=\"clog-block\">\n", 3, vweb__filter(msg), vweb__filter(day)));
			// FOR IN array
			array _t2262 = commits;
			for (int _t2263 = 0; _t2263 < _t2262.len; ++_t2263) {
				main__Commit commit = ((main__Commit*)_t2262.data)[_t2263];
				strings__Builder_write(&sb, _STR("\n<div class=\"clog\">\n<div class=\"clog-msg\">\n<a href=\"/%.*s\000/%.*s\000/commit/%.*s\000\">%.*s\000</a>\n</div>\n<span class=\"clog-author\">\n<a href=\"\">%.*s\000</a>\n</span>\n<span class=\"clog-time\">\ncommited %.*s\000\n</span>\n<!--\n<i class=\"commit_hash\">%.*s\000</i>\n-->\n</div>\n", 8, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(commit.hash), vweb__filter(commit.message), vweb__filter(commit.author), vweb__filter(main__Commit_relative(commit)), vweb__filter(commit.hash)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n"));
		}
		/*for in map cleanup*/
		for (int _t2260 = 0; _t2260 < keys__t2259.len; ++_t2260) { string_free(&((string*)keys__t2259.data)[_t2260]); }
		array_free(&keys__t2259);
		strings__Builder_write(&sb, tos_lit("\n\n<div class=\"buttons\">\n<br/>\n"));
		if (first) {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/commits/%"PRId32"\000\" class=\"button disabled\">Prev</a>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), last_site));
		} else {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/commits/%"PRId32"\000\" class=\"button\">Prev</a>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), last_site));
		}
		strings__Builder_write(&sb, tos_lit("\n\n"));
		if (last) {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/commits/%"PRId32"\000\" class=\"button disabled\">Next</a>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), next_site));
		} else {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/commits/%"PRId32"\000\" class=\"button\">Next</a>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), next_site));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		string _tmpl_res_commits = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_commits); strings__Builder_free(&sb); string_free(&_tmpl_res_commits);
	;
}

// Attr: [/:user/:repo/commit/:hash]
vweb__Result main__App_commit(main__App* app, string user, string repo, string hash) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	main__Commit commit = main__App_find_repo_commit_by_hash(app, app->repo.id, hash);
	array_main__Change changes = main__Commit_get_changes(commit, app->repo);
	int all_adds = 0;
	int all_dels = 0;
	map_string_vweb__RawHtml sources = new_map_1(sizeof(vweb__RawHtml));
	// FOR IN array
	array _t2264 = changes;
	for (int _t2265 = 0; _t2265 < _t2264.len; ++_t2265) {
		main__Change change = ((main__Change*)_t2264.data)[_t2265];
		all_adds += change.additions;
		all_dels += change.deletions;
		multi_return_string_int_int mr_13814 = hl__highlight_text(change.message, change.file, true);
		string src = mr_13814.arg0;
		map_set(&sources, change.file, &(vweb__RawHtml[]) { ((vweb__RawHtml)(src)) });
	}
		strings__Builder sb = strings__new_builder(7590);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<style>\npre {\noverflow-y: hidden;\noverflow-x: scroll;\n}\npre > *{\nfont-family:Roboto-Mono, Menlo;\n}\n.hl_table a {\npadding-right: 5px;\npadding-left: 5px;\nfloat: right;\n}\n.hl_table {\nwidth: 1000px;\nborder-right-color: rgb(36, 41, 46);\nborder-right-style: solid;\nborder-right-width: 0.5px;\nborder-bottom-color: rgb(36, 41, 46);\nborder-bottom-style: solid;\nborder-bottom-width: 0.5px;\nborder-left-color: rgb(36, 41, 46);\nborder-left-style: solid;\nborder-left-width: 0.5px;\n}\n.hl_table b {\ncolor: rgb(150, 77, 0);\n}\n.hl_table u {\ncolor: rgb(0, 124, 255);\ntext-decoration: none;\n}\n.hl_table i {\ncolor: rgb(3, 125, 3);\n}\n.a {\nbackground-color: #90fb90;\n}\n.d {\nbackground-color: #f27e7e;\n}\n</style>\n\n<span class=\"additions\">\nAdditions: %"PRId32"\000\n</span>\n\n<span class=\"deletions\">\nDeletions: %"PRId32"\000\n</span>\n\n", 15, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), all_adds, all_dels));
		// FOR IN map
		map_string_vweb__RawHtml _t2268 = sources;
		array_string keys__t2266 = map_keys(&_t2268);
		for (int _t2267 = 0; _t2267 < keys__t2266.len; ++_t2267) {
			string file = /*kkkk*/ string_clone( ((string*)keys__t2266.data)[_t2267] );
			vweb__RawHtml src = /*vvv*/ (*(vweb__RawHtml*)map_get(_t2268, file, &(vweb__RawHtml[]){ 0 }));
			strings__Builder_write(&sb, _STR("\n<div id=\"%.*s\000\">\n<a href=\"/%.*s\000/%.*s\000/blob/%.*s\000\">%.*s\000</a>\n<pre>%.*s\000</pre>\n</div>\n", 7, vweb__filter(file), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(file), vweb__filter(file), src));
		}
		/*for in map cleanup*/
		for (int _t2267 = 0; _t2267 < keys__t2266.len; ++_t2267) { string_free(&((string*)keys__t2266.data)[_t2267]); }
		array_free(&keys__t2266);
		strings__Builder_write(&sb, tos_lit("\n"));
		string _tmpl_res_commit = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_commit); strings__Builder_free(&sb); string_free(&_tmpl_res_commit);
	;
}

// Attr: [/:user/:repo/issues]
// Attr: [/:user/:repo/issues/:page_str]
vweb__Result main__App_issues(main__App* app, string user, string repo, string page_str) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		vweb__Context_not_found(&app->vweb);
	}
	app->show_menu = true;
	int page = (page_str.len >= 1 ? (string_int(page_str)) : (0));
	array_main__Issue issues = main__App_find_repo_issues_as_page(app, app->repo.id, page);
	bool first = false;
	bool last = false;
	// FOR IN array
	array _t2269 = issues;
	for (int index = 0; index < _t2269.len; ++index) {
		main__Issue issue = ((main__Issue*)_t2269.data)[index];
		(*(main__Issue*)array_get(issues, index)).author_name = main__App_find_username_by_id(app, issue.author_id);
	}
	if (app->repo.nr_open_issues > _const_main__commits_per_page) {
		int offset = page * _const_main__commits_per_page;
		int delta = app->repo.nr_open_issues - offset;
		if (delta > 0) {
			if (delta == app->repo.nr_open_issues && page == 0) {
				first = true;
			} else {
				last = true;
			}
		}
	} else {
		last = true;
		first = true;
	}
	int last_site = 0;
	if (page > 0) {
		last_site = page - 1;
	}
	int next_site = page + 1;
		strings__Builder sb = strings__new_builder(7920);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h3> Issues </h3>\n\n<div class=\"commit-day\">\n</div>\n\n<div class=\"clog-block\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2270 = issues;
		for (int _t2271 = 0; _t2271 < _t2270.len; ++_t2271) {
			main__Issue issue = ((main__Issue*)_t2270.data)[_t2271];
			strings__Builder_write(&sb, _STR("\n<div class=\"clog\">\n<div class=\"clog-msg\">\n<a href=\"/%.*s\000/%.*s\000/issue/%"PRId32"\000\">%.*s\000</a>\n</div>\n<span class=\"clog-author\">\n#%"PRId32"\000 opened %.*s\000\nby %.*s\000\n</span>\n", 8, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), issue.id, vweb__filter(issue.title), issue.id, vweb__filter(main__Issue_relative_time(&issue)), vweb__filter(issue.author_name)));
			if (issue.nr_comments > 0) {
				strings__Builder_write(&sb, tos_lit("\n<div class=\"comments\">\n"));
				if (issue.nr_comments == 1) {
					strings__Builder_write(&sb, _STR("\n%"PRId32"\000 comment\n", 2, issue.nr_comments));
				} else {
					strings__Builder_write(&sb, _STR("\n%"PRId32"\000 comments\n", 2, issue.nr_comments));
				}
				strings__Builder_write(&sb, tos_lit("\n</div>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n\n<div>\n<br>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/issues/new\">New issue</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n\n<div class=\"buttons\">\n<br>\n"));
		if (first) {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/issues/%"PRId32"\000\" class=\"button disabled\">Prev</a>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), last_site));
		} else {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/issues/%"PRId32"\000\" class=\"button\">Prev</a>/\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), last_site));
		}
		strings__Builder_write(&sb, tos_lit("\n\n"));
		if (last) {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/issues/%"PRId32"\000\" class=\"button disabled\">Next</a>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), next_site));
		} else {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000/issues/%"PRId32"\000\" class=\"button\">Next</a>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), next_site));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 3, vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_issues = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_issues); strings__Builder_free(&sb); string_free(&_tmpl_res_issues);
	;
}

// Attr: [/:user/:repo/issue/:id]
vweb__Result main__App_issue(main__App* app, string user, string repo, string id_str) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	app->show_menu = true;
	int id = 1;
	if (string_ne(id_str, tos_lit(""))) {
		id = string_int(id_str);
	}
	Option_main__Issue _t2272 = main__App_find_issue_by_id(app, id);
	if (!_t2272.ok) {
		string err = _t2272.v_error;
		int errcode = _t2272.ecode;
		return vweb__Context_not_found(&app->vweb);
	}
	main__Issue issue0 = *(main__Issue*)_t2272.data;
	main__Issue issue = issue0;
	issue.author_name = main__App_find_username_by_id(app, issue.author_id);
	array_main__Comment comments = main__App_find_issue_comments(app, issue.id);
		strings__Builder sb = strings__new_builder(6690);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<style>\n.comment {\nmargin-left: 20px;\nmargin-top: 20px;\n}\n</style>\n\n<h1>%.*s\000#%"PRId32"\000</h1>\n<i>by %.*s\000</i>\n<p>%.*s\000</p>\n\n\n", 17, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(issue.title), issue.id, vweb__filter(issue.author_name), vweb__filter(issue.text)));
		// FOR IN array
		array _t2273 = comments;
		for (int _t2274 = 0; _t2274 < _t2273.len; ++_t2274) {
			main__Comment comment = ((main__Comment*)_t2273.data)[_t2274];
			strings__Builder_write(&sb, _STR("\n\n<div class=\"comment\">\n<i>%.*s\000 commented %.*s\000</i>\n<p>%.*s\000</p>\n</div>\n\n", 4, vweb__filter(comment.author_name), vweb__filter(main__Comment_relative(comment)), vweb__filter(comment.text)));
		}
		strings__Builder_write(&sb, tos_lit("\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, _STR("\n<form method=\"post\" action=\"/%.*s\000/%.*s\000/comment\">\n<textarea type=\"text\" name=\"text\" placeholder=\"Write the command...\" required></textarea>\n<input type=\"number\" class=\"new_comment\" name=\"issue_id\" value=\"%"PRId32"\000\" style=\"visibility: hidden; position: absolute;\">\n<input type=\"submit\" name=\"submit\" value=\"Comment\">\n</form>\n", 4, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), issue.id));
		}
		strings__Builder_write(&sb, tos_lit("\n"));
		string _tmpl_res_issue = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_issue); strings__Builder_free(&sb); string_free(&_tmpl_res_issue);
	;
}

// Attr: [/:user/:repo/pull/:id]
vweb__Result main__App_pull(main__App* app, string user, string repo, string id_str) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	string_split(app->path, tos_lit("/"));
	int id = 0;
	Option_main__Issue _t2275 = main__App_find_pr_by_id(app, id);
	if (!_t2275.ok) {
		string err = _t2275.v_error;
		int errcode = _t2275.ecode;
		return vweb__Context_not_found(&app->vweb);
	}
	main__Issue pr0 = *(main__Issue*)_t2275.data;
	main__Issue pr = pr0;
	array_main__Comment comments = main__App_find_issue_comments(app, pr.id);
		strings__Builder sb = strings__new_builder(6480);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<style>\n.comment {\nmargin-left: 20px;\nmargin-top: 20px;\n}\n</style>\n\n<h1>%.*s\000#%"PRId32"\000</h1>\n<i>by %"PRId32"\000</i>\n<p>%.*s\000</p>\n\n\n", 17, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(pr.title), pr.id, pr.author_id, vweb__filter(pr.text)));
		// FOR IN array
		array _t2276 = comments;
		for (int _t2277 = 0; _t2277 < _t2276.len; ++_t2277) {
			main__Comment comment = ((main__Comment*)_t2276.data)[_t2277];
			strings__Builder_write(&sb, _STR("\n\n<div class=\"comment\">\n<i>%"PRId32"\000 commented</i>\n<p>%.*s\000</p>\n</div>\n\n", 3, comment.author_id, vweb__filter(comment.text)));
		}
		strings__Builder_write(&sb, tos_lit("\n"));
		string _tmpl_res_pull = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_pull); strings__Builder_free(&sb); string_free(&_tmpl_res_pull);
	;
}

vweb__Result main__App_pulls(main__App* app) {
	array_main__Issue prs = main__App_find_repo_prs(app, app->repo.id);
		strings__Builder sb = strings__new_builder(6480);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h3> Pull Requests </h3>\n\n<div class=\"clog-block\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2278 = prs;
		for (int _t2279 = 0; _t2279 < _t2278.len; ++_t2279) {
			main__Issue pr = ((main__Issue*)_t2278.data)[_t2279];
			strings__Builder_write(&sb, _STR("\n<div class=\"clog\">\n<div class=\"clog-msg\">\n<a href=\"/%.*s\000/%.*s\000/pull/%"PRId32"\000\">%.*s\000</a>\n</div>\n<span class=\"clog-author\">\n#%"PRId32"\000 opened %.*s\000\nby pr.author\n</span>\n</div>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), pr.id, vweb__filter(pr.title), pr.id, vweb__filter(main__Issue_relative_time(&pr))));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n\n<div>\n<br>\n<a href=\"/%.*s\000/%.*s\000/new_pr\">New pull request</a>\n</div>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		string _tmpl_res_pulls = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_pulls); strings__Builder_free(&sb); string_free(&_tmpl_res_pulls);
	;
}

// Attr: [/:user/:repo/contributors]
vweb__Result main__App_contributors(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	array_main__User contributors = main__App_find_repo_registered_contributor(app, app->repo.id);
		strings__Builder sb = strings__new_builder(6390);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h3> Contributors </h3>\n\n\n<div class=\"contributors\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2280 = contributors;
		for (int _t2281 = 0; _t2281 < _t2280.len; ++_t2281) {
			main__User contributor = ((main__User*)_t2280.data)[_t2281];
			strings__Builder_write(&sb, tos_lit("\n<div class=\"contributor\">\n<!--\n<span>email</span>\n-->\n"));
			if (contributor.is_registered) {
				strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000\"><span>%.*s\000</span></a>\n", 3, vweb__filter(contributor.username), vweb__filter(contributor.username)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(contributor.username)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		string _tmpl_res_contributors = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_contributors); strings__Builder_free(&sb); string_free(&_tmpl_res_contributors);
	;
}

// Attr: [/:user/:repo/branches]
vweb__Result main__App_branches(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	app->show_menu = true;
	array_main__Branch branches = main__App_find_repo_branches(app, app->repo.id);
		strings__Builder sb = strings__new_builder(6450);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n<h3>Branches</h3>\n<div class=\"branches\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2282 = branches;
		for (int _t2283 = 0; _t2283 < _t2282.len; ++_t2283) {
			main__Branch branch = ((main__Branch*)_t2282.data)[_t2283];
			strings__Builder_write(&sb, _STR("\n<div class=\"branch\">\n<div class=\"clog-block\">\n<div class=\"clog\">\n<div class=\"clog-msg\">\n<a href=\"/%.*s\000/%.*s\000/tree/%.*s\000\">%.*s\000</a>\n</div>\n<span class=\"clog-author\">\n<span >%.*s\000</span>\n</span>\n<span class=\"clog-time\">\nupdated %.*s\000\n</span>\n</div>\n</div>\n</div>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(branch.name), vweb__filter(branch.name), vweb__filter(branch.author), vweb__filter(main__Branch_relative(branch))));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		string _tmpl_res_branches = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_branches); strings__Builder_free(&sb); string_free(&_tmpl_res_branches);
	;
}

// Attr: [/:user/:repo/releases]
vweb__Result main__App_releases(main__App* app, string user_str, string repo) {
	if (!main__App_exists_user_repo(app, user_str, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	app->show_menu = true;
	array_main__Release releases = __new_array_with_default(0, 0, sizeof(main__Release), 0);
	main__Release release = (main__Release){.id = 0,.repo_id = 0,.tag_id = 0,.notes = (string){.str=(byteptr)""},.tag_name = (string){.str=(byteptr)""},.tag_hash = (string){.str=(byteptr)""},.user = (string){.str=(byteptr)""},.date = {0},};
	array_main__Tag tags = main__App_find_repo_tags(app, app->repo.id);
	array_main__Release rels = main__App_find_repo_releases(app, app->repo.id);
	array_main__User users = main__App_find_repo_registered_contributor(app, app->repo.id);
	// FOR IN array
	array _t2284 = rels;
	for (int _t2285 = 0; _t2285 < _t2284.len; ++_t2285) {
		main__Release rel = ((main__Release*)_t2284.data)[_t2285];
		release.notes = rel.notes;
		int user_id = 0;
		// FOR IN array
		array _t2286 = tags;
		for (int _t2287 = 0; _t2287 < _t2286.len; ++_t2287) {
			main__Tag tag = ((main__Tag*)_t2286.data)[_t2287];
			if (tag.id == rel.tag_id) {
				release.tag_name = tag.name;
				release.tag_hash = tag.hash;
				release.date = time__unix(tag.date);
				user_id = tag.user_id;
				break;
			}
		}
		// FOR IN array
		array _t2288 = users;
		for (int _t2289 = 0; _t2289 < _t2288.len; ++_t2289) {
			main__User user = ((main__User*)_t2288.data)[_t2289];
			if (user.id == user_id) {
				release.user = user.username;
				break;
			}
		}
		array_push(&releases, _MOV((main__Release[]){ release }));
	}
		strings__Builder sb = strings__new_builder(6240);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n<h3>Releases</h3>\n\n<div class=\"releases\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2291 = releases;
		for (int _t2292 = 0; _t2292 < _t2291.len; ++_t2292) {
			main__Release release = ((main__Release*)_t2291.data)[_t2292];
			strings__Builder_write(&sb, _STR("\n<div class=\"release\">\n<strong>Release:</strong> %.*s\000<br/>\n<strong>Hash:</strong> %.*s\000<br/>\n<strong>Created by:</strong> %.*s\000<br/>\n<strong>Notes:</strong> %.*s\000<br/>\n</div>\n<br/>\n", 5, vweb__filter(release.tag_name), vweb__filter(release.tag_hash), vweb__filter(release.user), vweb__filter(release.notes)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		string _tmpl_res_releases = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_releases); strings__Builder_free(&sb); string_free(&_tmpl_res_releases);
	;
}

// Attr: [/:user/:repo/blob/:branch/:path...]
vweb__Result main__App_blob(main__App* app, string user, string repo, string branch, string path) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	app->path = path;
	if (!main__App_contains_repo_branch(app, branch, app->repo.id) && string_ne(branch, app->repo.primary_branch)) {
		main__App_info(app, _STR("Branch %.*s\000 not found", 2, branch));
		return vweb__Context_not_found(&app->vweb);
	}
	bool raw = false;
	if (string_ends_with(app->path, tos_lit("/raw"))) {
		app->path = string_substr(app->path, 0, app->path.len - 4);
		raw = true;
	}
	string blob_path = os__join_path(app->repo.git_dir, (varg_string){.len=1,.args={app->path}});
	string plain_text = main__Repo_git(&app->repo, _STR("--no-pager show %.*s\000:%.*s", 2, branch, app->path));
	vweb__RawHtml source = ((vweb__RawHtml)(string_str(plain_text)));
	if (os__file_size(blob_path) < 1000000) {
		if (!raw) {
			multi_return_string_int_int mr_18028 = hl__highlight_text(plain_text, blob_path, false);
			string src = mr_18028.arg0;
			source = ((vweb__RawHtml)(src));
		}
	}
		strings__Builder sb = strings__new_builder(6660);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		if (raw) {
			strings__Builder_write(&sb, _STR("\n%.*s\000\n", 2, source));
		} else {
			strings__Builder_write(&sb, _STR("\n\n<pre>\n%.*s\000\n</pre>\n", 2, source));
		}
		strings__Builder_write(&sb, _STR("\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 3, vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_blob = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_blob); strings__Builder_free(&sb); string_free(&_tmpl_res_blob);
	;
}

// Attr: [/:user/:repo/issues/new]
vweb__Result main__App_new_issue(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	if (!app->logged_in) {
		return vweb__Context_not_found(&app->vweb);
	}
		strings__Builder sb = strings__new_builder(6960);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<style>\ninput[type=text], textarea {\nwidth: 50%%;\n}\ntextarea {\nheight: 300px;\n}\n</style>\n\n<h3>\nNew issue\n</h3>\n\n<form method=\"post\" class=\"vertical-form\" action=\"/%.*s\000/%.*s\000/issues/new\">\n<input type=\"text\" name=\"title\" placeholder=\"Title\" required>\n<textarea name=\"text\" required></textarea>\n<input type=\"submit\" value=\"Submit new issue\">\n</form>\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 17, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_new_issue = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_new_issue); strings__Builder_free(&sb); string_free(&_tmpl_res_new_issue);
	;
}

// Attr: [post]
// Attr: [/:user/:repo/issues/new]
vweb__Result main__App_add_issue(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	if (!app->logged_in || (app->logged_in && app->user.nr_posts >= _const_main__posts_per_day)) {
		return main__App_r_home(app);
	}
	string title = (*(string*)map_get(app->vweb.form, tos_lit("title"), &(string[]){ (string){.str=(byteptr)""} }));
	string text = (*(string*)map_get(app->vweb.form, tos_lit("text"), &(string[]){ (string){.str=(byteptr)""} }));
	if (string_eq(title, tos_lit("")) || string_eq(text, tos_lit(""))) {
		return vweb__Context_redirect(&app->vweb, _STR("/%.*s\000/%.*s\000/new_issue", 3, user, repo));
	}
	main__Issue issue = (main__Issue){.id = 0,.author_id = app->user.id,.repo_id = app->repo.id,.is_pr = 0,.assigned = __new_array(0, 1, sizeof(int)),.labels = __new_array(0, 1, sizeof(int)),.nr_comments = 0,.title = title,.text = text,.created_at = ((int)(time__now().v_unix)),.status = 0,.linked_issues = __new_array(0, 1, sizeof(int)),.author_name = (string){.str=(byteptr)""},.repo_author = (string){.str=(byteptr)""},.repo_name = (string){.str=(byteptr)""},};
	main__App_inc_user_post(app, (voidptr)&/*qq*/app->user);
	main__App_insert_issue(app, issue);
	main__App_inc_repo_issues(app, app->repo.id);
	return vweb__Context_redirect(&app->vweb, _STR("/%.*s\000/%.*s\000/issues", 3, user, repo));
}

// Attr: [post]
// Attr: [/:user/:repo/comment]
vweb__Result main__App_add_comment(main__App* app, string user, string repo) {
	if (!main__App_exists_user_repo(app, user, repo)) {
		return vweb__Context_not_found(&app->vweb);
	}
	string text = (*(string*)map_get(app->vweb.form, tos_lit("text"), &(string[]){ (string){.str=(byteptr)""} }));
	string issue_id = (*(string*)map_get(app->vweb.form, tos_lit("issue_id"), &(string[]){ (string){.str=(byteptr)""} }));
	if (string_eq(text, tos_lit("")) || string_eq(issue_id, tos_lit("")) || !app->logged_in) {
		return vweb__Context_redirect(&app->vweb, _STR("/%.*s\000/%.*s\000/issue/%.*s", 3, user, repo, issue_id));
	}
	main__Comment comm = (main__Comment){.id = 0,.author_id = app->user.id,.issue_id = string_int(issue_id),.created_at = ((int)(time__now().v_unix)),.text = text,.author_name = (string){.str=(byteptr)""},};
	main__App_insert_comment(app, comm);
	main__App_inc_issue_comments(app, comm.issue_id);
	return vweb__Context_redirect(&app->vweb, _STR("/%.*s\000/%.*s\000/issue/%.*s", 3, user, repo, issue_id));
}

static void main__App_insert_issue(main__App* app, main__Issue issue) {
	main__App_info(app, tos_lit("inserting issue:"));
	main__App_info(app, issue.title);
	
	// sql insert
	sqlite__DB _t2293 = app->db;
	sqlite3_stmt* _t2294 = sqlite__DB_init_stmt(_t2293, tos_lit("INSERT INTO `Issue` (`author_id`, `repo_id`, `is_pr`, `nr_comments`, `title`, `text`, `created_at`) values (?1, ?2, ?3, ?4, ?5, ?6, ?7)"));
	sqlite3_bind_int(_t2294, 1, issue.author_id); // stmt
	sqlite3_bind_int(_t2294, 2, issue.repo_id); // stmt
	sqlite3_bind_int(_t2294, 3, issue.is_pr); // stmt
	sqlite3_bind_int(_t2294, 4, issue.nr_comments); // stmt
	sqlite3_bind_text(_t2294, 5, issue.title.str, issue.title.len, 0);
	sqlite3_bind_text(_t2294, 6, issue.text.str, issue.text.len, 0);
	sqlite3_bind_int(_t2294, 7, issue.created_at); // stmt
	
		int _t2295 = sqlite3_step(_t2294);
		if( (_t2295 != SQLITE_OK) && (_t2295 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2293.conn)); }
		sqlite3_finalize(_t2294);
}

static Option_main__Issue main__App_find_issue_by_id(main__App* app, int issue_id) {

	// sql select
	sqlite__DB _t2297 = app->db;
	sqlite3_stmt* _t2296 = sqlite__DB_init_stmt(_t2297, tos_lit("SELECT `id`, `author_id`, `repo_id`, `is_pr`, `nr_comments`, `title`, `text`, `created_at` FROM `Issue` WHERE id = ?1 ORDER BY id  LIMIT ?2"));
	sqlite3_bind_int(_t2296, 1, issue_id);
sqlite3_bind_int(_t2296, 2, 1);

	int _t2298 = sqlite3_extended_errcode(_t2297.conn);
	if (_t2298 != SQLITE_OK) { puts(sqlite3_errmsg(_t2297.conn)); }
	main__Issue _t2299 = (main__Issue){
	.id = 0, .author_id = 0, .repo_id = 0, .is_pr = 0, .assigned = __new_array(0, 1, sizeof(int)), .labels = __new_array(0, 1, sizeof(int)), .nr_comments = 0, .title = (string){.str=(byteptr)""}, .text = (string){.str=(byteptr)""}, .created_at = 0, .status = 0, .linked_issues = __new_array(0, 1, sizeof(int)), .author_name = (string){.str=(byteptr)""}, .repo_author = (string){.str=(byteptr)""}, .repo_name = (string){.str=(byteptr)""}};
	int _step_res_t2299 = sqlite3_step(_t2296);
		if (_step_res_t2299 == SQLITE_OK || _step_res_t2299 == SQLITE_ROW) {
	_t2299.id = sqlite3_column_int(_t2296, 0);
	_t2299.author_id = sqlite3_column_int(_t2296, 1);
	_t2299.repo_id = sqlite3_column_int(_t2296, 2);
	_t2299.is_pr = sqlite3_column_int(_t2296, 3);
	_t2299.nr_comments = sqlite3_column_int(_t2296, 4);
	_t2299.title = tos_clone(sqlite3_column_text(_t2296, 5));
	_t2299.text = tos_clone(sqlite3_column_text(_t2296, 6));
	_t2299.created_at = sqlite3_column_int(_t2296, 7);
	}
	sqlite3_finalize(_t2296);
		main__Issue issue =  _t2299; 
	;
	if (issue.id == 0) {
		Option _t2300 = opt_none();
		return *(Option_main__Issue*)&_t2300;
	}
	Option_main__Issue _t2301;
	opt_ok2(&(main__Issue[]) { issue }, (OptionBase*)(&_t2301), sizeof(main__Issue));
	return _t2301;
}

static Option_main__Issue main__App_find_pr_by_id(main__App* app, int issue_id) {

	// sql select
	sqlite__DB _t2303 = app->db;
	sqlite3_stmt* _t2302 = sqlite__DB_init_stmt(_t2303, tos_lit("SELECT `id`, `author_id`, `repo_id`, `is_pr`, `nr_comments`, `title`, `text`, `created_at` FROM `Issue` WHERE id = ?1 ORDER BY id  LIMIT ?2"));
	sqlite3_bind_int(_t2302, 1, issue_id);
sqlite3_bind_int(_t2302, 2, 1);

	int _t2304 = sqlite3_extended_errcode(_t2303.conn);
	if (_t2304 != SQLITE_OK) { puts(sqlite3_errmsg(_t2303.conn)); }
	main__Issue _t2305 = (main__Issue){
	.id = 0, .author_id = 0, .repo_id = 0, .is_pr = 0, .assigned = __new_array(0, 1, sizeof(int)), .labels = __new_array(0, 1, sizeof(int)), .nr_comments = 0, .title = (string){.str=(byteptr)""}, .text = (string){.str=(byteptr)""}, .created_at = 0, .status = 0, .linked_issues = __new_array(0, 1, sizeof(int)), .author_name = (string){.str=(byteptr)""}, .repo_author = (string){.str=(byteptr)""}, .repo_name = (string){.str=(byteptr)""}};
	int _step_res_t2305 = sqlite3_step(_t2302);
		if (_step_res_t2305 == SQLITE_OK || _step_res_t2305 == SQLITE_ROW) {
	_t2305.id = sqlite3_column_int(_t2302, 0);
	_t2305.author_id = sqlite3_column_int(_t2302, 1);
	_t2305.repo_id = sqlite3_column_int(_t2302, 2);
	_t2305.is_pr = sqlite3_column_int(_t2302, 3);
	_t2305.nr_comments = sqlite3_column_int(_t2302, 4);
	_t2305.title = tos_clone(sqlite3_column_text(_t2302, 5));
	_t2305.text = tos_clone(sqlite3_column_text(_t2302, 6));
	_t2305.created_at = sqlite3_column_int(_t2302, 7);
	}
	sqlite3_finalize(_t2302);
		main__Issue pr =  _t2305; 
	;
	if (pr.id == 0) {
		Option _t2306 = opt_none();
		return *(Option_main__Issue*)&_t2306;
	}
	Option_main__Issue _t2307;
	opt_ok2(&(main__Issue[]) { pr }, (OptionBase*)(&_t2307), sizeof(main__Issue));
	return _t2307;
}

static array_main__Issue main__App_find_repo_issues_as_page(main__App* app, int repo_id, int page) {
	int off = page * _const_main__commits_per_page;

	// sql select
	sqlite__DB _t2309 = app->db;
	sqlite3_stmt* _t2308 = sqlite__DB_init_stmt(_t2309, tos_lit("SELECT `id`, `author_id`, `repo_id`, `is_pr`, `nr_comments`, `title`, `text`, `created_at` FROM `Issue` WHERE repo_id = ?1 and is_pr = ?2 ORDER BY id  LIMIT ?3 OFFSET ?4"));
	sqlite3_bind_int(_t2308, 1, repo_id);
sqlite3_bind_int(_t2308, 2, 0);
sqlite3_bind_int(_t2308, 3, 35);
sqlite3_bind_int(_t2308, 4, off);

	int _t2310 = sqlite3_extended_errcode(_t2309.conn);
	if (_t2310 != SQLITE_OK) { puts(sqlite3_errmsg(_t2309.conn)); }
	array_main__Issue _t2311_array = __new_array(0, 10, sizeof(main__Issue));
	while (1) {
		main__Issue _t2311 = (main__Issue) {
	.id = 0, .author_id = 0, .repo_id = 0, .is_pr = 0, .assigned = __new_array(0, 1, sizeof(int)), .labels = __new_array(0, 1, sizeof(int)), .nr_comments = 0, .title = (string){.str=(byteptr)""}, .text = (string){.str=(byteptr)""}, .created_at = 0, .status = 0, .linked_issues = __new_array(0, 1, sizeof(int)), .author_name = (string){.str=(byteptr)""}, .repo_author = (string){.str=(byteptr)""}, .repo_name = (string){.str=(byteptr)""}};
	int _step_res_t2311 = sqlite3_step(_t2308);
		if (_step_res_t2311 == SQLITE_DONE) break;
		if (_step_res_t2311 == SQLITE_ROW) ;
		else if (_step_res_t2311 != SQLITE_OK) break;
	_t2311.id = sqlite3_column_int(_t2308, 0);
	_t2311.author_id = sqlite3_column_int(_t2308, 1);
	_t2311.repo_id = sqlite3_column_int(_t2308, 2);
	_t2311.is_pr = sqlite3_column_int(_t2308, 3);
	_t2311.nr_comments = sqlite3_column_int(_t2308, 4);
	_t2311.title = tos_clone(sqlite3_column_text(_t2308, 5));
	_t2311.text = tos_clone(sqlite3_column_text(_t2308, 6));
	_t2311.created_at = sqlite3_column_int(_t2308, 7);
		 array_push(&_t2311_array, _MOV((main__Issue[]){ _t2311 }));
	}
	sqlite3_finalize(_t2308);
		return  _t2311_array; 
	;
}

static array_main__Issue main__App_find_repo_issues(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2313 = app->db;
	sqlite3_stmt* _t2312 = sqlite__DB_init_stmt(_t2313, tos_lit("SELECT `id`, `author_id`, `repo_id`, `is_pr`, `nr_comments`, `title`, `text`, `created_at` FROM `Issue` WHERE repo_id = ?1 and is_pr = ?2 ORDER BY id "));
	sqlite3_bind_int(_t2312, 1, repo_id);
sqlite3_bind_int(_t2312, 2, 0);

	int _t2314 = sqlite3_extended_errcode(_t2313.conn);
	if (_t2314 != SQLITE_OK) { puts(sqlite3_errmsg(_t2313.conn)); }
	array_main__Issue _t2315_array = __new_array(0, 10, sizeof(main__Issue));
	while (1) {
		main__Issue _t2315 = (main__Issue) {
	.id = 0, .author_id = 0, .repo_id = 0, .is_pr = 0, .assigned = __new_array(0, 1, sizeof(int)), .labels = __new_array(0, 1, sizeof(int)), .nr_comments = 0, .title = (string){.str=(byteptr)""}, .text = (string){.str=(byteptr)""}, .created_at = 0, .status = 0, .linked_issues = __new_array(0, 1, sizeof(int)), .author_name = (string){.str=(byteptr)""}, .repo_author = (string){.str=(byteptr)""}, .repo_name = (string){.str=(byteptr)""}};
	int _step_res_t2315 = sqlite3_step(_t2312);
		if (_step_res_t2315 == SQLITE_DONE) break;
		if (_step_res_t2315 == SQLITE_ROW) ;
		else if (_step_res_t2315 != SQLITE_OK) break;
	_t2315.id = sqlite3_column_int(_t2312, 0);
	_t2315.author_id = sqlite3_column_int(_t2312, 1);
	_t2315.repo_id = sqlite3_column_int(_t2312, 2);
	_t2315.is_pr = sqlite3_column_int(_t2312, 3);
	_t2315.nr_comments = sqlite3_column_int(_t2312, 4);
	_t2315.title = tos_clone(sqlite3_column_text(_t2312, 5));
	_t2315.text = tos_clone(sqlite3_column_text(_t2312, 6));
	_t2315.created_at = sqlite3_column_int(_t2312, 7);
		 array_push(&_t2315_array, _MOV((main__Issue[]){ _t2315 }));
	}
	sqlite3_finalize(_t2312);
		array_main__Issue issues =  _t2315_array; 
	;
	return issues;
}

static array_main__Issue main__App_find_repo_prs(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2317 = app->db;
	sqlite3_stmt* _t2316 = sqlite__DB_init_stmt(_t2317, tos_lit("SELECT `id`, `author_id`, `repo_id`, `is_pr`, `nr_comments`, `title`, `text`, `created_at` FROM `Issue` WHERE repo_id = ?1 and is_pr = ?2 ORDER BY id "));
	sqlite3_bind_int(_t2316, 1, repo_id);
sqlite3_bind_int(_t2316, 2, 1);

	int _t2318 = sqlite3_extended_errcode(_t2317.conn);
	if (_t2318 != SQLITE_OK) { puts(sqlite3_errmsg(_t2317.conn)); }
	array_main__Issue _t2319_array = __new_array(0, 10, sizeof(main__Issue));
	while (1) {
		main__Issue _t2319 = (main__Issue) {
	.id = 0, .author_id = 0, .repo_id = 0, .is_pr = 0, .assigned = __new_array(0, 1, sizeof(int)), .labels = __new_array(0, 1, sizeof(int)), .nr_comments = 0, .title = (string){.str=(byteptr)""}, .text = (string){.str=(byteptr)""}, .created_at = 0, .status = 0, .linked_issues = __new_array(0, 1, sizeof(int)), .author_name = (string){.str=(byteptr)""}, .repo_author = (string){.str=(byteptr)""}, .repo_name = (string){.str=(byteptr)""}};
	int _step_res_t2319 = sqlite3_step(_t2316);
		if (_step_res_t2319 == SQLITE_DONE) break;
		if (_step_res_t2319 == SQLITE_ROW) ;
		else if (_step_res_t2319 != SQLITE_OK) break;
	_t2319.id = sqlite3_column_int(_t2316, 0);
	_t2319.author_id = sqlite3_column_int(_t2316, 1);
	_t2319.repo_id = sqlite3_column_int(_t2316, 2);
	_t2319.is_pr = sqlite3_column_int(_t2316, 3);
	_t2319.nr_comments = sqlite3_column_int(_t2316, 4);
	_t2319.title = tos_clone(sqlite3_column_text(_t2316, 5));
	_t2319.text = tos_clone(sqlite3_column_text(_t2316, 6));
	_t2319.created_at = sqlite3_column_int(_t2316, 7);
		 array_push(&_t2319_array, _MOV((main__Issue[]){ _t2319 }));
	}
	sqlite3_finalize(_t2316);
		array_main__Issue issues =  _t2319_array; 
	;
	return issues;
}

static array_main__Issue main__App_find_user_issues(main__App* app, int user_id) {

	// sql select
	sqlite__DB _t2321 = app->db;
	sqlite3_stmt* _t2320 = sqlite__DB_init_stmt(_t2321, tos_lit("SELECT `id`, `author_id`, `repo_id`, `is_pr`, `nr_comments`, `title`, `text`, `created_at` FROM `Issue` WHERE author_id = ?1 and is_pr = ?2 ORDER BY id "));
	sqlite3_bind_int(_t2320, 1, user_id);
sqlite3_bind_int(_t2320, 2, 0);

	int _t2322 = sqlite3_extended_errcode(_t2321.conn);
	if (_t2322 != SQLITE_OK) { puts(sqlite3_errmsg(_t2321.conn)); }
	array_main__Issue _t2323_array = __new_array(0, 10, sizeof(main__Issue));
	while (1) {
		main__Issue _t2323 = (main__Issue) {
	.id = 0, .author_id = 0, .repo_id = 0, .is_pr = 0, .assigned = __new_array(0, 1, sizeof(int)), .labels = __new_array(0, 1, sizeof(int)), .nr_comments = 0, .title = (string){.str=(byteptr)""}, .text = (string){.str=(byteptr)""}, .created_at = 0, .status = 0, .linked_issues = __new_array(0, 1, sizeof(int)), .author_name = (string){.str=(byteptr)""}, .repo_author = (string){.str=(byteptr)""}, .repo_name = (string){.str=(byteptr)""}};
	int _step_res_t2323 = sqlite3_step(_t2320);
		if (_step_res_t2323 == SQLITE_DONE) break;
		if (_step_res_t2323 == SQLITE_ROW) ;
		else if (_step_res_t2323 != SQLITE_OK) break;
	_t2323.id = sqlite3_column_int(_t2320, 0);
	_t2323.author_id = sqlite3_column_int(_t2320, 1);
	_t2323.repo_id = sqlite3_column_int(_t2320, 2);
	_t2323.is_pr = sqlite3_column_int(_t2320, 3);
	_t2323.nr_comments = sqlite3_column_int(_t2320, 4);
	_t2323.title = tos_clone(sqlite3_column_text(_t2320, 5));
	_t2323.text = tos_clone(sqlite3_column_text(_t2320, 6));
	_t2323.created_at = sqlite3_column_int(_t2320, 7);
		 array_push(&_t2323_array, _MOV((main__Issue[]){ _t2323 }));
	}
	sqlite3_finalize(_t2320);
		return  _t2323_array; 
	;
}

static void main__App_delete_repo_issues(main__App* app, int repo_id) {
	
	// sql insert
	sqlite__DB _t2324 = app->db;
	sqlite3_stmt* _t2325 = sqlite__DB_init_stmt(_t2324, tos_lit("DELETE FROM `Issue`  WHERE repo_id = ?1"));
	sqlite3_bind_int(_t2325, 1, repo_id);

		int _t2326 = sqlite3_step(_t2325);
		if( (_t2326 != SQLITE_OK) && (_t2326 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2324.conn)); }
		sqlite3_finalize(_t2325);
}

static void main__App_inc_issue_comments(main__App* app, int id) {
	
	// sql insert
	sqlite__DB _t2327 = app->db;
	sqlite3_stmt* _t2328 = sqlite__DB_init_stmt(_t2327, tos_lit("UPDATE `Issue` SET  nr_comments = nr_comments + ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2328, 1, 1);
sqlite3_bind_int(_t2328, 2, id);

		int _t2329 = sqlite3_step(_t2328);
		if( (_t2329 != SQLITE_OK) && (_t2329 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2327.conn)); }
		sqlite3_finalize(_t2328);
}

static string main__Issue_relative_time(main__Issue* i) {
	return time__Time_relative(time__unix(i->created_at));
}

vweb__RawHtml main__LangStat_pct_html(main__LangStat* l) {
	f64 x = ((f64)(l->pct)) / 10.0;
	string sloc = (l->nr_lines < 1000 ? (int_str(l->nr_lines)) : (string_add(int_str((l->nr_lines / 1000)), tos_lit("k"))));
	return _STR("<span>%g\000%%</span> <span class=lang-stat-loc>%.*s\000 loc</span>", 3, x, sloc);
}

array_main__LangStat main__App_find_repo_lang_stats(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2331 = app->db;
	sqlite3_stmt* _t2330 = sqlite__DB_init_stmt(_t2331, tos_lit("SELECT `id`, `repo_id`, `name`, `nr_lines`, `pct`, `color` FROM `LangStat` WHERE repo_id = ?1 ORDER BY pct DESC "));
	sqlite3_bind_int(_t2330, 1, repo_id);

	int _t2332 = sqlite3_extended_errcode(_t2331.conn);
	if (_t2332 != SQLITE_OK) { puts(sqlite3_errmsg(_t2331.conn)); }
	array_main__LangStat _t2333_array = __new_array(0, 10, sizeof(main__LangStat));
	while (1) {
		main__LangStat _t2333 = (main__LangStat) {
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .nr_lines = 0, .pct = 0, .color = (string){.str=(byteptr)""}};
	int _step_res_t2333 = sqlite3_step(_t2330);
		if (_step_res_t2333 == SQLITE_DONE) break;
		if (_step_res_t2333 == SQLITE_ROW) ;
		else if (_step_res_t2333 != SQLITE_OK) break;
	_t2333.id = sqlite3_column_int(_t2330, 0);
	_t2333.repo_id = sqlite3_column_int(_t2330, 1);
	_t2333.name = tos_clone(sqlite3_column_text(_t2330, 2));
	_t2333.nr_lines = sqlite3_column_int(_t2330, 3);
	_t2333.pct = sqlite3_column_int(_t2330, 4);
	_t2333.color = tos_clone(sqlite3_column_text(_t2330, 5));
		 array_push(&_t2333_array, _MOV((main__LangStat[]){ _t2333 }));
	}
	sqlite3_finalize(_t2330);
		array_main__LangStat lang_stats =  _t2333_array; 
	;
	return lang_stats;
}

// Attr: [/login]
vweb__Result main__App_login(main__App* app) {
	string csrf = rand__string(30);
	vweb__Context_set_cookie(&app->vweb, (vweb__Cookie){.name = tos_lit("csrf"),.value = csrf,.expires = {0},.secure = 0,.http_only = 0,});
	if (main__App_logged_in(app)) {
		return vweb__Context_not_found(&app->vweb);
	}
		strings__Builder sb = strings__new_builder(6810);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<!--\n<h3>\nSign in\n</h3>\n\n<form method=\"post\" action=\"login_post\">\n<input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n<input type=\"password\" name=\"password\" placeholder=\"Password\" required>\n<input type=\"submit\" value=\"Login\">\n</form>\n-->\n\n<a href=\"https://github.com/login/oauth/authorize?response_type=code&state=%.*s\000&client_id=%.*s\000\">Login via GitHub</a>\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 17, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(csrf), vweb__filter(app->oauth_client_id), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_login = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_login); strings__Builder_free(&sb); string_free(&_tmpl_res_login);
	;
}

// Attr: [post]
// Attr: [/login]
vweb__Result main__App_handle_login(main__App* app) {
	if (app->only_gh_login) {
		return main__App_r_home(app);
	}
	string username = (*(string*)map_get(app->vweb.form, tos_lit("username"), &(string[]){ (string){.str=(byteptr)""} }));
	string password = (*(string*)map_get(app->vweb.form, tos_lit("password"), &(string[]){ (string){.str=(byteptr)""} }));
	if (string_eq(username, tos_lit("")) || string_eq(password, tos_lit(""))) {
		return vweb__Context_redirect(&app->vweb, tos_lit("/login"));
	}
	Option_main__User _t2334 = main__App_find_user_by_username(app, username);
	if (!_t2334.ok) {
		string err = _t2334.v_error;
		int errcode = _t2334.ecode;
		return vweb__Context_redirect(&app->vweb, tos_lit("/login"));
	}
	main__User user = *(main__User*)_t2334.data;
	if (user.is_blocked) {
		return vweb__Context_redirect(&app->vweb, tos_lit("/login"));
	}
	if (!main__check_password(password, username, user.password)) {
		main__App_inc_user_login_attempts(app, user.id);
		if (user.login_attempts == _const_main__max_login_attempts) {
			main__App_warn(app, _STR("User %.*s\000 got blocked", 2, user.username));
			main__App_block_user(app, user.id);
		}
		return vweb__Context_redirect(&app->vweb, tos_lit("/login"));
	}
	if (!user.is_registered) {
		return vweb__Context_redirect(&app->vweb, tos_lit("/login"));
	}
	Option_string _t2335 = main__App_client_ip(app, int_str(user.id));
	if (!_t2335.ok) {
		string err = _t2335.v_error;
		int errcode = _t2335.ecode;
		return main__App_r_home(app);
	}
	string ip = *(string*)_t2335.data;
	main__App_auth_user(app, user, ip);
	main__App_security_log(app, (main__SecurityLog){.id = 0,.user_id = user.id,.kind = main__SecurityLogKind_logged_in,.ip = (string){.str=(byteptr)""},.arg1 = (string){.str=(byteptr)""},.arg2 = (string){.str=(byteptr)""},.created_at = 0,});
	return main__App_r_home(app);
}

void main__App_auth_user(main__App* app, main__User user, string ip) {
	time__Time_add_days(time__utc(), _const_main__expire_length);
	string token = main__App_add_token(app, user.id, ip);
	main__App_update_user_login_attempts(app, user.id, 0);
	time__Time expire_date = time__Time_add_days(time__now(), 200);
	vweb__Context_set_cookie(&app->vweb, (vweb__Cookie){.name = tos_lit("id"),.value = int_str(user.id),.expires = expire_date,.secure = 0,.http_only = 0,});
	vweb__Context_set_cookie(&app->vweb, (vweb__Cookie){.name = tos_lit("token"),.value = token,.expires = expire_date,.secure = 0,.http_only = 0,});
}

bool main__App_logged_in(main__App* app) {
	Option_string _t2336 = vweb__Context_get_cookie(&app->vweb, tos_lit("id"));
	if (!_t2336.ok) {
		string err = _t2336.v_error;
		int errcode = _t2336.ecode;
		return false;
	}
	string id = *(string*)_t2336.data;
	Option_string _t2337 = vweb__Context_get_cookie(&app->vweb, tos_lit("token"));
	if (!_t2337.ok) {
		string err = _t2337.v_error;
		int errcode = _t2337.ecode;
		return false;
	}
	string token = *(string*)_t2337.data;
	Option_string _t2338 = main__App_client_ip(app, id);
	if (!_t2338.ok) {
		string err = _t2338.v_error;
		int errcode = _t2338.ecode;
		return false;
	}
	string ip = *(string*)_t2338.data;
	string t = main__App_find_user_token(app, string_int(id), ip);
	bool blocked = main__App_check_user_blocked(app, string_int(id));
	if (blocked) {
		main__App_logout(app);
		return false;
	}
	return string_ne(id, tos_lit("")) && string_ne(token, tos_lit("")) && string_ne(t, tos_lit("")) && string_eq(t, token);
}

vweb__Result main__App_logout(main__App* app) {
	vweb__Context_set_cookie(&app->vweb, (vweb__Cookie){.name = tos_lit("id"),.value = tos_lit(""),.expires = {0},.secure = 0,.http_only = 0,});
	vweb__Context_set_cookie(&app->vweb, (vweb__Cookie){.name = tos_lit("token"),.value = tos_lit(""),.expires = {0},.secure = 0,.http_only = 0,});
	return main__App_r_home(app);
}

Option_main__User main__App_get_user_from_cookies(main__App* app) {
	Option_string _t2339 = vweb__Context_get_cookie(&app->vweb, tos_lit("id"));
	if (!_t2339.ok) {
		string err = _t2339.v_error;
		int errcode = _t2339.ecode;
		Option _t2340 = opt_none();
		return *(Option_main__User*)&_t2340;
	}
	string id = *(string*)_t2339.data;
	Option_string _t2341 = vweb__Context_get_cookie(&app->vweb, tos_lit("token"));
	if (!_t2341.ok) {
		string err = _t2341.v_error;
		int errcode = _t2341.ecode;
		Option _t2342 = opt_none();
		return *(Option_main__User*)&_t2342;
	}
	string token = *(string*)_t2341.data;
	Option_main__User _t2343 = main__App_find_user_by_id(app, string_int(id));
	if (!_t2343.ok) {
		string err = _t2343.v_error;
		int errcode = _t2343.ecode;
		Option _t2344 = opt_none();
		return *(Option_main__User*)&_t2344;
	}
	main__User user = *(main__User*)_t2343.data;
	Option_string _t2345 = main__App_client_ip(app, id);
	if (!_t2345.ok) {
		string err = _t2345.v_error;
		int errcode = _t2345.ecode;
		Option _t2346 = opt_none();
		return *(Option_main__User*)&_t2346;
	}
	string ip = *(string*)_t2345.data;
	if (string_ne(token, main__App_find_user_token(app, user.id, ip))) {
		Option _t2347 = opt_none();
		return *(Option_main__User*)&_t2347;
	}
	user.b_avatar = string_ne(user.avatar, tos_lit(""));
	if (!user.b_avatar) {
		user.avatar = byte_str((*(byte*)array_get(string_bytes(user.username), 0)));
	}
	Option_main__User _t2348;
	opt_ok2(&(main__User[]) { user }, (OptionBase*)(&_t2348), sizeof(main__User));
	return _t2348;
}

// Attr: [/register]
vweb__Result main__App_register(main__App* app) {
	if (app->only_gh_login) {
		return main__App_r_home(app);
	}
	app->path = tos_lit("");
		strings__Builder sb = strings__new_builder(6840);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h3>\nRegister\n</h3>\n\n<div class=\"form-error\">\n%.*s\000\n</div>\n\n<form method=\"post\">\n<input type=\"text\" name=\"username\" placeholder=\"Username\" required>\n<input type=\"password\" name=\"password\" placeholder=\"Password\" required>\n<input type=\"email\" name=\"email\" placeholder=\"Email\" required>\n<input type=\"submit\" value=\"Register\">\n</form>\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 16, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(app->vweb.form_error), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_register = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_register); strings__Builder_free(&sb); string_free(&_tmpl_res_register);
	;
}

// Attr: [post]
// Attr: [/register]
vweb__Result main__App_handle_register(main__App* app) {
	if (app->only_gh_login) {
		return main__App_r_home(app);
	}
	string username = (*(string*)map_get(app->vweb.form, tos_lit("username"), &(string[]){ (string){.str=(byteptr)""} }));
	if ((string_eq(username, tos_lit("login")) || string_eq(username, tos_lit("register")) || string_eq(username, tos_lit("new")) || string_eq(username, tos_lit("new_post")) || string_eq(username, tos_lit("oauth")))) {
		vweb__Context_error(&app->vweb, _STR("Username `%.*s\000` is not available", 2, username));
		return main__App_register(app);
	}
	array_byte user_chars = string_bytes(username);
	if (user_chars.len > _const_main__max_username_len) {
		vweb__Context_error(&app->vweb, _STR("Username is too long (max. %"PRId32"\000)", 2, _const_main__max_username_len));
		return main__App_register(app);
	}
	if (string_contains(username, tos_lit("--"))) {
		vweb__Context_error(&app->vweb, tos_lit("Username cannot contain two hyphens"));
		return main__App_register(app);
	}
	if ((*(byte*)array_get(user_chars, 0)) == '-' || *(byte*)array_last(user_chars) == '-') {
		vweb__Context_error(&app->vweb, tos_lit("Username cannot begin or end with a hyphen"));
		return main__App_register(app);
	}
	// FOR IN array
	array _t2349 = user_chars;
	for (int _t2350 = 0; _t2350 < _t2349.len; ++_t2350) {
		byte v_char = ((byte*)_t2349.data)[_t2350];
		if (!byte_is_letter(v_char) && !byte_is_digit(v_char) && v_char != '-') {
			vweb__Context_error(&app->vweb, tos_lit("Username cannot contain special characters"));
			return main__App_register(app);
		}
	}
	if (string_eq((*(string*)map_get(app->vweb.form, tos_lit("password"), &(string[]){ (string){.str=(byteptr)""} })), tos_lit(""))) {
		vweb__Context_error(&app->vweb, tos_lit("Password cannot be empty"));
		return main__App_register(app);
	}
	string password = main__make_password((*(string*)map_get(app->vweb.form, tos_lit("password"), &(string[]){ (string){.str=(byteptr)""} })), username);
	string email = (*(string*)map_get(app->vweb.form, tos_lit("email"), &(string[]){ (string){.str=(byteptr)""} }));
	if (string_eq(username, tos_lit("")) || string_eq(email, tos_lit(""))) {
		vweb__Context_error(&app->vweb, tos_lit("Username or Email cannot be emtpy"));
		return main__App_register(app);
	}
	if (!main__App_add_user(app, username, password, new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){email})), false)) {
		vweb__Context_error(&app->vweb, tos_lit("Failed to register"));
		return main__App_register(app);
	}
	Option_main__User _t2351 = main__App_find_user_by_username(app, username);
	if (!_t2351.ok) {
		string err = _t2351.v_error;
		int errcode = _t2351.ecode;
		vweb__Context_error(&app->vweb, tos_lit("User already exists"));
		return main__App_register(app);
	}
	main__User user = *(main__User*)_t2351.data;
	println(tos_lit("register: logging in"));
	Option_string _t2352 = main__App_client_ip(app, int_str(user.id));
	if (!_t2352.ok) {
		string err = _t2352.v_error;
		int errcode = _t2352.ecode;
		vweb__Context_error(&app->vweb, tos_lit("Failed to register"));
		return main__App_register(app);
	}
	string ip = *(string*)_t2352.data;
	main__App_auth_user(app, user, ip);
	main__App_security_log(app, (main__SecurityLog){.id = 0,.user_id = user.id,.kind = main__SecurityLogKind_registered,.ip = (string){.str=(byteptr)""},.arg1 = (string){.str=(byteptr)""},.arg2 = (string){.str=(byteptr)""},.created_at = 0,});
	app->only_gh_login = true;
	return vweb__Context_redirect(&app->vweb, string_add(tos_lit("/"), username));
}

static string main__gen_uuid_v4ish() {
	string a = int_hex(rand__intn(_const_math__max_i32 / 2));
	string b = int_hex(rand__intn(_const_math__max_i16));
	string c = int_hex(rand__intn(_const_math__max_i16));
	string d = int_hex(rand__intn(_const_math__max_i16));
	string e = int_hex(rand__intn(_const_math__max_i32 / 2));
	string f = int_hex(rand__intn(_const_math__max_i16));
	return string_replace(_STR("%*.*s\000-%*.*s\000-%*.*s\000-%*.*s\000-%*.*s\000%*.*s", 6, a, 8, b, 4, c, 4, d, 4, e, 8, f, 4), tos_lit(" "), tos_lit("0"));
}

vweb__Result main__App_oauth(main__App* app) {
	string code = (*(string*)map_get(app->vweb.query, tos_lit("code"), &(string[]){ (string){.str=(byteptr)""} }));
	string state = (*(string*)map_get(app->vweb.query, tos_lit("state"), &(string[]){ (string){.str=(byteptr)""} }));
	if (string_eq(code, tos_lit(""))) {
		main__App_security_log(app, (main__SecurityLog){.id = 0,.user_id = app->user.id,.kind = main__SecurityLogKind_empty_oauth_code,.ip = (string){.str=(byteptr)""},.arg1 = (string){.str=(byteptr)""},.arg2 = (string){.str=(byteptr)""},.created_at = 0,});
		main__App_info(app, tos_lit("Code is empty"));
		return main__App_r_home(app);
	}
	Option_string _t2353 = vweb__Context_get_cookie(&app->vweb, tos_lit("csrf"));
	if (!_t2353.ok) {
		string err = _t2353.v_error;
		int errcode = _t2353.ecode;
		return main__App_r_home(app);
	}
	string csrf = *(string*)_t2353.data;
	if (string_ne(csrf, state) || string_eq(csrf, tos_lit(""))) {
		main__App_security_log(app, (main__SecurityLog){.id = 0,.user_id = app->user.id,.kind = main__SecurityLogKind_wrong_oauth_state,.ip = (string){.str=(byteptr)""},.arg1 = _STR("csrf=%.*s", 1, csrf),.arg2 = _STR("state=%.*s", 1, state),.created_at = 0,});
		return main__App_r_home(app);
	}
	main__OAuthRequest req = (main__OAuthRequest){.client_id = app->oauth_client_id,.client_secret = app->oauth_client_secret,.code = code,.state = csrf,};
	string d = json__json_print(json__encode_main__OAuthRequest(req));
	Option_net__http__Response _t2354 = net__http__post_json(tos_lit("https://github.com/login/oauth/access_token"), d);
	if (!_t2354.ok) {
		string err = _t2354.v_error;
		int errcode = _t2354.ecode;
		main__App_info(app, err);
		return main__App_r_home(app);
	}
	net__http__Response resp = *(net__http__Response*)_t2354.data;
	string token = string_find_between(resp.text, tos_lit("access_token="), tos_lit("&"));
	Option_net__http__Request _t2355 = net__http__new_request(tos_lit("get"), tos_lit("https://api.github.com/user"), tos_lit(""));
	if (!_t2355.ok) {
		string err = _t2355.v_error;
		int errcode = _t2355.ecode;
		main__App_info(app, err);
		return main__App_r_home(app);
	}
	net__http__Request request = *(net__http__Request*)_t2355.data;
	net__http__Request_add_header(&request, tos_lit("Authorization"), _STR("token %.*s", 1, token));
	Option_net__http__Response _t2356 = net__http__Request_do(&request);
	if (!_t2356.ok) {
		string err = _t2356.v_error;
		int errcode = _t2356.ecode;
		main__App_info(app, err);
		return main__App_r_home(app);
	}
	net__http__Response user_js = *(net__http__Response*)_t2356.data;
	if (user_js.status_code != 200) {
		main__App_info(app, int_str(user_js.status_code));
		main__App_info(app, user_js.text);
		return vweb__Context_text(&app->vweb, _STR("Received %"PRId32"\000 error while attempting to contact GitHub", 2, user_js.status_code));
	}
// json.decode
		Option_main__GitHubUser _t2357 = json__decode_main__GitHubUser(json__json_parse(user_js.text));
	if (!_t2357.ok) {
		string err = _t2357.v_error;
		int errcode = _t2357.ecode;
		return main__App_r_home(app);
	}
	main__GitHubUser gh_user = *(main__GitHubUser*)_t2357.data;
	println(tos_lit("gh user:"));
	println(user_js.text);
	println(main__GitHubUser_str(gh_user));
	if (string_trim_space(gh_user.email).len == 0) {
		main__App_security_log(app, (main__SecurityLog){.id = 0,.user_id = app->user.id,.kind = main__SecurityLogKind_empty_oauth_email,.ip = (string){.str=(byteptr)""},.arg1 = user_js.text,.arg2 = (string){.str=(byteptr)""},.created_at = 0,});
		main__App_info(app, tos_lit("Email is empty"));
		return main__App_r_home(app);
	}
	Option_main__User _t2358 = main__App_find_user_by_email(app, gh_user.email);
	if (!_t2358.ok) {
		string err = _t2358.v_error;
		int errcode = _t2358.ecode;
		*(main__User*) _t2358.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
	}
	main__User user = *(main__User*)_t2358.data;
	if (!user.is_github) {
		main__App_security_log(app, (main__SecurityLog){.id = 0,.user_id = user.id,.kind = main__SecurityLogKind_registered_via_github,.ip = (string){.str=(byteptr)""},.arg1 = user_js.text,.arg2 = (string){.str=(byteptr)""},.created_at = 0,});
		main__App_add_user(app, gh_user.username, tos_lit(""), new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){gh_user.email})), true);
		Option_main__User _t2359 = main__App_find_user_by_email(app, gh_user.email);
		if (!_t2359.ok) {
			string err = _t2359.v_error;
			int errcode = _t2359.ecode;
			return main__App_r_home(app);
		}
		user = *(main__User*)_t2359.data;
		main__App_update_user_avatar(app, gh_user.avatar, user.id);
	}
	Option_string _t2360 = main__App_client_ip(app, int_str(user.id));
	if (!_t2360.ok) {
		string err = _t2360.v_error;
		int errcode = _t2360.ecode;
		println(tos_lit("Can not fetch ip"));
		return main__App_r_home(app);
	}
	string ip = *(string*)_t2360.data;
	main__App_auth_user(app, user, ip);
	main__App_security_log(app, (main__SecurityLog){.id = 0,.user_id = user.id,.kind = main__SecurityLogKind_logged_in_via_github,.ip = (string){.str=(byteptr)""},.arg1 = user_js.text,.arg2 = (string){.str=(byteptr)""},.created_at = 0,});
	return main__App_r_home(app);
}

static void main__App_get_oauth_tokens_from_db(main__App* app) {

	// sql select
	sqlite__DB _t2362 = app->db;
	sqlite3_stmt* _t2361 = sqlite__DB_init_stmt(_t2362, tos_lit("SELECT `id`, `oauth_client_id`, `oauth_client_secret`, `only_gh_login` FROM `GitlySettings` ORDER BY id  LIMIT ?1"));
	sqlite3_bind_int(_t2361, 1, 1);

	int _t2363 = sqlite3_extended_errcode(_t2362.conn);
	if (_t2363 != SQLITE_OK) { puts(sqlite3_errmsg(_t2362.conn)); }
	main__GitlySettings _t2364 = (main__GitlySettings){
	.id = 0, .oauth_client_id = (string){.str=(byteptr)""}, .oauth_client_secret = (string){.str=(byteptr)""}, .only_gh_login = true};
	int _step_res_t2364 = sqlite3_step(_t2361);
		if (_step_res_t2364 == SQLITE_OK || _step_res_t2364 == SQLITE_ROW) {
	_t2364.id = sqlite3_column_int(_t2361, 0);
	_t2364.oauth_client_id = tos_clone(sqlite3_column_text(_t2361, 1));
	_t2364.oauth_client_secret = tos_clone(sqlite3_column_text(_t2361, 2));
	_t2364.only_gh_login = sqlite3_column_int(_t2361, 3);
	}
	sqlite3_finalize(_t2361);
		main__GitlySettings data =  _t2364; 
	;
	app->oauth_client_id = data.oauth_client_id;
	app->oauth_client_secret = data.oauth_client_secret;
	app->only_gh_login = data.only_gh_login;
}

void main__App_insert_release(main__App* app, main__Release release) {
	
	// sql insert
	sqlite__DB _t2365 = app->db;
	sqlite3_stmt* _t2366 = sqlite__DB_init_stmt(_t2365, tos_lit("INSERT INTO `Release` (`repo_id`, `tag_id`, `notes`) values (?1, ?2, ?3)"));
	sqlite3_bind_int(_t2366, 1, release.repo_id); // stmt
	sqlite3_bind_int(_t2366, 2, release.tag_id); // stmt
	sqlite3_bind_text(_t2366, 3, release.notes.str, release.notes.len, 0);
	
		int _t2367 = sqlite3_step(_t2366);
		if( (_t2367 != SQLITE_OK) && (_t2367 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2365.conn)); }
		sqlite3_finalize(_t2366);
}

array_main__Release main__App_find_repo_releases(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2369 = app->db;
	sqlite3_stmt* _t2368 = sqlite__DB_init_stmt(_t2369, tos_lit("SELECT `id`, `repo_id`, `tag_id`, `notes` FROM `Release` WHERE repo_id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2368, 1, repo_id);

	int _t2370 = sqlite3_extended_errcode(_t2369.conn);
	if (_t2370 != SQLITE_OK) { puts(sqlite3_errmsg(_t2369.conn)); }
	array_main__Release _t2371_array = __new_array(0, 10, sizeof(main__Release));
	while (1) {
		main__Release _t2371 = (main__Release) {
	.id = 0, .repo_id = 0, .tag_id = 0, .notes = (string){.str=(byteptr)""}, .tag_name = (string){.str=(byteptr)""}, .tag_hash = (string){.str=(byteptr)""}, .user = (string){.str=(byteptr)""}, .date = {0}};
	int _step_res_t2371 = sqlite3_step(_t2368);
		if (_step_res_t2371 == SQLITE_DONE) break;
		if (_step_res_t2371 == SQLITE_ROW) ;
		else if (_step_res_t2371 != SQLITE_OK) break;
	_t2371.id = sqlite3_column_int(_t2368, 0);
	_t2371.repo_id = sqlite3_column_int(_t2368, 1);
	_t2371.tag_id = sqlite3_column_int(_t2368, 2);
	_t2371.notes = tos_clone(sqlite3_column_text(_t2368, 3));
		 array_push(&_t2371_array, _MOV((main__Release[]){ _t2371 }));
	}
	sqlite3_finalize(_t2368);
		return  _t2371_array; 
	;
}

void main__App_delete_repo_releases(main__App* app, int repo_id) {
	
	// sql insert
	sqlite__DB _t2372 = app->db;
	sqlite3_stmt* _t2373 = sqlite__DB_init_stmt(_t2372, tos_lit("DELETE FROM `Release`  WHERE repo_id = ?1"));
	sqlite3_bind_int(_t2373, 1, repo_id);

		int _t2374 = sqlite3_step(_t2373);
		if( (_t2374 != SQLITE_OK) && (_t2374 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2372.conn)); }
		sqlite3_finalize(_t2373);
}

static void main__App_update_repo(main__App* app) {
	main__Repo r = app->repo;
	sync__WaitGroup* wg = sync__new_waitgroup();
	sync__WaitGroup_add(wg, 1);
	// go
	thread_arg_main__Repo_analyse_lang *arg__t2375 = malloc(sizeof(thread_arg_main__Repo_analyse_lang));
	arg__t2375->arg0 = r;
	arg__t2375->arg1 = wg;
	arg__t2375->arg2 = app;
	pthread_t thread__t2375;
	pthread_create(&thread__t2375, NULL, (void*)main__Repo_analyse_lang_thread_wrapper, arg__t2375);
	// endgo

	string data = main__Repo_git(&r, _STR("--no-pager log --abbrev-commit --abbrev=7 --pretty=\"%%h%.*s\000%%aE%.*s\000%%cD%.*s\000%%s%.*s\000%%aN\"", 5, _const_main__log_field_separator, _const_main__log_field_separator, _const_main__log_field_separator, _const_main__log_field_separator));
	main__Commit tmp_commit = (main__Commit){.id = 0,.author_id = 0,.author = (string){.str=(byteptr)""},.hash = (string){.str=(byteptr)""},.created_at = 0,.repo_id = 0,.message = (string){.str=(byteptr)""},};
	sqlite__DB_exec(app->db, tos_lit("BEGIN TRANSACTION"));
	// FOR IN array
	array _t2376 = string_split_into_lines(data);
	for (int _t2377 = 0; _t2377 < _t2376.len; ++_t2377) {
		string line = ((string*)_t2376.data)[_t2377];
		array_string args = string_split(line, _const_main__log_field_separator);
		if (args.len > 3) {
			tmp_commit.repo_id = r.id;
			tmp_commit.hash = (*(string*)array_get(args, 0));
			tmp_commit.author = (*(string*)array_get(args, 4));
			Option_time__Time _t2378 = time__parse_rfc2822((*(string*)array_get(args, 2)));
			if (!_t2378.ok) {
				string err = _t2378.v_error;
				int errcode = _t2378.ecode;
				main__App_info(app, _STR("Error: %.*s", 1, err));
				return;
			}
			time__Time t = *(time__Time*)_t2378.data;
			tmp_commit.created_at = ((int)(t.v_unix));
			tmp_commit.message = (*(string*)array_get(args, 3));
			Option_main__User _t2379 = main__App_find_user_by_email(app, (*(string*)array_get(args, 1)));
			if (!_t2379.ok) {
				string err = _t2379.v_error;
				int errcode = _t2379.ecode;
				*(main__User*) _t2379.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
			}
			main__User user = *(main__User*)_t2379.data;
			if (string_ne(user.username, tos_lit(""))) {
				main__App_insert_contributor(app, (main__Contributor){.id = 0,.user = user.id,.repo = r.id,});
				tmp_commit.author_id = user.id;
			} else {
				int empty_user = main__App_create_empty_user(app, tmp_commit.author, (*(string*)array_get(args, 1)));
				main__App_insert_contributor(app, (main__Contributor){.id = 0,.user = empty_user,.repo = r.id,});
			}
			main__App_insert_commit(app, tmp_commit);
		}
	}
	main__App_info(app, int_str(r.nr_contributors));
	main__App_fetch_branches(app, r);
	r.nr_commits = main__App_nr_repo_commits(app, r.id);
	r.nr_contributors = main__App_nr_repo_contributor(app, r.id);
	r.nr_branches = main__App_nr_repo_branches(app, r.id);
	main__App_update_repo_nr_commits(app, r.id, r.nr_commits);
	main__App_update_repo_nr_contributor(app, r.id, r.nr_contributors);
	// FOR IN array
	array _t2380 = main__App_find_repo_tags(app, r.id);
	for (int _t2381 = 0; _t2381 < _t2380.len; ++_t2381) {
		main__Tag tag = ((main__Tag*)_t2380.data)[_t2381];
		main__Release* release = (main__Release*)memdup(&(main__Release){.id = 0,.repo_id = r.id,.tag_id = tag.id,.notes = tos_lit("Some notes about this release..."),.tag_name = (string){.str=(byteptr)""},.tag_hash = (string){.str=(byteptr)""},.user = (string){.str=(byteptr)""},.date = {0},}, sizeof(main__Release));
		main__App_insert_release(app, *release);
		r.nr_releases++;
	}
	sync__WaitGroup_wait(wg);
	main__App_update_repo_in_db(app, (voidptr)&/*qq*/r);
	sqlite__DB_exec(app->db, tos_lit("END TRANSACTION"));
	main__App_info(app, tos_lit("Repo updated"));
}

static void main__App_update_repo_data(main__App* app, main__Repo repo) {
	main__Repo r = repo;
	main__Commit last_commit = main__App_find_repo_last_commit(app, r.id);
	main__Repo_git(&r, tos_lit("fetch --all"));
	main__Repo_git(&r, tos_lit("pull --all"));
	sync__WaitGroup* wg = sync__new_waitgroup();
	sync__WaitGroup_add(wg, 1);
	// go
	thread_arg_main__Repo_analyse_lang *arg__t2382 = malloc(sizeof(thread_arg_main__Repo_analyse_lang));
	arg__t2382->arg0 = r;
	arg__t2382->arg1 = wg;
	arg__t2382->arg2 = app;
	pthread_t thread__t2382;
	pthread_create(&thread__t2382, NULL, (void*)main__Repo_analyse_lang_thread_wrapper, arg__t2382);
	// endgo

	string data = main__Repo_git(&r, _STR("--no-pager log %.*s\000.. --abbrev-commit --abbrev=7 --pretty=\"%%h%.*s\000%%aE%.*s\000%%cD%.*s\000%%s%.*s\000%%aN\"", 6, last_commit.hash, _const_main__log_field_separator, _const_main__log_field_separator, _const_main__log_field_separator, _const_main__log_field_separator));
	main__Commit tmp_commit = (main__Commit){.id = 0,.author_id = 0,.author = (string){.str=(byteptr)""},.hash = (string){.str=(byteptr)""},.created_at = 0,.repo_id = 0,.message = (string){.str=(byteptr)""},};
	sqlite__DB_exec(app->db, tos_lit("BEGIN TRANSACTION"));
	// FOR IN array
	array _t2383 = string_split_into_lines(data);
	for (int _t2384 = 0; _t2384 < _t2383.len; ++_t2384) {
		string line = ((string*)_t2383.data)[_t2384];
		array_string args = string_split(line, _const_main__log_field_separator);
		if (args.len > 3) {
			tmp_commit.repo_id = r.id;
			tmp_commit.hash = (*(string*)array_get(args, 0));
			tmp_commit.author = (*(string*)array_get(args, 4));
			Option_time__Time _t2385 = time__parse_rfc2822((*(string*)array_get(args, 2)));
			if (!_t2385.ok) {
				string err = _t2385.v_error;
				int errcode = _t2385.ecode;
				main__App_info(app, _STR("Error: %.*s", 1, err));
				return;
			}
			time__Time t = *(time__Time*)_t2385.data;
			tmp_commit.created_at = ((int)(t.v_unix));
			tmp_commit.message = (*(string*)array_get(args, 3));
			Option_main__User _t2386 = main__App_find_user_by_email(app, (*(string*)array_get(args, 1)));
			if (!_t2386.ok) {
				string err = _t2386.v_error;
				int errcode = _t2386.ecode;
				*(main__User*) _t2386.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
			}
			main__User user = *(main__User*)_t2386.data;
			if (string_ne(user.username, tos_lit(""))) {
				main__App_insert_contributor(app, (main__Contributor){.id = 0,.user = user.id,.repo = r.id,});
				tmp_commit.author_id = user.id;
			} else {
				int empty_user = main__App_create_empty_user(app, tmp_commit.author, (*(string*)array_get(args, 1)));
				main__App_insert_contributor(app, (main__Contributor){.id = 0,.user = empty_user,.repo = r.id,});
			}
			main__App_insert_commit(app, tmp_commit);
		}
	}
	r.nr_commits = main__App_nr_repo_commits(app, r.id);
	r.nr_contributors = main__App_nr_repo_contributor(app, r.id);
	r.nr_branches = main__App_nr_repo_branches(app, r.id);
	main__App_update_repo_nr_commits(app, r.id, r.nr_commits);
	main__App_update_repo_nr_contributor(app, r.id, r.nr_contributors);
	main__App_update_branches(app, (voidptr)&/*qq*/r);
	main__App_update_repo_in_db(app, (voidptr)&/*qq*/r);
	sync__WaitGroup_wait(wg);
	sqlite__DB_exec(app->db, tos_lit("END TRANSACTION"));
	main__App_info(app, tos_lit("Repo updated"));
}

static void main__Repo_analyse_lang(main__Repo r, sync__WaitGroup* wg, main__App* app) {
	array_string files = main__Repo_get_all_files(r, r.git_dir);
	int all_size = 0;
	map_string_int lang_stats = new_map_1(sizeof(int));
	map_string_hl__Lang langs = new_map_1(sizeof(hl__Lang));
	// FOR IN array
	array _t2387 = files;
	for (int _t2388 = 0; _t2388 < _t2387.len; ++_t2388) {
		string file = ((string*)_t2387.data)[_t2388];
		Option_hl__Lang _t2389 = hl__extension_to_lang(*(string*)array_last(string_split(file, tos_lit("."))));
		if (!_t2389.ok) {
			string err = _t2389.v_error;
			int errcode = _t2389.ecode;
			continue;
		}
		hl__Lang lang = *(hl__Lang*)_t2389.data;
		Option_string _t2390 = os__read_file(file);
		if (!_t2390.ok) {
			string err = _t2390.v_error;
			int errcode = _t2390.ecode;
			*(string*) _t2390.data = tos_lit("");
		}
		string f_text = *(string*)_t2390.data;
		array_string lines = string_split_into_lines(f_text);
		int size = main__calc_lines_of_code(lines, lang);
		if (!_IN_MAP(lang.name, lang_stats)) {
			map_set(&lang_stats, lang.name, &(int[]) { 0 });
		}
		if (!_IN_MAP(lang.name, langs)) {
			map_set(&langs, lang.name, &(hl__Lang[]) { lang });
		}
		map_set(&lang_stats, lang.name, &(int[]) { (*(int*)map_get(lang_stats, lang.name, &(int[]){ 0 })) + size });
		all_size += size;
	}
	array_main__LangStat d_lang_stats = __new_array_with_default(0, 0, sizeof(main__LangStat), 0);
	array_int tmp_a = __new_array_with_default(0, 0, sizeof(int), 0);
	// FOR IN map
	map_string_int _t2393 = lang_stats;
	array_string keys__t2391 = map_keys(&_t2393);
	for (int _t2392 = 0; _t2392 < keys__t2391.len; ++_t2392) {
		string lang = /*kkkk*/ string_clone( ((string*)keys__t2391.data)[_t2392] );
		int amount = /*vvv*/ (*(int*)map_get(_t2393, lang, &(int[]){ 0 }));
		f32 tmp = ((f32)(amount)) / ((f32)(all_size));
		tmp *= 1000;
		int pct = ((int)(tmp));
		if (!_IN(int, pct, tmp_a)) {
			array_push(&tmp_a, _MOV((int[]){ pct }));
		}
		hl__Lang lang_data = (*(hl__Lang*)map_get(langs, lang, &(hl__Lang[]){ {0} }));
		array_push(&d_lang_stats, _MOV((main__LangStat[]){ (main__LangStat){
			.id = 0,
			.repo_id = r.id,
			.name = lang_data.name,
			.nr_lines = amount,
			.pct = pct,
			.color = lang_data.color,
		} }));
	}
	/*for in map cleanup*/
	for (int _t2392 = 0; _t2392 < keys__t2391.len; ++_t2392) { string_free(&((string*)keys__t2391.data)[_t2392]); }
	array_free(&keys__t2391);
	array_int_sort(&tmp_a);
	tmp_a = array_reverse(tmp_a);
	array_main__LangStat tmp_stats = __new_array_with_default(0, 0, sizeof(main__LangStat), 0);
	// FOR IN array
	array _t2396 = tmp_a;
	for (int _t2397 = 0; _t2397 < _t2396.len; ++_t2397) {
		int pct = ((int*)_t2396.data)[_t2397];

int _t2398_len = r.lang_stats.len;
		array_main__LangStat _t2398 = __new_array(0, _t2398_len, sizeof(main__LangStat));
		for (int i = 0; i < _t2398_len; ++i) {
		  main__LangStat it = ((main__LangStat*) r.lang_stats.data)[i];
		if (it.pct == pct) array_push(&_t2398, &it); 
 }
				array_main__LangStat all_with_ptc =  _t2398;
		// FOR IN array
		array _t2399 = all_with_ptc;
		for (int _t2400 = 0; _t2400 < _t2399.len; ++_t2400) {
			main__LangStat lang = ((main__LangStat*)_t2399.data)[_t2400];
			array_push(&tmp_stats, _MOV((main__LangStat[]){ lang }));
		}
	}
	// FOR IN array
	array _t2402 = d_lang_stats;
	for (int _t2403 = 0; _t2403 < _t2402.len; ++_t2403) {
		main__LangStat lang_stat = ((main__LangStat*)_t2402.data)[_t2403];
		
	// sql insert
		sqlite__DB _t2404 = app->db;
		sqlite3_stmt* _t2405 = sqlite__DB_init_stmt(_t2404, tos_lit("INSERT INTO `LangStat` (`repo_id`, `name`, `nr_lines`, `pct`, `color`) values (?1, ?2, ?3, ?4, ?5)"));
		sqlite3_bind_int(_t2405, 1, lang_stat.repo_id); // stmt
		sqlite3_bind_text(_t2405, 2, lang_stat.name.str, lang_stat.name.len, 0);
		sqlite3_bind_int(_t2405, 3, lang_stat.nr_lines); // stmt
		sqlite3_bind_int(_t2405, 4, lang_stat.pct); // stmt
		sqlite3_bind_text(_t2405, 5, lang_stat.color.str, lang_stat.color.len, 0);
		
			int _t2406 = sqlite3_step(_t2405);
			if( (_t2406 != SQLITE_OK) && (_t2406 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2404.conn)); }
			sqlite3_finalize(_t2405);
	}
	sync__WaitGroup_done(wg);
}

static int main__calc_lines_of_code(array_string lines, hl__Lang lang) {
	int size = 0;
	string lcomment = lang.line_comments;
	string mlcomment_start = tos_lit("");
	string mlcomment_end = tos_lit("");
	if (lang.mline_comments.len >= 2) {
		mlcomment_start = (*(string*)array_get(lang.mline_comments, 0));
		mlcomment_end = (*(string*)array_get(lang.mline_comments, 1));
	}
	bool in_comment = false;
	// FOR IN array
	array _t2407 = lines;
	for (int _t2408 = 0; _t2408 < _t2407.len; ++_t2408) {
		string line = ((string*)_t2407.data)[_t2408];
		string tmp_line = string_trim_space(line);
		if (tmp_line.len > 0) {
			if (string_contains(tmp_line, mlcomment_start)) {
				in_comment = true;
				if (string_starts_with(tmp_line, mlcomment_start)) {
					continue;
				}
			}
			if (string_contains(tmp_line, mlcomment_end)) {
				if (in_comment) {
					in_comment = false;
				}
				if (string_ends_with(tmp_line, mlcomment_end)) {
					continue;
				}
			}
			if (in_comment) {
				continue;
			}
			if (string_contains(tmp_line, lcomment)) {
				if (string_starts_with(tmp_line, lcomment)) {
					continue;
				}
			}
			size++;
		}
	}
	return size;
}

static array_string main__Repo_get_all_files(main__Repo r, string path) {
	Option_array_string _t2409 = os__ls(path);
	if (!_t2409.ok) {
		string err = _t2409.v_error;
		int errcode = _t2409.ecode;
		return __new_array_with_default(0, 0, sizeof(string), 0);
	}
	array_string files = *(array_string*)_t2409.data;
	array_string returnval = __new_array_with_default(0, 0, sizeof(string), 0);
	// FOR IN array
	array _t2410 = files;
	for (int _t2411 = 0; _t2411 < _t2410.len; ++_t2411) {
		string file = ((string*)_t2410.data)[_t2411];
		if (!os__is_dir(_STR("%.*s\000/%.*s", 2, path, file))) {
			array_push(&returnval, _MOV((string[]){ _STR("%.*s\000/%.*s", 2, path, file) }));
		} else {
			if (_IN(string, file, _const_main__ignored_folder)) {
				continue;
			}
			_PUSH_MANY(&returnval, (main__Repo_get_all_files(r, _STR("%.*s\000/%.*s", 2, path, file))), _t2413, array_string);
		}
	}
	return returnval;
}

static vweb__RawHtml main__Repo_nr_commits_fmt(main__Repo* r) {
	int nr = r->nr_commits;
	if (nr == 1) {
		return tos_lit("<b>1</b> commit");
	}
	return _STR("<b>%"PRId32"\000</b> commits", 2, nr);
}

static vweb__RawHtml main__Repo_nr_branches_fmt(main__Repo* r) {
	int nr = r->nr_branches;
	if (nr == 1) {
		return tos_lit("<b>1</b> branch");
	}
	return _STR("<b>%"PRId32"\000</b> branches", 2, nr);
}

static vweb__RawHtml main__Repo_nr_open_prs_fmt(main__Repo* r) {
	int nr = r->nr_open_prs;
	if (nr == 1) {
		return tos_lit("<b>1</b> pull request");
	}
	return _STR("<b>%"PRId32"\000</b> pull requests", 2, nr);
}

static vweb__RawHtml main__Repo_nr_open_issues_fmt(main__Repo* r) {
	int nr = r->nr_open_issues;
	if (nr == 1) {
		return tos_lit("<b>1</b> issue");
	}
	return _STR("<b>%"PRId32"\000</b> issues", 2, nr);
}

static vweb__RawHtml main__Repo_nr_contributors_fmt(main__Repo* r) {
	int nr = r->nr_contributors;
	if (nr == 1) {
		return tos_lit("<b>1</b> contributor");
	}
	return _STR("<b>%"PRId32"\000</b> contributors", 2, nr);
}

static vweb__RawHtml main__Repo_nr_topics_fmt(main__Repo* r) {
	int nr = r->nr_topics;
	if (nr == 1) {
		return tos_lit("<b>1</b> discussion");
	}
	return _STR("<b>%"PRId32"\000</b> discussions", 2, nr);
}

static vweb__RawHtml main__Repo_nr_releases_fmt(main__Repo* r) {
	int nr = r->nr_releases;
	if (nr == 1) {
		return tos_lit("<b>1</b> release");
	}
	return _STR("<b>%"PRId32"\000</b> releases", 2, nr);
}

static string main__Repo_git(main__Repo* r, string cmd_) {
	string cmd = cmd_;
	if (string_contains(cmd, tos_lit("&")) || string_contains(cmd, tos_lit(";"))) {
		return tos_lit("");
	}
	if (!string_starts_with(cmd, tos_lit("init"))) {
		cmd = _STR("-C %.*s\000 %.*s", 2, r->git_dir, cmd);
	}
	Option_os__Result _t2414 = os__exec(_STR("git %.*s", 1, cmd));
	if (!_t2414.ok) {
		string err = _t2414.v_error;
		int errcode = _t2414.ecode;
		println(_STR("git error %.*s\000 out=x.output", 2, cmd));
		return tos_lit("");
	}
	os__Result x = *(os__Result*)_t2414.data;
	string res = string_trim_space(x.output);
	if (res.len > _const_main__max_git_res_size) {
		println(_STR("Huge git() output: %"PRId32"\000 KB %.*s", 2, res.len, cmd));
	}
	return res;
}

static Option_main__File main__Repo_parse_ls(main__Repo* r, string ls, string branch) {
	array_string words = string_fields(ls);
	if (words.len < 4) {
		Option _t2415 = opt_none();
		return *(Option_main__File*)&_t2415;
	}
	string typ = (*(string*)array_get(words, 1));
	string parent_path = os__base_dir((*(string*)array_get(words, 3)));
	string hash = main__Repo_git(r, _STR("log -n 1 --format=\"%%h\" %.*s", 1, (*(string*)array_get(words, 3))));
	println(hash);
	string name = string_after((*(string*)array_get(words, 3)), tos_lit("/"));
	if (string_eq(name, tos_lit(""))) {
		Option _t2416 = opt_none();
		return *(Option_main__File*)&_t2416;
	}
	if (string_eq(parent_path, name)) {
		parent_path = tos_lit("");
	}
	if (string_contains(name, tos_lit("\"\\"))) {
	}
	Option_main__File _t2417;
	opt_ok2(&(main__File[]) { (main__File){
		.id = 0,
		.repo_id = r->id,
		.name = name,
		.parent_path = parent_path,
		.is_dir = string_eq(typ, tos_lit("tree")),
		.branch = branch,
		.nr_contributors = 0,
		.last_hash = hash,
		.size = 0,
		.nr_views = 0,
		.last_msg = (string){.str=(byteptr)""},
		.last_time = 0,
		.commit = {0},
	} }, (OptionBase*)(&_t2417), sizeof(main__File));
	return _t2417;
}

static array_main__File main__App_cache_repo_files(main__App* app, main__Repo* r, string branch, string path) {
	main__App_info(app, _STR("Repo.cache_files(%.*s\000 branch=%.*s\000 path=%.*s\000)", 4, r->name, branch, path));
	main__App_info(app, _STR("path.len=%"PRId32"", 1, path.len));
	if (r->status == main__RepoStatus_caching) {
		main__App_info(app, _STR("repo `%.*s\000` is being cached already", 2, r->name));
		return __new_array_with_default(0, 0, sizeof(main__File), 0);
	}
	string res = tos_lit("");
	if (string_eq(path, tos_lit("."))) {
		r->status = main__RepoStatus_caching;
	} else {
		string p = path;
		if (string_ne(path, tos_lit(""))) {
			p = /*f*/string_add(p, tos_lit("/"));
		}
		res = main__Repo_git(r, _STR("ls-tree --full-name %.*s\000 %.*s", 2, branch, p));
	}
	array_string lines = string_split(res, tos_lit("\n"));
	array_main__File dirs = __new_array_with_default(0, 0, sizeof(main__File), 0);
	array_main__File files = __new_array_with_default(0, 0, sizeof(main__File), 0);
	sqlite__DB_exec(app->db, tos_lit("BEGIN TRANSACTION"));
	// FOR IN array
	array _t2418 = lines;
	for (int _t2419 = 0; _t2419 < _t2418.len; ++_t2419) {
		string line = ((string*)_t2418.data)[_t2419];
		Option_main__File _t2420 = main__Repo_parse_ls(r, line, branch);
		if (!_t2420.ok) {
			string err = _t2420.v_error;
			int errcode = _t2420.ecode;
			main__App_warn(app, _STR("failed to parse %.*s", 1, line));
			continue;
		}
		main__File file = *(main__File*)_t2420.data;
		if (file.is_dir) {
			array_push(&dirs, _MOV((main__File[]){ file }));
			main__App_insert_file(app, file);
		} else {
			array_push(&files, _MOV((main__File[]){ file }));
		}
	}
	_PUSH_MANY(&dirs, (files), _t2423, array_main__File);
	// FOR IN array
	array _t2424 = files;
	for (int _t2425 = 0; _t2425 < _t2424.len; ++_t2425) {
		main__File file = ((main__File*)_t2424.data)[_t2425];
		main__App_insert_file(app, file);
	}
	sqlite__DB_exec(app->db, tos_lit("END TRANSACTION"));
	// Defer begin
	r->status = main__RepoStatus_done;
	// Defer end
	return dirs;
}

static vweb__RawHtml main__Repo_html_path_to(main__Repo* r, string path, string branch) {
	array_string vals = string_split(string_trim_right(string_trim_space(path), tos_lit("/")), tos_lit("/"));
	string res = tos_lit("");
	string growp = tos_lit("");
	// FOR IN array
	array _t2426 = vals;
	for (int i = 0; i < _t2426.len; ++i) {
		string val = ((string*)_t2426.data)[i];
		if (string_eq(val, tos_lit(""))) {
			continue;
		}
		if (i == vals.len - 1) {
			res = /*f*/string_add(res, val);
		} else {
			if (string_ne(val, tos_lit(""))) {
				growp = /*f*/string_add(growp, string_add(tos_lit("/"), val));
			}
			res = /*f*/string_add(res, _STR("<a href=\"/tree%.*s\000/\">%.*s\000</a> / ", 3, growp, val));
		}
	}
	if (string_ne(res, tos_lit(""))) {
		res = string_add(tos_lit("/ "), res);
	}
	return res;
}

static void main__App_slow_fetch_files_info(main__App* app, string branch, string path) {
	array_main__File files = main__App_find_repo_files(app, app->repo.id, branch, path);
	for (int i = 0; i < files.len; ++i) {
		if (string_ne((*(main__File*)array_get(files, i)).last_msg, tos_lit(""))) {
			main__App_warn(app, _STR("skipping %.*s", 1, (*(main__File*)array_get(files, i)).name));
			continue;
		}
		main__App_fetch_file_info(app, (voidptr)&/*qq*/app->repo, (voidptr)&/*qq*/(*(main__File*)array_get(files, i)));
	}
}

static string main__Repo_git_advertise(main__Repo r, string a) {
	Option_os__Result _t2427 = os__exec(_STR("git %.*s\000 --stateless-rpc --advertise-refs %.*s", 2, a, r.git_dir));
	if (!_t2427.ok) {
		string err = _t2427.v_error;
		int errcode = _t2427.ecode;
		return tos_lit("");
	}
	os__Result cmd = *(os__Result*)_t2427.data;
	if (cmd.exit_code != 0) {
	}
	return cmd.output;
}

static string main__first_line(string s) {
	Option_int _t2428 = string_index(s, tos_lit("\n"));
	if (!_t2428.ok) {
		string err = _t2428.v_error;
		int errcode = _t2428.ecode;
		return s;
	}
	int pos = *(int*)_t2428.data;
	return string_substr(s, 0, pos);
}

static void main__App_fetch_file_info(main__App* app, main__Repo* r, main__File* file) {
	string logs = main__Repo_git(r, _STR("log -n1 --format=%%B___%%at___%%H___%%an %.*s\000 -- %.*s", 2, file->branch, main__File_full_path(file)));
	array_string vals = string_split(logs, tos_lit("___"));
	if (vals.len < 3) {
		return;
	}
	string last_msg = main__first_line((*(string*)array_get(vals, 0)));
	int last_time = string_int((*(string*)array_get(vals, 1)));
	{string _ = (*(string*)array_get(vals, 2));}
	;
	{string _ = (*(string*)array_get(vals, 3));}
	;
	int file_id = file->id;
	
	// sql insert
	sqlite__DB _t2429 = app->db;
	sqlite3_stmt* _t2430 = sqlite__DB_init_stmt(_t2429, tos_lit("UPDATE `File` SET  last_msg = ?1,  last_time = ?2 WHERE id = ?3"));
	sqlite3_bind_text(_t2430, 1, last_msg.str, last_msg.len, 0);
sqlite3_bind_int(_t2430, 2, last_time);
sqlite3_bind_int(_t2430, 3, file_id);

		int _t2431 = sqlite3_step(_t2430);
		if( (_t2431 != SQLITE_OK) && (_t2431 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2429.conn)); }
		sqlite3_finalize(_t2430);
}

static void main__Repo_clone(main__Repo* r) {
	if (!string_starts_with(r->clone_url, tos_lit("https://")) || string_contains(r->clone_url, tos_lit(" "))) {
		return;
	}
	println(_STR("starting git clone... %.*s\000 git_dir=%.*s", 2, r->clone_url, r->git_dir));
	Option_os__Result _t2432 = os__exec(_STR("git clone \"%.*s\000\" %.*s", 2, r->clone_url, r->git_dir));
	if (!_t2432.ok) {
		string err = _t2432.v_error;
		int errcode = _t2432.ecode;
		r->status = main__RepoStatus_clone_failed;
		println(tos_lit("git clone failed:"));
		return;
	};
	main__Repo_git(r, tos_lit("config receive.denyCurrentBranch ignore"));
	main__Repo_git(r, tos_lit("config core.bare false"));
	main__Repo_git(r, tos_lit("checkout master"));
	r->status = main__RepoStatus_clone_done;
}

static void main__App_create_table(main__App* app, string name, array_string fields) {
	sqlite__DB_exec(app->db, string_add(string_add(_STR("create table if not exists `%.*s\000` (", 2, name), array_string_join(fields, tos_lit(","))), tos_lit(")")));
}

static void main__App_create_tables(main__App* app) {
	main__App_create_table(app, tos_lit("Repo"), new_array_from_c_array(17, 17, sizeof(string), _MOV((string[17]){
			tos_lit("id integer primary key"), tos_lit("git_dir text default ''"), tos_lit("name text default ''"), tos_lit("description text default ''"), tos_lit("user_id int default 0"), tos_lit("user_name text default ''"), tos_lit("primary_branch text default \"\""), tos_lit("nr_views int default 0"), tos_lit("nr_commits int default 0"), tos_lit("nr_open_issues int default 0"), tos_lit("nr_tags int default 0"), tos_lit("nr_releases int default 0"), tos_lit("nr_open_prs int default 0"), tos_lit("webhook_secret text default \"\""), tos_lit("nr_branches int default 0"), tos_lit("nr_contributors int default 0"), tos_lit("created_at int default (strftime('%s', 'now'))")})));
	main__App_create_table(app, tos_lit("File"), new_array_from_c_array(13, 13, sizeof(string), _MOV((string[13]){
			tos_lit("id integer primary key"), tos_lit("name text default ''"), tos_lit("repo_id int default 0"), tos_lit("parent_path text default ''"), tos_lit("branch text default ''"), tos_lit("is_dir int default 0"), tos_lit("last_hash text default ''"), tos_lit("last_msg text default ''"), tos_lit("last_time int default 0"), tos_lit("size int default 0"), tos_lit("nr_contributors int default 0"), tos_lit("nr_views int default 0"), tos_lit("UNIQUE(parent_path, name, repo_id, branch) ON CONFLICT REPLACE")})));
	main__App_create_table(app, tos_lit("Issue"), new_array_from_c_array(8, 8, sizeof(string), _MOV((string[8]){tos_lit("id integer primary key"), tos_lit("author_id int default 0"), tos_lit("is_pr int default 0"), tos_lit("repo_id int default 0"), tos_lit("title text default ''"), tos_lit("text text default ''"), tos_lit("created_at integer default 0"), tos_lit("nr_comments int default 0")})));
	main__App_create_table(app, tos_lit("Commit"), new_array_from_c_array(8, 8, sizeof(string), _MOV((string[8]){tos_lit("id integer primary key"), tos_lit("author_id int default 0"), tos_lit("author text default ''"), tos_lit("hash text default ''"), tos_lit("repo_id int default 0"), tos_lit("message text default ''"), tos_lit("created_at int default (strftime('%s', 'now'))"), tos_lit("UNIQUE(hash, repo_id)")})));
	main__App_create_table(app, tos_lit("LangStat"), new_array_from_c_array(7, 7, sizeof(string), _MOV((string[7]){tos_lit("id integer primary key"), tos_lit("repo_id int default 0"), tos_lit("name text default \"\""), tos_lit("nr_lines int default 0"), tos_lit("pct int default 0"), tos_lit("color text default \"\""), tos_lit("UNIQUE(repo_id, name) ON CONFLICT REPLACE")})));
	main__App_create_table(app, tos_lit("User"), new_array_from_c_array(15, 15, sizeof(string), _MOV((string[15]){
			tos_lit("id integer primary key"), tos_lit("name text default \"\""), tos_lit("username text default \"\""), tos_lit("password text default \"\""), tos_lit("avatar text default \"\""), tos_lit("nr_posts integer default 0"), tos_lit("last_post_time integer default 0"), tos_lit("nr_namechanges integer default 0"), tos_lit("last_namechange_time integer default 0"), tos_lit("is_github int default 0"), tos_lit("is_blocked int default 0"), tos_lit("is_registered int default 0"), tos_lit("is_admin int default 0"), tos_lit("login_attempts int default 0"), tos_lit("UNIQUE(username)")})));
	main__App_create_table(app, tos_lit("Email"), new_array_from_c_array(4, 4, sizeof(string), _MOV((string[4]){tos_lit("id integer primary key"), tos_lit("user integer default 0"), tos_lit("email text default \"\""), tos_lit("UNIQUE(email)")})));
	main__App_create_table(app, tos_lit("Contributor"), new_array_from_c_array(4, 4, sizeof(string), _MOV((string[4]){tos_lit("id integer primary key"), tos_lit("user integer default 0"), tos_lit("repo integer default 0"), tos_lit("UNIQUE(user, repo)")})));
	main__App_create_table(app, tos_lit("Tag"), new_array_from_c_array(7, 7, sizeof(string), _MOV((string[7]){tos_lit("id integer primary key"), tos_lit("name text default \"\""), tos_lit("hash text default \"\""), tos_lit("user_id integer default 0"), tos_lit("repo_id integer default 0"), tos_lit("date integer default 0"), tos_lit("UNIQUE(name, repo_id)")})));
	main__App_create_table(app, tos_lit("Release"), new_array_from_c_array(5, 5, sizeof(string), _MOV((string[5]){tos_lit("id integer primary key"), tos_lit("tag_id integer not null"), tos_lit("repo_id integer not null"), tos_lit("notes text default \"\""), tos_lit("UNIQUE(tag_id, repo_id)")})));
	main__App_create_table(app, tos_lit("SshKey"), new_array_from_c_array(5, 5, sizeof(string), _MOV((string[5]){tos_lit("id integer primary key"), tos_lit("user integer default 0"), tos_lit("title text default \"\""), tos_lit("sshkey text default \"\""), tos_lit("is_deleted integer default 0")})));
	main__App_create_table(app, tos_lit("Comment"), new_array_from_c_array(5, 5, sizeof(string), _MOV((string[5]){tos_lit("id integer primary key"), tos_lit("author_id integer default 0"), tos_lit("issue_id integer default 0"), tos_lit("created_at integer default 0"), tos_lit("text text default \"\"")})));
	main__App_create_table(app, tos_lit("Branch"), new_array_from_c_array(7, 7, sizeof(string), _MOV((string[7]){tos_lit("id integer primary key"), tos_lit("repo_id integer default 0"), tos_lit("name text default \"\""), tos_lit("author text default \"\""), tos_lit("hash text default \"\""), tos_lit("date integer default 0"), tos_lit("UNIQUE(repo_id, name)")})));
	main__App_create_table(app, tos_lit("Visit"), new_array_from_c_array(5, 5, sizeof(string), _MOV((string[5]){tos_lit("id integer primary key"), tos_lit("repo_id integer default 0"), tos_lit("url text default ''"), tos_lit("referer text default ''"), tos_lit("created_at integer default 0")})));
	main__App_create_table(app, tos_lit("GitlySettings"), new_array_from_c_array(5, 5, sizeof(string), _MOV((string[5]){tos_lit("id integer primary key"), tos_lit("oauth_client_id text default \"\""), tos_lit("oauth_client_secret text default \"\""), tos_lit("only_gh_login int default 1"), tos_lit("repo_storage_path text default \"./repos\"")})));
	main__App_create_table(app, tos_lit("Token"), new_array_from_c_array(4, 4, sizeof(string), _MOV((string[4]){tos_lit("id integer primary key"), tos_lit("user_id integer default 0"), tos_lit("value text defaut ''"), tos_lit("ip text default \"\"")})));
	main__App_create_table(app, tos_lit("Token2"), new_array_from_c_array(4, 4, sizeof(string), _MOV((string[4]){tos_lit("id integer primary key"), tos_lit("user_id integer default 0"), tos_lit("value text defaut ''"), tos_lit("ip text default \"\"")})));
	main__App_create_table(app, tos_lit("SecurityLog"), new_array_from_c_array(7, 7, sizeof(string), _MOV((string[7]){tos_lit("id integer primary key"), tos_lit("user_id integer default 0"), tos_lit("kind int default 0"), tos_lit("ip text default ''"), tos_lit("arg1 text default ''"), tos_lit("arg2 text default ''"), tos_lit("created_at int default (strftime('%s', 'now'))")})));
}

static void main__App_update_repo_in_db(main__App* app, main__Repo* repo) {
	int id = repo->id;
	string desc = repo->description;
	int nr_views = repo->nr_views;
	string webhook_secret = repo->webhook_secret;
	int nr_tags = repo->nr_tags;
	int nr_open_issues = repo->nr_open_issues;
	int nr_open_prs = repo->nr_open_prs;
	int nr_branches = repo->nr_branches;
	int nr_releases = repo->nr_releases;
	int nr_contributors = repo->nr_contributors;
	int nr_commits = repo->nr_commits;
	
	// sql insert
	sqlite__DB _t2433 = app->db;
	sqlite3_stmt* _t2434 = sqlite__DB_init_stmt(_t2433, tos_lit("UPDATE `Repo` SET  description = ?1,  nr_views = ?2,  webhook_secret = ?3,  nr_tags = ?4,  nr_open_issues = ?5,  nr_open_prs = ?6,  nr_releases = ?7,  nr_contributors = ?8,  nr_commits = ?9,  nr_branches = ?10 WHERE id = ?11"));
	sqlite3_bind_text(_t2434, 1, desc.str, desc.len, 0);
sqlite3_bind_int(_t2434, 2, nr_views);
sqlite3_bind_text(_t2434, 3, webhook_secret.str, webhook_secret.len, 0);
sqlite3_bind_int(_t2434, 4, nr_tags);
sqlite3_bind_int(_t2434, 5, nr_open_issues);
sqlite3_bind_int(_t2434, 6, nr_open_prs);
sqlite3_bind_int(_t2434, 7, nr_releases);
sqlite3_bind_int(_t2434, 8, nr_contributors);
sqlite3_bind_int(_t2434, 9, nr_commits);
sqlite3_bind_int(_t2434, 10, nr_branches);
sqlite3_bind_int(_t2434, 11, id);

		int _t2435 = sqlite3_step(_t2434);
		if( (_t2435 != SQLITE_OK) && (_t2435 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2433.conn)); }
		sqlite3_finalize(_t2434);
}

static Option_main__Repo main__App_find_repo_by_name(main__App* app, int user, string name) {

	// sql select
	sqlite__DB _t2437 = app->db;
	sqlite3_stmt* _t2436 = sqlite__DB_init_stmt(_t2437, tos_lit("SELECT `id`, `git_dir`, `name`, `user_id`, `user_name`, `primary_branch`, `description`, `nr_views`, `webhook_secret`, `nr_tags`, `nr_open_issues`, `nr_open_prs`, `nr_releases`, `nr_branches`, `created_at`, `nr_contributors`, `nr_commits` FROM `Repo` WHERE name = ?1 and user_id = ?2 ORDER BY id  LIMIT ?3"));
	sqlite3_bind_text(_t2436, 1, name.str, name.len, 0);
sqlite3_bind_int(_t2436, 2, user);
sqlite3_bind_int(_t2436, 3, 1);

	int _t2438 = sqlite3_extended_errcode(_t2437.conn);
	if (_t2438 != SQLITE_OK) { puts(sqlite3_errmsg(_t2437.conn)); }
	main__Repo _t2439 = (main__Repo){
	.id = 0, .git_dir = (string){.str=(byteptr)""}, .name = (string){.str=(byteptr)""}, .user_id = 0, .user_name = (string){.str=(byteptr)""}, .clone_url = (string){.str=(byteptr)""}, .primary_branch = (string){.str=(byteptr)""}, .description = (string){.str=(byteptr)""}, .is_public = 0, .users_contributed = __new_array(0, 1, sizeof(string)), .users_authorized = __new_array(0, 1, sizeof(string)), .nr_topics = 0, .nr_views = 0, .latest_update_hash = (string){.str=(byteptr)""}, .latest_activity = {0}, .webhook_secret = (string){.str=(byteptr)""}, .nr_tags = 0, .nr_open_issues = 0, .nr_open_prs = 0, .nr_releases = 0, .nr_branches = 0, .lang_stats = __new_array(0, 1, sizeof(main__LangStat)), .created_at = 0, .nr_contributors = 0, .nr_commits = 0, .labels = __new_array(0, 1, sizeof(main__Label)), .status = 0, .msg_cache = new_map_1(sizeof(string))};
	int _step_res_t2439 = sqlite3_step(_t2436);
		if (_step_res_t2439 == SQLITE_OK || _step_res_t2439 == SQLITE_ROW) {
	_t2439.id = sqlite3_column_int(_t2436, 0);
	_t2439.git_dir = tos_clone(sqlite3_column_text(_t2436, 1));
	_t2439.name = tos_clone(sqlite3_column_text(_t2436, 2));
	_t2439.user_id = sqlite3_column_int(_t2436, 3);
	_t2439.user_name = tos_clone(sqlite3_column_text(_t2436, 4));
	_t2439.primary_branch = tos_clone(sqlite3_column_text(_t2436, 5));
	_t2439.description = tos_clone(sqlite3_column_text(_t2436, 6));
	_t2439.nr_views = sqlite3_column_int(_t2436, 7);
	_t2439.webhook_secret = tos_clone(sqlite3_column_text(_t2436, 8));
	_t2439.nr_tags = sqlite3_column_int(_t2436, 9);
	_t2439.nr_open_issues = sqlite3_column_int(_t2436, 10);
	_t2439.nr_open_prs = sqlite3_column_int(_t2436, 11);
	_t2439.nr_releases = sqlite3_column_int(_t2436, 12);
	_t2439.nr_branches = sqlite3_column_int(_t2436, 13);
	_t2439.created_at = sqlite3_column_int(_t2436, 14);
	_t2439.nr_contributors = sqlite3_column_int(_t2436, 15);
	_t2439.nr_commits = sqlite3_column_int(_t2436, 16);
	}
	sqlite3_finalize(_t2436);
		main__Repo x =  _t2439; 
	;
	if (x.id == 0) {
		Option _t2440 = opt_none();
		return *(Option_main__Repo*)&_t2440;
	}
	Option_main__Repo _t2441;
	opt_ok2(&(main__Repo[]) { x }, (OptionBase*)(&_t2441), sizeof(main__Repo));
	return _t2441;
}

static int main__App_nr_user_repos(main__App* app, int user_id) {

	// sql select
	sqlite__DB _t2443 = app->db;
	sqlite3_stmt* _t2442 = sqlite__DB_init_stmt(_t2443, tos_lit("SELECT COUNT(*) FROM `Repo`  WHERE user_id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2442, 1, user_id);

	int _t2444 = sqlite3_extended_errcode(_t2443.conn);
	if (_t2444 != SQLITE_OK) { puts(sqlite3_errmsg(_t2443.conn)); }
		return  sqlite__get_int_from_stmt(_t2442);
	;
}

static array_main__Repo main__App_find_user_repos(main__App* app, int user_id) {

	// sql select
	sqlite__DB _t2446 = app->db;
	sqlite3_stmt* _t2445 = sqlite__DB_init_stmt(_t2446, tos_lit("SELECT `id`, `git_dir`, `name`, `user_id`, `user_name`, `primary_branch`, `description`, `nr_views`, `webhook_secret`, `nr_tags`, `nr_open_issues`, `nr_open_prs`, `nr_releases`, `nr_branches`, `created_at`, `nr_contributors`, `nr_commits` FROM `Repo` WHERE user_id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2445, 1, user_id);

	int _t2447 = sqlite3_extended_errcode(_t2446.conn);
	if (_t2447 != SQLITE_OK) { puts(sqlite3_errmsg(_t2446.conn)); }
	array_main__Repo _t2448_array = __new_array(0, 10, sizeof(main__Repo));
	while (1) {
		main__Repo _t2448 = (main__Repo) {
	.id = 0, .git_dir = (string){.str=(byteptr)""}, .name = (string){.str=(byteptr)""}, .user_id = 0, .user_name = (string){.str=(byteptr)""}, .clone_url = (string){.str=(byteptr)""}, .primary_branch = (string){.str=(byteptr)""}, .description = (string){.str=(byteptr)""}, .is_public = 0, .users_contributed = __new_array(0, 1, sizeof(string)), .users_authorized = __new_array(0, 1, sizeof(string)), .nr_topics = 0, .nr_views = 0, .latest_update_hash = (string){.str=(byteptr)""}, .latest_activity = {0}, .webhook_secret = (string){.str=(byteptr)""}, .nr_tags = 0, .nr_open_issues = 0, .nr_open_prs = 0, .nr_releases = 0, .nr_branches = 0, .lang_stats = __new_array(0, 1, sizeof(main__LangStat)), .created_at = 0, .nr_contributors = 0, .nr_commits = 0, .labels = __new_array(0, 1, sizeof(main__Label)), .status = 0, .msg_cache = new_map_1(sizeof(string))};
	int _step_res_t2448 = sqlite3_step(_t2445);
		if (_step_res_t2448 == SQLITE_DONE) break;
		if (_step_res_t2448 == SQLITE_ROW) ;
		else if (_step_res_t2448 != SQLITE_OK) break;
	_t2448.id = sqlite3_column_int(_t2445, 0);
	_t2448.git_dir = tos_clone(sqlite3_column_text(_t2445, 1));
	_t2448.name = tos_clone(sqlite3_column_text(_t2445, 2));
	_t2448.user_id = sqlite3_column_int(_t2445, 3);
	_t2448.user_name = tos_clone(sqlite3_column_text(_t2445, 4));
	_t2448.primary_branch = tos_clone(sqlite3_column_text(_t2445, 5));
	_t2448.description = tos_clone(sqlite3_column_text(_t2445, 6));
	_t2448.nr_views = sqlite3_column_int(_t2445, 7);
	_t2448.webhook_secret = tos_clone(sqlite3_column_text(_t2445, 8));
	_t2448.nr_tags = sqlite3_column_int(_t2445, 9);
	_t2448.nr_open_issues = sqlite3_column_int(_t2445, 10);
	_t2448.nr_open_prs = sqlite3_column_int(_t2445, 11);
	_t2448.nr_releases = sqlite3_column_int(_t2445, 12);
	_t2448.nr_branches = sqlite3_column_int(_t2445, 13);
	_t2448.created_at = sqlite3_column_int(_t2445, 14);
	_t2448.nr_contributors = sqlite3_column_int(_t2445, 15);
	_t2448.nr_commits = sqlite3_column_int(_t2445, 16);
		 array_push(&_t2448_array, _MOV((main__Repo[]){ _t2448 }));
	}
	sqlite3_finalize(_t2445);
		return  _t2448_array; 
	;
}

static main__Repo main__App_find_repo_by_id(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2450 = app->db;
	sqlite3_stmt* _t2449 = sqlite__DB_init_stmt(_t2450, tos_lit("SELECT `id`, `git_dir`, `name`, `user_id`, `user_name`, `primary_branch`, `description`, `nr_views`, `webhook_secret`, `nr_tags`, `nr_open_issues`, `nr_open_prs`, `nr_releases`, `nr_branches`, `created_at`, `nr_contributors`, `nr_commits` FROM `Repo` WHERE id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2449, 1, repo_id);

	int _t2451 = sqlite3_extended_errcode(_t2450.conn);
	if (_t2451 != SQLITE_OK) { puts(sqlite3_errmsg(_t2450.conn)); }
	main__Repo _t2452 = (main__Repo){
	.id = 0, .git_dir = (string){.str=(byteptr)""}, .name = (string){.str=(byteptr)""}, .user_id = 0, .user_name = (string){.str=(byteptr)""}, .clone_url = (string){.str=(byteptr)""}, .primary_branch = (string){.str=(byteptr)""}, .description = (string){.str=(byteptr)""}, .is_public = 0, .users_contributed = __new_array(0, 1, sizeof(string)), .users_authorized = __new_array(0, 1, sizeof(string)), .nr_topics = 0, .nr_views = 0, .latest_update_hash = (string){.str=(byteptr)""}, .latest_activity = {0}, .webhook_secret = (string){.str=(byteptr)""}, .nr_tags = 0, .nr_open_issues = 0, .nr_open_prs = 0, .nr_releases = 0, .nr_branches = 0, .lang_stats = __new_array(0, 1, sizeof(main__LangStat)), .created_at = 0, .nr_contributors = 0, .nr_commits = 0, .labels = __new_array(0, 1, sizeof(main__Label)), .status = 0, .msg_cache = new_map_1(sizeof(string))};
	int _step_res_t2452 = sqlite3_step(_t2449);
		if (_step_res_t2452 == SQLITE_OK || _step_res_t2452 == SQLITE_ROW) {
	_t2452.id = sqlite3_column_int(_t2449, 0);
	_t2452.git_dir = tos_clone(sqlite3_column_text(_t2449, 1));
	_t2452.name = tos_clone(sqlite3_column_text(_t2449, 2));
	_t2452.user_id = sqlite3_column_int(_t2449, 3);
	_t2452.user_name = tos_clone(sqlite3_column_text(_t2449, 4));
	_t2452.primary_branch = tos_clone(sqlite3_column_text(_t2449, 5));
	_t2452.description = tos_clone(sqlite3_column_text(_t2449, 6));
	_t2452.nr_views = sqlite3_column_int(_t2449, 7);
	_t2452.webhook_secret = tos_clone(sqlite3_column_text(_t2449, 8));
	_t2452.nr_tags = sqlite3_column_int(_t2449, 9);
	_t2452.nr_open_issues = sqlite3_column_int(_t2449, 10);
	_t2452.nr_open_prs = sqlite3_column_int(_t2449, 11);
	_t2452.nr_releases = sqlite3_column_int(_t2449, 12);
	_t2452.nr_branches = sqlite3_column_int(_t2449, 13);
	_t2452.created_at = sqlite3_column_int(_t2449, 14);
	_t2452.nr_contributors = sqlite3_column_int(_t2449, 15);
	_t2452.nr_commits = sqlite3_column_int(_t2449, 16);
	}
	sqlite3_finalize(_t2449);
		return  _t2452; 
	;
}

static bool main__App_exists_user_repo(main__App* app, string user, string name) {
	if (user.len == 0 || name.len == 0) {
		main__App_info(app, tos_lit("User or repo was not found"));
		return false;
	}
	Option_main__User _t2453 = main__App_find_user_by_username(app, user);
	if (!_t2453.ok) {
		string err = _t2453.v_error;
		int errcode = _t2453.ecode;
		main__App_info(app, tos_lit("User was not found"));
		return false;
	}
	main__User u = *(main__User*)_t2453.data;
	Option_main__Repo _t2454 = main__App_find_repo_by_name(app, u.id, name);
	if (!_t2454.ok) {
		string err = _t2454.v_error;
		int errcode = _t2454.ecode;
		main__App_info(app, tos_lit("Repo was not found"));
		return false;
	}
	app->repo = *(main__Repo*)_t2454.data;
	app->repo.lang_stats = main__App_find_repo_lang_stats(app, app->repo.id);
	app->html_path = main__Repo_html_path_to(&app->repo, app->path, app->repo.primary_branch);
	return true;
}

static main__Repo main__App_retrieve_repo(main__App* app, int id) {
	return app->repo;
}

static void main__App_inc_repo_views(main__App* app, int repo_id) {
	
	// sql insert
	sqlite__DB _t2455 = app->db;
	sqlite3_stmt* _t2456 = sqlite__DB_init_stmt(_t2455, tos_lit("UPDATE `Repo` SET  nr_views = nr_views + ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2456, 1, 1);
sqlite3_bind_int(_t2456, 2, repo_id);

		int _t2457 = sqlite3_step(_t2456);
		if( (_t2457 != SQLITE_OK) && (_t2457 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2455.conn)); }
		sqlite3_finalize(_t2456);
}

static void main__App_inc_file_views(main__App* app, int file_id) {
	
	// sql insert
	sqlite__DB _t2458 = app->db;
	sqlite3_stmt* _t2459 = sqlite__DB_init_stmt(_t2458, tos_lit("UPDATE `File` SET  nr_views = nr_views + ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2459, 1, 1);
sqlite3_bind_int(_t2459, 2, file_id);

		int _t2460 = sqlite3_step(_t2459);
		if( (_t2460 != SQLITE_OK) && (_t2460 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2458.conn)); }
		sqlite3_finalize(_t2459);
}

static void main__App_inc_repo_issues(main__App* app, int repo_id) {
	
	// sql insert
	sqlite__DB _t2461 = app->db;
	sqlite3_stmt* _t2462 = sqlite__DB_init_stmt(_t2461, tos_lit("UPDATE `Repo` SET  nr_open_issues = nr_open_issues + ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2462, 1, 1);
sqlite3_bind_int(_t2462, 2, repo_id);

		int _t2463 = sqlite3_step(_t2462);
		if( (_t2463 != SQLITE_OK) && (_t2463 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2461.conn)); }
		sqlite3_finalize(_t2462);
	app->repo.nr_open_issues++;
}

static void main__App_update_repo_nr_commits(main__App* app, int repo_id, int nr_commits) {
	
	// sql insert
	sqlite__DB _t2464 = app->db;
	sqlite3_stmt* _t2465 = sqlite__DB_init_stmt(_t2464, tos_lit("UPDATE `Repo` SET  nr_commits = ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2465, 1, nr_commits);
sqlite3_bind_int(_t2465, 2, repo_id);

		int _t2466 = sqlite3_step(_t2465);
		if( (_t2466 != SQLITE_OK) && (_t2466 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2464.conn)); }
		sqlite3_finalize(_t2465);
	app->repo.nr_commits = nr_commits;
}

static void main__App_update_repo_webhook(main__App* app, int repo_id, string webhook) {
	
	// sql insert
	sqlite__DB _t2467 = app->db;
	sqlite3_stmt* _t2468 = sqlite__DB_init_stmt(_t2467, tos_lit("UPDATE `Repo` SET  webhook_secret = ?1 WHERE id = ?2"));
	sqlite3_bind_text(_t2468, 1, webhook.str, webhook.len, 0);
sqlite3_bind_int(_t2468, 2, repo_id);

		int _t2469 = sqlite3_step(_t2468);
		if( (_t2469 != SQLITE_OK) && (_t2469 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2467.conn)); }
		sqlite3_finalize(_t2468);
}

static void main__App_update_repo_nr_contributor(main__App* app, int repo_id, int nr_contributors) {
	
	// sql insert
	sqlite__DB _t2470 = app->db;
	sqlite3_stmt* _t2471 = sqlite__DB_init_stmt(_t2470, tos_lit("UPDATE `Repo` SET  nr_contributors = ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2471, 1, nr_contributors);
sqlite3_bind_int(_t2471, 2, repo_id);

		int _t2472 = sqlite3_step(_t2471);
		if( (_t2472 != SQLITE_OK) && (_t2472 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2470.conn)); }
		sqlite3_finalize(_t2471);
	app->repo.nr_contributors = nr_contributors;
}

static void main__App_insert_repo(main__App* app, main__Repo repo) {
	
	// sql insert
	sqlite__DB _t2473 = app->db;
	sqlite3_stmt* _t2474 = sqlite__DB_init_stmt(_t2473, tos_lit("INSERT INTO `Repo` (`git_dir`, `name`, `user_id`, `user_name`, `primary_branch`, `description`, `nr_views`, `webhook_secret`, `nr_tags`, `nr_open_issues`, `nr_open_prs`, `nr_releases`, `nr_branches`, `created_at`, `nr_contributors`, `nr_commits`) values (?1, ?2, ?3, ?4, ?5, ?6, ?7, ?8, ?9, ?10, ?11, ?12, ?13, ?14, ?15, ?16)"));
	sqlite3_bind_text(_t2474, 1, repo.git_dir.str, repo.git_dir.len, 0);
	sqlite3_bind_text(_t2474, 2, repo.name.str, repo.name.len, 0);
	sqlite3_bind_int(_t2474, 3, repo.user_id); // stmt
	sqlite3_bind_text(_t2474, 4, repo.user_name.str, repo.user_name.len, 0);
	sqlite3_bind_text(_t2474, 5, repo.primary_branch.str, repo.primary_branch.len, 0);
	sqlite3_bind_text(_t2474, 6, repo.description.str, repo.description.len, 0);
	sqlite3_bind_int(_t2474, 7, repo.nr_views); // stmt
	sqlite3_bind_text(_t2474, 8, repo.webhook_secret.str, repo.webhook_secret.len, 0);
	sqlite3_bind_int(_t2474, 9, repo.nr_tags); // stmt
	sqlite3_bind_int(_t2474, 10, repo.nr_open_issues); // stmt
	sqlite3_bind_int(_t2474, 11, repo.nr_open_prs); // stmt
	sqlite3_bind_int(_t2474, 12, repo.nr_releases); // stmt
	sqlite3_bind_int(_t2474, 13, repo.nr_branches); // stmt
	sqlite3_bind_int(_t2474, 14, repo.created_at); // stmt
	sqlite3_bind_int(_t2474, 15, repo.nr_contributors); // stmt
	sqlite3_bind_int(_t2474, 16, repo.nr_commits); // stmt
	
		int _t2475 = sqlite3_step(_t2474);
		if( (_t2475 != SQLITE_OK) && (_t2475 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2473.conn)); }
		sqlite3_finalize(_t2474);
}

static void main__App_delete_repo(main__App* app, int id, string path, string name) {
	
	// sql insert
	sqlite__DB _t2476 = app->db;
	sqlite3_stmt* _t2477 = sqlite__DB_init_stmt(_t2476, tos_lit("DELETE FROM `Repo`  WHERE id = ?1"));
	sqlite3_bind_int(_t2477, 1, id);

		int _t2478 = sqlite3_step(_t2477);
		if( (_t2478 != SQLITE_OK) && (_t2478 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2476.conn)); }
		sqlite3_finalize(_t2477);
	main__App_info(app, _STR("Removed repo entry (%"PRId32"\000, %.*s\000)", 3, id, name));
	
	// sql insert
	sqlite__DB _t2479 = app->db;
	sqlite3_stmt* _t2480 = sqlite__DB_init_stmt(_t2479, tos_lit("DELETE FROM `Commit`  WHERE repo_id = ?1"));
	sqlite3_bind_int(_t2480, 1, id);

		int _t2481 = sqlite3_step(_t2480);
		if( (_t2481 != SQLITE_OK) && (_t2481 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2479.conn)); }
		sqlite3_finalize(_t2480);
	main__App_info(app, _STR("Removed repo commits (%"PRId32"\000, %.*s\000)", 3, id, name));
	main__App_delete_repo_issues(app, id);
	main__App_info(app, _STR("Removed repo issues (%"PRId32"\000, %.*s\000)", 3, id, name));
	main__App_delete_repo_branches(app, id);
	main__App_info(app, _STR("Removed repo branches (%"PRId32"\000, %.*s\000)", 3, id, name));
	main__App_delete_repo_releases(app, id);
	main__App_info(app, _STR("Removed repo releases (%"PRId32"\000, %.*s\000)", 3, id, name));
	main__App_delete_repo_files(app, id);
	main__App_info(app, _STR("Removed repo files (%"PRId32"\000, %.*s\000)", 3, id, name));
	main__App_delete_repo_folder(app, path);
	main__App_info(app, _STR("Removed repo folder (%"PRId32"\000, %.*s\000)", 3, id, name));
}

static void main__App_move_repo_to_user(main__App* app, int repo_id, int user_id, string user_name) {
	
	// sql insert
	sqlite__DB _t2482 = app->db;
	sqlite3_stmt* _t2483 = sqlite__DB_init_stmt(_t2482, tos_lit("UPDATE `Repo` SET  user_id = ?1,  user_name = ?2 WHERE id = ?3"));
	sqlite3_bind_int(_t2483, 1, user_id);
sqlite3_bind_text(_t2483, 2, user_name.str, user_name.len, 0);
sqlite3_bind_int(_t2483, 3, repo_id);

		int _t2484 = sqlite3_step(_t2483);
		if( (_t2484 != SQLITE_OK) && (_t2484 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2482.conn)); }
		sqlite3_finalize(_t2483);
}

static bool main__App_user_has_repo(main__App* app, int user_id, string repo_name) {

	// sql select
	sqlite__DB _t2486 = app->db;
	sqlite3_stmt* _t2485 = sqlite__DB_init_stmt(_t2486, tos_lit("SELECT COUNT(*) FROM `Repo`  WHERE user_id = ?1 and name = ?2 ORDER BY id "));
	sqlite3_bind_int(_t2485, 1, user_id);
sqlite3_bind_text(_t2485, 2, repo_name.str, repo_name.len, 0);

	int _t2487 = sqlite3_extended_errcode(_t2486.conn);
	if (_t2487 != SQLITE_OK) { puts(sqlite3_errmsg(_t2486.conn)); }
		int count =  sqlite__get_int_from_stmt(_t2485);
	;
	return count >= 0;
}

static void main__App_security_log(main__App* app, main__SecurityLog log) {
	main__SecurityLog log2 = // assoc
	(main__SecurityLog){
		.id = log.id,
		.user_id = log.user_id,
		.kind = log.kind,
		.ip = vweb__Context_ip(&app->vweb), 
		.arg1 = log.arg1,
		.arg2 = log.arg2,
		.created_at = log.created_at,
	};
	
	// sql insert
	sqlite__DB _t2488 = app->db;
	sqlite3_stmt* _t2489 = sqlite__DB_init_stmt(_t2488, tos_lit("INSERT INTO `SecurityLog` (`user_id`, `ip`, `arg1`, `arg2`, `created_at`) values (?1, ?2, ?3, ?4, ?5)"));
	sqlite3_bind_int(_t2489, 1, log2.user_id); // stmt
	sqlite3_bind_text(_t2489, 2, log2.ip.str, log2.ip.len, 0);
	sqlite3_bind_text(_t2489, 3, log2.arg1.str, log2.arg1.len, 0);
	sqlite3_bind_text(_t2489, 4, log2.arg2.str, log2.arg2.len, 0);
	sqlite3_bind_int(_t2489, 5, log2.created_at); // stmt
	
		int _t2490 = sqlite3_step(_t2489);
		if( (_t2490 != SQLITE_OK) && (_t2490 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2488.conn)); }
		sqlite3_finalize(_t2489);
}

static array_main__SecurityLog main__App_find_security_logs(main__App* app, int user_id) {

	// sql select
	sqlite__DB _t2492 = app->db;
	sqlite3_stmt* _t2491 = sqlite__DB_init_stmt(_t2492, tos_lit("SELECT `id`, `user_id`, `ip`, `arg1`, `arg2`, `created_at` FROM `SecurityLog` WHERE user_id = ?1 ORDER BY id DESC "));
	sqlite3_bind_int(_t2491, 1, user_id);

	int _t2493 = sqlite3_extended_errcode(_t2492.conn);
	if (_t2493 != SQLITE_OK) { puts(sqlite3_errmsg(_t2492.conn)); }
	array_main__SecurityLog _t2494_array = __new_array(0, 10, sizeof(main__SecurityLog));
	while (1) {
		main__SecurityLog _t2494 = (main__SecurityLog) {
	.id = 0, .user_id = 0, .kind = 0, .ip = (string){.str=(byteptr)""}, .arg1 = (string){.str=(byteptr)""}, .arg2 = (string){.str=(byteptr)""}, .created_at = 0};
	int _step_res_t2494 = sqlite3_step(_t2491);
		if (_step_res_t2494 == SQLITE_DONE) break;
		if (_step_res_t2494 == SQLITE_ROW) ;
		else if (_step_res_t2494 != SQLITE_OK) break;
	_t2494.id = sqlite3_column_int(_t2491, 0);
	_t2494.user_id = sqlite3_column_int(_t2491, 1);
	_t2494.ip = tos_clone(sqlite3_column_text(_t2491, 2));
	_t2494.arg1 = tos_clone(sqlite3_column_text(_t2491, 3));
	_t2494.arg2 = tos_clone(sqlite3_column_text(_t2491, 4));
	_t2494.created_at = sqlite3_column_int(_t2491, 5);
		 array_push(&_t2494_array, _MOV((main__SecurityLog[]){ _t2494 }));
	}
	sqlite3_finalize(_t2491);
		return  _t2494_array; 
	;
}

// Attr: [/settings/security]
static vweb__Result main__App_security(main__App* app) {
	array_main__SecurityLog logs = main__App_find_security_logs(app, app->user.id);
		strings__Builder sb = strings__new_builder(6210);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h3>Security log</h3>\n\n<div class=\"commit-day\">\n</div>\n\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		// FOR IN array
		array _t2495 = logs;
		for (int _t2496 = 0; _t2496 < _t2495.len; ++_t2496) {
			main__SecurityLog log = ((main__SecurityLog*)_t2495.data)[_t2496];
			strings__Builder_write(&sb, _STR("\n<div>\n%.*s\000\n\n</div>\n", 2, main__SecurityLog_str(  log)));
		}
		strings__Builder_write(&sb, tos_lit("\n"));
		string _tmpl_res_security = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_security); strings__Builder_free(&sb); string_free(&_tmpl_res_security);
	;
}

static void main__App_init_tags(main__App* app, main__Repo* r) {
	main__Tag tag = (main__Tag){.id = 0,.repo_id = r->id,.name = (string){.str=(byteptr)""},.hash = (string){.str=(byteptr)""},.user_id = 0,.date = 0,};
	string data = main__Repo_git(r, tos_lit("ls-remote -tq"));
	sqlite__DB_exec(app->db, tos_lit("BEGIN TRANSACTION"));
	// FOR IN array
	array _t2497 = string_split_into_lines(data);
	for (int _t2498 = 0; _t2498 < _t2497.len; ++_t2498) {
		string remote_tag = ((string*)_t2497.data)[_t2498];
		tag.name = string_after(remote_tag, tos_lit("refs/tags/"));
		tag.hash = string_substr(remote_tag, 0, 7);
		string tag_hash_data = main__Repo_git(r, _STR("log -1 --pretty=\"%%aE%.*s\000%%cD\" %.*s", 2, _const_main__log_field_separator, tag.hash));
		array_string args = string_split(tag_hash_data, _const_main__log_field_separator);
		if (args.len < 2) {
			continue;
		}
		Option_main__User _t2499 = main__App_find_user_by_email(app, (*(string*)array_get(args, 0)));
		if (!_t2499.ok) {
			string err = _t2499.v_error;
			int errcode = _t2499.ecode;
			*(main__User*) _t2499.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
		}
		main__User user = *(main__User*)_t2499.data;
		tag.user_id = user.id;
		Option_time__Time _t2500 = time__parse_rfc2822((*(string*)array_get(args, 1)));
		if (!_t2500.ok) {
			string err = _t2500.v_error;
			int errcode = _t2500.ecode;
			eprintln(_STR("Error: %.*s", 1, err));
			return;
		}
		time__Time date = *(time__Time*)_t2500.data;
		tag.date = time__Time_unix_time(date);
		main__App_insert_tag(app, tag);
		r->nr_tags++;
	}
	sqlite__DB_exec(app->db, tos_lit("END TRANSACTION"));
}

void main__App_insert_tag(main__App* app, main__Tag tag) {
	println(_STR("Insert tag: %.*s", 1, tag.name));
	
	// sql insert
	sqlite__DB _t2501 = app->db;
	sqlite3_stmt* _t2502 = sqlite__DB_init_stmt(_t2501, tos_lit("INSERT INTO `Tag` (`repo_id`, `name`, `hash`, `user_id`, `date`) values (?1, ?2, ?3, ?4, ?5)"));
	sqlite3_bind_int(_t2502, 1, tag.repo_id); // stmt
	sqlite3_bind_text(_t2502, 2, tag.name.str, tag.name.len, 0);
	sqlite3_bind_text(_t2502, 3, tag.hash.str, tag.hash.len, 0);
	sqlite3_bind_int(_t2502, 4, tag.user_id); // stmt
	sqlite3_bind_int(_t2502, 5, tag.date); // stmt
	
		int _t2503 = sqlite3_step(_t2502);
		if( (_t2503 != SQLITE_OK) && (_t2503 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2501.conn)); }
		sqlite3_finalize(_t2502);
}

main__Tag main__App_find_tag_by_name(main__App* app, string name) {

	// sql select
	sqlite__DB _t2505 = app->db;
	sqlite3_stmt* _t2504 = sqlite__DB_init_stmt(_t2505, tos_lit("SELECT `id`, `repo_id`, `name`, `hash`, `user_id`, `date` FROM `Tag` WHERE name = ?1 ORDER BY id "));
	sqlite3_bind_text(_t2504, 1, name.str, name.len, 0);

	int _t2506 = sqlite3_extended_errcode(_t2505.conn);
	if (_t2506 != SQLITE_OK) { puts(sqlite3_errmsg(_t2505.conn)); }
	array_main__Tag _t2507_array = __new_array(0, 10, sizeof(main__Tag));
	while (1) {
		main__Tag _t2507 = (main__Tag) {
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .user_id = 0, .date = 0};
	int _step_res_t2507 = sqlite3_step(_t2504);
		if (_step_res_t2507 == SQLITE_DONE) break;
		if (_step_res_t2507 == SQLITE_ROW) ;
		else if (_step_res_t2507 != SQLITE_OK) break;
	_t2507.id = sqlite3_column_int(_t2504, 0);
	_t2507.repo_id = sqlite3_column_int(_t2504, 1);
	_t2507.name = tos_clone(sqlite3_column_text(_t2504, 2));
	_t2507.hash = tos_clone(sqlite3_column_text(_t2504, 3));
	_t2507.user_id = sqlite3_column_int(_t2504, 4);
	_t2507.date = sqlite3_column_int(_t2504, 5);
		 array_push(&_t2507_array, _MOV((main__Tag[]){ _t2507 }));
	}
	sqlite3_finalize(_t2504);
		array_main__Tag tag =  _t2507_array; 
	;
	return (*(main__Tag*)array_get(tag, 0));
}

main__Tag main__App_find_tag_by_id(main__App* app, int id) {

	// sql select
	sqlite__DB _t2509 = app->db;
	sqlite3_stmt* _t2508 = sqlite__DB_init_stmt(_t2509, tos_lit("SELECT `id`, `repo_id`, `name`, `hash`, `user_id`, `date` FROM `Tag` WHERE id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2508, 1, id);

	int _t2510 = sqlite3_extended_errcode(_t2509.conn);
	if (_t2510 != SQLITE_OK) { puts(sqlite3_errmsg(_t2509.conn)); }
	main__Tag _t2511 = (main__Tag){
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .user_id = 0, .date = 0};
	int _step_res_t2511 = sqlite3_step(_t2508);
		if (_step_res_t2511 == SQLITE_OK || _step_res_t2511 == SQLITE_ROW) {
	_t2511.id = sqlite3_column_int(_t2508, 0);
	_t2511.repo_id = sqlite3_column_int(_t2508, 1);
	_t2511.name = tos_clone(sqlite3_column_text(_t2508, 2));
	_t2511.hash = tos_clone(sqlite3_column_text(_t2508, 3));
	_t2511.user_id = sqlite3_column_int(_t2508, 4);
	_t2511.date = sqlite3_column_int(_t2508, 5);
	}
	sqlite3_finalize(_t2508);
		main__Tag tag =  _t2511; 
	;
	return tag;
}

array_main__Tag main__App_find_repo_tags(main__App* app, int repo_id) {

	// sql select
	sqlite__DB _t2513 = app->db;
	sqlite3_stmt* _t2512 = sqlite__DB_init_stmt(_t2513, tos_lit("SELECT `id`, `repo_id`, `name`, `hash`, `user_id`, `date` FROM `Tag` WHERE repo_id = ?1 ORDER BY date DESC "));
	sqlite3_bind_int(_t2512, 1, repo_id);

	int _t2514 = sqlite3_extended_errcode(_t2513.conn);
	if (_t2514 != SQLITE_OK) { puts(sqlite3_errmsg(_t2513.conn)); }
	array_main__Tag _t2515_array = __new_array(0, 10, sizeof(main__Tag));
	while (1) {
		main__Tag _t2515 = (main__Tag) {
	.id = 0, .repo_id = 0, .name = (string){.str=(byteptr)""}, .hash = (string){.str=(byteptr)""}, .user_id = 0, .date = 0};
	int _step_res_t2515 = sqlite3_step(_t2512);
		if (_step_res_t2515 == SQLITE_DONE) break;
		if (_step_res_t2515 == SQLITE_ROW) ;
		else if (_step_res_t2515 != SQLITE_OK) break;
	_t2515.id = sqlite3_column_int(_t2512, 0);
	_t2515.repo_id = sqlite3_column_int(_t2512, 1);
	_t2515.name = tos_clone(sqlite3_column_text(_t2512, 2));
	_t2515.hash = tos_clone(sqlite3_column_text(_t2512, 3));
	_t2515.user_id = sqlite3_column_int(_t2512, 4);
	_t2515.date = sqlite3_column_int(_t2512, 5);
		 array_push(&_t2515_array, _MOV((main__Tag[]){ _t2515 }));
	}
	sqlite3_finalize(_t2512);
		return  _t2515_array; 
	;
}

static string main__App_update_user_token(main__App* app, int user_id, string token, string ip) {
	string tok = main__App_find_user_token(app, user_id, ip);
	if (string_eq(tok, tos_lit(""))) {
		main__Token new_token = (main__Token){.id = 0,.user_id = user_id,.value = token,.ip = ip,};
		
	// sql insert
		sqlite__DB _t2516 = app->db;
		sqlite3_stmt* _t2517 = sqlite__DB_init_stmt(_t2516, tos_lit("INSERT INTO `Token` (`user_id`, `value`, `ip`) values (?1, ?2, ?3)"));
		sqlite3_bind_int(_t2517, 1, new_token.user_id); // stmt
		sqlite3_bind_text(_t2517, 2, new_token.value.str, new_token.value.len, 0);
		sqlite3_bind_text(_t2517, 3, new_token.ip.str, new_token.ip.len, 0);
		
			int _t2518 = sqlite3_step(_t2517);
			if( (_t2518 != SQLITE_OK) && (_t2518 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2516.conn)); }
			sqlite3_finalize(_t2517);
		return token;
	}
	return tok;
}

static string main__App_find_user_token(main__App* app, int user_id, string ip) {

	// sql select
	sqlite__DB _t2520 = app->db;
	sqlite3_stmt* _t2519 = sqlite__DB_init_stmt(_t2520, tos_lit("SELECT `id`, `user_id`, `value`, `ip` FROM `Token` WHERE user_id = ?1 and ip = ?2 ORDER BY id  LIMIT ?3"));
	sqlite3_bind_int(_t2519, 1, user_id);
sqlite3_bind_text(_t2519, 2, ip.str, ip.len, 0);
sqlite3_bind_int(_t2519, 3, 1);

	int _t2521 = sqlite3_extended_errcode(_t2520.conn);
	if (_t2521 != SQLITE_OK) { puts(sqlite3_errmsg(_t2520.conn)); }
	main__Token _t2522 = (main__Token){
	.id = 0, .user_id = 0, .value = (string){.str=(byteptr)""}, .ip = (string){.str=(byteptr)""}};
	int _step_res_t2522 = sqlite3_step(_t2519);
		if (_step_res_t2522 == SQLITE_OK || _step_res_t2522 == SQLITE_ROW) {
	_t2522.id = sqlite3_column_int(_t2519, 0);
	_t2522.user_id = sqlite3_column_int(_t2519, 1);
	_t2522.value = tos_clone(sqlite3_column_text(_t2519, 2));
	_t2522.ip = tos_clone(sqlite3_column_text(_t2519, 3));
	}
	sqlite3_finalize(_t2519);
		main__Token tok =  _t2522; 
	;
	return tok.value;
}

static void main__App_clear_sessions(main__App* app, int user_id) {
	
	// sql insert
	sqlite__DB _t2523 = app->db;
	sqlite3_stmt* _t2524 = sqlite__DB_init_stmt(_t2523, tos_lit("DELETE FROM `Token`  WHERE user_id = ?1"));
	sqlite3_bind_int(_t2524, 1, user_id);

		int _t2525 = sqlite3_step(_t2524);
		if( (_t2525 != SQLITE_OK) && (_t2525 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2523.conn)); }
		sqlite3_finalize(_t2524);
}

static string main__App_add_token(main__App* app, int user_id, string ip) {
	string token = main__gen_uuid_v4ish();
	token = main__App_update_user_token(app, user_id, token, ip);
	return token;
}

static string main__make_password(string password, string username) {
	array_u32 seed = new_array_from_c_array(2, 2, sizeof(u32), _MOV((u32[2]){((u32)(string_at(username, 0))), ((u32)(string_at(username, 1)))}));
	rand__seed(seed);
	string salt = i64_str(rand__i64());
	string pw = _STR("%.*s\000%.*s", 2, password, salt);
	return string_str(array_byte_hex(crypto__sha256__sum(string_bytes(pw))));
}

static bool main__check_password(string password, string username, string hashed) {
	return string_eq(main__make_password(password, username), hashed);
}

bool main__App_add_user(main__App* app, string username, string password, array_string emails, bool github) {
	Option_main__User _t2526 = main__App_find_user_by_username(app, username);
	if (!_t2526.ok) {
		string err = _t2526.v_error;
		int errcode = _t2526.ecode;
		*(main__User*) _t2526.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
	}
	main__User user = *(main__User*)_t2526.data;
	if (user.id != 0 && user.is_registered) {
		main__App_info(app, _STR("User %.*s\000 already exists", 2, username));
		return false;
	}
	Option_main__User _t2527 = main__App_find_user_by_email(app, (*(string*)array_get(emails, 0)));
	if (!_t2527.ok) {
		string err = _t2527.v_error;
		int errcode = _t2527.ecode;
		*(main__User*) _t2527.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
	}
	user = *(main__User*)_t2527.data;
	if (user.id == 0) {
		user = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = username,.password = password,.is_github = github,.is_registered = true,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
		main__App_insert_user(app, user);
		Option_main__User _t2528 = main__App_find_user_by_username(app, user.username);
		if (!_t2528.ok) {
			string err = _t2528.v_error;
			int errcode = _t2528.ecode;
			main__App_info(app, tos_lit("User was not inserted"));
			return false;
		}
		main__User u = *(main__User*)_t2528.data;
		if (string_ne(u.password, user.password) || string_ne(u.name, user.name)) {
			main__App_info(app, tos_lit("User was not inserted"));
			return false;
		}
		// FOR IN array
		array _t2529 = emails;
		for (int _t2530 = 0; _t2530 < _t2529.len; ++_t2530) {
			string email = ((string*)_t2529.data)[_t2530];
			main__Email mail = (main__Email){.id = 0,.user = u.id,.email = email,};
			main__App_insert_email(app, mail);
		}
		u.emails = main__App_find_user_emails(app, u.id);
	} else {
		string name = user.username;
		if (!github) {
			
	// sql insert
			sqlite__DB _t2531 = app->db;
			sqlite3_stmt* _t2532 = sqlite__DB_init_stmt(_t2531, tos_lit("UPDATE `User` SET  username = ?1,  password = ?2,  name = ?3,  is_registered = ?4 WHERE id = ?5"));
			sqlite3_bind_text(_t2532, 1, username.str, username.len, 0);
sqlite3_bind_text(_t2532, 2, password.str, password.len, 0);
sqlite3_bind_text(_t2532, 3, name.str, name.len, 0);
sqlite3_bind_int(_t2532, 4, 1);
sqlite3_bind_int(_t2532, 5, user.id);

				int _t2533 = sqlite3_step(_t2532);
				if( (_t2533 != SQLITE_OK) && (_t2533 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2531.conn)); }
				sqlite3_finalize(_t2532);
			main__App_create_user_dir(app, username);
			return true;
		}
		if (user.is_registered) {
			
	// sql insert
			sqlite__DB _t2534 = app->db;
			sqlite3_stmt* _t2535 = sqlite__DB_init_stmt(_t2534, tos_lit("UPDATE `User` SET  is_github = ?1 WHERE id = ?2"));
			sqlite3_bind_int(_t2535, 1, 1);
sqlite3_bind_int(_t2535, 2, user.id);

				int _t2536 = sqlite3_step(_t2535);
				if( (_t2536 != SQLITE_OK) && (_t2536 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2534.conn)); }
				sqlite3_finalize(_t2535);
			return true;
		}
		
	// sql insert
		sqlite__DB _t2537 = app->db;
		sqlite3_stmt* _t2538 = sqlite__DB_init_stmt(_t2537, tos_lit("UPDATE `User` SET  username = ?1,  name = ?2,  is_registered = ?3,  is_github = ?4 WHERE id = ?5"));
		sqlite3_bind_text(_t2538, 1, username.str, username.len, 0);
sqlite3_bind_text(_t2538, 2, name.str, name.len, 0);
sqlite3_bind_int(_t2538, 3, 1);
sqlite3_bind_int(_t2538, 4, 1);
sqlite3_bind_int(_t2538, 5, user.id);

			int _t2539 = sqlite3_step(_t2538);
			if( (_t2539 != SQLITE_OK) && (_t2539 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2537.conn)); }
			sqlite3_finalize(_t2538);
	}
	main__App_create_user_dir(app, username);
	return true;
}

static void main__App_create_user_dir(main__App* app, string username) {
	string user_path = _STR("%.*s\000/%.*s", 2, _const_main__repo_storage_path, username);
	Option_bool _t2540 = os__mkdir(user_path);
	if (!_t2540.ok) {
		string err = _t2540.v_error;
		int errcode = _t2540.ecode;
		main__App_info(app, _STR("Failed to create %.*s", 1, user_path));
		main__App_info(app, _STR("Error: %.*s", 1, err));
	};
}

void main__App_update_user_avatar(main__App* app, string data, int id) {
	
	// sql insert
	sqlite__DB _t2541 = app->db;
	sqlite3_stmt* _t2542 = sqlite__DB_init_stmt(_t2541, tos_lit("UPDATE `User` SET  avatar = ?1 WHERE id = ?2"));
	sqlite3_bind_text(_t2542, 1, data.str, data.len, 0);
sqlite3_bind_int(_t2542, 2, id);

		int _t2543 = sqlite3_step(_t2542);
		if( (_t2543 != SQLITE_OK) && (_t2543 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2541.conn)); }
		sqlite3_finalize(_t2542);
}

int main__App_create_empty_user(main__App* app, string username, string email) {
	main__User user = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = username,.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = false,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
	main__App_insert_user(app, user);
	Option_main__User _t2544 = main__App_find_user_by_username(app, user.username);
	if (!_t2544.ok) {
		string err = _t2544.v_error;
		int errcode = _t2544.ecode;
		main__App_info(app, tos_lit("User was not inserted"));
		return -1;
	}
	main__User u = *(main__User*)_t2544.data;
	if (string_ne(user.username, u.username)) {
		main__App_info(app, tos_lit("User was not inserted"));
		return -1;
	}
	main__Email mail = (main__Email){.id = 0,.user = u.id,.email = email,};
	main__App_insert_email(app, mail);
	return u.id;
}

void main__App_insert_user(main__App* app, main__User user) {
	
	// sql insert
	sqlite__DB _t2545 = app->db;
	sqlite3_stmt* _t2546 = sqlite__DB_init_stmt(_t2545, tos_lit("INSERT INTO `User` (`name`, `username`, `password`, `is_github`, `is_registered`, `is_blocked`, `is_admin`, `nr_namechanges`, `last_namechange_time`, `nr_posts`, `last_post_time`, `avatar`, `login_attempts`) values (?1, ?2, ?3, ?4, ?5, ?6, ?7, ?8, ?9, ?10, ?11, ?12, ?13)"));
	sqlite3_bind_text(_t2546, 1, user.name.str, user.name.len, 0);
	sqlite3_bind_text(_t2546, 2, user.username.str, user.username.len, 0);
	sqlite3_bind_text(_t2546, 3, user.password.str, user.password.len, 0);
	sqlite3_bind_int(_t2546, 4, user.is_github); // stmt
	sqlite3_bind_int(_t2546, 5, user.is_registered); // stmt
	sqlite3_bind_int(_t2546, 6, user.is_blocked); // stmt
	sqlite3_bind_int(_t2546, 7, user.is_admin); // stmt
	sqlite3_bind_int(_t2546, 8, user.nr_namechanges); // stmt
	sqlite3_bind_int(_t2546, 9, user.last_namechange_time); // stmt
	sqlite3_bind_int(_t2546, 10, user.nr_posts); // stmt
	sqlite3_bind_int(_t2546, 11, user.last_post_time); // stmt
	sqlite3_bind_text(_t2546, 12, user.avatar.str, user.avatar.len, 0);
	sqlite3_bind_int(_t2546, 13, user.login_attempts); // stmt
	
		int _t2547 = sqlite3_step(_t2546);
		if( (_t2547 != SQLITE_OK) && (_t2547 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2545.conn)); }
		sqlite3_finalize(_t2546);
}

void main__App_insert_email(main__App* app, main__Email email) {
	
	// sql insert
	sqlite__DB _t2548 = app->db;
	sqlite3_stmt* _t2549 = sqlite__DB_init_stmt(_t2548, tos_lit("INSERT INTO `Email` (`user`, `email`) values (?1, ?2)"));
	sqlite3_bind_int(_t2549, 1, email.user); // stmt
	sqlite3_bind_text(_t2549, 2, email.email.str, email.email.len, 0);
	
		int _t2550 = sqlite3_step(_t2549);
		if( (_t2550 != SQLITE_OK) && (_t2550 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2548.conn)); }
		sqlite3_finalize(_t2549);
}

void main__App_insert_sshkey(main__App* app, main__SshKey sshkey) {
	
	// sql insert
	sqlite__DB _t2551 = app->db;
	sqlite3_stmt* _t2552 = sqlite__DB_init_stmt(_t2551, tos_lit("INSERT INTO `SshKey` (`user`, `title`, `sshkey`, `is_deleted`) values (?1, ?2, ?3, ?4)"));
	sqlite3_bind_int(_t2552, 1, sshkey.user); // stmt
	sqlite3_bind_text(_t2552, 2, sshkey.title.str, sshkey.title.len, 0);
	sqlite3_bind_text(_t2552, 3, sshkey.sshkey.str, sshkey.sshkey.len, 0);
	sqlite3_bind_int(_t2552, 4, sshkey.is_deleted); // stmt
	
		int _t2553 = sqlite3_step(_t2552);
		if( (_t2553 != SQLITE_OK) && (_t2553 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2551.conn)); }
		sqlite3_finalize(_t2552);
}

void main__App_insert_contributor(main__App* app, main__Contributor contributor) {
	
	// sql insert
	sqlite__DB _t2554 = app->db;
	sqlite3_stmt* _t2555 = sqlite__DB_init_stmt(_t2554, tos_lit("INSERT INTO `Contributor` (`user`, `repo`) values (?1, ?2)"));
	sqlite3_bind_int(_t2555, 1, contributor.user); // stmt
	sqlite3_bind_int(_t2555, 2, contributor.repo); // stmt
	
		int _t2556 = sqlite3_step(_t2555);
		if( (_t2556 != SQLITE_OK) && (_t2556 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2554.conn)); }
		sqlite3_finalize(_t2555);
}

void main__App_remove_ssh_key(main__App* app, string title, int user_id) {
	
	// sql insert
	sqlite__DB _t2557 = app->db;
	sqlite3_stmt* _t2558 = sqlite__DB_init_stmt(_t2557, tos_lit("UPDATE `SshKey` SET  is_deleted = ?1 WHERE title = ?2 and user = ?3"));
	sqlite3_bind_int(_t2558, 1, 1);
sqlite3_bind_text(_t2558, 2, title.str, title.len, 0);
sqlite3_bind_int(_t2558, 3, user_id);

		int _t2559 = sqlite3_step(_t2558);
		if( (_t2559 != SQLITE_OK) && (_t2559 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2557.conn)); }
		sqlite3_finalize(_t2558);
}

void main__App_user_set_admin(main__App* app, int id) {
	
	// sql insert
	sqlite__DB _t2560 = app->db;
	sqlite3_stmt* _t2561 = sqlite__DB_init_stmt(_t2560, tos_lit("UPDATE `User` SET  is_admin = ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2561, 1, 1);
sqlite3_bind_int(_t2561, 2, id);

		int _t2562 = sqlite3_step(_t2561);
		if( (_t2562 != SQLITE_OK) && (_t2562 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2560.conn)); }
		sqlite3_finalize(_t2561);
}

void main__App_user_unset_admin(main__App* app, int id) {
	
	// sql insert
	sqlite__DB _t2563 = app->db;
	sqlite3_stmt* _t2564 = sqlite__DB_init_stmt(_t2563, tos_lit("UPDATE `User` SET  is_admin = ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2564, 1, 0);
sqlite3_bind_int(_t2564, 2, id);

		int _t2565 = sqlite3_step(_t2564);
		if( (_t2565 != SQLITE_OK) && (_t2565 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2563.conn)); }
		sqlite3_finalize(_t2564);
}

array_main__SshKey main__App_find_user_sshkeys(main__App* app, int id) {

	// sql select
	sqlite__DB _t2567 = app->db;
	sqlite3_stmt* _t2566 = sqlite__DB_init_stmt(_t2567, tos_lit("SELECT `id`, `user`, `title`, `sshkey`, `is_deleted` FROM `SshKey` WHERE user = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2566, 1, id);

	int _t2568 = sqlite3_extended_errcode(_t2567.conn);
	if (_t2568 != SQLITE_OK) { puts(sqlite3_errmsg(_t2567.conn)); }
	array_main__SshKey _t2569_array = __new_array(0, 10, sizeof(main__SshKey));
	while (1) {
		main__SshKey _t2569 = (main__SshKey) {
	.id = 0, .user = 0, .title = (string){.str=(byteptr)""}, .sshkey = (string){.str=(byteptr)""}, .is_deleted = 0};
	int _step_res_t2569 = sqlite3_step(_t2566);
		if (_step_res_t2569 == SQLITE_DONE) break;
		if (_step_res_t2569 == SQLITE_ROW) ;
		else if (_step_res_t2569 != SQLITE_OK) break;
	_t2569.id = sqlite3_column_int(_t2566, 0);
	_t2569.user = sqlite3_column_int(_t2566, 1);
	_t2569.title = tos_clone(sqlite3_column_text(_t2566, 2));
	_t2569.sshkey = tos_clone(sqlite3_column_text(_t2566, 3));
	_t2569.is_deleted = sqlite3_column_int(_t2566, 4);
		 array_push(&_t2569_array, _MOV((main__SshKey[]){ _t2569 }));
	}
	sqlite3_finalize(_t2566);
		return  _t2569_array; 
	;
}

string main__App_find_username_by_id(main__App* app, int id) {

	// sql select
	sqlite__DB _t2571 = app->db;
	sqlite3_stmt* _t2570 = sqlite__DB_init_stmt(_t2571, tos_lit("SELECT `id`, `name`, `username`, `password`, `is_github`, `is_registered`, `is_blocked`, `is_admin`, `nr_namechanges`, `last_namechange_time`, `nr_posts`, `last_post_time`, `avatar`, `login_attempts` FROM `User` WHERE id = ?1 ORDER BY id  LIMIT ?2"));
	sqlite3_bind_int(_t2570, 1, id);
sqlite3_bind_int(_t2570, 2, 1);

	int _t2572 = sqlite3_extended_errcode(_t2571.conn);
	if (_t2572 != SQLITE_OK) { puts(sqlite3_errmsg(_t2571.conn)); }
	main__User _t2573 = (main__User){
	.id = 0, .name = (string){.str=(byteptr)""}, .username = (string){.str=(byteptr)""}, .password = (string){.str=(byteptr)""}, .is_github = 0, .is_registered = 0, .is_blocked = 0, .is_admin = 0, .oauth_state = (string){.str=(byteptr)""}, .nr_namechanges = 0, .last_namechange_time = 0, .nr_posts = 0, .last_post_time = 0, .avatar = (string){.str=(byteptr)""}, .b_avatar = 0, .emails = __new_array(0, 1, sizeof(main__Email)), .login_attempts = 0};
	int _step_res_t2573 = sqlite3_step(_t2570);
		if (_step_res_t2573 == SQLITE_OK || _step_res_t2573 == SQLITE_ROW) {
	_t2573.id = sqlite3_column_int(_t2570, 0);
	_t2573.name = tos_clone(sqlite3_column_text(_t2570, 1));
	_t2573.username = tos_clone(sqlite3_column_text(_t2570, 2));
	_t2573.password = tos_clone(sqlite3_column_text(_t2570, 3));
	_t2573.is_github = sqlite3_column_int(_t2570, 4);
	_t2573.is_registered = sqlite3_column_int(_t2570, 5);
	_t2573.is_blocked = sqlite3_column_int(_t2570, 6);
	_t2573.is_admin = sqlite3_column_int(_t2570, 7);
	_t2573.nr_namechanges = sqlite3_column_int(_t2570, 8);
	_t2573.last_namechange_time = sqlite3_column_int(_t2570, 9);
	_t2573.nr_posts = sqlite3_column_int(_t2570, 10);
	_t2573.last_post_time = sqlite3_column_int(_t2570, 11);
	_t2573.avatar = tos_clone(sqlite3_column_text(_t2570, 12));
	_t2573.login_attempts = sqlite3_column_int(_t2570, 13);
	}
	sqlite3_finalize(_t2570);
		main__User user =  _t2573; 
	;
	return user.username;
}

Option_main__User main__App_find_user_by_username(main__App* app, string username) {

	// sql select
	sqlite__DB _t2575 = app->db;
	sqlite3_stmt* _t2574 = sqlite__DB_init_stmt(_t2575, tos_lit("SELECT `id`, `name`, `username`, `password`, `is_github`, `is_registered`, `is_blocked`, `is_admin`, `nr_namechanges`, `last_namechange_time`, `nr_posts`, `last_post_time`, `avatar`, `login_attempts` FROM `User` WHERE username = ?1 ORDER BY id "));
	sqlite3_bind_text(_t2574, 1, username.str, username.len, 0);

	int _t2576 = sqlite3_extended_errcode(_t2575.conn);
	if (_t2576 != SQLITE_OK) { puts(sqlite3_errmsg(_t2575.conn)); }
	array_main__User _t2577_array = __new_array(0, 10, sizeof(main__User));
	while (1) {
		main__User _t2577 = (main__User) {
	.id = 0, .name = (string){.str=(byteptr)""}, .username = (string){.str=(byteptr)""}, .password = (string){.str=(byteptr)""}, .is_github = 0, .is_registered = 0, .is_blocked = 0, .is_admin = 0, .oauth_state = (string){.str=(byteptr)""}, .nr_namechanges = 0, .last_namechange_time = 0, .nr_posts = 0, .last_post_time = 0, .avatar = (string){.str=(byteptr)""}, .b_avatar = 0, .emails = __new_array(0, 1, sizeof(main__Email)), .login_attempts = 0};
	int _step_res_t2577 = sqlite3_step(_t2574);
		if (_step_res_t2577 == SQLITE_DONE) break;
		if (_step_res_t2577 == SQLITE_ROW) ;
		else if (_step_res_t2577 != SQLITE_OK) break;
	_t2577.id = sqlite3_column_int(_t2574, 0);
	_t2577.name = tos_clone(sqlite3_column_text(_t2574, 1));
	_t2577.username = tos_clone(sqlite3_column_text(_t2574, 2));
	_t2577.password = tos_clone(sqlite3_column_text(_t2574, 3));
	_t2577.is_github = sqlite3_column_int(_t2574, 4);
	_t2577.is_registered = sqlite3_column_int(_t2574, 5);
	_t2577.is_blocked = sqlite3_column_int(_t2574, 6);
	_t2577.is_admin = sqlite3_column_int(_t2574, 7);
	_t2577.nr_namechanges = sqlite3_column_int(_t2574, 8);
	_t2577.last_namechange_time = sqlite3_column_int(_t2574, 9);
	_t2577.nr_posts = sqlite3_column_int(_t2574, 10);
	_t2577.last_post_time = sqlite3_column_int(_t2574, 11);
	_t2577.avatar = tos_clone(sqlite3_column_text(_t2574, 12));
	_t2577.login_attempts = sqlite3_column_int(_t2574, 13);
		 array_push(&_t2577_array, _MOV((main__User[]){ _t2577 }));
	}
	sqlite3_finalize(_t2574);
		array_main__User user =  _t2577_array; 
	;
	if (user.len == 0) {
		Option _t2578 = v_error(tos_lit("User not found"));
		return *(Option_main__User*)&_t2578;
	}
	main__User u = (*(main__User*)array_get(user, 0));
	array_main__Email emails = main__App_find_user_emails(app, u.id);
	u.emails = emails;
	Option_main__User _t2579;
	opt_ok2(&(main__User[]) { u }, (OptionBase*)(&_t2579), sizeof(main__User));
	return _t2579;
}

Option_main__User main__App_find_user_by_id(main__App* app, int id2) {

	// sql select
	sqlite__DB _t2581 = app->db;
	sqlite3_stmt* _t2580 = sqlite__DB_init_stmt(_t2581, tos_lit("SELECT `id`, `name`, `username`, `password`, `is_github`, `is_registered`, `is_blocked`, `is_admin`, `nr_namechanges`, `last_namechange_time`, `nr_posts`, `last_post_time`, `avatar`, `login_attempts` FROM `User` WHERE id = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2580, 1, id2);

	int _t2582 = sqlite3_extended_errcode(_t2581.conn);
	if (_t2582 != SQLITE_OK) { puts(sqlite3_errmsg(_t2581.conn)); }
	main__User _t2583 = (main__User){
	.id = 0, .name = (string){.str=(byteptr)""}, .username = (string){.str=(byteptr)""}, .password = (string){.str=(byteptr)""}, .is_github = 0, .is_registered = 0, .is_blocked = 0, .is_admin = 0, .oauth_state = (string){.str=(byteptr)""}, .nr_namechanges = 0, .last_namechange_time = 0, .nr_posts = 0, .last_post_time = 0, .avatar = (string){.str=(byteptr)""}, .b_avatar = 0, .emails = __new_array(0, 1, sizeof(main__Email)), .login_attempts = 0};
	int _step_res_t2583 = sqlite3_step(_t2580);
		if (_step_res_t2583 == SQLITE_OK || _step_res_t2583 == SQLITE_ROW) {
	_t2583.id = sqlite3_column_int(_t2580, 0);
	_t2583.name = tos_clone(sqlite3_column_text(_t2580, 1));
	_t2583.username = tos_clone(sqlite3_column_text(_t2580, 2));
	_t2583.password = tos_clone(sqlite3_column_text(_t2580, 3));
	_t2583.is_github = sqlite3_column_int(_t2580, 4);
	_t2583.is_registered = sqlite3_column_int(_t2580, 5);
	_t2583.is_blocked = sqlite3_column_int(_t2580, 6);
	_t2583.is_admin = sqlite3_column_int(_t2580, 7);
	_t2583.nr_namechanges = sqlite3_column_int(_t2580, 8);
	_t2583.last_namechange_time = sqlite3_column_int(_t2580, 9);
	_t2583.nr_posts = sqlite3_column_int(_t2580, 10);
	_t2583.last_post_time = sqlite3_column_int(_t2580, 11);
	_t2583.avatar = tos_clone(sqlite3_column_text(_t2580, 12));
	_t2583.login_attempts = sqlite3_column_int(_t2580, 13);
	}
	sqlite3_finalize(_t2580);
		main__User user =  _t2583; 
	;
	if (user.id == 0) {
		Option _t2584 = opt_none();
		return *(Option_main__User*)&_t2584;
	}
	array_main__Email emails = main__App_find_user_emails(app, user.id);
	user.emails = emails;
	Option_main__User _t2585;
	opt_ok2(&(main__User[]) { user }, (OptionBase*)(&_t2585), sizeof(main__User));
	return _t2585;
}

Option_main__User main__App_find_user_by_email(main__App* app, string email) {

	// sql select
	sqlite__DB _t2587 = app->db;
	sqlite3_stmt* _t2586 = sqlite__DB_init_stmt(_t2587, tos_lit("SELECT `id`, `user`, `email` FROM `Email` WHERE email = ?1 ORDER BY id "));
	sqlite3_bind_text(_t2586, 1, email.str, email.len, 0);

	int _t2588 = sqlite3_extended_errcode(_t2587.conn);
	if (_t2588 != SQLITE_OK) { puts(sqlite3_errmsg(_t2587.conn)); }
	array_main__Email _t2589_array = __new_array(0, 10, sizeof(main__Email));
	while (1) {
		main__Email _t2589 = (main__Email) {
	.id = 0, .user = 0, .email = (string){.str=(byteptr)""}};
	int _step_res_t2589 = sqlite3_step(_t2586);
		if (_step_res_t2589 == SQLITE_DONE) break;
		if (_step_res_t2589 == SQLITE_ROW) ;
		else if (_step_res_t2589 != SQLITE_OK) break;
	_t2589.id = sqlite3_column_int(_t2586, 0);
	_t2589.user = sqlite3_column_int(_t2586, 1);
	_t2589.email = tos_clone(sqlite3_column_text(_t2586, 2));
		 array_push(&_t2589_array, _MOV((main__Email[]){ _t2589 }));
	}
	sqlite3_finalize(_t2586);
		array_main__Email emails =  _t2589_array; 
	;
	if (emails.len != 1) {
		Option _t2590 = v_error(tos_lit("Email do not exist"));
		return *(Option_main__User*)&_t2590;
	}
	return main__App_find_user_by_id(app, (*(main__Email*)array_get(emails, 0)).user);
}

array_main__Email main__App_find_user_emails(main__App* app, int id2) {

	// sql select
	sqlite__DB _t2592 = app->db;
	sqlite3_stmt* _t2591 = sqlite__DB_init_stmt(_t2592, tos_lit("SELECT `id`, `user`, `email` FROM `Email` WHERE user = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2591, 1, id2);

	int _t2593 = sqlite3_extended_errcode(_t2592.conn);
	if (_t2593 != SQLITE_OK) { puts(sqlite3_errmsg(_t2592.conn)); }
	array_main__Email _t2594_array = __new_array(0, 10, sizeof(main__Email));
	while (1) {
		main__Email _t2594 = (main__Email) {
	.id = 0, .user = 0, .email = (string){.str=(byteptr)""}};
	int _step_res_t2594 = sqlite3_step(_t2591);
		if (_step_res_t2594 == SQLITE_DONE) break;
		if (_step_res_t2594 == SQLITE_ROW) ;
		else if (_step_res_t2594 != SQLITE_OK) break;
	_t2594.id = sqlite3_column_int(_t2591, 0);
	_t2594.user = sqlite3_column_int(_t2591, 1);
	_t2594.email = tos_clone(sqlite3_column_text(_t2591, 2));
		 array_push(&_t2594_array, _MOV((main__Email[]){ _t2594 }));
	}
	sqlite3_finalize(_t2591);
		array_main__Email emails =  _t2594_array; 
	;
	return emails;
}

array_main__Contributor main__App_find_repo_contributor(main__App* app, int id) {

	// sql select
	sqlite__DB _t2596 = app->db;
	sqlite3_stmt* _t2595 = sqlite__DB_init_stmt(_t2596, tos_lit("SELECT `id`, `user`, `repo` FROM `Contributor` WHERE repo = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2595, 1, id);

	int _t2597 = sqlite3_extended_errcode(_t2596.conn);
	if (_t2597 != SQLITE_OK) { puts(sqlite3_errmsg(_t2596.conn)); }
	array_main__Contributor _t2598_array = __new_array(0, 10, sizeof(main__Contributor));
	while (1) {
		main__Contributor _t2598 = (main__Contributor) {
	.id = 0, .user = 0, .repo = 0};
	int _step_res_t2598 = sqlite3_step(_t2595);
		if (_step_res_t2598 == SQLITE_DONE) break;
		if (_step_res_t2598 == SQLITE_ROW) ;
		else if (_step_res_t2598 != SQLITE_OK) break;
	_t2598.id = sqlite3_column_int(_t2595, 0);
	_t2598.user = sqlite3_column_int(_t2595, 1);
	_t2598.repo = sqlite3_column_int(_t2595, 2);
		 array_push(&_t2598_array, _MOV((main__Contributor[]){ _t2598 }));
	}
	sqlite3_finalize(_t2595);
		return  _t2598_array; 
	;
}

array_main__User main__App_find_repo_registered_contributor(main__App* app, int id) {

	// sql select
	sqlite__DB _t2600 = app->db;
	sqlite3_stmt* _t2599 = sqlite__DB_init_stmt(_t2600, tos_lit("SELECT `id`, `user`, `repo` FROM `Contributor` WHERE repo = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2599, 1, id);

	int _t2601 = sqlite3_extended_errcode(_t2600.conn);
	if (_t2601 != SQLITE_OK) { puts(sqlite3_errmsg(_t2600.conn)); }
	array_main__Contributor _t2602_array = __new_array(0, 10, sizeof(main__Contributor));
	while (1) {
		main__Contributor _t2602 = (main__Contributor) {
	.id = 0, .user = 0, .repo = 0};
	int _step_res_t2602 = sqlite3_step(_t2599);
		if (_step_res_t2602 == SQLITE_DONE) break;
		if (_step_res_t2602 == SQLITE_ROW) ;
		else if (_step_res_t2602 != SQLITE_OK) break;
	_t2602.id = sqlite3_column_int(_t2599, 0);
	_t2602.user = sqlite3_column_int(_t2599, 1);
	_t2602.repo = sqlite3_column_int(_t2599, 2);
		 array_push(&_t2602_array, _MOV((main__Contributor[]){ _t2602 }));
	}
	sqlite3_finalize(_t2599);
		array_main__Contributor contributors =  _t2602_array; 
	;
	array_main__User users = __new_array_with_default(0, contributors.len, sizeof(main__User), 0);
	// FOR IN array
	array _t2603 = contributors;
	for (int _t2604 = 0; _t2604 < _t2603.len; ++_t2604) {
		main__Contributor contrib = ((main__Contributor*)_t2603.data)[_t2604];
		Option_main__User _t2605 = main__App_find_user_by_id(app, contrib.user);
		if (!_t2605.ok) {
			string err = _t2605.v_error;
			int errcode = _t2605.ecode;
			continue;
		}
		main__User x = *(main__User*)_t2605.data;
		array_push(&users, _MOV((main__User[]){ x }));
	}
	return users;
}

array_main__User main__App_find_registered_user(main__App* app) {

	// sql select
	sqlite__DB _t2608 = app->db;
	sqlite3_stmt* _t2607 = sqlite__DB_init_stmt(_t2608, tos_lit("SELECT `id`, `name`, `username`, `password`, `is_github`, `is_registered`, `is_blocked`, `is_admin`, `nr_namechanges`, `last_namechange_time`, `nr_posts`, `last_post_time`, `avatar`, `login_attempts` FROM `User` WHERE is_registered = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2607, 1, 1);

	int _t2609 = sqlite3_extended_errcode(_t2608.conn);
	if (_t2609 != SQLITE_OK) { puts(sqlite3_errmsg(_t2608.conn)); }
	array_main__User _t2610_array = __new_array(0, 10, sizeof(main__User));
	while (1) {
		main__User _t2610 = (main__User) {
	.id = 0, .name = (string){.str=(byteptr)""}, .username = (string){.str=(byteptr)""}, .password = (string){.str=(byteptr)""}, .is_github = 0, .is_registered = 0, .is_blocked = 0, .is_admin = 0, .oauth_state = (string){.str=(byteptr)""}, .nr_namechanges = 0, .last_namechange_time = 0, .nr_posts = 0, .last_post_time = 0, .avatar = (string){.str=(byteptr)""}, .b_avatar = 0, .emails = __new_array(0, 1, sizeof(main__Email)), .login_attempts = 0};
	int _step_res_t2610 = sqlite3_step(_t2607);
		if (_step_res_t2610 == SQLITE_DONE) break;
		if (_step_res_t2610 == SQLITE_ROW) ;
		else if (_step_res_t2610 != SQLITE_OK) break;
	_t2610.id = sqlite3_column_int(_t2607, 0);
	_t2610.name = tos_clone(sqlite3_column_text(_t2607, 1));
	_t2610.username = tos_clone(sqlite3_column_text(_t2607, 2));
	_t2610.password = tos_clone(sqlite3_column_text(_t2607, 3));
	_t2610.is_github = sqlite3_column_int(_t2607, 4);
	_t2610.is_registered = sqlite3_column_int(_t2607, 5);
	_t2610.is_blocked = sqlite3_column_int(_t2607, 6);
	_t2610.is_admin = sqlite3_column_int(_t2607, 7);
	_t2610.nr_namechanges = sqlite3_column_int(_t2607, 8);
	_t2610.last_namechange_time = sqlite3_column_int(_t2607, 9);
	_t2610.nr_posts = sqlite3_column_int(_t2607, 10);
	_t2610.last_post_time = sqlite3_column_int(_t2607, 11);
	_t2610.avatar = tos_clone(sqlite3_column_text(_t2607, 12));
	_t2610.login_attempts = sqlite3_column_int(_t2607, 13);
		 array_push(&_t2610_array, _MOV((main__User[]){ _t2610 }));
	}
	sqlite3_finalize(_t2607);
		array_main__User users =  _t2610_array; 
	;
	// FOR IN array
	array _t2611 = users;
	for (int i = 0; i < _t2611.len; ++i) {
		main__User user = ((main__User*)_t2611.data)[i];
		(*(main__User*)array_get(users, i)).emails = main__App_find_user_emails(app, user.id);
	}
	return users;
}

int main__App_nr_repo_contributor(main__App* app, int id) {

	// sql select
	sqlite__DB _t2613 = app->db;
	sqlite3_stmt* _t2612 = sqlite__DB_init_stmt(_t2613, tos_lit("SELECT COUNT(*) FROM `Contributor`  WHERE repo = ?1 ORDER BY id "));
	sqlite3_bind_int(_t2612, 1, id);

	int _t2614 = sqlite3_extended_errcode(_t2613.conn);
	if (_t2614 != SQLITE_OK) { puts(sqlite3_errmsg(_t2613.conn)); }
		return  sqlite__get_int_from_stmt(_t2612);
	;
}

void main__App_inc_user_post(main__App* app, main__User* user) {
	user->nr_posts++;
	main__User u = *user;
	int id = u.id;
	int now = ((int)(time__now().v_unix));
	int lastplus = ((int)(time__Time_add_days(time__unix(u.last_post_time), 1).v_unix));
	if (now >= lastplus) {
		user->last_post_time = now;
		
	// sql insert
		sqlite__DB _t2615 = app->db;
		sqlite3_stmt* _t2616 = sqlite__DB_init_stmt(_t2615, tos_lit("UPDATE `User` SET  nr_posts = ?1,  last_post_time = ?2 WHERE id = ?3"));
		sqlite3_bind_int(_t2616, 1, 0);
sqlite3_bind_int(_t2616, 2, now);
sqlite3_bind_int(_t2616, 3, id);

			int _t2617 = sqlite3_step(_t2616);
			if( (_t2617 != SQLITE_OK) && (_t2617 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2615.conn)); }
			sqlite3_finalize(_t2616);
	}
	
	// sql insert
	sqlite__DB _t2618 = app->db;
	sqlite3_stmt* _t2619 = sqlite__DB_init_stmt(_t2618, tos_lit("UPDATE `User` SET  nr_posts = nr_posts + ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2619, 1, 1);
sqlite3_bind_int(_t2619, 2, id);

		int _t2620 = sqlite3_step(_t2619);
		if( (_t2620 != SQLITE_OK) && (_t2620 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2618.conn)); }
		sqlite3_finalize(_t2619);
}

void main__App_inc_user_login_attempts(main__App* app, int user_id) {
	
	// sql insert
	sqlite__DB _t2621 = app->db;
	sqlite3_stmt* _t2622 = sqlite__DB_init_stmt(_t2621, tos_lit("UPDATE `User` SET  login_attempts = login_attempts + ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2622, 1, 1);
sqlite3_bind_int(_t2622, 2, user_id);

		int _t2623 = sqlite3_step(_t2622);
		if( (_t2623 != SQLITE_OK) && (_t2623 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2621.conn)); }
		sqlite3_finalize(_t2622);
}

void main__App_update_user_login_attempts(main__App* app, int user_id, int attempts) {
	
	// sql insert
	sqlite__DB _t2624 = app->db;
	sqlite3_stmt* _t2625 = sqlite__DB_init_stmt(_t2624, tos_lit("UPDATE `User` SET  login_attempts = ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2625, 1, attempts);
sqlite3_bind_int(_t2625, 2, user_id);

		int _t2626 = sqlite3_step(_t2625);
		if( (_t2626 != SQLITE_OK) && (_t2626 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2624.conn)); }
		sqlite3_finalize(_t2625);
}

void main__App_block_user(main__App* app, int user_id) {
	
	// sql insert
	sqlite__DB _t2627 = app->db;
	sqlite3_stmt* _t2628 = sqlite__DB_init_stmt(_t2627, tos_lit("UPDATE `User` SET  is_blocked = ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2628, 1, 1);
sqlite3_bind_int(_t2628, 2, user_id);

		int _t2629 = sqlite3_step(_t2628);
		if( (_t2629 != SQLITE_OK) && (_t2629 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2627.conn)); }
		sqlite3_finalize(_t2628);
}

void main__App_unblock_user(main__App* app, int user_id) {
	
	// sql insert
	sqlite__DB _t2630 = app->db;
	sqlite3_stmt* _t2631 = sqlite__DB_init_stmt(_t2630, tos_lit("UPDATE `User` SET  is_blocked = ?1 WHERE id = ?2"));
	sqlite3_bind_int(_t2631, 1, 0);
sqlite3_bind_int(_t2631, 2, user_id);

		int _t2632 = sqlite3_step(_t2631);
		if( (_t2632 != SQLITE_OK) && (_t2632 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2630.conn)); }
		sqlite3_finalize(_t2631);
}

bool main__App_check_user_blocked(main__App* app, int user_id) {
	Option_main__User _t2633 = main__App_find_user_by_id(app, user_id);
	if (!_t2633.ok) {
		string err = _t2633.v_error;
		int errcode = _t2633.ecode;
		return false;
	}
	main__User user = *(main__User*)_t2633.data;
	return user.is_blocked;
}

Option_string main__App_client_ip(main__App* app, string username) {
	Option_string _t2634 = net__Socket_peer_ip(app->vweb.conn);
	if (!_t2634.ok) {
		string err = _t2634.v_error;
		int errcode = _t2634.ecode;
		Option _t2635 = opt_none();
		return *(Option_string*)&_t2635;
	}
	string ip = *(string*)_t2634.data;
	Option_string _t2636;
	opt_ok2(&(string[]) { main__make_password(ip, _STR("%.*s\000token", 2, username)) }, (OptionBase*)(&_t2636), sizeof(string));
	return _t2636;
}

static void main__App_change_username(main__App* app, int user_id, string username) {
	
	// sql insert
	sqlite__DB _t2637 = app->db;
	sqlite3_stmt* _t2638 = sqlite__DB_init_stmt(_t2637, tos_lit("UPDATE `User` SET  username = ?1 WHERE id = ?2"));
	sqlite3_bind_text(_t2638, 1, username.str, username.len, 0);
sqlite3_bind_int(_t2638, 2, user_id);

		int _t2639 = sqlite3_step(_t2638);
		if( (_t2639 != SQLITE_OK) && (_t2639 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2637.conn)); }
		sqlite3_finalize(_t2638);
	
	// sql insert
	sqlite__DB _t2640 = app->db;
	sqlite3_stmt* _t2641 = sqlite__DB_init_stmt(_t2640, tos_lit("UPDATE `Repo` SET  user_name = ?1 WHERE user_id = ?2"));
	sqlite3_bind_text(_t2641, 1, username.str, username.len, 0);
sqlite3_bind_int(_t2641, 2, user_id);

		int _t2642 = sqlite3_step(_t2641);
		if( (_t2642 != SQLITE_OK) && (_t2642 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2640.conn)); }
		sqlite3_finalize(_t2641);
}

static void main__App_inc_namechanges(main__App* app, int user_id) {
	int now = ((int)(time__now().v_unix));
	
	// sql insert
	sqlite__DB _t2643 = app->db;
	sqlite3_stmt* _t2644 = sqlite__DB_init_stmt(_t2643, tos_lit("UPDATE `User` SET  nr_namechanges = nr_namechanges + ?1,  last_namechange_time = ?2 WHERE id = ?3"));
	sqlite3_bind_int(_t2644, 1, 1);
sqlite3_bind_int(_t2644, 2, now);
sqlite3_bind_int(_t2644, 3, user_id);

		int _t2645 = sqlite3_step(_t2644);
		if( (_t2645 != SQLITE_OK) && (_t2645 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2643.conn)); }
		sqlite3_finalize(_t2644);
}

static multi_return_bool_main__User main__App_check_username(main__App* app, string user) {
	if (user.len == 0) {
		return (multi_return_bool_main__User){.arg0=false, .arg1=(main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,}};
	}
	Option_main__User _t2646 = main__App_find_user_by_username(app, user);
	if (!_t2646.ok) {
		string err = _t2646.v_error;
		int errcode = _t2646.ecode;
		return (multi_return_bool_main__User){.arg0=false, .arg1=(main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,}};
	}
	main__User u = *(main__User*)_t2646.data;
	u.b_avatar = string_ne(u.avatar, tos_lit(""));
	if (!u.b_avatar) {
		u.avatar = byte_str((*(byte*)array_get(string_bytes(u.username), 0)));
	}
	return (multi_return_bool_main__User){.arg0=u.is_registered, .arg1=u};
}

// Attr: [/:username]
vweb__Result main__App_user(main__App* app, string username) {
	println(_STR("user() name=%.*s", 1, username));
	app->show_menu = false;
	multi_return_bool_main__User mr_478 = main__App_check_username(app, username);
	bool exists = mr_478.arg0;
	main__User u = mr_478.arg1;
	if (!exists) {
		return vweb__Context_not_found(&app->vweb);
	}
	main__User user = u;
		strings__Builder sb = strings__new_builder(6690);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<div class=\"avatar\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		if (user.b_avatar) {
			strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(user.avatar)));
		} else {
			strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(user.avatar)));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n<h3> %.*s\000 </h3>\n<h4> %.*s\000 </h4>\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 5, vweb__filter(user.username), vweb__filter(user.name), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_user = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_user); strings__Builder_free(&sb); string_free(&_tmpl_res_user);
	;
}

// Attr: [/:username/repos]
vweb__Result main__App_user_repos(main__App* app, string username) {
	multi_return_bool_main__User mr_688 = main__App_check_username(app, username);
	bool exists = mr_688.arg0;
	main__User u = mr_688.arg1;
	if (!exists) {
		return vweb__Context_not_found(&app->vweb);
	}
	main__User user = u;
	array_main__Repo repos = main__App_find_user_repos(app, user.id);
		strings__Builder sb = strings__new_builder(6990);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<div class=\"avatar\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		if (user.b_avatar) {
			strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(user.avatar)));
		} else {
			strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(user.avatar)));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n<h3> %.*s\000 s repositories</h3>\n\n", 2, vweb__filter(user.username)));
		if (repos.len > 0) {
			strings__Builder_write(&sb, tos_lit("\n"));
			// FOR IN array
			array _t2647 = repos;
			for (int _t2648 = 0; _t2648 < _t2647.len; ++_t2648) {
				main__Repo repo = ((main__Repo*)_t2647.data)[_t2648];
				strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/%.*s\000\" class=\"userrepo\">\n<h3>%.*s\000</h3>\n<p>%.*s\000</p>\n</a>\n", 5, vweb__filter(user.username), vweb__filter(repo.name), vweb__filter(repo.name), vweb__filter(repo.description)));
			}
			strings__Builder_write(&sb, tos_lit("\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<h2>No repositories</h2>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 3, vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_user_repos = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_user_repos); strings__Builder_free(&sb); string_free(&_tmpl_res_user_repos);
	;
}

// Attr: [/:username/issues]
// Attr: [/:username/issues/:page_str]
vweb__Result main__App_user_issues(main__App* app, string username, string page_str) {
	if (!app->logged_in) {
		return vweb__Context_not_found(&app->vweb);
	}
	if (string_ne(app->user.username, username)) {
		return vweb__Context_not_found(&app->vweb);
	}
	multi_return_bool_main__User mr_1103 = main__App_check_username(app, username);
	bool exists = mr_1103.arg0;
	main__User u = mr_1103.arg1;
	if (!exists) {
		return vweb__Context_not_found(&app->vweb);
	}
	main__User user = u;
	int page = (page_str.len >= 1 ? (string_int(page_str)) : (0));
	array_main__Issue issues = main__App_find_user_issues(app, user.id);
	bool first = false;
	bool last = false;
	// FOR IN array
	array _t2649 = issues;
	for (int i = 0; i < _t2649.len; ++i) {
		main__Issue issue = ((main__Issue*)_t2649.data)[i];
		(*(main__Issue*)array_get(issues, i)).author_name = username;
		main__Repo repo = main__App_find_repo_by_id(app, issue.repo_id);
		(*(main__Issue*)array_get(issues, i)).repo_author = repo.user_name;
		(*(main__Issue*)array_get(issues, i)).repo_name = repo.name;
	}
	if (issues.len > _const_main__commits_per_page) {
		int offset = page * _const_main__commits_per_page;
		int delta = issues.len - offset;
		if (delta > 0) {
			if (delta == issues.len && page == 0) {
				first = true;
			} else {
				last = true;
			}
		}
	} else {
		last = true;
		first = true;
	}
	int last_site = 0;
	if (page > 0) {
		last_site = page - 1;
	}
	int next_site = page + 1;
		strings__Builder sb = strings__new_builder(7950);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<div class=\"avatar\">\n", 13, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header)));
		if (user.b_avatar) {
			strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(user.avatar)));
		} else {
			strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(user.avatar)));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n<h3> %.*s\000 s issues</h3>\n\n<div class=\"commit-day\">\n</div>\n\n<div class=\"clog-block\">\n", 2, vweb__filter(user.username)));
		// FOR IN array
		array _t2650 = issues;
		for (int _t2651 = 0; _t2651 < _t2650.len; ++_t2651) {
			main__Issue issue = ((main__Issue*)_t2650.data)[_t2651];
			strings__Builder_write(&sb, _STR("\n<div class=\"clog\">\n<div class=\"clog-msg\">\n<a href=\"/%.*s\000/%.*s\000/issue/%"PRId32"\000\">%.*s\000</a>\n</div>\n<span class=\"clog-author\">\n#%"PRId32"\000 opened %.*s\000\nby %.*s\000\n</span>\n", 8, vweb__filter(issue.repo_author), vweb__filter(issue.repo_name), issue.id, vweb__filter(issue.title), issue.id, vweb__filter(main__Issue_relative_time(&issue)), vweb__filter(issue.author_name)));
			if (issue.nr_comments > 0) {
				strings__Builder_write(&sb, tos_lit("\n<div class=\"comments\">\n"));
				if (issue.nr_comments == 1) {
					strings__Builder_write(&sb, _STR("\n%"PRId32"\000 comment\n", 2, issue.nr_comments));
				} else {
					strings__Builder_write(&sb, _STR("\n%"PRId32"\000 comments\n", 2, issue.nr_comments));
				}
				strings__Builder_write(&sb, tos_lit("\n</div>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n\n<div class=\"buttons\">\n<br>\n"));
		if (first) {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/issues/%"PRId32"\000\" class=\"button disabled\">Prev</a>\n", 3, vweb__filter(app->user.username), last_site));
		} else {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/issues/%"PRId32"\000\" class=\"button\">Prev</a>/\n", 3, vweb__filter(app->user.username), last_site));
		}
		strings__Builder_write(&sb, tos_lit("\n\n"));
		if (last) {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/issues/%"PRId32"\000\" class=\"button disabled\">Next</a>\n", 3, vweb__filter(app->user.username), next_site));
		} else {
			strings__Builder_write(&sb, _STR("\n<a href=\"/%.*s\000/issues/%"PRId32"\000\" class=\"button\">Next</a>\n", 3, vweb__filter(app->user.username), next_site));
		}
		strings__Builder_write(&sb, _STR("\n</div>\n\n\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 3, vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_user_issues = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_user_issues); strings__Builder_free(&sb); string_free(&_tmpl_res_user_issues);
	;
}

// Attr: [/:user/settings]
vweb__Result main__App_user_settings(main__App* app, string user) {
		strings__Builder sb = strings__new_builder(6780);
		string header = tos_lit(" ");
		{string _ = header;}
		;
		string footer = tos_lit(" ");
		{string _ = footer;}
		;
		strings__Builder_write(&sb, _STR("<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<title>Gitly</title>\n<link rel=\"icon\" type=\"image/svg+xml\" href=\"/favicon.svg\" sizes=\"any\">\n<script>\nvar repoName = \"%.*s\000\"\nvar branch = \"%.*s\000\"\nvar path = \"%.*s\000\"\n//var isTopFiles = {{.IsTopFiles}}\n\nvar fetchurl = \"/%.*s\000/tree-data?branch=%.*s\000&path=%.*s\000\"\n\nvar sshUrl = \"ssh://git&#64;gitly.org/%.*s\000/%.*s\000\"\nvar httpsUrl = \"https://%.*s\000&#64;gitly.org/%.*s\000\"\n</script>\n\n", 11, vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.name), vweb__filter(app->repo.primary_branch), vweb__filter(app->path), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
		if (app->is_tree) {
			strings__Builder_write(&sb, tos_lit("\n<script src=\"/jquery.js\"></script>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n\n<link href=\"//fonts.googleapis.com/css?family=Roboto:400,300,100,200,500,700\" rel=\"stylesheet\" type=\"text/css\">\n<link href=\"/gitly.css?3\" rel=\"stylesheet\" type=\"text/css\">\n</head>\n<body>\n\n<div id=\"header\">\n<a id=\"mainlogo\" href=\"/\">Gitly</a>\n<div class=\"content\">\n&nbsp;&nbsp;\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, tos_lit("\n"));
			if (string_ne(app->repo.user_name, tos_lit(""))) {
				strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"https://gitly.org/%.*s\000\">%.*s\000</a> /\n-->\n<a href=\"/%.*s\000\">%.*s\000</a> /\n", 5, vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.user_name)));
			}
			strings__Builder_write(&sb, _STR("\n<!--\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n", 7, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name)));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"new\">\n<a href=\"/new\">New repo</a>\n</div>\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n<div class=\"user\" tabindex=\"0\">\n"));
		if (app->logged_in) {
			strings__Builder_write(&sb, tos_lit("\n<div class=\"avatar\">\n"));
			if (app->user.b_avatar) {
				strings__Builder_write(&sb, _STR("\n<img src=\"%.*s\000\">\n", 2, vweb__filter(app->user.avatar)));
			} else {
				strings__Builder_write(&sb, _STR("\n<span>%.*s\000</span>\n", 2, vweb__filter(app->user.avatar)));
			}
			strings__Builder_write(&sb, _STR("\n</div>\n<div class=\"header-dropdown\">\n<div class=\"username\">\n<span>Signed in as</span>\n<a href=\"/%.*s\000\">%.*s\000</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/repos\" class=\"link\">Repositories</a>\n<a href=\"/%.*s\000/issues\" class=\"link\">Issues</a>\n<a href=\"/%.*s\000/prs\" class=\"link\">Pull requests</a>\n</div>\n<div class=\"links\">\n<a href=\"/%.*s\000/settings\" class=\"link\">Settings</a>\n</div>\n", 7, vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(app->user.username)));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, tos_lit("\n<a href=\"/admin\" class=\"link\">Admin Panel</a>\n"));
			}
			strings__Builder_write(&sb, tos_lit("\n<div class=\"links\">\n<a href=\"/logout\" class=\"link\">Sign out</a>\n</div>\n<div class=\"dropdown-hoverzone\"></div>\n</div>\n"));
		} else {
			strings__Builder_write(&sb, tos_lit("\n<a href=\"/login\" class=\"login-button\">Sign in</a>\n<!--\n<a href=\"/register\">Register</a>\n-->\n"));
		}
		strings__Builder_write(&sb, tos_lit("\n</div>\n</div>\n\n\n\n<div class=\"content\">\n<!-- don\"t show the path on the index page -->\n"));
		if (string_ne(app->path, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\n<div class=\"tree-path\">\n<!--\n<a href=\"/%.*s\000\">%.*s\000</a>\n-->\n<a href=\"/%.*s\000/%.*s\000\">%.*s\000</a>\n%.*s\000\n</div>\n", 7, vweb__filter(app->repo.name), vweb__filter(app->repo.name), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), vweb__filter(app->repo.name), app->html_path));
		}
		strings__Builder_write(&sb, tos_lit("\n\n\n<!--\n<div class=\"repo-stats\">\n-->\n\n"));
		if (app->show_menu) {
			strings__Builder_write(&sb, _STR("\n<div class=\"repo-stats\">\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n", 19, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), vweb__filter(app->repo.user_name), vweb__filter(app->repo.name), main__Repo_nr_releases_fmt(&app->repo)));
			if (app->repo.user_id == app->user.id) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/settings\">\nSettings\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n\n"));
			if (app->user.is_admin) {
				strings__Builder_write(&sb, _STR("\n<a class=\"menu\" href=\"/%.*s\000/%.*s\000/update\">\nUpdate\n</a>\n", 3, vweb__filter(app->repo.user_name), vweb__filter(app->repo.name)));
			}
			strings__Builder_write(&sb, tos_lit("\n</div>\n"));
		}
		strings__Builder_write(&sb, _STR("\n\n<div style=\"display:none\" class=\"repo-stats\">\n<!--\n<a class=\"menu\" href=\"/%.*s\000/commits\">\n-->\n<a class=\"menu\" href=\"/commits\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/issues\">\n-->\n<a class=\"menu\" href=\"/issues\">\n<svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"exclamation-circle\" class=\"svg-inline--fa fa-exclamation-circle fa-w-16\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path fill=\"currentColor\" d=\"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z\"></path></svg>\n%.*s\000\n</a>\n<!--\n<a class=\"menu\" href=\"/%.*s\000/pulls\">\n-->\n<a class=\"menu\" href=\"/pulls\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 768 1024\"><path fill=\"currentColor\" d=\"M640 448c-47.625 0-88.625 26.312-110.625 64.906C523.625 512.5 518 512 512 512c-131.062 0-255.438-99.844-300.812-223.438C238.469 265.09400000000005 256 230.71900000000005 256 192c0-70.656-57.344-128-128-128S0 121.34400000000005 0 192c0 47.219 25.844 88.062 64 110.281V721.75C25.844 743.938 0 784.75 0 832c0 70.625 57.344 128 128 128s128-57.375 128-128c0-47.25-25.844-88.062-64-110.25V491.469C276.156 580.5 392.375 640 512 640c6.375 0 11.625-0.438 17.375-0.625C551.5 677.812 592.5 704 640 704c70.625 0 128-57.375 128-128C768 505.344 710.625 448 640 448zM128 896c-35.312 0-64-28.625-64-64 0-35.312 28.688-64 64-64 35.406 0 64 28.688 64 64C192 867.375 163.406 896 128 896zM128 256c-35.312 0-64-28.594-64-64s28.688-64 64-64c35.406 0 64 28.594 64 64S163.406 256 128 256zM640 640c-35.312 0-64-28.625-64-64 0-35.406 28.688-64 64-64 35.375 0 64 28.594 64 64C704 611.375 675.375 640 640 640z\" /></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/contributors\">\n-->\n<a class=\"menu\" href=\"/contributors\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M192 256c61.9 0 112-50.1 112-112S253.9 32 192 32 80 82.1 80 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C51.6 288 0 339.6 0 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zM480 256c53 0 96-43 96-96s-43-96-96-96-96 43-96 96 43 96 96 96zm48 32h-3.8c-13.9 4.8-28.6 8-44.2 8s-30.3-3.2-44.2-8H432c-20.4 0-39.2 5.9-55.7 15.4 24.4 26.3 39.7 61.2 39.7 99.8v38.4c0 2.2-.5 4.3-.6 6.4H592c26.5 0 48-21.5 48-48 0-61.9-50.1-112-112-112z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/%.*s\000/releases\">\n-->\n<a class=\"menu\" href=\"/branches\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\"><path fill=\"currentColor\" d=\"M384 144c0-44.2-35.8-80-80-80s-80 35.8-80 80c0 36.4 24.3 67.1 57.5 76.8-.6 16.1-4.2 28.5-11 36.9-15.4 19.2-49.3 22.4-85.2 25.7-28.2 2.6-57.4 5.4-81.3 16.9v-144c32.5-10.2 56-40.5 56-76.3 0-44.2-35.8-80-80-80S0 35.8 0 80c0 35.8 23.5 66.1 56 76.3v199.3C23.5 365.9 0 396.2 0 432c0 44.2 35.8 80 80 80s80-35.8 80-80c0-34-21.2-63.1-51.2-74.6 3.1-5.2 7.8-9.8 14.9-13.4 16.2-8.2 40.4-10.4 66.1-12.8 42.2-3.9 90-8.4 118.2-43.4 14-17.4 21.1-39.8 21.6-67.9 31.6-10.8 54.4-40.7 54.4-75.9zM80 64c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16zm0 384c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16zm224-320c8.8 0 16 7.2 16 16s-7.2 16-16 16-16-7.2-16-16 7.2-16 16-16z\"></path></svg>\n%.*s\000\n</a>\n\n<!--\n<a class=\"menu\" href=\"/reponame/settings\">Settings</a>\n-->\n<a class=\"menu\" href=\"/releases\">\n<svg aria-hidden=\"true\" focusable=\"false\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 640 512\"><path fill=\"currentColor\" d=\"M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z\"></path></svg>\n%.*s\000\n</a>\n\n</div>%.*s\000\n\n<h2>User settings</h2>\n\n<div class=\"div-center\">\n<div class=\"form-error\">\n%.*s\000\n</div>\n\n<form action=\"/%.*s\000/settings_post\" method=\"post\">\n<input type=\"text\" name=\"name\" value=\"%.*s\000\">\n<input type=\"submit\" value=\"Save settings\">\n</form>\n</div>\n\n%.*s\000</div>\n<div id=\"footer\">\n<div class=\"content\">\nPowered by <a target=_blank href=\"https://gitly.org\">gitly.org</a>%.*s\000.\nWritten in <a target=_blank href=\"https://vlang.io\">V</a>.\n", 18, vweb__filter(app->repo.name), main__Repo_nr_commits_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_issues_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_open_prs_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_contributors_fmt(&app->repo), vweb__filter(app->repo.name), main__Repo_nr_branches_fmt(&app->repo), main__Repo_nr_releases_fmt(&app->repo), vweb__filter(header), vweb__filter(app->vweb.form_error), vweb__filter(app->user.username), vweb__filter(app->user.username), vweb__filter(footer), vweb__filter(app->version)));
		if (string_ne(app->page_gen_time, tos_lit(""))) {
			strings__Builder_write(&sb, _STR("\nPage generated in %.*s\000.\n", 2, vweb__filter(app->page_gen_time)));
		}
		strings__Builder_write(&sb, tos_lit("\n<div style=\"float:right\">\nSource code:\n<a target=_blank href=\"https://github.com/vlang/gitly\"\n>github.com/vlang/gitly</a>\n</div>\n</div>\n</div>\n</body>\n</html>\n"));
		string _tmpl_res_user_settings = strings__Builder_str(&sb);
	vweb__Context_html(&app->vweb, _tmpl_res_user_settings); strings__Builder_free(&sb); string_free(&_tmpl_res_user_settings);
	;
}

// Attr: [post]
// Attr: [/:user/settings]
vweb__Result main__App_update_user_settings(main__App* app, string user) {
	if (!app->logged_in || string_ne(user, app->user.username)) {
		return main__App_r_home(app);
	}
	string name = (_IN_MAP(tos_lit("name"), app->vweb.form) ? ((*(string*)map_get(app->vweb.form, tos_lit("name"), &(string[]){ (string){.str=(byteptr)""} }))) : (tos_lit("")));
	if (string_eq(name, tos_lit(""))) {
		vweb__Context_error(&app->vweb, tos_lit("New name is empty"));
		return main__App_user_settings(app, user);
	}
	if (string_eq(name, user)) {
		return main__App_user_settings(app, user);
	}
	if (app->user.nr_namechanges > _const_main__max_namechanges) {
		vweb__Context_error(&app->vweb, tos_lit("You can not change your username, limit reached"));
		return main__App_user_settings(app, user);
	}
	if (app->user.last_namechange_time == 0 || _us64_gt(time__now().v_unix,app->user.last_namechange_time + _const_main__namechange_period)) {
		Option_main__User _t2652 = main__App_find_user_by_username(app, name);
		if (!_t2652.ok) {
			string err = _t2652.v_error;
			int errcode = _t2652.ecode;
			*(main__User*) _t2652.data = (main__User){.id = 0,.name = (string){.str=(byteptr)""},.username = (string){.str=(byteptr)""},.password = (string){.str=(byteptr)""},.is_github = 0,.is_registered = 0,.is_blocked = 0,.is_admin = 0,.oauth_state = (string){.str=(byteptr)""},.nr_namechanges = 0,.last_namechange_time = 0,.nr_posts = 0,.last_post_time = 0,.avatar = (string){.str=(byteptr)""},.b_avatar = 0,.emails = __new_array(0, 1, sizeof(main__Email)),.login_attempts = 0,};
		}
		main__User u = *(main__User*)_t2652.data;
		if (u.id != 0) {
			vweb__Context_error(&app->vweb, tos_lit("Name already exists"));
			return main__App_user_settings(app, user);
		}
		main__App_change_username(app, app->user.id, name);
		main__App_inc_namechanges(app, app->user.id);
		return vweb__Context_redirect(&app->vweb, _STR("/%.*s", 1, name));
	}
	vweb__Context_error(&app->vweb, tos_lit("You need to wait until you can change the name again"));
	return main__App_user_settings(app, user);
}

static void main__App_add_visit(main__App* app) {
	main__Visit visit = (main__Visit){.id = 0,.repo_id = app->repo.id,.url = app->vweb.req.url,.referer = net__http__Request_referer(&app->vweb.req),.created_at = ((int)(time__now().v_unix)),};
	
	// sql insert
	sqlite__DB _t2653 = app->db;
	sqlite3_stmt* _t2654 = sqlite__DB_init_stmt(_t2653, tos_lit("INSERT INTO `Visit` (`repo_id`, `url`, `referer`, `created_at`) values (?1, ?2, ?3, ?4)"));
	sqlite3_bind_int(_t2654, 1, visit.repo_id); // stmt
	sqlite3_bind_text(_t2654, 2, visit.url.str, visit.url.len, 0);
	sqlite3_bind_text(_t2654, 3, visit.referer.str, visit.referer.len, 0);
	sqlite3_bind_int(_t2654, 4, visit.created_at); // stmt
	
		int _t2655 = sqlite3_step(_t2654);
		if( (_t2655 != SQLITE_OK) && (_t2655 != SQLITE_DONE)){ puts(sqlite3_errmsg(_t2653.conn)); }
		sqlite3_finalize(_t2654);
}

void _vinit() {
	builtin_init();
	vinit_string_literals();
	// Initializations for module strings :
	// Initializations for module hash :
	_const_hash__wyp0 = ((u64)(0xa0761d6478bd642f));
	_const_hash__wyp1 = ((u64)(0xe7037ed1a0b428db));
	_const_hash__wyp2 = ((u64)(0x8ebc6af09c88c6e3));
	_const_hash__wyp3 = ((u64)(0x589965cc75374cc3));
	_const_hash__wyp4 = ((u64)(0x1d8e4e27c47d124f));
	// Initializations for module math.bits :
	_const_math__bits__de_bruijn32 = ((u32)(0x077CB531));
	_const_math__bits__de_bruijn32tab = new_array_from_c_array(32, 32, sizeof(byte), _MOV((byte[32]){
		((byte)(0)), 1, 28, 2, 29, 14, 24, 3, 30, 22, 20, 15, 25, 17, 4, 8, 31, 27, 13, 23, 21, 19, 16, 7, 26, 12, 18, 6, 11, 5, 10, 9}));
	_const_math__bits__de_bruijn64 = ((u64)(0x03f79d71b4ca8b09));
	_const_math__bits__de_bruijn64tab = new_array_from_c_array(64, 64, sizeof(byte), _MOV((byte[64]){
		((byte)(0)), 1, 56, 2, 57, 49, 28, 3, 61, 58, 42, 50, 38, 29, 17, 4, 62, 47, 59, 36, 45, 43, 51, 22, 53, 39, 33, 30, 24, 18, 12, 5, 63, 55, 48, 27, 60, 41, 37, 16, 46, 35, 44, 21, 52, 32, 23, 11, 54, 26, 40, 15, 34, 20, 31, 10, 25, 14, 19, 9, 13, 8, 7, 6}));
	_const_math__bits__m0 = ((u64)(0x5555555555555555));
	_const_math__bits__m1 = ((u64)(0x3333333333333333));
	_const_math__bits__m2 = ((u64)(0x0f0f0f0f0f0f0f0f));
	_const_math__bits__m3 = ((u64)(0x00ff00ff00ff00ff));
	_const_math__bits__m4 = ((u64)(0x0000ffff0000ffff));
	_const_math__bits__max_u32 = ((u32)(4294967295));
	_const_math__bits__max_u64 = ((u64)(18446744073709551615));
	_const_math__bits__two32 = ((u64)(0x100000000));
	_const_math__bits__mask32 = _const_math__bits__two32 - 1;
	_const_math__bits__ntz_8_tab = new_array_from_c_array(256, 256, sizeof(byte), _MOV((byte[256]){
		((byte)(0x08)), 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x05, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x06, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x05, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x07, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x05, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x06, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x05, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x04, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00, 0x03, 0x00, 0x01, 0x00, 0x02, 0x00, 0x01, 0x00}));
	_const_math__bits__pop_8_tab = new_array_from_c_array(256, 256, sizeof(byte), _MOV((byte[256]){
		((byte)(0x00)), 0x01, 0x01, 0x02, 0x01, 0x02, 0x02, 0x03, 0x01, 0x02, 0x02, 0x03, 0x02, 0x03, 0x03, 0x04, 0x01, 0x02, 0x02, 0x03, 0x02, 0x03, 0x03, 0x04, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x01, 0x02, 0x02, 0x03, 0x02, 0x03, 0x03, 0x04, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x01, 0x02, 0x02, 0x03, 0x02, 0x03, 0x03, 0x04, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x04, 0x05, 0x05, 0x06, 0x05, 0x06, 0x06, 0x07, 0x01, 0x02, 0x02, 0x03, 0x02, 0x03, 0x03, 0x04, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x04, 0x05, 0x05, 0x06, 0x05, 0x06, 0x06, 0x07, 0x02, 0x03, 0x03, 0x04, 0x03, 0x04, 0x04, 0x05, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x04, 0x05, 0x05, 0x06, 0x05, 0x06, 0x06, 0x07, 0x03, 0x04, 0x04, 0x05, 0x04, 0x05, 0x05, 0x06, 0x04, 0x05, 0x05, 0x06, 0x05, 0x06, 0x06, 0x07, 0x04, 0x05, 0x05, 0x06, 0x05, 0x06, 0x06, 0x07, 0x05, 0x06, 0x06, 0x07, 0x06, 0x07, 0x07, 0x08}));
	_const_math__bits__rev_8_tab = new_array_from_c_array(256, 256, sizeof(byte), _MOV((byte[256]){
		((byte)(0x00)), 0x80, 0x40, 0xc0, 0x20, 0xa0, 0x60, 0xe0, 0x10, 0x90, 0x50, 0xd0, 0x30, 0xb0, 0x70, 0xf0, 0x08, 0x88, 0x48, 0xc8, 0x28, 0xa8, 0x68, 0xe8, 0x18, 0x98, 0x58, 0xd8, 0x38, 0xb8, 0x78, 0xf8, 0x04, 0x84, 0x44, 0xc4, 0x24, 0xa4, 0x64, 0xe4, 0x14, 0x94, 0x54, 0xd4, 0x34, 0xb4, 0x74, 0xf4, 0x0c, 0x8c, 0x4c, 0xcc, 0x2c, 0xac, 0x6c, 0xec, 0x1c, 0x9c, 0x5c, 0xdc, 0x3c, 0xbc, 0x7c, 0xfc, 0x02, 0x82, 0x42, 0xc2, 0x22, 0xa2, 0x62, 0xe2, 0x12, 0x92, 0x52, 0xd2, 0x32, 0xb2, 0x72, 0xf2, 0x0a, 0x8a, 0x4a, 0xca, 0x2a, 0xaa, 0x6a, 0xea, 0x1a, 0x9a, 0x5a, 0xda, 0x3a, 0xba, 0x7a, 0xfa, 0x06, 0x86, 0x46, 0xc6, 0x26, 0xa6, 0x66, 0xe6, 0x16, 0x96, 0x56, 0xd6, 0x36, 0xb6, 0x76, 0xf6, 0x0e, 0x8e, 0x4e, 0xce, 0x2e, 0xae, 0x6e, 0xee, 0x1e, 0x9e, 0x5e, 0xde, 0x3e, 0xbe, 0x7e, 0xfe, 0x01, 0x81, 0x41, 0xc1, 0x21, 0xa1, 0x61, 0xe1, 0x11, 0x91, 0x51, 0xd1, 0x31, 0xb1, 0x71, 0xf1, 0x09, 0x89, 0x49, 0xc9, 0x29, 0xa9, 0x69, 0xe9, 0x19, 0x99, 0x59, 0xd9, 0x39, 0xb9, 0x79, 0xf9, 0x05, 0x85, 0x45, 0xc5, 0x25, 0xa5, 0x65, 0xe5, 0x15, 0x95, 0x55, 0xd5, 0x35, 0xb5, 0x75, 0xf5, 0x0d, 0x8d, 0x4d, 0xcd, 0x2d, 0xad, 0x6d, 0xed, 0x1d, 0x9d, 0x5d, 0xdd, 0x3d, 0xbd, 0x7d, 0xfd, 0x03, 0x83, 0x43, 0xc3, 0x23, 0xa3, 0x63, 0xe3, 0x13, 0x93, 0x53, 0xd3, 0x33, 0xb3, 0x73, 0xf3, 0x0b, 0x8b, 0x4b, 0xcb, 0x2b, 0xab, 0x6b, 0xeb, 0x1b, 0x9b, 0x5b, 0xdb, 0x3b, 0xbb, 0x7b, 0xfb, 0x07, 0x87, 0x47, 0xc7, 0x27, 0xa7, 0x67, 0xe7, 0x17, 0x97, 0x57, 0xd7, 0x37, 0xb7, 0x77, 0xf7, 0x0f, 0x8f, 0x4f, 0xcf, 0x2f, 0xaf, 0x6f, 0xef, 0x1f, 0x9f, 0x5f, 0xdf, 0x3f, 0xbf, 0x7f, 0xff}));
	_const_math__bits__len_8_tab = new_array_from_c_array(256, 256, sizeof(byte), _MOV((byte[256]){
		((byte)(0x00)), 0x01, 0x02, 0x02, 0x03, 0x03, 0x03, 0x03, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08}));
	// Initializations for module strconv :
	_const_strconv__double_plus_zero = ((u64)(0x0000000000000000));
	_const_strconv__double_minus_zero = ((u64)(0x8000000000000000));
	_const_strconv__double_plus_infinity = ((u64)(0x7FF0000000000000));
	_const_strconv__double_minus_infinity = ((u64)(0xFFF0000000000000));
	_const_strconv__c_ten = ((u32)(10));
	_const_strconv__pos_exp = new_array_from_c_array(309, 309, sizeof(u64), _MOV((u64[309]){
		((u64)(0x3ff0000000000000)), ((u64)(0x4024000000000000)), ((u64)(0x4059000000000000)), ((u64)(0x408f400000000000)), ((u64)(0x40c3880000000000)), ((u64)(0x40f86a0000000000)), ((u64)(0x412e848000000000)), ((u64)(0x416312d000000000)), ((u64)(0x4197d78400000000)), ((u64)(0x41cdcd6500000000)), ((u64)(0x4202a05f20000000)), ((u64)(0x42374876e8000000)), ((u64)(0x426d1a94a2000000)), ((u64)(0x42a2309ce5400000)), ((u64)(0x42d6bcc41e900000)), ((u64)(0x430c6bf526340000)), ((u64)(0x4341c37937e08000)), ((u64)(0x4376345785d8a000)), ((u64)(0x43abc16d674ec800)), ((u64)(0x43e158e460913d00)), ((u64)(0x4415af1d78b58c40)), ((u64)(0x444b1ae4d6e2ef50)), ((u64)(0x4480f0cf064dd592)), ((u64)(0x44b52d02c7e14af6)), ((u64)(0x44ea784379d99db4)), ((u64)(0x45208b2a2c280291)), ((u64)(0x4554adf4b7320335)), ((u64)(0x4589d971e4fe8402)), ((u64)(0x45c027e72f1f1281)), ((u64)(0x45f431e0fae6d721)), ((u64)(0x46293e5939a08cea)), ((u64)(0x465f8def8808b024)), ((u64)(0x4693b8b5b5056e17)), ((u64)(0x46c8a6e32246c99c)), ((u64)(0x46fed09bead87c03)), ((u64)(0x4733426172c74d82)), ((u64)(0x476812f9cf7920e3)), ((u64)(0x479e17b84357691b)), ((u64)(0x47d2ced32a16a1b1)), ((u64)(0x48078287f49c4a1d)), ((u64)(0x483d6329f1c35ca5)), ((u64)(0x48725dfa371a19e7)), ((u64)(0x48a6f578c4e0a061)), ((u64)(0x48dcb2d6f618c879)), ((u64)(0x4911efc659cf7d4c)), ((u64)(0x49466bb7f0435c9e)), ((u64)(0x497c06a5ec5433c6)), ((u64)(0x49b18427b3b4a05c)), ((u64)(0x49e5e531a0a1c873)), ((u64)(0x4a1b5e7e08ca3a8f)), ((u64)(0x4a511b0ec57e649a)), ((u64)(0x4a8561d276ddfdc0)), ((u64)(0x4ababa4714957d30)), ((u64)(0x4af0b46c6cdd6e3e)), ((u64)(0x4b24e1878814c9ce)), ((u64)(0x4b5a19e96a19fc41)), ((u64)(0x4b905031e2503da9)), ((u64)(0x4bc4643e5ae44d13)), ((u64)(0x4bf97d4df19d6057)), ((u64)(0x4c2fdca16e04b86d)), ((u64)(0x4c63e9e4e4c2f344)), ((u64)(0x4c98e45e1df3b015)), ((u64)(0x4ccf1d75a5709c1b)), ((u64)(0x4d03726987666191)), ((u64)(0x4d384f03e93ff9f5)), ((u64)(0x4d6e62c4e38ff872)), ((u64)(0x4da2fdbb0e39fb47)), ((u64)(0x4dd7bd29d1c87a19)), ((u64)(0x4e0dac74463a989f)), ((u64)(0x4e428bc8abe49f64)), ((u64)(0x4e772ebad6ddc73d)), ((u64)(0x4eacfa698c95390c)), ((u64)(0x4ee21c81f7dd43a7)), ((u64)(0x4f16a3a275d49491)), ((u64)(0x4f4c4c8b1349b9b5)), ((u64)(0x4f81afd6ec0e1411)), ((u64)(0x4fb61bcca7119916)), ((u64)(0x4feba2bfd0d5ff5b)), ((u64)(0x502145b7e285bf99)), ((u64)(0x50559725db272f7f)), ((u64)(0x508afcef51f0fb5f)), ((u64)(0x50c0de1593369d1b)), ((u64)(0x50f5159af8044462)), ((u64)(0x512a5b01b605557b)), ((u64)(0x516078e111c3556d)), ((u64)(0x5194971956342ac8)), ((u64)(0x51c9bcdfabc1357a)), ((u64)(0x5200160bcb58c16c)), ((u64)(0x52341b8ebe2ef1c7)), ((u64)(0x526922726dbaae39)), ((u64)(0x529f6b0f092959c7)), ((u64)(0x52d3a2e965b9d81d)), ((u64)(0x53088ba3bf284e24)), ((u64)(0x533eae8caef261ad)), ((u64)(0x53732d17ed577d0c)), ((u64)(0x53a7f85de8ad5c4f)), ((u64)(0x53ddf67562d8b363)), ((u64)(0x5412ba095dc7701e)), ((u64)(0x5447688bb5394c25)), ((u64)(0x547d42aea2879f2e)), ((u64)(0x54b249ad2594c37d)), ((u64)(0x54e6dc186ef9f45c)), ((u64)(0x551c931e8ab87173)), ((u64)(0x5551dbf316b346e8)), ((u64)(0x558652efdc6018a2)), ((u64)(0x55bbe7abd3781eca)), ((u64)(0x55f170cb642b133f)), ((u64)(0x5625ccfe3d35d80e)), ((u64)(0x565b403dcc834e12)), ((u64)(0x569108269fd210cb)), ((u64)(0x56c54a3047c694fe)), ((u64)(0x56fa9cbc59b83a3d)), ((u64)(0x5730a1f5b8132466)), ((u64)(0x5764ca732617ed80)), ((u64)(0x5799fd0fef9de8e0)), ((u64)(0x57d03e29f5c2b18c)), ((u64)(0x58044db473335def)), ((u64)(0x583961219000356b)), ((u64)(0x586fb969f40042c5)), ((u64)(0x58a3d3e2388029bb)), ((u64)(0x58d8c8dac6a0342a)), ((u64)(0x590efb1178484135)), ((u64)(0x59435ceaeb2d28c1)), ((u64)(0x59783425a5f872f1)), ((u64)(0x59ae412f0f768fad)), ((u64)(0x59e2e8bd69aa19cc)), ((u64)(0x5a17a2ecc414a03f)), ((u64)(0x5a4d8ba7f519c84f)), ((u64)(0x5a827748f9301d32)), ((u64)(0x5ab7151b377c247e)), ((u64)(0x5aecda62055b2d9e)), ((u64)(0x5b22087d4358fc82)), ((u64)(0x5b568a9c942f3ba3)), ((u64)(0x5b8c2d43b93b0a8c)), ((u64)(0x5bc19c4a53c4e697)), ((u64)(0x5bf6035ce8b6203d)), ((u64)(0x5c2b843422e3a84d)), ((u64)(0x5c6132a095ce4930)), ((u64)(0x5c957f48bb41db7c)), ((u64)(0x5ccadf1aea12525b)), ((u64)(0x5d00cb70d24b7379)), ((u64)(0x5d34fe4d06de5057)), ((u64)(0x5d6a3de04895e46d)), ((u64)(0x5da066ac2d5daec4)), ((u64)(0x5dd4805738b51a75)), ((u64)(0x5e09a06d06e26112)), ((u64)(0x5e400444244d7cab)), ((u64)(0x5e7405552d60dbd6)), ((u64)(0x5ea906aa78b912cc)), ((u64)(0x5edf485516e7577f)), ((u64)(0x5f138d352e5096af)), ((u64)(0x5f48708279e4bc5b)), ((u64)(0x5f7e8ca3185deb72)), ((u64)(0x5fb317e5ef3ab327)), ((u64)(0x5fe7dddf6b095ff1)), ((u64)(0x601dd55745cbb7ed)), ((u64)(0x6052a5568b9f52f4)), ((u64)(0x60874eac2e8727b1)), ((u64)(0x60bd22573a28f19d)), ((u64)(0x60f2357684599702)), ((u64)(0x6126c2d4256ffcc3)), ((u64)(0x615c73892ecbfbf4)), ((u64)(0x6191c835bd3f7d78)), ((u64)(0x61c63a432c8f5cd6)), ((u64)(0x61fbc8d3f7b3340c)), ((u64)(0x62315d847ad00087)), ((u64)(0x6265b4e5998400a9)), ((u64)(0x629b221effe500d4)), ((u64)(0x62d0f5535fef2084)), ((u64)(0x630532a837eae8a5)), ((u64)(0x633a7f5245e5a2cf)), ((u64)(0x63708f936baf85c1)), ((u64)(0x63a4b378469b6732)), ((u64)(0x63d9e056584240fe)), ((u64)(0x64102c35f729689f)), ((u64)(0x6444374374f3c2c6)), ((u64)(0x647945145230b378)), ((u64)(0x64af965966bce056)), ((u64)(0x64e3bdf7e0360c36)), ((u64)(0x6518ad75d8438f43)), ((u64)(0x654ed8d34e547314)), ((u64)(0x6583478410f4c7ec)), ((u64)(0x65b819651531f9e8)), ((u64)(0x65ee1fbe5a7e7861)), ((u64)(0x6622d3d6f88f0b3d)), ((u64)(0x665788ccb6b2ce0c)), ((u64)(0x668d6affe45f818f)), ((u64)(0x66c262dfeebbb0f9)), ((u64)(0x66f6fb97ea6a9d38)), ((u64)(0x672cba7de5054486)), ((u64)(0x6761f48eaf234ad4)), ((u64)(0x679671b25aec1d89)), ((u64)(0x67cc0e1ef1a724eb)), ((u64)(0x680188d357087713)), ((u64)(0x6835eb082cca94d7)), ((u64)(0x686b65ca37fd3a0d)), ((u64)(0x68a11f9e62fe4448)), ((u64)(0x68d56785fbbdd55a)), ((u64)(0x690ac1677aad4ab1)), ((u64)(0x6940b8e0acac4eaf)), ((u64)(0x6974e718d7d7625a)), ((u64)(0x69aa20df0dcd3af1)), ((u64)(0x69e0548b68a044d6)), ((u64)(0x6a1469ae42c8560c)), ((u64)(0x6a498419d37a6b8f)), ((u64)(0x6a7fe52048590673)), ((u64)(0x6ab3ef342d37a408)), ((u64)(0x6ae8eb0138858d0a)), ((u64)(0x6b1f25c186a6f04c)), ((u64)(0x6b537798f4285630)), ((u64)(0x6b88557f31326bbb)), ((u64)(0x6bbe6adefd7f06aa)), ((u64)(0x6bf302cb5e6f642a)), ((u64)(0x6c27c37e360b3d35)), ((u64)(0x6c5db45dc38e0c82)), ((u64)(0x6c9290ba9a38c7d1)), ((u64)(0x6cc734e940c6f9c6)), ((u64)(0x6cfd022390f8b837)), ((u64)(0x6d3221563a9b7323)), ((u64)(0x6d66a9abc9424feb)), ((u64)(0x6d9c5416bb92e3e6)), ((u64)(0x6dd1b48e353bce70)), ((u64)(0x6e0621b1c28ac20c)), ((u64)(0x6e3baa1e332d728f)), ((u64)(0x6e714a52dffc6799)), ((u64)(0x6ea59ce797fb817f)), ((u64)(0x6edb04217dfa61df)), ((u64)(0x6f10e294eebc7d2c)), ((u64)(0x6f451b3a2a6b9c76)), ((u64)(0x6f7a6208b5068394)), ((u64)(0x6fb07d457124123d)), ((u64)(0x6fe49c96cd6d16cc)), ((u64)(0x7019c3bc80c85c7f)), ((u64)(0x70501a55d07d39cf)), ((u64)(0x708420eb449c8843)), ((u64)(0x70b9292615c3aa54)), ((u64)(0x70ef736f9b3494e9)), ((u64)(0x7123a825c100dd11)), ((u64)(0x7158922f31411456)), ((u64)(0x718eb6bafd91596b)), ((u64)(0x71c33234de7ad7e3)), ((u64)(0x71f7fec216198ddc)), ((u64)(0x722dfe729b9ff153)), ((u64)(0x7262bf07a143f6d4)), ((u64)(0x72976ec98994f489)), ((u64)(0x72cd4a7bebfa31ab)), ((u64)(0x73024e8d737c5f0b)), ((u64)(0x7336e230d05b76cd)), ((u64)(0x736c9abd04725481)), ((u64)(0x73a1e0b622c774d0)), ((u64)(0x73d658e3ab795204)), ((u64)(0x740bef1c9657a686)), ((u64)(0x74417571ddf6c814)), ((u64)(0x7475d2ce55747a18)), ((u64)(0x74ab4781ead1989e)), ((u64)(0x74e10cb132c2ff63)), ((u64)(0x75154fdd7f73bf3c)), ((u64)(0x754aa3d4df50af0b)), ((u64)(0x7580a6650b926d67)), ((u64)(0x75b4cffe4e7708c0)), ((u64)(0x75ea03fde214caf1)), ((u64)(0x7620427ead4cfed6)), ((u64)(0x7654531e58a03e8c)), ((u64)(0x768967e5eec84e2f)), ((u64)(0x76bfc1df6a7a61bb)), ((u64)(0x76f3d92ba28c7d15)), ((u64)(0x7728cf768b2f9c5a)), ((u64)(0x775f03542dfb8370)), ((u64)(0x779362149cbd3226)), ((u64)(0x77c83a99c3ec7eb0)), ((u64)(0x77fe494034e79e5c)), ((u64)(0x7832edc82110c2f9)), ((u64)(0x7867a93a2954f3b8)), ((u64)(0x789d9388b3aa30a5)), ((u64)(0x78d27c35704a5e67)), ((u64)(0x79071b42cc5cf601)), ((u64)(0x793ce2137f743382)), ((u64)(0x79720d4c2fa8a031)), ((u64)(0x79a6909f3b92c83d)), ((u64)(0x79dc34c70a777a4d)), ((u64)(0x7a11a0fc668aac70)), ((u64)(0x7a46093b802d578c)), ((u64)(0x7a7b8b8a6038ad6f)), ((u64)(0x7ab137367c236c65)), ((u64)(0x7ae585041b2c477f)), ((u64)(0x7b1ae64521f7595e)), ((u64)(0x7b50cfeb353a97db)), ((u64)(0x7b8503e602893dd2)), ((u64)(0x7bba44df832b8d46)), ((u64)(0x7bf06b0bb1fb384c)), ((u64)(0x7c2485ce9e7a065f)), ((u64)(0x7c59a742461887f6)), ((u64)(0x7c9008896bcf54fa)), ((u64)(0x7cc40aabc6c32a38)), ((u64)(0x7cf90d56b873f4c7)), ((u64)(0x7d2f50ac6690f1f8)), ((u64)(0x7d63926bc01a973b)), ((u64)(0x7d987706b0213d0a)), ((u64)(0x7dce94c85c298c4c)), ((u64)(0x7e031cfd3999f7b0)), ((u64)(0x7e37e43c8800759c)), ((u64)(0x7e6ddd4baa009303)), ((u64)(0x7ea2aa4f4a405be2)), ((u64)(0x7ed754e31cd072da)), ((u64)(0x7f0d2a1be4048f90)), ((u64)(0x7f423a516e82d9ba)), ((u64)(0x7f76c8e5ca239029)), ((u64)(0x7fac7b1f3cac7433)), ((u64)(0x7fe1ccf385ebc8a0))}));
	_const_strconv__neg_exp = new_array_from_c_array(324, 324, sizeof(u64), _MOV((u64[324]){
		((u64)(0x3ff0000000000000)), ((u64)(0x3fb999999999999a)), ((u64)(0x3f847ae147ae147b)), ((u64)(0x3f50624dd2f1a9fc)), ((u64)(0x3f1a36e2eb1c432d)), ((u64)(0x3ee4f8b588e368f1)), ((u64)(0x3eb0c6f7a0b5ed8d)), ((u64)(0x3e7ad7f29abcaf48)), ((u64)(0x3e45798ee2308c3a)), ((u64)(0x3e112e0be826d695)), ((u64)(0x3ddb7cdfd9d7bdbb)), ((u64)(0x3da5fd7fe1796495)), ((u64)(0x3d719799812dea11)), ((u64)(0x3d3c25c268497682)), ((u64)(0x3d06849b86a12b9b)), ((u64)(0x3cd203af9ee75616)), ((u64)(0x3c9cd2b297d889bc)), ((u64)(0x3c670ef54646d497)), ((u64)(0x3c32725dd1d243ac)), ((u64)(0x3bfd83c94fb6d2ac)), ((u64)(0x3bc79ca10c924223)), ((u64)(0x3b92e3b40a0e9b4f)), ((u64)(0x3b5e392010175ee6)), ((u64)(0x3b282db34012b251)), ((u64)(0x3af357c299a88ea7)), ((u64)(0x3abef2d0f5da7dd9)), ((u64)(0x3a88c240c4aecb14)), ((u64)(0x3a53ce9a36f23c10)), ((u64)(0x3a1fb0f6be506019)), ((u64)(0x39e95a5efea6b347)), ((u64)(0x39b4484bfeebc2a0)), ((u64)(0x398039d665896880)), ((u64)(0x3949f623d5a8a733)), ((u64)(0x3914c4e977ba1f5c)), ((u64)(0x38e09d8792fb4c49)), ((u64)(0x38aa95a5b7f87a0f)), ((u64)(0x38754484932d2e72)), ((u64)(0x3841039d428a8b8f)), ((u64)(0x380b38fb9daa78e4)), ((u64)(0x37d5c72fb1552d83)), ((u64)(0x37a16c262777579c)), ((u64)(0x376be03d0bf225c7)), ((u64)(0x37364cfda3281e39)), ((u64)(0x3701d7314f534b61)), ((u64)(0x36cc8b8218854567)), ((u64)(0x3696d601ad376ab9)), ((u64)(0x366244ce242c5561)), ((u64)(0x362d3ae36d13bbce)), ((u64)(0x35f7624f8a762fd8)), ((u64)(0x35c2b50c6ec4f313)), ((u64)(0x358dee7a4ad4b81f)), ((u64)(0x3557f1fb6f10934c)), ((u64)(0x352327fc58da0f70)), ((u64)(0x34eea6608e29b24d)), ((u64)(0x34b8851a0b548ea4)), ((u64)(0x34839dae6f76d883)), ((u64)(0x344f62b0b257c0d2)), ((u64)(0x34191bc08eac9a41)), ((u64)(0x33e41633a556e1ce)), ((u64)(0x33b011c2eaabe7d8)), ((u64)(0x3379b604aaaca626)), ((u64)(0x3344919d5556eb52)), ((u64)(0x3310747ddddf22a8)), ((u64)(0x32da53fc9631d10d)), ((u64)(0x32a50ffd44f4a73d)), ((u64)(0x3270d9976a5d5297)), ((u64)(0x323af5bf109550f2)), ((u64)(0x32059165a6ddda5b)), ((u64)(0x31d1411e1f17e1e3)), ((u64)(0x319b9b6364f30304)), ((u64)(0x316615e91d8f359d)), ((u64)(0x3131ab20e472914a)), ((u64)(0x30fc45016d841baa)), ((u64)(0x30c69d9abe034955)), ((u64)(0x309217aefe690777)), ((u64)(0x305cf2b1970e7258)), ((u64)(0x3027288e1271f513)), ((u64)(0x2ff286d80ec190dc)), ((u64)(0x2fbda48ce468e7c7)), ((u64)(0x2f87b6d71d20b96c)), ((u64)(0x2f52f8ac174d6123)), ((u64)(0x2f1e5aacf2156838)), ((u64)(0x2ee8488a5b445360)), ((u64)(0x2eb36d3b7c36a91a)), ((u64)(0x2e7f152bf9f10e90)), ((u64)(0x2e48ddbcc7f40ba6)), ((u64)(0x2e13e497065cd61f)), ((u64)(0x2ddfd424d6faf031)), ((u64)(0x2da97683df2f268d)), ((u64)(0x2d745ecfe5bf520b)), ((u64)(0x2d404bd984990e6f)), ((u64)(0x2d0a12f5a0f4e3e5)), ((u64)(0x2cd4dbf7b3f71cb7)), ((u64)(0x2ca0aff95cc5b092)), ((u64)(0x2c6ab328946f80ea)), ((u64)(0x2c355c2076bf9a55)), ((u64)(0x2c0116805effaeaa)), ((u64)(0x2bcb5733cb32b111)), ((u64)(0x2b95df5ca28ef40d)), ((u64)(0x2b617f7d4ed8c33e)), ((u64)(0x2b2bff2ee48e0530)), ((u64)(0x2af665bf1d3e6a8d)), ((u64)(0x2ac1eaff4a98553d)), ((u64)(0x2a8cab3210f3bb95)), ((u64)(0x2a56ef5b40c2fc77)), ((u64)(0x2a225915cd68c9f9)), ((u64)(0x29ed5b561574765b)), ((u64)(0x29b77c44ddf6c516)), ((u64)(0x2982c9d0b1923745)), ((u64)(0x294e0fb44f50586e)), ((u64)(0x29180c903f7379f2)), ((u64)(0x28e33d4032c2c7f5)), ((u64)(0x28aec866b79e0cba)), ((u64)(0x2878a0522c7e7095)), ((u64)(0x2843b374f06526de)), ((u64)(0x280f8587e7083e30)), ((u64)(0x27d9379fec069826)), ((u64)(0x27a42c7ff0054685)), ((u64)(0x277023998cd10537)), ((u64)(0x2739d28f47b4d525)), ((u64)(0x2704a8729fc3ddb7)), ((u64)(0x26d086c219697e2c)), ((u64)(0x269a71368f0f3047)), ((u64)(0x2665275ed8d8f36c)), ((u64)(0x2630ec4be0ad8f89)), ((u64)(0x25fb13ac9aaf4c0f)), ((u64)(0x25c5a956e225d672)), ((u64)(0x2591544581b7dec2)), ((u64)(0x255bba08cf8c979d)), ((u64)(0x25262e6d72d6dfb0)), ((u64)(0x24f1bebdf578b2f4)), ((u64)(0x24bc6463225ab7ec)), ((u64)(0x2486b6b5b5155ff0)), ((u64)(0x24522bc490dde65a)), ((u64)(0x241d12d41afca3c3)), ((u64)(0x23e7424348ca1c9c)), ((u64)(0x23b29b69070816e3)), ((u64)(0x237dc574d80cf16b)), ((u64)(0x2347d12a4670c123)), ((u64)(0x23130dbb6b8d674f)), ((u64)(0x22de7c5f127bd87e)), ((u64)(0x22a8637f41fcad32)), ((u64)(0x227382cc34ca2428)), ((u64)(0x223f37ad21436d0c)), ((u64)(0x2208f9574dcf8a70)), ((u64)(0x21d3faac3e3fa1f3)), ((u64)(0x219ff779fd329cb9)), ((u64)(0x216992c7fdc216fa)), ((u64)(0x2134756ccb01abfb)), ((u64)(0x21005df0a267bcc9)), ((u64)(0x20ca2fe76a3f9475)), ((u64)(0x2094f31f8832dd2a)), ((u64)(0x2060c27fa028b0ef)), ((u64)(0x202ad0cc33744e4b)), ((u64)(0x1ff573d68f903ea2)), ((u64)(0x1fc1297872d9cbb5)), ((u64)(0x1f8b758d848fac55)), ((u64)(0x1f55f7a46a0c89dd)), ((u64)(0x1f2192e9ee706e4b)), ((u64)(0x1eec1e43171a4a11)), ((u64)(0x1eb67e9c127b6e74)), ((u64)(0x1e81fee341fc585d)), ((u64)(0x1e4ccb0536608d61)), ((u64)(0x1e1708d0f84d3de7)), ((u64)(0x1de26d73f9d764b9)), ((u64)(0x1dad7becc2f23ac2)), ((u64)(0x1d779657025b6235)), ((u64)(0x1d42deac01e2b4f7)), ((u64)(0x1d0e3113363787f2)), ((u64)(0x1cd8274291c6065b)), ((u64)(0x1ca3529ba7d19eaf)), ((u64)(0x1c6eea92a61c3118)), ((u64)(0x1c38bba884e35a7a)), ((u64)(0x1c03c9539d82aec8)), ((u64)(0x1bcfa885c8d117a6)), ((u64)(0x1b99539e3a40dfb8)), ((u64)(0x1b6442e4fb671960)), ((u64)(0x1b303583fc527ab3)), ((u64)(0x1af9ef3993b72ab8)), ((u64)(0x1ac4bf6142f8eefa)), ((u64)(0x1a90991a9bfa58c8)), ((u64)(0x1a5a8e90f9908e0d)), ((u64)(0x1a253eda614071a4)), ((u64)(0x19f0ff151a99f483)), ((u64)(0x19bb31bb5dc320d2)), ((u64)(0x1985c162b168e70e)), ((u64)(0x1951678227871f3e)), ((u64)(0x191bd8d03f3e9864)), ((u64)(0x18e6470cff6546b6)), ((u64)(0x18b1d270cc51055f)), ((u64)(0x187c83e7ad4e6efe)), ((u64)(0x1846cfec8aa52598)), ((u64)(0x18123ff06eea847a)), ((u64)(0x17dd331a4b10d3f6)), ((u64)(0x17a75c1508da432b)), ((u64)(0x1772b010d3e1cf56)), ((u64)(0x173de6815302e556)), ((u64)(0x1707eb9aa8cf1dde)), ((u64)(0x16d322e220a5b17e)), ((u64)(0x169e9e369aa2b597)), ((u64)(0x16687e92154ef7ac)), ((u64)(0x16339874ddd8c623)), ((u64)(0x15ff5a549627a36c)), ((u64)(0x15c91510781fb5f0)), ((u64)(0x159410d9f9b2f7f3)), ((u64)(0x15600d7b2e28c65c)), ((u64)(0x1529af2b7d0e0a2d)), ((u64)(0x14f48c22ca71a1bd)), ((u64)(0x14c0701bd527b498)), ((u64)(0x148a4cf9550c5426)), ((u64)(0x14550a6110d6a9b8)), ((u64)(0x1420d51a73deee2d)), ((u64)(0x13eaee90b964b047)), ((u64)(0x13b58ba6fab6f36c)), ((u64)(0x13813c85955f2923)), ((u64)(0x134b9408eefea839)), ((u64)(0x1316100725988694)), ((u64)(0x12e1a66c1e139edd)), ((u64)(0x12ac3d79c9b8fe2e)), ((u64)(0x12769794a160cb58)), ((u64)(0x124212dd4de70913)), ((u64)(0x120ceafbafd80e85)), ((u64)(0x11d72262f3133ed1)), ((u64)(0x11a281e8c275cbda)), ((u64)(0x116d9ca79d89462a)), ((u64)(0x1137b08617a104ee)), ((u64)(0x1102f39e794d9d8b)), ((u64)(0x10ce5297287c2f45)), ((u64)(0x1098421286c9bf6b)), ((u64)(0x1063680ed23aff89)), ((u64)(0x102f0ce4839198db)), ((u64)(0x0ff8d71d360e13e2)), ((u64)(0x0fc3df4a91a4dcb5)), ((u64)(0x0f8fcbaa82a16121)), ((u64)(0x0f596fbb9bb44db4)), ((u64)(0x0f245962e2f6a490)), ((u64)(0x0ef047824f2bb6da)), ((u64)(0x0eba0c03b1df8af6)), ((u64)(0x0e84d6695b193bf8)), ((u64)(0x0e50ab877c142ffa)), ((u64)(0x0e1aac0bf9b9e65c)), ((u64)(0x0de5566ffafb1eb0)), ((u64)(0x0db111f32f2f4bc0)), ((u64)(0x0d7b4feb7eb212cd)), ((u64)(0x0d45d98932280f0a)), ((u64)(0x0d117ad428200c08)), ((u64)(0x0cdbf7b9d9cce00d)), ((u64)(0x0ca65fc7e170b33e)), ((u64)(0x0c71e6398126f5cb)), ((u64)(0x0c3ca38f350b22df)), ((u64)(0x0c06e93f5da2824c)), ((u64)(0x0bd25432b14ecea3)), ((u64)(0x0b9d53844ee47dd1)), ((u64)(0x0b677603725064a8)), ((u64)(0x0b32c4cf8ea6b6ec)), ((u64)(0x0afe07b27dd78b14)), ((u64)(0x0ac8062864ac6f43)), ((u64)(0x0a9338205089f29c)), ((u64)(0x0a5ec033b40fea93)), ((u64)(0x0a2899c2f6732210)), ((u64)(0x09f3ae3591f5b4d9)), ((u64)(0x09bf7d228322baf5)), ((u64)(0x098930e868e89591)), ((u64)(0x0954272053ed4474)), ((u64)(0x09201f4d0ff10390)), ((u64)(0x08e9cbae7fe805b3)), ((u64)(0x08b4a2f1ffecd15c)), ((u64)(0x0880825b3323dab0)), ((u64)(0x084a6a2b85062ab3)), ((u64)(0x081521bc6a6b555c)), ((u64)(0x07e0e7c9eebc444a)), ((u64)(0x07ab0c764ac6d3a9)), ((u64)(0x0775a391d56bdc87)), ((u64)(0x07414fa7ddefe3a0)), ((u64)(0x070bb2a62fe638ff)), ((u64)(0x06d62884f31e93ff)), ((u64)(0x06a1ba03f5b21000)), ((u64)(0x066c5cd322b67fff)), ((u64)(0x0636b0a8e891ffff)), ((u64)(0x060226ed86db3333)), ((u64)(0x05cd0b15a491eb84)), ((u64)(0x05973c115074bc6a)), ((u64)(0x05629674405d6388)), ((u64)(0x052dbd86cd6238d9)), ((u64)(0x04f7cad23de82d7b)), ((u64)(0x04c308a831868ac9)), ((u64)(0x048e74404f3daadb)), ((u64)(0x04585d003f6488af)), ((u64)(0x04237d99cc506d59)), ((u64)(0x03ef2f5c7a1a488e)), ((u64)(0x03b8f2b061aea072)), ((u64)(0x0383f559e7bee6c1)), ((u64)(0x034feef63f97d79c)), ((u64)(0x03198bf832dfdfb0)), ((u64)(0x02e46ff9c24cb2f3)), ((u64)(0x02b059949b708f29)), ((u64)(0x027a28edc580e50e)), ((u64)(0x0244ed8b04671da5)), ((u64)(0x0210be08d0527e1d)), ((u64)(0x01dac9a7b3b7302f)), ((u64)(0x01a56e1fc2f8f359)), ((u64)(0x017124e63593f5e1)), ((u64)(0x013b6e3d22865634)), ((u64)(0x0105f1ca820511c3)), ((u64)(0x00d18e3b9b374169)), ((u64)(0x009c16c5c5253575)), ((u64)(0x0066789e3750f791)), ((u64)(0x0031fa182c40c60d)), ((u64)(0x000730d67819e8d2)), ((u64)(0x0000b8157268fdaf)), ((u64)(0x000012688b70e62b)), ((u64)(0x000001d74124e3d1)), ((u64)(0x0000002f201d49fb)), ((u64)(0x00000004b6695433)), ((u64)(0x0000000078a42205)), ((u64)(0x000000000c1069cd)), ((u64)(0x000000000134d761)), ((u64)(0x00000000001ee257)), ((u64)(0x00000000000316a2)), ((u64)(0x0000000000004f10)), ((u64)(0x00000000000007e8)), ((u64)(0x00000000000000ca)), ((u64)(0x0000000000000014)), ((u64)(0x0000000000000002))}));
	_const_strconv__max_u64 = ((u64)(UINT64_MAX));
	_const_strconv__ten_pow_table_32 = new_array_from_c_array(12, 12, sizeof(u32), _MOV((u32[12]){
		((u32)(1)), ((u32)(10)), ((u32)(100)), ((u32)(1000)), ((u32)(10000)), ((u32)(100000)), ((u32)(1000000)), ((u32)(10000000)), ((u32)(100000000)), ((u32)(1000000000)), ((u32)(10000000000)), ((u32)(100000000000))}));
	_const_strconv__mantbits32 = ((u32)(23));
	_const_strconv__expbits32 = ((u32)(8));
	_const_strconv__ten_pow_table_64 = new_array_from_c_array(20, 20, sizeof(u64), _MOV((u64[20]){
		((u64)(1)), ((u64)(10)), ((u64)(100)), ((u64)(1000)), ((u64)(10000)), ((u64)(100000)), ((u64)(1000000)), ((u64)(10000000)), ((u64)(100000000)), ((u64)(1000000000)), ((u64)(10000000000)), ((u64)(100000000000)), ((u64)(1000000000000)), ((u64)(10000000000000)), ((u64)(100000000000000)), ((u64)(1000000000000000)), ((u64)(10000000000000000)), ((u64)(100000000000000000)), ((u64)(1000000000000000000)), ((u64)(10000000000000000000))}));
	_const_strconv__mantbits64 = ((u32)(52));
	_const_strconv__expbits64 = ((u32)(11));
	_const_strconv__dec_round = new_array_from_c_array(20, 20, sizeof(f64), _MOV((f64[20]){
		((f64)(0.44)), 0.044, 0.0044, 0.00044, 0.000044, 0.0000044, 0.00000044, 0.000000044, 0.0000000044, 0.00000000044, 0.000000000044, 0.0000000000044, 0.00000000000044, 0.000000000000044, 0.0000000000000044, 0.00000000000000044, 0.000000000000000044, 0.0000000000000000044, 0.00000000000000000044, 0.000000000000000000044}));
	_const_strconv__powers_of_10 = new_array_from_c_array(18, 18, sizeof(u64), _MOV((u64[18]){
		((u64)(1e0)), ((u64)(1e1)), ((u64)(1e2)), ((u64)(1e3)), ((u64)(1e4)), ((u64)(1e5)), ((u64)(1e6)), ((u64)(1e7)), ((u64)(1e8)), ((u64)(1e9)), ((u64)(1e10)), ((u64)(1e11)), ((u64)(1e12)), ((u64)(1e13)), ((u64)(1e14)), ((u64)(1e15)), ((u64)(1e16)), ((u64)(1e17))}));
	_const_strconv__pow5_split_32 = new_array_from_c_array(47, 47, sizeof(u64), _MOV((u64[47]){
		((u64)(1152921504606846976)), ((u64)(1441151880758558720)), ((u64)(1801439850948198400)), ((u64)(2251799813685248000)), ((u64)(1407374883553280000)), ((u64)(1759218604441600000)), ((u64)(2199023255552000000)), ((u64)(1374389534720000000)), ((u64)(1717986918400000000)), ((u64)(2147483648000000000)), ((u64)(1342177280000000000)), ((u64)(1677721600000000000)), ((u64)(2097152000000000000)), ((u64)(1310720000000000000)), ((u64)(1638400000000000000)), ((u64)(2048000000000000000)), ((u64)(1280000000000000000)), ((u64)(1600000000000000000)), ((u64)(2000000000000000000)), ((u64)(1250000000000000000)), ((u64)(1562500000000000000)), ((u64)(1953125000000000000)), ((u64)(1220703125000000000)), ((u64)(1525878906250000000)), ((u64)(1907348632812500000)), ((u64)(1192092895507812500)), ((u64)(1490116119384765625)), ((u64)(1862645149230957031)), ((u64)(1164153218269348144)), ((u64)(1455191522836685180)), ((u64)(1818989403545856475)), ((u64)(2273736754432320594)), ((u64)(1421085471520200371)), ((u64)(1776356839400250464)), ((u64)(2220446049250313080)), ((u64)(1387778780781445675)), ((u64)(1734723475976807094)), ((u64)(2168404344971008868)), ((u64)(1355252715606880542)), ((u64)(1694065894508600678)), ((u64)(2117582368135750847)), ((u64)(1323488980084844279)), ((u64)(1654361225106055349)), ((u64)(2067951531382569187)), ((u64)(1292469707114105741)), ((u64)(1615587133892632177)), ((u64)(2019483917365790221))}));
	_const_strconv__pow5_inv_split_32 = new_array_from_c_array(31, 31, sizeof(u64), _MOV((u64[31]){
		((u64)(576460752303423489)), ((u64)(461168601842738791)), ((u64)(368934881474191033)), ((u64)(295147905179352826)), ((u64)(472236648286964522)), ((u64)(377789318629571618)), ((u64)(302231454903657294)), ((u64)(483570327845851670)), ((u64)(386856262276681336)), ((u64)(309485009821345069)), ((u64)(495176015714152110)), ((u64)(396140812571321688)), ((u64)(316912650057057351)), ((u64)(507060240091291761)), ((u64)(405648192073033409)), ((u64)(324518553658426727)), ((u64)(519229685853482763)), ((u64)(415383748682786211)), ((u64)(332306998946228969)), ((u64)(531691198313966350)), ((u64)(425352958651173080)), ((u64)(340282366920938464)), ((u64)(544451787073501542)), ((u64)(435561429658801234)), ((u64)(348449143727040987)), ((u64)(557518629963265579)), ((u64)(446014903970612463)), ((u64)(356811923176489971)), ((u64)(570899077082383953)), ((u64)(456719261665907162)), ((u64)(365375409332725730))}));
	_const_strconv__pow5_split_64 = new_array_from_c_array(326, 326, sizeof(strconv__Uint128), _MOV((strconv__Uint128[326]){
		(strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x0100000000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x0140000000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x0190000000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01f4000000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x0138800000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x0186a00000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01e8480000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01312d0000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x017d784000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01dcd65000000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x012a05f200000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x0174876e80000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01d1a94a20000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x012309ce54000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x016bcc41e9000000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01c6bf5263400000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x011c37937e080000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x016345785d8a0000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01bc16d674ec8000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01158e460913d000)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x015af1d78b58c400)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01b1ae4d6e2ef500)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x010f0cf064dd5920)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x0152d02c7e14af68)),}, (strconv__Uint128){.lo = ((u64)(0x0000000000000000)),.hi = ((u64)(0x01a784379d99db42)),}, (strconv__Uint128){.lo = ((u64)(0x4000000000000000)),.hi = ((u64)(0x0108b2a2c2802909)),}, (strconv__Uint128){.lo = ((u64)(0x9000000000000000)),.hi = ((u64)(0x014adf4b7320334b)),}, (strconv__Uint128){.lo = ((u64)(0x7400000000000000)),.hi = ((u64)(0x019d971e4fe8401e)),}, (strconv__Uint128){.lo = ((u64)(0x0880000000000000)),.hi = ((u64)(0x01027e72f1f12813)),}, (strconv__Uint128){.lo = ((u64)(0xcaa0000000000000)),.hi = ((u64)(0x01431e0fae6d7217)),}, (strconv__Uint128){.lo = ((u64)(0xbd48000000000000)),.hi = ((u64)(0x0193e5939a08ce9d)),}, (strconv__Uint128){.lo = ((u64)(0x2c9a000000000000)),.hi = ((u64)(0x01f8def8808b0245)),}, (strconv__Uint128){.lo = ((u64)(0x3be0400000000000)),.hi = ((u64)(0x013b8b5b5056e16b)),}, (strconv__Uint128){.lo = ((u64)(0x0ad8500000000000)),.hi = ((u64)(0x018a6e32246c99c6)),}, (strconv__Uint128){.lo = ((u64)(0x8d8e640000000000)),.hi = ((u64)(0x01ed09bead87c037)),}, (strconv__Uint128){.lo = ((u64)(0xb878fe8000000000)),.hi = ((u64)(0x013426172c74d822)),}, (strconv__Uint128){.lo = ((u64)(0x66973e2000000000)),.hi = ((u64)(0x01812f9cf7920e2b)),}, (strconv__Uint128){.lo = ((u64)(0x403d0da800000000)),.hi = ((u64)(0x01e17b84357691b6)),}, (strconv__Uint128){.lo = ((u64)(0xe826288900000000)),.hi = ((u64)(0x012ced32a16a1b11)),}, (strconv__Uint128){.lo = ((u64)(0x622fb2ab40000000)),.hi = ((u64)(0x0178287f49c4a1d6)),}, (strconv__Uint128){.lo = ((u64)(0xfabb9f5610000000)),.hi = ((u64)(0x01d6329f1c35ca4b)),}, (strconv__Uint128){.lo = ((u64)(0x7cb54395ca000000)),.hi = ((u64)(0x0125dfa371a19e6f)),}, (strconv__Uint128){.lo = ((u64)(0x5be2947b3c800000)),.hi = ((u64)(0x016f578c4e0a060b)),}, (strconv__Uint128){.lo = ((u64)(0x32db399a0ba00000)),.hi = ((u64)(0x01cb2d6f618c878e)),}, (strconv__Uint128){.lo = ((u64)(0xdfc9040047440000)),.hi = ((u64)(0x011efc659cf7d4b8)),}, (strconv__Uint128){.lo = ((u64)(0x17bb450059150000)),.hi = ((u64)(0x0166bb7f0435c9e7)),}, (strconv__Uint128){.lo = ((u64)(0xddaa16406f5a4000)),.hi = ((u64)(0x01c06a5ec5433c60)),}, (strconv__Uint128){.lo = ((u64)(0x8a8a4de845986800)),.hi = ((u64)(0x0118427b3b4a05bc)),}, (strconv__Uint128){.lo = ((u64)(0xad2ce16256fe8200)),.hi = ((u64)(0x015e531a0a1c872b)),}, (strconv__Uint128){.lo = ((u64)(0x987819baecbe2280)),.hi = ((u64)(0x01b5e7e08ca3a8f6)),}, (strconv__Uint128){.lo = ((u64)(0x1f4b1014d3f6d590)),.hi = ((u64)(0x0111b0ec57e6499a)),}, (strconv__Uint128){.lo = ((u64)(0xa71dd41a08f48af4)),.hi = ((u64)(0x01561d276ddfdc00)),}, (strconv__Uint128){.lo = ((u64)(0xd0e549208b31adb1)),.hi = ((u64)(0x01aba4714957d300)),}, (strconv__Uint128){.lo = ((u64)(0x828f4db456ff0c8e)),.hi = ((u64)(0x010b46c6cdd6e3e0)),}, (strconv__Uint128){.lo = ((u64)(0xa33321216cbecfb2)),.hi = ((u64)(0x014e1878814c9cd8)),}, (strconv__Uint128){.lo = ((u64)(0xcbffe969c7ee839e)),.hi = ((u64)(0x01a19e96a19fc40e)),}, (strconv__Uint128){.lo = ((u64)(0x3f7ff1e21cf51243)),.hi = ((u64)(0x0105031e2503da89)),}, (strconv__Uint128){.lo = ((u64)(0x8f5fee5aa43256d4)),.hi = ((u64)(0x014643e5ae44d12b)),}, (strconv__Uint128){.lo = ((u64)(0x7337e9f14d3eec89)),.hi = ((u64)(0x0197d4df19d60576)),}, (strconv__Uint128){.lo = ((u64)(0x1005e46da08ea7ab)),.hi = ((u64)(0x01fdca16e04b86d4)),}, (strconv__Uint128){.lo = ((u64)(0x8a03aec4845928cb)),.hi = ((u64)(0x013e9e4e4c2f3444)),}, (strconv__Uint128){.lo = ((u64)(0xac849a75a56f72fd)),.hi = ((u64)(0x018e45e1df3b0155)),}, (strconv__Uint128){.lo = ((u64)(0x17a5c1130ecb4fbd)),.hi = ((u64)(0x01f1d75a5709c1ab)),}, (strconv__Uint128){.lo = ((u64)(0xeec798abe93f11d6)),.hi = ((u64)(0x013726987666190a)),}, (strconv__Uint128){.lo = ((u64)(0xaa797ed6e38ed64b)),.hi = ((u64)(0x0184f03e93ff9f4d)),}, (strconv__Uint128){.lo = ((u64)(0x1517de8c9c728bde)),.hi = ((u64)(0x01e62c4e38ff8721)),}, (strconv__Uint128){.lo = ((u64)(0xad2eeb17e1c7976b)),.hi = ((u64)(0x012fdbb0e39fb474)),}, (strconv__Uint128){.lo = ((u64)(0xd87aa5ddda397d46)),.hi = ((u64)(0x017bd29d1c87a191)),}, (strconv__Uint128){.lo = ((u64)(0x4e994f5550c7dc97)),.hi = ((u64)(0x01dac74463a989f6)),}, (strconv__Uint128){.lo = ((u64)(0xf11fd195527ce9de)),.hi = ((u64)(0x0128bc8abe49f639)),}, (strconv__Uint128){.lo = ((u64)(0x6d67c5faa71c2456)),.hi = ((u64)(0x0172ebad6ddc73c8)),}, (strconv__Uint128){.lo = ((u64)(0x88c1b77950e32d6c)),.hi = ((u64)(0x01cfa698c95390ba)),}, (strconv__Uint128){.lo = ((u64)(0x957912abd28dfc63)),.hi = ((u64)(0x0121c81f7dd43a74)),}, (strconv__Uint128){.lo = ((u64)(0xbad75756c7317b7c)),.hi = ((u64)(0x016a3a275d494911)),}, (strconv__Uint128){.lo = ((u64)(0x298d2d2c78fdda5b)),.hi = ((u64)(0x01c4c8b1349b9b56)),}, (strconv__Uint128){.lo = ((u64)(0xd9f83c3bcb9ea879)),.hi = ((u64)(0x011afd6ec0e14115)),}, (strconv__Uint128){.lo = ((u64)(0x50764b4abe865297)),.hi = ((u64)(0x0161bcca7119915b)),}, (strconv__Uint128){.lo = ((u64)(0x2493de1d6e27e73d)),.hi = ((u64)(0x01ba2bfd0d5ff5b2)),}, (strconv__Uint128){.lo = ((u64)(0x56dc6ad264d8f086)),.hi = ((u64)(0x01145b7e285bf98f)),}, (strconv__Uint128){.lo = ((u64)(0x2c938586fe0f2ca8)),.hi = ((u64)(0x0159725db272f7f3)),}, (strconv__Uint128){.lo = ((u64)(0xf7b866e8bd92f7d2)),.hi = ((u64)(0x01afcef51f0fb5ef)),}, (strconv__Uint128){.lo = ((u64)(0xfad34051767bdae3)),.hi = ((u64)(0x010de1593369d1b5)),}, (strconv__Uint128){.lo = ((u64)(0x79881065d41ad19c)),.hi = ((u64)(0x015159af80444623)),}, (strconv__Uint128){.lo = ((u64)(0x57ea147f49218603)),.hi = ((u64)(0x01a5b01b605557ac)),}, (strconv__Uint128){.lo = ((u64)(0xb6f24ccf8db4f3c1)),.hi = ((u64)(0x01078e111c3556cb)),}, (strconv__Uint128){.lo = ((u64)(0xa4aee003712230b2)),.hi = ((u64)(0x014971956342ac7e)),}, (strconv__Uint128){.lo = ((u64)(0x4dda98044d6abcdf)),.hi = ((u64)(0x019bcdfabc13579e)),}, (strconv__Uint128){.lo = ((u64)(0xf0a89f02b062b60b)),.hi = ((u64)(0x010160bcb58c16c2)),}, (strconv__Uint128){.lo = ((u64)(0xacd2c6c35c7b638e)),.hi = ((u64)(0x0141b8ebe2ef1c73)),}, (strconv__Uint128){.lo = ((u64)(0x98077874339a3c71)),.hi = ((u64)(0x01922726dbaae390)),}, (strconv__Uint128){.lo = ((u64)(0xbe0956914080cb8e)),.hi = ((u64)(0x01f6b0f092959c74)),}, (strconv__Uint128){.lo = ((u64)(0xf6c5d61ac8507f38)),.hi = ((u64)(0x013a2e965b9d81c8)),}, (strconv__Uint128){.lo = ((u64)(0x34774ba17a649f07)),.hi = ((u64)(0x0188ba3bf284e23b)),}, (strconv__Uint128){.lo = ((u64)(0x01951e89d8fdc6c8)),.hi = ((u64)(0x01eae8caef261aca)),}, (strconv__Uint128){.lo = ((u64)(0x40fd3316279e9c3d)),.hi = ((u64)(0x0132d17ed577d0be)),}, (strconv__Uint128){.lo = ((u64)(0xd13c7fdbb186434c)),.hi = ((u64)(0x017f85de8ad5c4ed)),}, (strconv__Uint128){.lo = ((u64)(0x458b9fd29de7d420)),.hi = ((u64)(0x01df67562d8b3629)),}, (strconv__Uint128){.lo = ((u64)(0xcb7743e3a2b0e494)),.hi = ((u64)(0x012ba095dc7701d9)),}, (strconv__Uint128){.lo = ((u64)(0x3e5514dc8b5d1db9)),.hi = ((u64)(0x017688bb5394c250)),}, (strconv__Uint128){.lo = ((u64)(0x4dea5a13ae346527)),.hi = ((u64)(0x01d42aea2879f2e4)),}, (strconv__Uint128){.lo = ((u64)(0xb0b2784c4ce0bf38)),.hi = ((u64)(0x01249ad2594c37ce)),}, (strconv__Uint128){.lo = ((u64)(0x5cdf165f6018ef06)),.hi = ((u64)(0x016dc186ef9f45c2)),}, (strconv__Uint128){.lo = ((u64)(0xf416dbf7381f2ac8)),.hi = ((u64)(0x01c931e8ab871732)),}, (strconv__Uint128){.lo = ((u64)(0xd88e497a83137abd)),.hi = ((u64)(0x011dbf316b346e7f)),}, (strconv__Uint128){.lo = ((u64)(0xceb1dbd923d8596c)),.hi = ((u64)(0x01652efdc6018a1f)),}, (strconv__Uint128){.lo = ((u64)(0xc25e52cf6cce6fc7)),.hi = ((u64)(0x01be7abd3781eca7)),}, (strconv__Uint128){.lo = ((u64)(0xd97af3c1a40105dc)),.hi = ((u64)(0x01170cb642b133e8)),}, (strconv__Uint128){.lo = ((u64)(0x0fd9b0b20d014754)),.hi = ((u64)(0x015ccfe3d35d80e3)),}, (strconv__Uint128){.lo = ((u64)(0xd3d01cde90419929)),.hi = ((u64)(0x01b403dcc834e11b)),}, (strconv__Uint128){.lo = ((u64)(0x6462120b1a28ffb9)),.hi = ((u64)(0x01108269fd210cb1)),}, (strconv__Uint128){.lo = ((u64)(0xbd7a968de0b33fa8)),.hi = ((u64)(0x0154a3047c694fdd)),}, (strconv__Uint128){.lo = ((u64)(0x2cd93c3158e00f92)),.hi = ((u64)(0x01a9cbc59b83a3d5)),}, (strconv__Uint128){.lo = ((u64)(0x3c07c59ed78c09bb)),.hi = ((u64)(0x010a1f5b81324665)),}, (strconv__Uint128){.lo = ((u64)(0x8b09b7068d6f0c2a)),.hi = ((u64)(0x014ca732617ed7fe)),}, (strconv__Uint128){.lo = ((u64)(0x2dcc24c830cacf34)),.hi = ((u64)(0x019fd0fef9de8dfe)),}, (strconv__Uint128){.lo = ((u64)(0xdc9f96fd1e7ec180)),.hi = ((u64)(0x0103e29f5c2b18be)),}, (strconv__Uint128){.lo = ((u64)(0x93c77cbc661e71e1)),.hi = ((u64)(0x0144db473335deee)),}, (strconv__Uint128){.lo = ((u64)(0x38b95beb7fa60e59)),.hi = ((u64)(0x01961219000356aa)),}, (strconv__Uint128){.lo = ((u64)(0xc6e7b2e65f8f91ef)),.hi = ((u64)(0x01fb969f40042c54)),}, (strconv__Uint128){.lo = ((u64)(0xfc50cfcffbb9bb35)),.hi = ((u64)(0x013d3e2388029bb4)),}, (strconv__Uint128){.lo = ((u64)(0x3b6503c3faa82a03)),.hi = ((u64)(0x018c8dac6a0342a2)),}, (strconv__Uint128){.lo = ((u64)(0xca3e44b4f9523484)),.hi = ((u64)(0x01efb1178484134a)),}, (strconv__Uint128){.lo = ((u64)(0xbe66eaf11bd360d2)),.hi = ((u64)(0x0135ceaeb2d28c0e)),}, (strconv__Uint128){.lo = ((u64)(0x6e00a5ad62c83907)),.hi = ((u64)(0x0183425a5f872f12)),}, (strconv__Uint128){.lo = ((u64)(0x0980cf18bb7a4749)),.hi = ((u64)(0x01e412f0f768fad7)),}, (strconv__Uint128){.lo = ((u64)(0x65f0816f752c6c8d)),.hi = ((u64)(0x012e8bd69aa19cc6)),}, (strconv__Uint128){.lo = ((u64)(0xff6ca1cb527787b1)),.hi = ((u64)(0x017a2ecc414a03f7)),}, (strconv__Uint128){.lo = ((u64)(0xff47ca3e2715699d)),.hi = ((u64)(0x01d8ba7f519c84f5)),}, (strconv__Uint128){.lo = ((u64)(0xbf8cde66d86d6202)),.hi = ((u64)(0x0127748f9301d319)),}, (strconv__Uint128){.lo = ((u64)(0x2f7016008e88ba83)),.hi = ((u64)(0x017151b377c247e0)),}, (strconv__Uint128){.lo = ((u64)(0x3b4c1b80b22ae923)),.hi = ((u64)(0x01cda62055b2d9d8)),}, (strconv__Uint128){.lo = ((u64)(0x250f91306f5ad1b6)),.hi = ((u64)(0x012087d4358fc827)),}, (strconv__Uint128){.lo = ((u64)(0xee53757c8b318623)),.hi = ((u64)(0x0168a9c942f3ba30)),}, (strconv__Uint128){.lo = ((u64)(0x29e852dbadfde7ac)),.hi = ((u64)(0x01c2d43b93b0a8bd)),}, (strconv__Uint128){.lo = ((u64)(0x3a3133c94cbeb0cc)),.hi = ((u64)(0x0119c4a53c4e6976)),}, (strconv__Uint128){.lo = ((u64)(0xc8bd80bb9fee5cff)),.hi = ((u64)(0x016035ce8b6203d3)),}, (strconv__Uint128){.lo = ((u64)(0xbaece0ea87e9f43e)),.hi = ((u64)(0x01b843422e3a84c8)),}, (strconv__Uint128){.lo = ((u64)(0x74d40c9294f238a7)),.hi = ((u64)(0x01132a095ce492fd)),}, (strconv__Uint128){.lo = ((u64)(0xd2090fb73a2ec6d1)),.hi = ((u64)(0x0157f48bb41db7bc)),}, (strconv__Uint128){.lo = ((u64)(0x068b53a508ba7885)),.hi = ((u64)(0x01adf1aea12525ac)),}, (strconv__Uint128){.lo = ((u64)(0x8417144725748b53)),.hi = ((u64)(0x010cb70d24b7378b)),}, (strconv__Uint128){.lo = ((u64)(0x651cd958eed1ae28)),.hi = ((u64)(0x014fe4d06de5056e)),}, (strconv__Uint128){.lo = ((u64)(0xfe640faf2a8619b2)),.hi = ((u64)(0x01a3de04895e46c9)),}, (strconv__Uint128){.lo = ((u64)(0x3efe89cd7a93d00f)),.hi = ((u64)(0x01066ac2d5daec3e)),}, (strconv__Uint128){.lo = ((u64)(0xcebe2c40d938c413)),.hi = ((u64)(0x014805738b51a74d)),}, (strconv__Uint128){.lo = ((u64)(0x426db7510f86f518)),.hi = ((u64)(0x019a06d06e261121)),}, (strconv__Uint128){.lo = ((u64)(0xc9849292a9b4592f)),.hi = ((u64)(0x0100444244d7cab4)),}, (strconv__Uint128){.lo = ((u64)(0xfbe5b73754216f7a)),.hi = ((u64)(0x01405552d60dbd61)),}, (strconv__Uint128){.lo = ((u64)(0x7adf25052929cb59)),.hi = ((u64)(0x01906aa78b912cba)),}, (strconv__Uint128){.lo = ((u64)(0x1996ee4673743e2f)),.hi = ((u64)(0x01f485516e7577e9)),}, (strconv__Uint128){.lo = ((u64)(0xaffe54ec0828a6dd)),.hi = ((u64)(0x0138d352e5096af1)),}, (strconv__Uint128){.lo = ((u64)(0x1bfdea270a32d095)),.hi = ((u64)(0x018708279e4bc5ae)),}, (strconv__Uint128){.lo = ((u64)(0xa2fd64b0ccbf84ba)),.hi = ((u64)(0x01e8ca3185deb719)),}, (strconv__Uint128){.lo = ((u64)(0x05de5eee7ff7b2f4)),.hi = ((u64)(0x01317e5ef3ab3270)),}, (strconv__Uint128){.lo = ((u64)(0x0755f6aa1ff59fb1)),.hi = ((u64)(0x017dddf6b095ff0c)),}, (strconv__Uint128){.lo = ((u64)(0x092b7454a7f3079e)),.hi = ((u64)(0x01dd55745cbb7ecf)),}, (strconv__Uint128){.lo = ((u64)(0x65bb28b4e8f7e4c3)),.hi = ((u64)(0x012a5568b9f52f41)),}, (strconv__Uint128){.lo = ((u64)(0xbf29f2e22335ddf3)),.hi = ((u64)(0x0174eac2e8727b11)),}, (strconv__Uint128){.lo = ((u64)(0x2ef46f9aac035570)),.hi = ((u64)(0x01d22573a28f19d6)),}, (strconv__Uint128){.lo = ((u64)(0xdd58c5c0ab821566)),.hi = ((u64)(0x0123576845997025)),}, (strconv__Uint128){.lo = ((u64)(0x54aef730d6629ac0)),.hi = ((u64)(0x016c2d4256ffcc2f)),}, (strconv__Uint128){.lo = ((u64)(0x29dab4fd0bfb4170)),.hi = ((u64)(0x01c73892ecbfbf3b)),}, (strconv__Uint128){.lo = ((u64)(0xfa28b11e277d08e6)),.hi = ((u64)(0x011c835bd3f7d784)),}, (strconv__Uint128){.lo = ((u64)(0x38b2dd65b15c4b1f)),.hi = ((u64)(0x0163a432c8f5cd66)),}, (strconv__Uint128){.lo = ((u64)(0xc6df94bf1db35de7)),.hi = ((u64)(0x01bc8d3f7b3340bf)),}, (strconv__Uint128){.lo = ((u64)(0xdc4bbcf772901ab0)),.hi = ((u64)(0x0115d847ad000877)),}, (strconv__Uint128){.lo = ((u64)(0xd35eac354f34215c)),.hi = ((u64)(0x015b4e5998400a95)),}, (strconv__Uint128){.lo = ((u64)(0x48365742a30129b4)),.hi = ((u64)(0x01b221effe500d3b)),}, (strconv__Uint128){.lo = ((u64)(0x0d21f689a5e0ba10)),.hi = ((u64)(0x010f5535fef20845)),}, (strconv__Uint128){.lo = ((u64)(0x506a742c0f58e894)),.hi = ((u64)(0x01532a837eae8a56)),}, (strconv__Uint128){.lo = ((u64)(0xe4851137132f22b9)),.hi = ((u64)(0x01a7f5245e5a2ceb)),}, (strconv__Uint128){.lo = ((u64)(0x6ed32ac26bfd75b4)),.hi = ((u64)(0x0108f936baf85c13)),}, (strconv__Uint128){.lo = ((u64)(0x4a87f57306fcd321)),.hi = ((u64)(0x014b378469b67318)),}, (strconv__Uint128){.lo = ((u64)(0x5d29f2cfc8bc07e9)),.hi = ((u64)(0x019e056584240fde)),}, (strconv__Uint128){.lo = ((u64)(0xfa3a37c1dd7584f1)),.hi = ((u64)(0x0102c35f729689ea)),}, (strconv__Uint128){.lo = ((u64)(0xb8c8c5b254d2e62e)),.hi = ((u64)(0x014374374f3c2c65)),}, (strconv__Uint128){.lo = ((u64)(0x26faf71eea079fb9)),.hi = ((u64)(0x01945145230b377f)),}, (strconv__Uint128){.lo = ((u64)(0xf0b9b4e6a48987a8)),.hi = ((u64)(0x01f965966bce055e)),}, (strconv__Uint128){.lo = ((u64)(0x5674111026d5f4c9)),.hi = ((u64)(0x013bdf7e0360c35b)),}, (strconv__Uint128){.lo = ((u64)(0x2c111554308b71fb)),.hi = ((u64)(0x018ad75d8438f432)),}, (strconv__Uint128){.lo = ((u64)(0xb7155aa93cae4e7a)),.hi = ((u64)(0x01ed8d34e547313e)),}, (strconv__Uint128){.lo = ((u64)(0x326d58a9c5ecf10c)),.hi = ((u64)(0x013478410f4c7ec7)),}, (strconv__Uint128){.lo = ((u64)(0xff08aed437682d4f)),.hi = ((u64)(0x01819651531f9e78)),}, (strconv__Uint128){.lo = ((u64)(0x3ecada89454238a3)),.hi = ((u64)(0x01e1fbe5a7e78617)),}, (strconv__Uint128){.lo = ((u64)(0x873ec895cb496366)),.hi = ((u64)(0x012d3d6f88f0b3ce)),}, (strconv__Uint128){.lo = ((u64)(0x290e7abb3e1bbc3f)),.hi = ((u64)(0x01788ccb6b2ce0c2)),}, (strconv__Uint128){.lo = ((u64)(0xb352196a0da2ab4f)),.hi = ((u64)(0x01d6affe45f818f2)),}, (strconv__Uint128){.lo = ((u64)(0xb0134fe24885ab11)),.hi = ((u64)(0x01262dfeebbb0f97)),}, (strconv__Uint128){.lo = ((u64)(0x9c1823dadaa715d6)),.hi = ((u64)(0x016fb97ea6a9d37d)),}, (strconv__Uint128){.lo = ((u64)(0x031e2cd19150db4b)),.hi = ((u64)(0x01cba7de5054485d)),}, (strconv__Uint128){.lo = ((u64)(0x21f2dc02fad2890f)),.hi = ((u64)(0x011f48eaf234ad3a)),}, (strconv__Uint128){.lo = ((u64)(0xaa6f9303b9872b53)),.hi = ((u64)(0x01671b25aec1d888)),}, (strconv__Uint128){.lo = ((u64)(0xd50b77c4a7e8f628)),.hi = ((u64)(0x01c0e1ef1a724eaa)),}, (strconv__Uint128){.lo = ((u64)(0xc5272adae8f199d9)),.hi = ((u64)(0x01188d357087712a)),}, (strconv__Uint128){.lo = ((u64)(0x7670f591a32e004f)),.hi = ((u64)(0x015eb082cca94d75)),}, (strconv__Uint128){.lo = ((u64)(0xd40d32f60bf98063)),.hi = ((u64)(0x01b65ca37fd3a0d2)),}, (strconv__Uint128){.lo = ((u64)(0xc4883fd9c77bf03e)),.hi = ((u64)(0x0111f9e62fe44483)),}, (strconv__Uint128){.lo = ((u64)(0xb5aa4fd0395aec4d)),.hi = ((u64)(0x0156785fbbdd55a4)),}, (strconv__Uint128){.lo = ((u64)(0xe314e3c447b1a760)),.hi = ((u64)(0x01ac1677aad4ab0d)),}, (strconv__Uint128){.lo = ((u64)(0xaded0e5aaccf089c)),.hi = ((u64)(0x010b8e0acac4eae8)),}, (strconv__Uint128){.lo = ((u64)(0xd96851f15802cac3)),.hi = ((u64)(0x014e718d7d7625a2)),}, (strconv__Uint128){.lo = ((u64)(0x8fc2666dae037d74)),.hi = ((u64)(0x01a20df0dcd3af0b)),}, (strconv__Uint128){.lo = ((u64)(0x39d980048cc22e68)),.hi = ((u64)(0x010548b68a044d67)),}, (strconv__Uint128){.lo = ((u64)(0x084fe005aff2ba03)),.hi = ((u64)(0x01469ae42c8560c1)),}, (strconv__Uint128){.lo = ((u64)(0x4a63d8071bef6883)),.hi = ((u64)(0x0198419d37a6b8f1)),}, (strconv__Uint128){.lo = ((u64)(0x9cfcce08e2eb42a4)),.hi = ((u64)(0x01fe52048590672d)),}, (strconv__Uint128){.lo = ((u64)(0x821e00c58dd309a7)),.hi = ((u64)(0x013ef342d37a407c)),}, (strconv__Uint128){.lo = ((u64)(0xa2a580f6f147cc10)),.hi = ((u64)(0x018eb0138858d09b)),}, (strconv__Uint128){.lo = ((u64)(0x8b4ee134ad99bf15)),.hi = ((u64)(0x01f25c186a6f04c2)),}, (strconv__Uint128){.lo = ((u64)(0x97114cc0ec80176d)),.hi = ((u64)(0x0137798f428562f9)),}, (strconv__Uint128){.lo = ((u64)(0xfcd59ff127a01d48)),.hi = ((u64)(0x018557f31326bbb7)),}, (strconv__Uint128){.lo = ((u64)(0xfc0b07ed7188249a)),.hi = ((u64)(0x01e6adefd7f06aa5)),}, (strconv__Uint128){.lo = ((u64)(0xbd86e4f466f516e0)),.hi = ((u64)(0x01302cb5e6f642a7)),}, (strconv__Uint128){.lo = ((u64)(0xace89e3180b25c98)),.hi = ((u64)(0x017c37e360b3d351)),}, (strconv__Uint128){.lo = ((u64)(0x1822c5bde0def3be)),.hi = ((u64)(0x01db45dc38e0c826)),}, (strconv__Uint128){.lo = ((u64)(0xcf15bb96ac8b5857)),.hi = ((u64)(0x01290ba9a38c7d17)),}, (strconv__Uint128){.lo = ((u64)(0xc2db2a7c57ae2e6d)),.hi = ((u64)(0x01734e940c6f9c5d)),}, (strconv__Uint128){.lo = ((u64)(0x3391f51b6d99ba08)),.hi = ((u64)(0x01d022390f8b8375)),}, (strconv__Uint128){.lo = ((u64)(0x403b393124801445)),.hi = ((u64)(0x01221563a9b73229)),}, (strconv__Uint128){.lo = ((u64)(0x904a077d6da01956)),.hi = ((u64)(0x016a9abc9424feb3)),}, (strconv__Uint128){.lo = ((u64)(0x745c895cc9081fac)),.hi = ((u64)(0x01c5416bb92e3e60)),}, (strconv__Uint128){.lo = ((u64)(0x48b9d5d9fda513cb)),.hi = ((u64)(0x011b48e353bce6fc)),}, (strconv__Uint128){.lo = ((u64)(0x5ae84b507d0e58be)),.hi = ((u64)(0x01621b1c28ac20bb)),}, (strconv__Uint128){.lo = ((u64)(0x31a25e249c51eeee)),.hi = ((u64)(0x01baa1e332d728ea)),}, (strconv__Uint128){.lo = ((u64)(0x5f057ad6e1b33554)),.hi = ((u64)(0x0114a52dffc67992)),}, (strconv__Uint128){.lo = ((u64)(0xf6c6d98c9a2002aa)),.hi = ((u64)(0x0159ce797fb817f6)),}, (strconv__Uint128){.lo = ((u64)(0xb4788fefc0a80354)),.hi = ((u64)(0x01b04217dfa61df4)),}, (strconv__Uint128){.lo = ((u64)(0xf0cb59f5d8690214)),.hi = ((u64)(0x010e294eebc7d2b8)),}, (strconv__Uint128){.lo = ((u64)(0x2cfe30734e83429a)),.hi = ((u64)(0x0151b3a2a6b9c767)),}, (strconv__Uint128){.lo = ((u64)(0xf83dbc9022241340)),.hi = ((u64)(0x01a6208b50683940)),}, (strconv__Uint128){.lo = ((u64)(0x9b2695da15568c08)),.hi = ((u64)(0x0107d457124123c8)),}, (strconv__Uint128){.lo = ((u64)(0xc1f03b509aac2f0a)),.hi = ((u64)(0x0149c96cd6d16cba)),}, (strconv__Uint128){.lo = ((u64)(0x726c4a24c1573acd)),.hi = ((u64)(0x019c3bc80c85c7e9)),}, (strconv__Uint128){.lo = ((u64)(0xe783ae56f8d684c0)),.hi = ((u64)(0x0101a55d07d39cf1)),}, (strconv__Uint128){.lo = ((u64)(0x616499ecb70c25f0)),.hi = ((u64)(0x01420eb449c8842e)),}, (strconv__Uint128){.lo = ((u64)(0xf9bdc067e4cf2f6c)),.hi = ((u64)(0x019292615c3aa539)),}, (strconv__Uint128){.lo = ((u64)(0x782d3081de02fb47)),.hi = ((u64)(0x01f736f9b3494e88)),}, (strconv__Uint128){.lo = ((u64)(0x4b1c3e512ac1dd0c)),.hi = ((u64)(0x013a825c100dd115)),}, (strconv__Uint128){.lo = ((u64)(0x9de34de57572544f)),.hi = ((u64)(0x018922f31411455a)),}, (strconv__Uint128){.lo = ((u64)(0x455c215ed2cee963)),.hi = ((u64)(0x01eb6bafd91596b1)),}, (strconv__Uint128){.lo = ((u64)(0xcb5994db43c151de)),.hi = ((u64)(0x0133234de7ad7e2e)),}, (strconv__Uint128){.lo = ((u64)(0x7e2ffa1214b1a655)),.hi = ((u64)(0x017fec216198ddba)),}, (strconv__Uint128){.lo = ((u64)(0x1dbbf89699de0feb)),.hi = ((u64)(0x01dfe729b9ff1529)),}, (strconv__Uint128){.lo = ((u64)(0xb2957b5e202ac9f3)),.hi = ((u64)(0x012bf07a143f6d39)),}, (strconv__Uint128){.lo = ((u64)(0x1f3ada35a8357c6f)),.hi = ((u64)(0x0176ec98994f4888)),}, (strconv__Uint128){.lo = ((u64)(0x270990c31242db8b)),.hi = ((u64)(0x01d4a7bebfa31aaa)),}, (strconv__Uint128){.lo = ((u64)(0x5865fa79eb69c937)),.hi = ((u64)(0x0124e8d737c5f0aa)),}, (strconv__Uint128){.lo = ((u64)(0xee7f791866443b85)),.hi = ((u64)(0x016e230d05b76cd4)),}, (strconv__Uint128){.lo = ((u64)(0x2a1f575e7fd54a66)),.hi = ((u64)(0x01c9abd04725480a)),}, (strconv__Uint128){.lo = ((u64)(0x5a53969b0fe54e80)),.hi = ((u64)(0x011e0b622c774d06)),}, (strconv__Uint128){.lo = ((u64)(0xf0e87c41d3dea220)),.hi = ((u64)(0x01658e3ab7952047)),}, (strconv__Uint128){.lo = ((u64)(0xed229b5248d64aa8)),.hi = ((u64)(0x01bef1c9657a6859)),}, (strconv__Uint128){.lo = ((u64)(0x3435a1136d85eea9)),.hi = ((u64)(0x0117571ddf6c8138)),}, (strconv__Uint128){.lo = ((u64)(0x4143095848e76a53)),.hi = ((u64)(0x015d2ce55747a186)),}, (strconv__Uint128){.lo = ((u64)(0xd193cbae5b2144e8)),.hi = ((u64)(0x01b4781ead1989e7)),}, (strconv__Uint128){.lo = ((u64)(0xe2fc5f4cf8f4cb11)),.hi = ((u64)(0x0110cb132c2ff630)),}, (strconv__Uint128){.lo = ((u64)(0x1bbb77203731fdd5)),.hi = ((u64)(0x0154fdd7f73bf3bd)),}, (strconv__Uint128){.lo = ((u64)(0x62aa54e844fe7d4a)),.hi = ((u64)(0x01aa3d4df50af0ac)),}, (strconv__Uint128){.lo = ((u64)(0xbdaa75112b1f0e4e)),.hi = ((u64)(0x010a6650b926d66b)),}, (strconv__Uint128){.lo = ((u64)(0xad15125575e6d1e2)),.hi = ((u64)(0x014cffe4e7708c06)),}, (strconv__Uint128){.lo = ((u64)(0x585a56ead360865b)),.hi = ((u64)(0x01a03fde214caf08)),}, (strconv__Uint128){.lo = ((u64)(0x37387652c41c53f8)),.hi = ((u64)(0x010427ead4cfed65)),}, (strconv__Uint128){.lo = ((u64)(0x850693e7752368f7)),.hi = ((u64)(0x014531e58a03e8be)),}, (strconv__Uint128){.lo = ((u64)(0x264838e1526c4334)),.hi = ((u64)(0x01967e5eec84e2ee)),}, (strconv__Uint128){.lo = ((u64)(0xafda4719a7075402)),.hi = ((u64)(0x01fc1df6a7a61ba9)),}, (strconv__Uint128){.lo = ((u64)(0x0de86c7008649481)),.hi = ((u64)(0x013d92ba28c7d14a)),}, (strconv__Uint128){.lo = ((u64)(0x9162878c0a7db9a1)),.hi = ((u64)(0x018cf768b2f9c59c)),}, (strconv__Uint128){.lo = ((u64)(0xb5bb296f0d1d280a)),.hi = ((u64)(0x01f03542dfb83703)),}, (strconv__Uint128){.lo = ((u64)(0x5194f9e568323906)),.hi = ((u64)(0x01362149cbd32262)),}, (strconv__Uint128){.lo = ((u64)(0xe5fa385ec23ec747)),.hi = ((u64)(0x0183a99c3ec7eafa)),}, (strconv__Uint128){.lo = ((u64)(0x9f78c67672ce7919)),.hi = ((u64)(0x01e494034e79e5b9)),}, (strconv__Uint128){.lo = ((u64)(0x03ab7c0a07c10bb0)),.hi = ((u64)(0x012edc82110c2f94)),}, (strconv__Uint128){.lo = ((u64)(0x04965b0c89b14e9c)),.hi = ((u64)(0x017a93a2954f3b79)),}, (strconv__Uint128){.lo = ((u64)(0x45bbf1cfac1da243)),.hi = ((u64)(0x01d9388b3aa30a57)),}, (strconv__Uint128){.lo = ((u64)(0x8b957721cb92856a)),.hi = ((u64)(0x0127c35704a5e676)),}, (strconv__Uint128){.lo = ((u64)(0x2e7ad4ea3e7726c4)),.hi = ((u64)(0x0171b42cc5cf6014)),}, (strconv__Uint128){.lo = ((u64)(0x3a198a24ce14f075)),.hi = ((u64)(0x01ce2137f7433819)),}, (strconv__Uint128){.lo = ((u64)(0xc44ff65700cd1649)),.hi = ((u64)(0x0120d4c2fa8a030f)),}, (strconv__Uint128){.lo = ((u64)(0xb563f3ecc1005bdb)),.hi = ((u64)(0x016909f3b92c83d3)),}, (strconv__Uint128){.lo = ((u64)(0xa2bcf0e7f14072d2)),.hi = ((u64)(0x01c34c70a777a4c8)),}, (strconv__Uint128){.lo = ((u64)(0x65b61690f6c847c3)),.hi = ((u64)(0x011a0fc668aac6fd)),}, (strconv__Uint128){.lo = ((u64)(0xbf239c35347a59b4)),.hi = ((u64)(0x016093b802d578bc)),}, (strconv__Uint128){.lo = ((u64)(0xeeec83428198f021)),.hi = ((u64)(0x01b8b8a6038ad6eb)),}, (strconv__Uint128){.lo = ((u64)(0x7553d20990ff9615)),.hi = ((u64)(0x01137367c236c653)),}, (strconv__Uint128){.lo = ((u64)(0x52a8c68bf53f7b9a)),.hi = ((u64)(0x01585041b2c477e8)),}, (strconv__Uint128){.lo = ((u64)(0x6752f82ef28f5a81)),.hi = ((u64)(0x01ae64521f7595e2)),}, (strconv__Uint128){.lo = ((u64)(0x8093db1d57999890)),.hi = ((u64)(0x010cfeb353a97dad)),}, (strconv__Uint128){.lo = ((u64)(0xe0b8d1e4ad7ffeb4)),.hi = ((u64)(0x01503e602893dd18)),}, (strconv__Uint128){.lo = ((u64)(0x18e7065dd8dffe62)),.hi = ((u64)(0x01a44df832b8d45f)),}, (strconv__Uint128){.lo = ((u64)(0x6f9063faa78bfefd)),.hi = ((u64)(0x0106b0bb1fb384bb)),}, (strconv__Uint128){.lo = ((u64)(0x4b747cf9516efebc)),.hi = ((u64)(0x01485ce9e7a065ea)),}, (strconv__Uint128){.lo = ((u64)(0xde519c37a5cabe6b)),.hi = ((u64)(0x019a742461887f64)),}, (strconv__Uint128){.lo = ((u64)(0x0af301a2c79eb703)),.hi = ((u64)(0x01008896bcf54f9f)),}, (strconv__Uint128){.lo = ((u64)(0xcdafc20b798664c4)),.hi = ((u64)(0x0140aabc6c32a386)),}, (strconv__Uint128){.lo = ((u64)(0x811bb28e57e7fdf5)),.hi = ((u64)(0x0190d56b873f4c68)),}, (strconv__Uint128){.lo = ((u64)(0xa1629f31ede1fd72)),.hi = ((u64)(0x01f50ac6690f1f82)),}, (strconv__Uint128){.lo = ((u64)(0xa4dda37f34ad3e67)),.hi = ((u64)(0x013926bc01a973b1)),}, (strconv__Uint128){.lo = ((u64)(0x0e150c5f01d88e01)),.hi = ((u64)(0x0187706b0213d09e)),}, (strconv__Uint128){.lo = ((u64)(0x919a4f76c24eb181)),.hi = ((u64)(0x01e94c85c298c4c5)),}, (strconv__Uint128){.lo = ((u64)(0x7b0071aa39712ef1)),.hi = ((u64)(0x0131cfd3999f7afb)),}, (strconv__Uint128){.lo = ((u64)(0x59c08e14c7cd7aad)),.hi = ((u64)(0x017e43c8800759ba)),}, (strconv__Uint128){.lo = ((u64)(0xf030b199f9c0d958)),.hi = ((u64)(0x01ddd4baa0093028)),}, (strconv__Uint128){.lo = ((u64)(0x961e6f003c1887d7)),.hi = ((u64)(0x012aa4f4a405be19)),}, (strconv__Uint128){.lo = ((u64)(0xfba60ac04b1ea9cd)),.hi = ((u64)(0x01754e31cd072d9f)),}, (strconv__Uint128){.lo = ((u64)(0xfa8f8d705de65440)),.hi = ((u64)(0x01d2a1be4048f907)),}, (strconv__Uint128){.lo = ((u64)(0xfc99b8663aaff4a8)),.hi = ((u64)(0x0123a516e82d9ba4)),}, (strconv__Uint128){.lo = ((u64)(0x3bc0267fc95bf1d2)),.hi = ((u64)(0x016c8e5ca239028e)),}, (strconv__Uint128){.lo = ((u64)(0xcab0301fbbb2ee47)),.hi = ((u64)(0x01c7b1f3cac74331)),}, (strconv__Uint128){.lo = ((u64)(0x1eae1e13d54fd4ec)),.hi = ((u64)(0x011ccf385ebc89ff)),}, (strconv__Uint128){.lo = ((u64)(0xe659a598caa3ca27)),.hi = ((u64)(0x01640306766bac7e)),}, (strconv__Uint128){.lo = ((u64)(0x9ff00efefd4cbcb1)),.hi = ((u64)(0x01bd03c81406979e)),}, (strconv__Uint128){.lo = ((u64)(0x23f6095f5e4ff5ef)),.hi = ((u64)(0x0116225d0c841ec3)),}, (strconv__Uint128){.lo = ((u64)(0xecf38bb735e3f36a)),.hi = ((u64)(0x015baaf44fa52673)),}, (strconv__Uint128){.lo = ((u64)(0xe8306ea5035cf045)),.hi = ((u64)(0x01b295b1638e7010)),}, (strconv__Uint128){.lo = ((u64)(0x911e4527221a162b)),.hi = ((u64)(0x010f9d8ede39060a)),}, (strconv__Uint128){.lo = ((u64)(0x3565d670eaa09bb6)),.hi = ((u64)(0x015384f295c7478d)),}, (strconv__Uint128){.lo = ((u64)(0x82bf4c0d2548c2a3)),.hi = ((u64)(0x01a8662f3b391970)),}, (strconv__Uint128){.lo = ((u64)(0x51b78f88374d79a6)),.hi = ((u64)(0x01093fdd8503afe6)),}, (strconv__Uint128){.lo = ((u64)(0xe625736a4520d810)),.hi = ((u64)(0x014b8fd4e6449bdf)),}, (strconv__Uint128){.lo = ((u64)(0xdfaed044d6690e14)),.hi = ((u64)(0x019e73ca1fd5c2d7)),}, (strconv__Uint128){.lo = ((u64)(0xebcd422b0601a8cc)),.hi = ((u64)(0x0103085e53e599c6)),}, (strconv__Uint128){.lo = ((u64)(0xa6c092b5c78212ff)),.hi = ((u64)(0x0143ca75e8df0038)),}, (strconv__Uint128){.lo = ((u64)(0xd070b763396297bf)),.hi = ((u64)(0x0194bd136316c046)),}, (strconv__Uint128){.lo = ((u64)(0x848ce53c07bb3daf)),.hi = ((u64)(0x01f9ec583bdc7058)),}, (strconv__Uint128){.lo = ((u64)(0x52d80f4584d5068d)),.hi = ((u64)(0x013c33b72569c637)),}, (strconv__Uint128){.lo = ((u64)(0x278e1316e60a4831)),.hi = ((u64)(0x018b40a4eec437c5)),}}));
	_const_strconv__pow5_inv_split_64 = new_array_from_c_array(292, 292, sizeof(strconv__Uint128), _MOV((strconv__Uint128[292]){
		(strconv__Uint128){.lo = ((u64)(0x0000000000000001)),.hi = ((u64)(0x0400000000000000)),}, (strconv__Uint128){.lo = ((u64)(0x3333333333333334)),.hi = ((u64)(0x0333333333333333)),}, (strconv__Uint128){.lo = ((u64)(0x28f5c28f5c28f5c3)),.hi = ((u64)(0x028f5c28f5c28f5c)),}, (strconv__Uint128){.lo = ((u64)(0xed916872b020c49c)),.hi = ((u64)(0x020c49ba5e353f7c)),}, (strconv__Uint128){.lo = ((u64)(0xaf4f0d844d013a93)),.hi = ((u64)(0x0346dc5d63886594)),}, (strconv__Uint128){.lo = ((u64)(0x8c3f3e0370cdc876)),.hi = ((u64)(0x029f16b11c6d1e10)),}, (strconv__Uint128){.lo = ((u64)(0xd698fe69270b06c5)),.hi = ((u64)(0x0218def416bdb1a6)),}, (strconv__Uint128){.lo = ((u64)(0xf0f4ca41d811a46e)),.hi = ((u64)(0x035afe535795e90a)),}, (strconv__Uint128){.lo = ((u64)(0xf3f70834acdae9f1)),.hi = ((u64)(0x02af31dc4611873b)),}, (strconv__Uint128){.lo = ((u64)(0x5cc5a02a23e254c1)),.hi = ((u64)(0x0225c17d04dad296)),}, (strconv__Uint128){.lo = ((u64)(0xfad5cd10396a2135)),.hi = ((u64)(0x036f9bfb3af7b756)),}, (strconv__Uint128){.lo = ((u64)(0xfbde3da69454e75e)),.hi = ((u64)(0x02bfaffc2f2c92ab)),}, (strconv__Uint128){.lo = ((u64)(0x2fe4fe1edd10b918)),.hi = ((u64)(0x0232f33025bd4223)),}, (strconv__Uint128){.lo = ((u64)(0x4ca19697c81ac1bf)),.hi = ((u64)(0x0384b84d092ed038)),}, (strconv__Uint128){.lo = ((u64)(0x3d4e1213067bce33)),.hi = ((u64)(0x02d09370d4257360)),}, (strconv__Uint128){.lo = ((u64)(0x643e74dc052fd829)),.hi = ((u64)(0x024075f3dceac2b3)),}, (strconv__Uint128){.lo = ((u64)(0x6d30baf9a1e626a7)),.hi = ((u64)(0x039a5652fb113785)),}, (strconv__Uint128){.lo = ((u64)(0x2426fbfae7eb5220)),.hi = ((u64)(0x02e1dea8c8da92d1)),}, (strconv__Uint128){.lo = ((u64)(0x1cebfcc8b9890e80)),.hi = ((u64)(0x024e4bba3a487574)),}, (strconv__Uint128){.lo = ((u64)(0x94acc7a78f41b0cc)),.hi = ((u64)(0x03b07929f6da5586)),}, (strconv__Uint128){.lo = ((u64)(0xaa23d2ec729af3d7)),.hi = ((u64)(0x02f394219248446b)),}, (strconv__Uint128){.lo = ((u64)(0xbb4fdbf05baf2979)),.hi = ((u64)(0x025c768141d369ef)),}, (strconv__Uint128){.lo = ((u64)(0xc54c931a2c4b758d)),.hi = ((u64)(0x03c7240202ebdcb2)),}, (strconv__Uint128){.lo = ((u64)(0x9dd6dc14f03c5e0b)),.hi = ((u64)(0x0305b66802564a28)),}, (strconv__Uint128){.lo = ((u64)(0x4b1249aa59c9e4d6)),.hi = ((u64)(0x026af8533511d4ed)),}, (strconv__Uint128){.lo = ((u64)(0x44ea0f76f60fd489)),.hi = ((u64)(0x03de5a1ebb4fbb15)),}, (strconv__Uint128){.lo = ((u64)(0x6a54d92bf80caa07)),.hi = ((u64)(0x0318481895d96277)),}, (strconv__Uint128){.lo = ((u64)(0x21dd7a89933d54d2)),.hi = ((u64)(0x0279d346de4781f9)),}, (strconv__Uint128){.lo = ((u64)(0x362f2a75b8622150)),.hi = ((u64)(0x03f61ed7ca0c0328)),}, (strconv__Uint128){.lo = ((u64)(0xf825bb91604e810d)),.hi = ((u64)(0x032b4bdfd4d668ec)),}, (strconv__Uint128){.lo = ((u64)(0xc684960de6a5340b)),.hi = ((u64)(0x0289097fdd7853f0)),}, (strconv__Uint128){.lo = ((u64)(0xd203ab3e521dc33c)),.hi = ((u64)(0x02073accb12d0ff3)),}, (strconv__Uint128){.lo = ((u64)(0xe99f7863b696052c)),.hi = ((u64)(0x033ec47ab514e652)),}, (strconv__Uint128){.lo = ((u64)(0x87b2c6b62bab3757)),.hi = ((u64)(0x02989d2ef743eb75)),}, (strconv__Uint128){.lo = ((u64)(0xd2f56bc4efbc2c45)),.hi = ((u64)(0x0213b0f25f69892a)),}, (strconv__Uint128){.lo = ((u64)(0x1e55793b192d13a2)),.hi = ((u64)(0x0352b4b6ff0f41de)),}, (strconv__Uint128){.lo = ((u64)(0x4b77942f475742e8)),.hi = ((u64)(0x02a8909265a5ce4b)),}, (strconv__Uint128){.lo = ((u64)(0xd5f9435905df68ba)),.hi = ((u64)(0x022073a8515171d5)),}, (strconv__Uint128){.lo = ((u64)(0x565b9ef4d6324129)),.hi = ((u64)(0x03671f73b54f1c89)),}, (strconv__Uint128){.lo = ((u64)(0xdeafb25d78283421)),.hi = ((u64)(0x02b8e5f62aa5b06d)),}, (strconv__Uint128){.lo = ((u64)(0x188c8eb12cecf681)),.hi = ((u64)(0x022d84c4eeeaf38b)),}, (strconv__Uint128){.lo = ((u64)(0x8dadb11b7b14bd9b)),.hi = ((u64)(0x037c07a17e44b8de)),}, (strconv__Uint128){.lo = ((u64)(0x7157c0e2c8dd647c)),.hi = ((u64)(0x02c99fb46503c718)),}, (strconv__Uint128){.lo = ((u64)(0x8ddfcd823a4ab6ca)),.hi = ((u64)(0x023ae629ea696c13)),}, (strconv__Uint128){.lo = ((u64)(0x1632e269f6ddf142)),.hi = ((u64)(0x0391704310a8acec)),}, (strconv__Uint128){.lo = ((u64)(0x44f581ee5f17f435)),.hi = ((u64)(0x02dac035a6ed5723)),}, (strconv__Uint128){.lo = ((u64)(0x372ace584c1329c4)),.hi = ((u64)(0x024899c4858aac1c)),}, (strconv__Uint128){.lo = ((u64)(0xbeaae3c079b842d3)),.hi = ((u64)(0x03a75c6da27779c6)),}, (strconv__Uint128){.lo = ((u64)(0x6555830061603576)),.hi = ((u64)(0x02ec49f14ec5fb05)),}, (strconv__Uint128){.lo = ((u64)(0xb7779c004de6912b)),.hi = ((u64)(0x0256a18dd89e626a)),}, (strconv__Uint128){.lo = ((u64)(0xf258f99a163db512)),.hi = ((u64)(0x03bdcf495a9703dd)),}, (strconv__Uint128){.lo = ((u64)(0x5b7a614811caf741)),.hi = ((u64)(0x02fe3f6de212697e)),}, (strconv__Uint128){.lo = ((u64)(0xaf951aa00e3bf901)),.hi = ((u64)(0x0264ff8b1b41edfe)),}, (strconv__Uint128){.lo = ((u64)(0x7f54f7667d2cc19b)),.hi = ((u64)(0x03d4cc11c5364997)),}, (strconv__Uint128){.lo = ((u64)(0x32aa5f8530f09ae3)),.hi = ((u64)(0x0310a3416a91d479)),}, (strconv__Uint128){.lo = ((u64)(0xf55519375a5a1582)),.hi = ((u64)(0x0273b5cdeedb1060)),}, (strconv__Uint128){.lo = ((u64)(0xbbbb5b8bc3c3559d)),.hi = ((u64)(0x03ec56164af81a34)),}, (strconv__Uint128){.lo = ((u64)(0x2fc916096969114a)),.hi = ((u64)(0x03237811d593482a)),}, (strconv__Uint128){.lo = ((u64)(0x596dab3ababa743c)),.hi = ((u64)(0x0282c674aadc39bb)),}, (strconv__Uint128){.lo = ((u64)(0x478aef622efb9030)),.hi = ((u64)(0x0202385d557cfafc)),}, (strconv__Uint128){.lo = ((u64)(0xd8de4bd04b2c19e6)),.hi = ((u64)(0x0336c0955594c4c6)),}, (strconv__Uint128){.lo = ((u64)(0xad7ea30d08f014b8)),.hi = ((u64)(0x029233aaaadd6a38)),}, (strconv__Uint128){.lo = ((u64)(0x24654f3da0c01093)),.hi = ((u64)(0x020e8fbbbbe454fa)),}, (strconv__Uint128){.lo = ((u64)(0x3a3bb1fc346680eb)),.hi = ((u64)(0x034a7f92c63a2190)),}, (strconv__Uint128){.lo = ((u64)(0x94fc8e635d1ecd89)),.hi = ((u64)(0x02a1ffa89e94e7a6)),}, (strconv__Uint128){.lo = ((u64)(0xaa63a51c4a7f0ad4)),.hi = ((u64)(0x021b32ed4baa52eb)),}, (strconv__Uint128){.lo = ((u64)(0xdd6c3b607731aaed)),.hi = ((u64)(0x035eb7e212aa1e45)),}, (strconv__Uint128){.lo = ((u64)(0x1789c919f8f488bd)),.hi = ((u64)(0x02b22cb4dbbb4b6b)),}, (strconv__Uint128){.lo = ((u64)(0xac6e3a7b2d906d64)),.hi = ((u64)(0x022823c3e2fc3c55)),}, (strconv__Uint128){.lo = ((u64)(0x13e390c515b3e23a)),.hi = ((u64)(0x03736c6c9e606089)),}, (strconv__Uint128){.lo = ((u64)(0xdcb60d6a77c31b62)),.hi = ((u64)(0x02c2bd23b1e6b3a0)),}, (strconv__Uint128){.lo = ((u64)(0x7d5e7121f968e2b5)),.hi = ((u64)(0x0235641c8e52294d)),}, (strconv__Uint128){.lo = ((u64)(0xc8971b698f0e3787)),.hi = ((u64)(0x0388a02db0837548)),}, (strconv__Uint128){.lo = ((u64)(0xa078e2bad8d82c6c)),.hi = ((u64)(0x02d3b357c0692aa0)),}, (strconv__Uint128){.lo = ((u64)(0xe6c71bc8ad79bd24)),.hi = ((u64)(0x0242f5dfcd20eee6)),}, (strconv__Uint128){.lo = ((u64)(0x0ad82c7448c2c839)),.hi = ((u64)(0x039e5632e1ce4b0b)),}, (strconv__Uint128){.lo = ((u64)(0x3be023903a356cfa)),.hi = ((u64)(0x02e511c24e3ea26f)),}, (strconv__Uint128){.lo = ((u64)(0x2fe682d9c82abd95)),.hi = ((u64)(0x0250db01d8321b8c)),}, (strconv__Uint128){.lo = ((u64)(0x4ca4048fa6aac8ee)),.hi = ((u64)(0x03b4919c8d1cf8e0)),}, (strconv__Uint128){.lo = ((u64)(0x3d5003a61eef0725)),.hi = ((u64)(0x02f6dae3a4172d80)),}, (strconv__Uint128){.lo = ((u64)(0x9773361e7f259f51)),.hi = ((u64)(0x025f1582e9ac2466)),}, (strconv__Uint128){.lo = ((u64)(0x8beb89ca6508fee8)),.hi = ((u64)(0x03cb559e42ad070a)),}, (strconv__Uint128){.lo = ((u64)(0x6fefa16eb73a6586)),.hi = ((u64)(0x0309114b688a6c08)),}, (strconv__Uint128){.lo = ((u64)(0xf3261abef8fb846b)),.hi = ((u64)(0x026da76f86d52339)),}, (strconv__Uint128){.lo = ((u64)(0x51d691318e5f3a45)),.hi = ((u64)(0x03e2a57f3e21d1f6)),}, (strconv__Uint128){.lo = ((u64)(0x0e4540f471e5c837)),.hi = ((u64)(0x031bb798fe8174c5)),}, (strconv__Uint128){.lo = ((u64)(0xd8376729f4b7d360)),.hi = ((u64)(0x027c92e0cb9ac3d0)),}, (strconv__Uint128){.lo = ((u64)(0xf38bd84321261eff)),.hi = ((u64)(0x03fa849adf5e061a)),}, (strconv__Uint128){.lo = ((u64)(0x293cad0280eb4bff)),.hi = ((u64)(0x032ed07be5e4d1af)),}, (strconv__Uint128){.lo = ((u64)(0xedca240200bc3ccc)),.hi = ((u64)(0x028bd9fcb7ea4158)),}, (strconv__Uint128){.lo = ((u64)(0xbe3b50019a3030a4)),.hi = ((u64)(0x02097b309321cde0)),}, (strconv__Uint128){.lo = ((u64)(0xc9f88002904d1a9f)),.hi = ((u64)(0x03425eb41e9c7c9a)),}, (strconv__Uint128){.lo = ((u64)(0x3b2d3335403daee6)),.hi = ((u64)(0x029b7ef67ee396e2)),}, (strconv__Uint128){.lo = ((u64)(0x95bdc291003158b8)),.hi = ((u64)(0x0215ff2b98b6124e)),}, (strconv__Uint128){.lo = ((u64)(0x892f9db4cd1bc126)),.hi = ((u64)(0x035665128df01d4a)),}, (strconv__Uint128){.lo = ((u64)(0x07594af70a7c9a85)),.hi = ((u64)(0x02ab840ed7f34aa2)),}, (strconv__Uint128){.lo = ((u64)(0x6c476f2c0863aed1)),.hi = ((u64)(0x0222d00bdff5d54e)),}, (strconv__Uint128){.lo = ((u64)(0x13a57eacda3917b4)),.hi = ((u64)(0x036ae67966562217)),}, (strconv__Uint128){.lo = ((u64)(0x0fb7988a482dac90)),.hi = ((u64)(0x02bbeb9451de81ac)),}, (strconv__Uint128){.lo = ((u64)(0xd95fad3b6cf156da)),.hi = ((u64)(0x022fefa9db1867bc)),}, (strconv__Uint128){.lo = ((u64)(0xf565e1f8ae4ef15c)),.hi = ((u64)(0x037fe5dc91c0a5fa)),}, (strconv__Uint128){.lo = ((u64)(0x911e4e608b725ab0)),.hi = ((u64)(0x02ccb7e3a7cd5195)),}, (strconv__Uint128){.lo = ((u64)(0xda7ea51a0928488d)),.hi = ((u64)(0x023d5fe9530aa7aa)),}, (strconv__Uint128){.lo = ((u64)(0xf7310829a8407415)),.hi = ((u64)(0x039566421e7772aa)),}, (strconv__Uint128){.lo = ((u64)(0x2c2739baed005cde)),.hi = ((u64)(0x02ddeb68185f8eef)),}, (strconv__Uint128){.lo = ((u64)(0xbcec2e2f24004a4b)),.hi = ((u64)(0x024b22b9ad193f25)),}, (strconv__Uint128){.lo = ((u64)(0x94ad16b1d333aa11)),.hi = ((u64)(0x03ab6ac2ae8ecb6f)),}, (strconv__Uint128){.lo = ((u64)(0xaa241227dc2954db)),.hi = ((u64)(0x02ef889bbed8a2bf)),}, (strconv__Uint128){.lo = ((u64)(0x54e9a81fe35443e2)),.hi = ((u64)(0x02593a163246e899)),}, (strconv__Uint128){.lo = ((u64)(0x2175d9cc9eed396a)),.hi = ((u64)(0x03c1f689ea0b0dc2)),}, (strconv__Uint128){.lo = ((u64)(0xe7917b0a18bdc788)),.hi = ((u64)(0x03019207ee6f3e34)),}, (strconv__Uint128){.lo = ((u64)(0xb9412f3b46fe393a)),.hi = ((u64)(0x0267a8065858fe90)),}, (strconv__Uint128){.lo = ((u64)(0xf535185ed7fd285c)),.hi = ((u64)(0x03d90cd6f3c1974d)),}, (strconv__Uint128){.lo = ((u64)(0xc42a79e57997537d)),.hi = ((u64)(0x03140a458fce12a4)),}, (strconv__Uint128){.lo = ((u64)(0x03552e512e12a931)),.hi = ((u64)(0x02766e9e0ca4dbb7)),}, (strconv__Uint128){.lo = ((u64)(0x9eeeb081e3510eb4)),.hi = ((u64)(0x03f0b0fce107c5f1)),}, (strconv__Uint128){.lo = ((u64)(0x4bf226ce4f740bc3)),.hi = ((u64)(0x0326f3fd80d304c1)),}, (strconv__Uint128){.lo = ((u64)(0xa3281f0b72c33c9c)),.hi = ((u64)(0x02858ffe00a8d09a)),}, (strconv__Uint128){.lo = ((u64)(0x1c2018d5f568fd4a)),.hi = ((u64)(0x020473319a20a6e2)),}, (strconv__Uint128){.lo = ((u64)(0xf9ccf48988a7fba9)),.hi = ((u64)(0x033a51e8f69aa49c)),}, (strconv__Uint128){.lo = ((u64)(0xfb0a5d3ad3b99621)),.hi = ((u64)(0x02950e53f87bb6e3)),}, (strconv__Uint128){.lo = ((u64)(0x2f3b7dc8a96144e7)),.hi = ((u64)(0x0210d8432d2fc583)),}, (strconv__Uint128){.lo = ((u64)(0xe52bfc7442353b0c)),.hi = ((u64)(0x034e26d1e1e608d1)),}, (strconv__Uint128){.lo = ((u64)(0xb756639034f76270)),.hi = ((u64)(0x02a4ebdb1b1e6d74)),}, (strconv__Uint128){.lo = ((u64)(0x2c451c735d92b526)),.hi = ((u64)(0x021d897c15b1f12a)),}, (strconv__Uint128){.lo = ((u64)(0x13a1c71efc1deea3)),.hi = ((u64)(0x0362759355e981dd)),}, (strconv__Uint128){.lo = ((u64)(0x761b05b2634b2550)),.hi = ((u64)(0x02b52adc44bace4a)),}, (strconv__Uint128){.lo = ((u64)(0x91af37c1e908eaa6)),.hi = ((u64)(0x022a88b036fbd83b)),}, (strconv__Uint128){.lo = ((u64)(0x82b1f2cfdb417770)),.hi = ((u64)(0x03774119f192f392)),}, (strconv__Uint128){.lo = ((u64)(0xcef4c23fe29ac5f3)),.hi = ((u64)(0x02c5cdae5adbf60e)),}, (strconv__Uint128){.lo = ((u64)(0x3f2a34ffe87bd190)),.hi = ((u64)(0x0237d7beaf165e72)),}, (strconv__Uint128){.lo = ((u64)(0x984387ffda5fb5b2)),.hi = ((u64)(0x038c8c644b56fd83)),}, (strconv__Uint128){.lo = ((u64)(0xe0360666484c915b)),.hi = ((u64)(0x02d6d6b6a2abfe02)),}, (strconv__Uint128){.lo = ((u64)(0x802b3851d3707449)),.hi = ((u64)(0x024578921bbccb35)),}, (strconv__Uint128){.lo = ((u64)(0x99dec082ebe72075)),.hi = ((u64)(0x03a25a835f947855)),}, (strconv__Uint128){.lo = ((u64)(0xae4bcd358985b391)),.hi = ((u64)(0x02e8486919439377)),}, (strconv__Uint128){.lo = ((u64)(0xbea30a913ad15c74)),.hi = ((u64)(0x02536d20e102dc5f)),}, (strconv__Uint128){.lo = ((u64)(0xfdd1aa81f7b560b9)),.hi = ((u64)(0x03b8ae9b019e2d65)),}, (strconv__Uint128){.lo = ((u64)(0x97daeece5fc44d61)),.hi = ((u64)(0x02fa2548ce182451)),}, (strconv__Uint128){.lo = ((u64)(0xdfe258a51969d781)),.hi = ((u64)(0x0261b76d71ace9da)),}, (strconv__Uint128){.lo = ((u64)(0x996a276e8f0fbf34)),.hi = ((u64)(0x03cf8be24f7b0fc4)),}, (strconv__Uint128){.lo = ((u64)(0xe121b9253f3fcc2a)),.hi = ((u64)(0x030c6fe83f95a636)),}, (strconv__Uint128){.lo = ((u64)(0xb41afa8432997022)),.hi = ((u64)(0x02705986994484f8)),}, (strconv__Uint128){.lo = ((u64)(0xecf7f739ea8f19cf)),.hi = ((u64)(0x03e6f5a4286da18d)),}, (strconv__Uint128){.lo = ((u64)(0x23f99294bba5ae40)),.hi = ((u64)(0x031f2ae9b9f14e0b)),}, (strconv__Uint128){.lo = ((u64)(0x4ffadbaa2fb7be99)),.hi = ((u64)(0x027f5587c7f43e6f)),}, (strconv__Uint128){.lo = ((u64)(0x7ff7c5dd1925fdc2)),.hi = ((u64)(0x03feef3fa6539718)),}, (strconv__Uint128){.lo = ((u64)(0xccc637e4141e649b)),.hi = ((u64)(0x033258ffb842df46)),}, (strconv__Uint128){.lo = ((u64)(0xd704f983434b83af)),.hi = ((u64)(0x028ead9960357f6b)),}, (strconv__Uint128){.lo = ((u64)(0x126a6135cf6f9c8c)),.hi = ((u64)(0x020bbe144cf79923)),}, (strconv__Uint128){.lo = ((u64)(0x83dd685618b29414)),.hi = ((u64)(0x0345fced47f28e9e)),}, (strconv__Uint128){.lo = ((u64)(0x9cb12044e08edcdd)),.hi = ((u64)(0x029e63f1065ba54b)),}, (strconv__Uint128){.lo = ((u64)(0x16f419d0b3a57d7d)),.hi = ((u64)(0x02184ff405161dd6)),}, (strconv__Uint128){.lo = ((u64)(0x8b20294dec3bfbfb)),.hi = ((u64)(0x035a19866e89c956)),}, (strconv__Uint128){.lo = ((u64)(0x3c19baa4bcfcc996)),.hi = ((u64)(0x02ae7ad1f207d445)),}, (strconv__Uint128){.lo = ((u64)(0xc9ae2eea30ca3adf)),.hi = ((u64)(0x02252f0e5b39769d)),}, (strconv__Uint128){.lo = ((u64)(0x0f7d17dd1add2afd)),.hi = ((u64)(0x036eb1b091f58a96)),}, (strconv__Uint128){.lo = ((u64)(0x3f97464a7be42264)),.hi = ((u64)(0x02bef48d41913bab)),}, (strconv__Uint128){.lo = ((u64)(0xcc790508631ce850)),.hi = ((u64)(0x02325d3dce0dc955)),}, (strconv__Uint128){.lo = ((u64)(0xe0c1a1a704fb0d4d)),.hi = ((u64)(0x0383c862e3494222)),}, (strconv__Uint128){.lo = ((u64)(0x4d67b4859d95a43e)),.hi = ((u64)(0x02cfd3824f6dce82)),}, (strconv__Uint128){.lo = ((u64)(0x711fc39e17aae9cb)),.hi = ((u64)(0x023fdc683f8b0b9b)),}, (strconv__Uint128){.lo = ((u64)(0xe832d2968c44a945)),.hi = ((u64)(0x039960a6cc11ac2b)),}, (strconv__Uint128){.lo = ((u64)(0xecf575453d03ba9e)),.hi = ((u64)(0x02e11a1f09a7bcef)),}, (strconv__Uint128){.lo = ((u64)(0x572ac4376402fbb1)),.hi = ((u64)(0x024dae7f3aec9726)),}, (strconv__Uint128){.lo = ((u64)(0x58446d256cd192b5)),.hi = ((u64)(0x03af7d985e47583d)),}, (strconv__Uint128){.lo = ((u64)(0x79d0575123dadbc4)),.hi = ((u64)(0x02f2cae04b6c4697)),}, (strconv__Uint128){.lo = ((u64)(0x94a6ac40e97be303)),.hi = ((u64)(0x025bd5803c569edf)),}, (strconv__Uint128){.lo = ((u64)(0x8771139b0f2c9e6c)),.hi = ((u64)(0x03c62266c6f0fe32)),}, (strconv__Uint128){.lo = ((u64)(0x9f8da948d8f07ebd)),.hi = ((u64)(0x0304e85238c0cb5b)),}, (strconv__Uint128){.lo = ((u64)(0xe60aedd3e0c06564)),.hi = ((u64)(0x026a5374fa33d5e2)),}, (strconv__Uint128){.lo = ((u64)(0xa344afb9679a3bd2)),.hi = ((u64)(0x03dd5254c3862304)),}, (strconv__Uint128){.lo = ((u64)(0xe903bfc78614fca8)),.hi = ((u64)(0x031775109c6b4f36)),}, (strconv__Uint128){.lo = ((u64)(0xba6966393810ca20)),.hi = ((u64)(0x02792a73b055d8f8)),}, (strconv__Uint128){.lo = ((u64)(0x2a423d2859b4769a)),.hi = ((u64)(0x03f510b91a22f4c1)),}, (strconv__Uint128){.lo = ((u64)(0xee9b642047c39215)),.hi = ((u64)(0x032a73c7481bf700)),}, (strconv__Uint128){.lo = ((u64)(0xbee2b680396941aa)),.hi = ((u64)(0x02885c9f6ce32c00)),}, (strconv__Uint128){.lo = ((u64)(0xff1bc53361210155)),.hi = ((u64)(0x0206b07f8a4f5666)),}, (strconv__Uint128){.lo = ((u64)(0x31c6085235019bbb)),.hi = ((u64)(0x033de73276e5570b)),}, (strconv__Uint128){.lo = ((u64)(0x27d1a041c4014963)),.hi = ((u64)(0x0297ec285f1ddf3c)),}, (strconv__Uint128){.lo = ((u64)(0xeca7b367d0010782)),.hi = ((u64)(0x021323537f4b18fc)),}, (strconv__Uint128){.lo = ((u64)(0xadd91f0c8001a59d)),.hi = ((u64)(0x0351d21f3211c194)),}, (strconv__Uint128){.lo = ((u64)(0xf17a7f3d3334847e)),.hi = ((u64)(0x02a7db4c280e3476)),}, (strconv__Uint128){.lo = ((u64)(0x279532975c2a0398)),.hi = ((u64)(0x021fe2a3533e905f)),}, (strconv__Uint128){.lo = ((u64)(0xd8eeb75893766c26)),.hi = ((u64)(0x0366376bb8641a31)),}, (strconv__Uint128){.lo = ((u64)(0x7a5892ad42c52352)),.hi = ((u64)(0x02b82c562d1ce1c1)),}, (strconv__Uint128){.lo = ((u64)(0xfb7a0ef102374f75)),.hi = ((u64)(0x022cf044f0e3e7cd)),}, (strconv__Uint128){.lo = ((u64)(0xc59017e8038bb254)),.hi = ((u64)(0x037b1a07e7d30c7c)),}, (strconv__Uint128){.lo = ((u64)(0x37a67986693c8eaa)),.hi = ((u64)(0x02c8e19feca8d6ca)),}, (strconv__Uint128){.lo = ((u64)(0xf951fad1edca0bbb)),.hi = ((u64)(0x023a4e198a20abd4)),}, (strconv__Uint128){.lo = ((u64)(0x28832ae97c76792b)),.hi = ((u64)(0x03907cf5a9cddfbb)),}, (strconv__Uint128){.lo = ((u64)(0x2068ef21305ec756)),.hi = ((u64)(0x02d9fd9154a4b2fc)),}, (strconv__Uint128){.lo = ((u64)(0x19ed8c1a8d189f78)),.hi = ((u64)(0x0247fe0ddd508f30)),}, (strconv__Uint128){.lo = ((u64)(0x5caf4690e1c0ff26)),.hi = ((u64)(0x03a66349621a7eb3)),}, (strconv__Uint128){.lo = ((u64)(0x4a25d20d81673285)),.hi = ((u64)(0x02eb82a11b48655c)),}, (strconv__Uint128){.lo = ((u64)(0x3b5174d79ab8f537)),.hi = ((u64)(0x0256021a7c39eab0)),}, (strconv__Uint128){.lo = ((u64)(0x921bee25c45b21f1)),.hi = ((u64)(0x03bcd02a605caab3)),}, (strconv__Uint128){.lo = ((u64)(0xdb498b5169e2818e)),.hi = ((u64)(0x02fd735519e3bbc2)),}, (strconv__Uint128){.lo = ((u64)(0x15d46f7454b53472)),.hi = ((u64)(0x02645c4414b62fcf)),}, (strconv__Uint128){.lo = ((u64)(0xefba4bed545520b6)),.hi = ((u64)(0x03d3c6d35456b2e4)),}, (strconv__Uint128){.lo = ((u64)(0xf2fb6ff110441a2b)),.hi = ((u64)(0x030fd242a9def583)),}, (strconv__Uint128){.lo = ((u64)(0x8f2f8cc0d9d014ef)),.hi = ((u64)(0x02730e9bbb18c469)),}, (strconv__Uint128){.lo = ((u64)(0xb1e5ae015c80217f)),.hi = ((u64)(0x03eb4a92c4f46d75)),}, (strconv__Uint128){.lo = ((u64)(0xc1848b344a001acc)),.hi = ((u64)(0x0322a20f03f6bdf7)),}, (strconv__Uint128){.lo = ((u64)(0xce03a2903b3348a3)),.hi = ((u64)(0x02821b3f365efe5f)),}, (strconv__Uint128){.lo = ((u64)(0xd802e873628f6d4f)),.hi = ((u64)(0x0201af65c518cb7f)),}, (strconv__Uint128){.lo = ((u64)(0x599e40b89db2487f)),.hi = ((u64)(0x0335e56fa1c14599)),}, (strconv__Uint128){.lo = ((u64)(0xe14b66fa17c1d399)),.hi = ((u64)(0x029184594e3437ad)),}, (strconv__Uint128){.lo = ((u64)(0x81091f2e7967dc7a)),.hi = ((u64)(0x020e037aa4f692f1)),}, (strconv__Uint128){.lo = ((u64)(0x9b41cb7d8f0c93f6)),.hi = ((u64)(0x03499f2aa18a84b5)),}, (strconv__Uint128){.lo = ((u64)(0xaf67d5fe0c0a0ff8)),.hi = ((u64)(0x02a14c221ad536f7)),}, (strconv__Uint128){.lo = ((u64)(0xf2b977fe70080cc7)),.hi = ((u64)(0x021aa34e7bddc592)),}, (strconv__Uint128){.lo = ((u64)(0x1df58cca4cd9ae0b)),.hi = ((u64)(0x035dd2172c9608eb)),}, (strconv__Uint128){.lo = ((u64)(0xe4c470a1d7148b3c)),.hi = ((u64)(0x02b174df56de6d88)),}, (strconv__Uint128){.lo = ((u64)(0x83d05a1b1276d5ca)),.hi = ((u64)(0x022790b2abe5246d)),}, (strconv__Uint128){.lo = ((u64)(0x9fb3c35e83f1560f)),.hi = ((u64)(0x0372811ddfd50715)),}, (strconv__Uint128){.lo = ((u64)(0xb2f635e5365aab3f)),.hi = ((u64)(0x02c200e4b310d277)),}, (strconv__Uint128){.lo = ((u64)(0xf591c4b75eaeef66)),.hi = ((u64)(0x0234cd83c273db92)),}, (strconv__Uint128){.lo = ((u64)(0xef4fa125644b18a3)),.hi = ((u64)(0x0387af39371fc5b7)),}, (strconv__Uint128){.lo = ((u64)(0x8c3fb41de9d5ad4f)),.hi = ((u64)(0x02d2f2942c196af9)),}, (strconv__Uint128){.lo = ((u64)(0x3cffc34b2177bdd9)),.hi = ((u64)(0x02425ba9bce12261)),}, (strconv__Uint128){.lo = ((u64)(0x94cc6bab68bf9628)),.hi = ((u64)(0x039d5f75fb01d09b)),}, (strconv__Uint128){.lo = ((u64)(0x10a38955ed6611b9)),.hi = ((u64)(0x02e44c5e6267da16)),}, (strconv__Uint128){.lo = ((u64)(0xda1c6dde5784dafb)),.hi = ((u64)(0x02503d184eb97b44)),}, (strconv__Uint128){.lo = ((u64)(0xf693e2fd58d49191)),.hi = ((u64)(0x03b394f3b128c53a)),}, (strconv__Uint128){.lo = ((u64)(0xc5431bfde0aa0e0e)),.hi = ((u64)(0x02f610c2f4209dc8)),}, (strconv__Uint128){.lo = ((u64)(0x6a9c1664b3bb3e72)),.hi = ((u64)(0x025e73cf29b3b16d)),}, (strconv__Uint128){.lo = ((u64)(0x10f9bd6dec5eca4f)),.hi = ((u64)(0x03ca52e50f85e8af)),}, (strconv__Uint128){.lo = ((u64)(0xda616457f04bd50c)),.hi = ((u64)(0x03084250d937ed58)),}, (strconv__Uint128){.lo = ((u64)(0xe1e783798d09773d)),.hi = ((u64)(0x026d01da475ff113)),}, (strconv__Uint128){.lo = ((u64)(0x030c058f480f252e)),.hi = ((u64)(0x03e19c9072331b53)),}, (strconv__Uint128){.lo = ((u64)(0x68d66ad906728425)),.hi = ((u64)(0x031ae3a6c1c27c42)),}, (strconv__Uint128){.lo = ((u64)(0x8711ef14052869b7)),.hi = ((u64)(0x027be952349b969b)),}, (strconv__Uint128){.lo = ((u64)(0x0b4fe4ecd50d75f2)),.hi = ((u64)(0x03f97550542c242c)),}, (strconv__Uint128){.lo = ((u64)(0xa2a650bd773df7f5)),.hi = ((u64)(0x032df7737689b689)),}, (strconv__Uint128){.lo = ((u64)(0xb551da312c31932a)),.hi = ((u64)(0x028b2c5c5ed49207)),}, (strconv__Uint128){.lo = ((u64)(0x5ddb14f4235adc22)),.hi = ((u64)(0x0208f049e576db39)),}, (strconv__Uint128){.lo = ((u64)(0x2fc4ee536bc49369)),.hi = ((u64)(0x034180763bf15ec2)),}, (strconv__Uint128){.lo = ((u64)(0xbfd0bea92303a921)),.hi = ((u64)(0x029acd2b63277f01)),}, (strconv__Uint128){.lo = ((u64)(0x9973cbba8269541a)),.hi = ((u64)(0x021570ef8285ff34)),}, (strconv__Uint128){.lo = ((u64)(0x5bec792a6a42202a)),.hi = ((u64)(0x0355817f373ccb87)),}, (strconv__Uint128){.lo = ((u64)(0xe3239421ee9b4cef)),.hi = ((u64)(0x02aacdff5f63d605)),}, (strconv__Uint128){.lo = ((u64)(0xb5b6101b25490a59)),.hi = ((u64)(0x02223e65e5e97804)),}, (strconv__Uint128){.lo = ((u64)(0x22bce691d541aa27)),.hi = ((u64)(0x0369fd6fd64259a1)),}, (strconv__Uint128){.lo = ((u64)(0xb563eba7ddce21b9)),.hi = ((u64)(0x02bb31264501e14d)),}, (strconv__Uint128){.lo = ((u64)(0xf78322ecb171b494)),.hi = ((u64)(0x022f5a850401810a)),}, (strconv__Uint128){.lo = ((u64)(0x259e9e47824f8753)),.hi = ((u64)(0x037ef73b399c01ab)),}, (strconv__Uint128){.lo = ((u64)(0x1e187e9f9b72d2a9)),.hi = ((u64)(0x02cbf8fc2e1667bc)),}, (strconv__Uint128){.lo = ((u64)(0x4b46cbb2e2c24221)),.hi = ((u64)(0x023cc73024deb963)),}, (strconv__Uint128){.lo = ((u64)(0x120adf849e039d01)),.hi = ((u64)(0x039471e6a1645bd2)),}, (strconv__Uint128){.lo = ((u64)(0xdb3be603b19c7d9a)),.hi = ((u64)(0x02dd27ebb4504974)),}, (strconv__Uint128){.lo = ((u64)(0x7c2feb3627b0647c)),.hi = ((u64)(0x024a865629d9d45d)),}, (strconv__Uint128){.lo = ((u64)(0x2d197856a5e7072c)),.hi = ((u64)(0x03aa7089dc8fba2f)),}, (strconv__Uint128){.lo = ((u64)(0x8a7ac6abb7ec05bd)),.hi = ((u64)(0x02eec06e4a0c94f2)),}, (strconv__Uint128){.lo = ((u64)(0xd52f05562cbcd164)),.hi = ((u64)(0x025899f1d4d6dd8e)),}, (strconv__Uint128){.lo = ((u64)(0x21e4d556adfae8a0)),.hi = ((u64)(0x03c0f64fbaf1627e)),}, (strconv__Uint128){.lo = ((u64)(0xe7ea444557fbed4d)),.hi = ((u64)(0x0300c50c958de864)),}, (strconv__Uint128){.lo = ((u64)(0xecbb69d1132ff10a)),.hi = ((u64)(0x0267040a113e5383)),}, (strconv__Uint128){.lo = ((u64)(0xadf8a94e851981aa)),.hi = ((u64)(0x03d8067681fd526c)),}, (strconv__Uint128){.lo = ((u64)(0x8b2d543ed0e13488)),.hi = ((u64)(0x0313385ece6441f0)),}, (strconv__Uint128){.lo = ((u64)(0xd5bddcff0d80f6d3)),.hi = ((u64)(0x0275c6b23eb69b26)),}, (strconv__Uint128){.lo = ((u64)(0x892fc7fe7c018aeb)),.hi = ((u64)(0x03efa45064575ea4)),}, (strconv__Uint128){.lo = ((u64)(0x3a8c9ffec99ad589)),.hi = ((u64)(0x03261d0d1d12b21d)),}, (strconv__Uint128){.lo = ((u64)(0xc8707fff07af113b)),.hi = ((u64)(0x0284e40a7da88e7d)),}, (strconv__Uint128){.lo = ((u64)(0x39f39998d2f2742f)),.hi = ((u64)(0x0203e9a1fe2071fe)),}, (strconv__Uint128){.lo = ((u64)(0x8fec28f484b7204b)),.hi = ((u64)(0x033975cffd00b663)),}, (strconv__Uint128){.lo = ((u64)(0xd989ba5d36f8e6a2)),.hi = ((u64)(0x02945e3ffd9a2b82)),}, (strconv__Uint128){.lo = ((u64)(0x47a161e42bfa521c)),.hi = ((u64)(0x02104b66647b5602)),}, (strconv__Uint128){.lo = ((u64)(0x0c35696d132a1cf9)),.hi = ((u64)(0x034d4570a0c5566a)),}, (strconv__Uint128){.lo = ((u64)(0x09c454574288172d)),.hi = ((u64)(0x02a4378d4d6aab88)),}, (strconv__Uint128){.lo = ((u64)(0xa169dd129ba0128b)),.hi = ((u64)(0x021cf93dd7888939)),}, (strconv__Uint128){.lo = ((u64)(0x0242fb50f9001dab)),.hi = ((u64)(0x03618ec958da7529)),}, (strconv__Uint128){.lo = ((u64)(0x9b68c90d940017bc)),.hi = ((u64)(0x02b4723aad7b90ed)),}, (strconv__Uint128){.lo = ((u64)(0x4920a0d7a999ac96)),.hi = ((u64)(0x0229f4fbbdfc73f1)),}, (strconv__Uint128){.lo = ((u64)(0x750101590f5c4757)),.hi = ((u64)(0x037654c5fcc71fe8)),}, (strconv__Uint128){.lo = ((u64)(0x2a6734473f7d05df)),.hi = ((u64)(0x02c5109e63d27fed)),}, (strconv__Uint128){.lo = ((u64)(0xeeb8f69f65fd9e4c)),.hi = ((u64)(0x0237407eb641fff0)),}, (strconv__Uint128){.lo = ((u64)(0xe45b24323cc8fd46)),.hi = ((u64)(0x038b9a6456cfffe7)),}, (strconv__Uint128){.lo = ((u64)(0xb6af502830a0ca9f)),.hi = ((u64)(0x02d6151d123fffec)),}, (strconv__Uint128){.lo = ((u64)(0xf88c402026e7087f)),.hi = ((u64)(0x0244ddb0db666656)),}, (strconv__Uint128){.lo = ((u64)(0x2746cd003e3e73fe)),.hi = ((u64)(0x03a162b4923d708b)),}, (strconv__Uint128){.lo = ((u64)(0x1f6bd73364fec332)),.hi = ((u64)(0x02e7822a0e978d3c)),}, (strconv__Uint128){.lo = ((u64)(0xe5efdf5c50cbcf5b)),.hi = ((u64)(0x0252ce880bac70fc)),}, (strconv__Uint128){.lo = ((u64)(0x3cb2fefa1adfb22b)),.hi = ((u64)(0x03b7b0d9ac471b2e)),}, (strconv__Uint128){.lo = ((u64)(0x308f3261af195b56)),.hi = ((u64)(0x02f95a47bd05af58)),}, (strconv__Uint128){.lo = ((u64)(0x5a0c284e25ade2ab)),.hi = ((u64)(0x0261150630d15913)),}, (strconv__Uint128){.lo = ((u64)(0x29ad0d49d5e30445)),.hi = ((u64)(0x03ce8809e7b55b52)),}, (strconv__Uint128){.lo = ((u64)(0x548a7107de4f369d)),.hi = ((u64)(0x030ba007ec9115db)),}, (strconv__Uint128){.lo = ((u64)(0xdd3b8d9fe50c2bb1)),.hi = ((u64)(0x026fb3398a0dab15)),}, (strconv__Uint128){.lo = ((u64)(0x952c15cca1ad12b5)),.hi = ((u64)(0x03e5eb8f434911bc)),}, (strconv__Uint128){.lo = ((u64)(0x775677d6e7bda891)),.hi = ((u64)(0x031e560c35d40e30)),}, (strconv__Uint128){.lo = ((u64)(0xc5dec645863153a7)),.hi = ((u64)(0x027eab3cf7dcd826)),}}));
	// Initializations for module builtin :
	_const_init_capicity = 1 << _const_init_log_capicity;
	_const_init_cap = _const_init_capicity - 2;
	_const_hash_mask = ((u32)(0x00FFFFFF));
	_const_probe_inc = ((u32)(0x01000000));
	_const_mid_index = _const_degree - 1;
	_const_max_len = 2 * _const_degree - 1;
	_const_children_bytes = /*SizeOfType*/ sizeof(voidptr) * (_const_max_len + 1);
	// Initializations for module json :
	// Initializations for module os :
	_const_os__std_input_handle = -10;
	_const_os__std_output_handle = -11;
	_const_os__std_error_handle = -12;
	_const_os__args = __new_array_with_default(0, 0, sizeof(string), 0);
	_const_os__wd_at_startup = os__getwd();
	// Initializations for module time :
	_const_time__month_days = new_array_from_c_array(12, 12, sizeof(int), _MOV((int[12]){
		31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31}));
	_const_time__absolute_zero_year = ((i64)(-292277022399));
	_const_time__seconds_per_hour = 60 * _const_time__seconds_per_minute;
	_const_time__seconds_per_day = 24 * _const_time__seconds_per_hour;
	_const_time__seconds_per_week = 7 * _const_time__seconds_per_day;
	_const_time__days_per_400_years = 365 * 400 + 97;
	_const_time__days_per_100_years = 365 * 100 + 24;
	_const_time__days_per_4_years = 365 * 4 + 1;
	_const_time__days_before = new_array_from_c_array(13, 13, sizeof(int), _MOV((int[13]){
		0, 31, 31 + 28, 31 + 28 + 31, 31 + 28 + 31 + 30, 31 + 28 + 31 + 30 + 31, 31 + 28 + 31 + 30 + 31 + 30, 31 + 28 + 31 + 30 + 31 + 30 + 31, 31 + 28 + 31 + 30 + 31 + 30 + 31 + 31, 31 + 28 + 31 + 30 + 31 + 30 + 31 + 31 + 30, 31 + 28 + 31 + 30 + 31 + 30 + 31 + 31 + 30 + 31, 31 + 28 + 31 + 30 + 31 + 30 + 31 + 31 + 30 + 31 + 30, 31 + 28 + 31 + 30 + 31 + 30 + 31 + 31 + 30 + 31 + 30 + 31}));
	_const_time__nanosecond = ((time__Duration)(1));
	_const_time__microsecond = ((time__Duration)(1000)) * _const_time__nanosecond;
	_const_time__millisecond = ((time__Duration)(1000)) * _const_time__microsecond;
	_const_time__second = ((time__Duration)(1000)) * _const_time__millisecond;
	_const_time__minute = ((time__Duration)(60)) * _const_time__second;
	_const_time__hour = ((time__Duration)(60)) * _const_time__minute;
	// Initializations for module hl :
	_const_hl__langs = hl__init_langs();
	// Initializations for module sqlite :
	// Initializations for module math :
	_const_math__uvnan = ((u64)(0x7FF8000000000001));
	_const_math__uvinf = ((u64)(0x7FF0000000000000));
	_const_math__uvneginf = ((u64)(0xFFF0000000000000));
	_const_math__uvone = ((u64)(0x3FF0000000000000));
	_const_math__shift = 64 - 11 - 1;
	_const_math__sign_mask = (((u64)(1)) << 63);
	_const_math__frac_mask = ((((u64)(1)) << ((u64)(_const_math__shift))) - ((u64)(1)));
	_const_math__log2_e = 1.0 / _const_math__ln2;
	_const_math__log10_e = 1.0 / _const_math__ln10;
	_const_math__min_i8 = -128;
	_const_math__min_i16 = -32768;
	_const_math__min_i32 = -2147483648;
	_const_math__min_i64 = ((i64)(-9223372036854775807 - 1));
	_const_math__max_i64 = ((i64)(9223372036854775807));
	_const_math__max_u32 = ((u32)(4294967295));
	_const_math__max_u64 = ((u64)(18446744073709551615));
	// Initializations for module net.urllib :
	// Initializations for module encoding.binary :
	// Initializations for module net.openssl :
	net__openssl__init();
	// Initializations for module net.http.chunked :
	// Initializations for module crypto.sha1 :
	// Initializations for module crypto.sha256 :
	_const_crypto__sha256___k = new_array_from_c_array(64, 64, sizeof(int), _MOV((int[64]){
		0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5, 0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174, 0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da, 0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967, 0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85, 0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070, 0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3, 0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2}));
	// Initializations for module net :
	// Initializations for module term :
	// Initializations for module rand.util :
	_const_rand__util__lower_mask = ((u64)(0x00000000FFFFFFFF));
	_const_rand__util__max_u32_as_f32 = ((f32)(_const_rand__util__max_u32)) + 1;
	_const_rand__util__max_u64_as_f64 = ((f64)(_const_rand__util__max_u64)) + 1;
	_const_rand__util__u31_mask = ((u32)(0x7FFFFFFF));
	_const_rand__util__u63_mask = ((u64)(0x7FFFFFFFFFFFFFFF));
	// Initializations for module runtime :
	// Initializations for module log :
	// Initializations for module net.http :
	_const_net__http__is_used = _const_net__openssl__is_used;
	// Initializations for module sync :
	_const_sync__no_result = ((voidptr)(0));
	// Initializations for module rand.wyrand :
	_const_rand__wyrand__wyp0 = ((u64)(0xa0761d6478bd642f));
	_const_rand__wyrand__wyp1 = ((u64)(0xe7037ed1a0b428db));
	// Initializations for module vweb :
	_const_vweb__methods_with_form = new_array_from_c_array(3, 3, sizeof(string), _MOV((string[3]){tos_lit("POST"), tos_lit("PUT"), tos_lit("PATCH")}));
	_const_vweb__method_all = new_array_from_c_array(7, 7, sizeof(string), _MOV((string[7]){tos_lit("GET"), tos_lit("POST"), tos_lit("PUT"), tos_lit("PATCH"), tos_lit("DELETE"), tos_lit("HEAD"), tos_lit("OPTIONS")}));
	_const_vweb__headers_close = _STR("%.*s\000%.*s\000\r\n", 3, _const_vweb__header_server, _const_vweb__header_connection_close);
	_const_vweb__http_404 = _STR("HTTP/1.1 404 Not Found\r\nContent-Type: text/plain\r\n%.*s\000404 Not Found", 2, _const_vweb__headers_close);
	_const_vweb__http_500 = _STR("HTTP/1.1 500 Internal Server Error\r\nContent-Type: text/plain\r\n%.*s\000500 Internal Server Error", 2, _const_vweb__headers_close);
	_const_vweb__mime_types = new_map_init(13, sizeof(string), _MOV((string[13]){tos_lit(".css"), tos_lit(".gif"), tos_lit(".htm"), tos_lit(".html"), tos_lit(".jpg"), tos_lit(".js"), tos_lit(".md"), tos_lit(".pdf"), tos_lit(".png"), tos_lit(".svg"), tos_lit(".txt"), tos_lit(".wasm"), tos_lit(".xml"), }), _MOV((string[13]){tos_lit("text/css; charset=utf-8"), tos_lit("image/gif"), tos_lit("text/html; charset=utf-8"), tos_lit("text/html; charset=utf-8"), tos_lit("image/jpeg"), tos_lit("application/javascript"), tos_lit("text/markdown; charset=utf-8"), tos_lit("application/pdf"), tos_lit("image/png"), tos_lit("image/svg+xml"), tos_lit("text/plain; charset=utf-8"), tos_lit("application/wasm"), tos_lit("text/xml; charset=utf-8"), }));
	_const_vweb__max_http_post_size = 1024 * 1024;
	// Initializations for module rand :
	rand__init();
	// Initializations for module main :
	_const_main__namechange_period = _const_time__hour * 24;
	_const_main__test_lang_stats = new_array_from_c_array(2, 2, sizeof(main__LangStat), _MOV((main__LangStat[2]){(main__LangStat){.id = 0,.repo_id = 0,.name = tos_lit("V"),.nr_lines = 96657,.pct = 989,.color = tos_lit("#5d87bd"),}, (main__LangStat){.id = 0,.repo_id = 0,.name = tos_lit("JavaScript"),.nr_lines = 1131,.pct = 11,.color = tos_lit("#f1e05a"),}}));
	_const_main__ignored_folder = new_array_from_c_array(1, 1, sizeof(string), _MOV((string[1]){tos_lit("thirdparty")}));
}

int main(int ___argc, char** ___argv){
	_vinit();
	_const_os__args = os__init_os_args(___argc, (byteptr*)___argv);
	main__main();
	return 0;
}

// THE END.

